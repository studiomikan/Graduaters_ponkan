/*!
 * ponkan v1.0.0
 * (C) Studio Mikan
 * license: MIT
 */!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=29)}([function(t,e,n){"use strict";n.r(e),n.d(e,"BaseTextureCache",(function(){return j})),n.d(e,"CanvasRenderTarget",(function(){return H})),n.d(e,"DATA_URI",(function(){return W})),n.d(e,"ProgramCache",(function(){return N})),n.d(e,"TextureCache",(function(){return V})),n.d(e,"clearTextureCache",(function(){return X})),n.d(e,"correctBlendMode",(function(){return x})),n.d(e,"createIndicesForQuads",(function(){return E})),n.d(e,"decomposeDataUri",(function(){return z})),n.d(e,"deprecation",(function(){return R})),n.d(e,"destroyTextureCache",(function(){return U})),n.d(e,"determineCrossOrigin",(function(){return q})),n.d(e,"getBufferType",(function(){return P})),n.d(e,"getResolutionOfUrl",(function(){return K})),n.d(e,"hex2rgb",(function(){return y})),n.d(e,"hex2string",(function(){return m})),n.d(e,"interleaveTypedArrays",(function(){return k})),n.d(e,"isPow2",(function(){return I})),n.d(e,"isWebGLSupported",(function(){return g})),n.d(e,"log2",(function(){return O})),n.d(e,"nextPow2",(function(){return A})),n.d(e,"premultiplyBlendMode",(function(){return _})),n.d(e,"premultiplyRgba",(function(){return w})),n.d(e,"premultiplyTint",(function(){return T})),n.d(e,"premultiplyTintToRgba",(function(){return S})),n.d(e,"removeItems",(function(){return L})),n.d(e,"rgb2hex",(function(){return b})),n.d(e,"sayHello",(function(){return f})),n.d(e,"sign",(function(){return M})),n.d(e,"skipHello",(function(){return d})),n.d(e,"string2hex",(function(){return v})),n.d(e,"trimCanvas",(function(){return G})),n.d(e,"uid",(function(){return D}));var r=n(4);n.d(e,"isMobile",(function(){return r.a}));var i=n(22),o=n.n(i);n.d(e,"EventEmitter",(function(){return o.a}));var s=n(23),a=n.n(s);n.d(e,"earcut",(function(){return a.a}));var u=n(17),h=n.n(u);n.d(e,"url",(function(){return h.a}));var l=n(1);
/*!
 * @pixi/utils - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */r.b.RETINA_PREFIX=/@([0-9\.]+)x/,r.b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var c,p=!1;function d(){p=!0}function f(t){var e;if(!p){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var n=["\n %c %c %c PixiJS 5.2.3 - ✰ "+t+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=window.console).log.apply(e,n)}else window.console&&window.console.log("PixiJS 5.2.3 - "+t+" - http://www.pixijs.com/");p=!0}}function g(){return void 0===c&&(c=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:r.b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),i=!(!n||!n.getContextAttributes().stencil);if(n){var o=n.getExtension("WEBGL_lose_context");o&&o.loseContext()}return n=null,i}catch(t){return!1}}()),c}function y(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function m(t){var e=t.toString(16);return"#"+(e="000000".substr(0,6-e.length)+e)}function v(t){return"string"==typeof t&&"#"===t[0]&&(t=t.substr(1)),parseInt(t,16)}function b(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)}var _=function(){for(var t=[],e=[],n=0;n<32;n++)t[n]=n,e[n]=n;t[l.b.NORMAL_NPM]=l.b.NORMAL,t[l.b.ADD_NPM]=l.b.ADD,t[l.b.SCREEN_NPM]=l.b.SCREEN,e[l.b.NORMAL]=l.b.NORMAL_NPM,e[l.b.ADD]=l.b.ADD_NPM,e[l.b.SCREEN]=l.b.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function x(t,e){return _[e?1:0][t]}function w(t,e,n,r){return n=n||new Float32Array(4),r||void 0===r?(n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e):(n[0]=t[0],n[1]=t[1],n[2]=t[2]),n[3]=e,n}function T(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var n=t>>16&255,r=t>>8&255,i=255&t;return(255*e<<24)+((n=n*e+.5|0)<<16)+((r=r*e+.5|0)<<8)+(i=i*e+.5|0)}function S(t,e,n,r){return(n=n||new Float32Array(4))[0]=(t>>16&255)/255,n[1]=(t>>8&255)/255,n[2]=(255&t)/255,(r||void 0===r)&&(n[0]*=e,n[1]*=e,n[2]*=e),n[3]=e,n}function E(t,e){void 0===e&&(e=null);var n=6*t;if((e=e||new Uint16Array(n)).length!==n)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+n);for(var r=0,i=0;r<n;r+=6,i+=4)e[r+0]=i+0,e[r+1]=i+1,e[r+2]=i+2,e[r+3]=i+0,e[r+4]=i+2,e[r+5]=i+3;return e}function P(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}var C={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function k(t,e){for(var n=0,r=0,i={},o=0;o<t.length;o++)r+=e[o],n+=t[o].length;var s=new ArrayBuffer(4*n),a=null,u=0;for(o=0;o<t.length;o++){var h=e[o],l=t[o],c=P(l);i[c]||(i[c]=new C[c](s)),a=i[c];for(var p=0;p<l.length;p++){a[(p/h|0)*r+u+p%h]=l[p]}u+=h}return new Float32Array(s)}function A(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function I(t){return!(t&t-1||!t)}function O(t){var e=(t>65535?1:0)<<4,n=((t>>>=e)>255?1:0)<<3;return e|=n,e|=n=((t>>>=n)>15?1:0)<<2,(e|=n=((t>>>=n)>3?1:0)<<1)|(t>>>=n)>>1}function L(t,e,n){var r,i=t.length;if(!(e>=i||0===n)){var o=i-(n=e+n>i?i-e:n);for(r=e;r<o;++r)t[r]=t[r+n];t.length=o}}function M(t){return 0===t?0:t<0?-1:1}var B=0;function D(){return++B}var F={};function R(t,e,n){if(void 0===n&&(n=3),!F[e]){var r=(new Error).stack;void 0===r?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(r=r.split("\n").splice(n).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(r))),F[e]=!0}}var N={},V=Object.create(null),j=Object.create(null);function U(){var t;for(t in V)V[t].destroy();for(t in j)j[t].destroy()}function X(){var t;for(t in V)delete V[t];for(t in j)delete j[t]}var H=function(){function t(t,e,n){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=n||r.b.RESOLUTION,this.resize(t,e)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!0,configurable:!0}),t}();function G(t){var e,n,r,i=t.width,o=t.height,s=t.getContext("2d"),a=s.getImageData(0,0,i,o).data,u=a.length,h={top:null,left:null,right:null,bottom:null},l=null;for(e=0;e<u;e+=4)0!==a[e+3]&&(n=e/4%i,r=~~(e/4/i),null===h.top&&(h.top=r),(null===h.left||n<h.left)&&(h.left=n),(null===h.right||h.right<n)&&(h.right=n+1),(null===h.bottom||h.bottom<r)&&(h.bottom=r));return null!==h.top&&(i=h.right-h.left,o=h.bottom-h.top+1,l=s.getImageData(h.left,h.top,i,o)),{height:o,width:i,data:l}}var Y,W=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function z(t){var e=W.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}}function q(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,Y||(Y=document.createElement("a")),Y.href=t;var n=Object(u.parse)(Y.href),r=!n.port&&""===e.port||n.port===e.port;return n.hostname===e.hostname&&r&&n.protocol===e.protocol?"":"anonymous"}function K(t,e){var n=r.b.RETINA_PREFIX.exec(t);return n?parseFloat(n[1]):void 0!==e?e:1}},function(t,e,n){"use strict";
/*!
 * @pixi/constants - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var r,i,o,s,a,u,h,l,c,p,d,f,g,y;n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return r})),n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return f})),n.d(e,"g",(function(){return y})),n.d(e,"h",(function(){return p})),n.d(e,"i",(function(){return g})),n.d(e,"j",(function(){return i})),n.d(e,"k",(function(){return l})),n.d(e,"l",(function(){return u})),n.d(e,"m",(function(){return h})),n.d(e,"n",(function(){return c})),function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(r||(r={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(i||(i={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(o||(o={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(s||(s={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(a||(a={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(u||(u={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(h||(h={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(l||(l={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(c||(c={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(p||(p={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(d||(d={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(f||(f={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(g||(g={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(y||(y={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return _})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return x})),n.d(e,"d",(function(){return h})),n.d(e,"e",(function(){return o})),n.d(e,"f",(function(){return s})),n.d(e,"g",(function(){return i})),n.d(e,"h",(function(){return w})),n.d(e,"i",(function(){return a})),n.d(e,"j",(function(){return b})),n.d(e,"k",(function(){return T})),n.d(e,"l",(function(){return r})),n.d(e,"m",(function(){return v})),n.d(e,"n",(function(){return m}));
/*!
 * @pixi/math - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var r,i=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}(),o=function(){function t(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0),this._x=n,this._y=r,this.cb=t,this.scope=e}return t.prototype.clone=function(e,n){return void 0===e&&(e=this.cb),void 0===n&&(n=this.scope),new t(e,n,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),t}(),s=2*Math.PI,a=180/Math.PI,u=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(r||(r={}));var h=function(){function t(t,e,n,r,i,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===i&&(i=0),void 0===o&&(o=0),this.array=null,this.a=t,this.b=e,this.c=n,this.d=r,this.tx=i,this.ty=o}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,n,r,i,o){return this.a=t,this.b=e,this.c=n,this.d=r,this.tx=i,this.ty=o,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n},t.prototype.apply=function(t,e){e=e||new i;var n=t.x,r=t.y;return e.x=this.a*n+this.c*r+this.tx,e.y=this.b*n+this.d*r+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new i;var n=1/(this.a*this.d+this.c*-this.b),r=t.x,o=t.y;return e.x=this.d*n*r+-this.c*n*o+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*o+-this.b*n*r+(-this.ty*this.a+this.tx*this.b)*n,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),r=this.a,i=this.c,o=this.tx;return this.a=r*e-this.b*n,this.b=r*n+this.b*e,this.c=i*e-this.d*n,this.d=i*n+this.d*e,this.tx=o*e-this.ty*n,this.ty=o*n+this.ty*e,this},t.prototype.append=function(t){var e=this.a,n=this.b,r=this.c,i=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*n+t.b*i,this.c=t.c*e+t.d*r,this.d=t.c*n+t.d*i,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*n+t.ty*i+this.ty,this},t.prototype.setTransform=function(t,e,n,r,i,o,s,a,u){return this.a=Math.cos(s+u)*i,this.b=Math.sin(s+u)*i,this.c=-Math.sin(s-a)*o,this.d=Math.cos(s-a)*o,this.tx=t-(n*this.a+r*this.c),this.ty=e-(n*this.b+r*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var n=this.a,r=this.c;this.a=n*t.a+this.b*t.c,this.b=n*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,n=this.b,r=this.c,i=this.d,o=-Math.atan2(-r,i),a=Math.atan2(n,e),u=Math.abs(o+a);return u<1e-5||Math.abs(s-u)<1e-5?(t.rotation=a,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=a),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(r*r+i*i),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,n=this.c,r=this.d,i=this.tx,o=t*r-e*n;return this.a=r/o,this.b=-e/o,this.c=-n/o,this.d=t/o,this.tx=(n*this.ty-r*i)/o,this.ty=-(t*this.ty-e*i)/o,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!0,configurable:!0}),t}(),l=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],c=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],p=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],d=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],f=[],g=[],y=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];f.push(e);for(var n=0;n<16;n++)for(var r=y(l[t]*l[n]+p[t]*c[n]),i=y(c[t]*l[n]+d[t]*c[n]),o=y(l[t]*p[n]+p[t]*d[n]),s=y(c[t]*p[n]+d[t]*d[n]),a=0;a<16;a++)if(l[a]===r&&c[a]===i&&p[a]===o&&d[a]===s){e.push(a);break}}for(t=0;t<16;t++){var u=new h;u.set(l[t],c[t],p[t],d[t],0,0),g.push(u)}}();var m={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return l[t]},uY:function(t){return c[t]},vX:function(t){return p[t]},vY:function(t){return d[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return f[t][e]},sub:function(t,e){return f[t][m.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?m.S:m.N:2*Math.abs(e)<=Math.abs(t)?t>0?m.E:m.W:e>0?t>0?m.SE:m.SW:t>0?m.NE:m.NW},matrixAppendRotationInv:function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var i=g[m.inv(e)];i.tx=n,i.ty=r,t.append(i)}},v=function(){function t(){this.worldTransform=new h,this.localTransform=new h,this.position=new o(this.onChange,this,0,0),this.scale=new o(this.onChange,this,1,1),this.pivot=new o(this.onChange,this,0,0),this.skew=new o(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var n=t.worldTransform,r=this.worldTransform;r.a=e.a*n.a+e.b*n.c,r.b=e.a*n.b+e.b*n.d,r.c=e.c*n.a+e.d*n.c,r.d=e.c*n.b+e.d*n.d,r.tx=e.tx*n.a+e.ty*n.c+n.tx,r.ty=e.tx*n.b+e.ty*n.d+n.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),t.IDENTITY=new t,t}(),b=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(i),this.type=r.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),i=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=r,this.height=Math.max(i-r,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var n=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=r-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),i=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=r,this.height=i-r,this},t}(),_=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.radius=n,this.type=r.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var n=this.radius*this.radius,r=this.x-t,i=this.y-e;return(r*=r)+(i*=i)<=n},t.prototype.getBounds=function(){return new b(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t}(),x=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=n,this.height=i,this.type=r.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var n=(t-this.x)/this.width,r=(e-this.y)/this.height;return(n*=n)+(r*=r)<=1},t.prototype.getBounds=function(){return new b(this.x-this.width,this.y-this.height,this.width,this.height)},t}(),w=function(){function t(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof i){for(var o=[],s=0,a=(e=e).length;s<a;s++)o.push(e[s].x,e[s].y);e=o}this.points=e,this.type=r.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var n=!1,r=this.points.length/2,i=0,o=r-1;i<r;o=i++){var s=this.points[2*i],a=this.points[2*i+1],u=this.points[2*o],h=this.points[2*o+1];a>e!=h>e&&t<(e-a)/(h-a)*(u-s)+s&&(n=!n)}return n},t}(),T=function(){function t(t,e,n,i,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=20),this.x=t,this.y=e,this.width=n,this.height=i,this.radius=o,this.type=r.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var n=t-(this.x+this.radius),r=e-(this.y+this.radius),i=this.radius*this.radius;if(n*n+r*r<=i)return!0;if((n=t-(this.x+this.width-this.radius))*n+r*r<=i)return!0;if(n*n+(r=e-(this.y+this.height-this.radius))*r<=i)return!0;if((n=t-(this.x+this.radius))*n+r*r<=i)return!0}return!1},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return de})),n.d(e,"b",(function(){return re})),n.d(e,"c",(function(){return R})),n.d(e,"d",(function(){return I})),n.d(e,"e",(function(){return v})),n.d(e,"f",(function(){return he})),n.d(e,"g",(function(){return ge})),n.d(e,"h",(function(){return ve})),n.d(e,"i",(function(){return _e})),n.d(e,"j",(function(){return fe})),n.d(e,"k",(function(){return le})),n.d(e,"l",(function(){return V})),n.d(e,"m",(function(){return ue})),n.d(e,"n",(function(){return Dt})),n.d(e,"o",(function(){return k})),n.d(e,"p",(function(){return zt})),n.d(e,"q",(function(){return $t})),n.d(e,"r",(function(){return Y})),n.d(e,"s",(function(){return st})),n.d(e,"t",(function(){return Q})),n.d(e,"u",(function(){return At})),n.d(e,"v",(function(){return W})),n.d(e,"w",(function(){return z})),n.d(e,"x",(function(){return D})),n.d(e,"y",(function(){return F})),n.d(e,"z",(function(){return ie})),n.d(e,"A",(function(){return Ot})),n.d(e,"B",(function(){return Vt})),n.d(e,"C",(function(){return Mt})),n.d(e,"D",(function(){return P})),n.d(e,"E",(function(){return M})),n.d(e,"F",(function(){return Rt})),n.d(e,"G",(function(){return O})),n.d(e,"H",(function(){return K})),n.d(e,"I",(function(){return ce})),n.d(e,"J",(function(){return oe})),n.d(e,"K",(function(){return Et})),n.d(e,"L",(function(){return ae})),n.d(e,"M",(function(){return se})),n.d(e,"N",(function(){return E})),n.d(e,"O",(function(){return ee}));var r=n(7),i=n(0),o=n(1),s=n(4),a=n(6),u=n(2),h=n(5),l=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new r.a("setRealSize",2),this.onUpdate=new r.a("update"),this.onError=new r.a("onError",1)},c={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};l.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},l.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},l.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},c.valid.get=function(){return!!this._width&&!!this._height},l.prototype.update=function(){this.destroyed||this.onUpdate.run()},l.prototype.load=function(){return Promise.resolve()},c.width.get=function(){return this._width},c.height.get=function(){return this._height},l.prototype.upload=function(t,e,n){return!1},l.prototype.style=function(t,e,n){return!1},l.prototype.dispose=function(){},l.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(l.prototype,c);var p=function(t){function e(e){var n=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;t.call(this,n,r),this.source=e,this.noSubImage=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.crossOrigin=function(t,e,n){void 0===n&&0!==e.indexOf("data:")?t.crossOrigin=Object(i.determineCrossOrigin)(e):!1!==n&&(t.crossOrigin="string"==typeof n?n:"anonymous")},e.prototype.upload=function(t,e,n,r){var i=t.gl,s=e.realWidth,a=e.realHeight;return r=r||this.source,i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===o.a.UNPACK),this.noSubImage||e.target!==i.TEXTURE_2D||n.width!==s||n.height!==a?(n.width=s,n.height=a,i.texImage2D(e.target,0,e.format,e.format,e.type,r)):i.texSubImage2D(i.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source.naturalWidth||this.source.videoWidth||this.source.width,n=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(e,n),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(l),d=function(t){function e(e,n){if(n=n||{},!(e instanceof HTMLImageElement)){var r=new Image;t.crossOrigin(r,e,n.crossorigin),r.src=e,e=r}t.call(this,e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==n.createBitmap?n.createBitmap:s.b.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof n.alphaMode?n.alphaMode:null,void 0!==n.premultiplyAlpha&&(this.premultiplyAlpha=n.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==n.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(t){var e=this;return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,n){e.url=e.source.src;var r=e.source,i=function(){e.destroyed||(r.onload=null,r.onerror=null,e.resize(r.width,r.height),e._load=null,e.createBitmap?t(e.process()):t(e))};r.complete&&r.src?i():(r.onload=i,r.onerror=function(t){n(t),e.onError.emit(t)})}))),this._load},e.prototype.process=function(){var t=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===o.a.UNPACK?"premultiply":"none"}).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process):Promise.resolve(this)},e.prototype.upload=function(e,n,r){if("number"==typeof this.alphaMode&&(n.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,n,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,n,r,this.bitmap),!this.preserveBitmap){var i=!0;for(var o in n._glTextures){var s=n._glTextures[o];if(s!==r&&s.dirtyId!==n.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e}(p),f=[];function g(t,e){if(!t)return null;var n="";if("string"==typeof t){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(n=r[1].toLowerCase())}for(var i=f.length-1;i>=0;--i){var o=f[i];if(o.test&&o.test(t,n))return new o(t,e)}return new d(t,e)}var y=function(t){function e(e,n){var r=n||{},i=r.width,o=r.height;if(!i||!o)throw new Error("BufferResource width or height invalid");t.call(this,i,o),this.data=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,n){var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===o.a.UNPACK),n.width===e.width&&n.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(n.width=e.width,n.height=e.height,r.texImage2D(e.target,0,n.internalFormat,e.width,e.height,0,e.format,n.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(l),m={scaleMode:o.k.NEAREST,format:o.e.RGBA,alphaMode:o.a.NPM},v=function(t){function e(e,n){void 0===e&&(e=null),void 0===n&&(n=null),t.call(this);var r=(n=n||{}).alphaMode,a=n.mipmap,u=n.anisotropicLevel,h=n.scaleMode,c=n.width,p=n.height,d=n.wrapMode,f=n.format,y=n.type,m=n.target,v=n.resolution,b=n.resourceOptions;!e||e instanceof l||((e=g(e,b)).internal=!0),this.width=c||0,this.height=p||0,this.resolution=v||s.b.RESOLUTION,this.mipmap=void 0!==a?a:s.b.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==u?u:s.b.ANISOTROPIC_LEVEL,this.wrapMode=d||s.b.WRAP_MODE,this.scaleMode=void 0!==h?h:s.b.SCALE_MODE,this.format=f||o.e.RGBA,this.type=y||o.m.UNSIGNED_BYTE,this.target=m||o.l.TEXTURE_2D,this.alphaMode=void 0!==r?r:o.a.UNPACK,void 0!==n.premultiplyAlpha&&(this.premultiplyAlpha=n.premultiplyAlpha),this.uid=Object(i.uid)(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=c>0&&p>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={realWidth:{configurable:!0},realHeight:{configurable:!0}};return n.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},n.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},e.prototype.setStyle=function(t,e){var n;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,n=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,n=!0),n&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,n){return this.resolution=n||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,n){return this.resolution=n||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=Object(i.isPow2)(this.realWidth)&&Object(i.isPow2)(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete i.BaseTextureCache[this.cacheId],delete i.TextureCache[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.from=function(t,n,r){void 0===r&&(r=s.b.STRICT_TEXTURE_CACHE);var o="string"==typeof t,a=null;o?a=t:(t._pixiId||(t._pixiId="pixiid_"+Object(i.uid)()),a=t._pixiId);var u=i.BaseTextureCache[a];if(o&&r&&!u)throw new Error('The cacheId "'+a+'" does not exist in BaseTextureCache.');return u||((u=new e(t,n)).cacheId=a,e.addToCache(u,a)),u},e.fromBuffer=function(t,n,r,i){t=t||new Float32Array(n*r*4);var s=new y(t,{width:n,height:r}),a=t instanceof Float32Array?o.m.FLOAT:o.m.UNSIGNED_BYTE;return new e(s,Object.assign(m,i||{width:n,height:r,type:a}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),i.BaseTextureCache[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),i.BaseTextureCache[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=i.BaseTextureCache[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete i.BaseTextureCache[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete i.BaseTextureCache[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(e.prototype,n),e}(i.EventEmitter);v._globalBatch=0;var b=function(t){function e(e,n){var r;n=n||{};var i=e;Array.isArray(e)&&(r=e,i=e.length),t.call(this,n.width,n.height),this.items=[],this.itemDirtyIds=[];for(var o=0;o<i;o++){var s=new v;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=i,this._load=null,r)for(var a=0;a<i;a++)this.addResourceAt(g(r[a],n),a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=o.l.TEXTURE_2D_ARRAY;for(var n=0;n<this.length;n++)this.items[n].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var n=0;n<this.length;n++)this.items[n].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})),n=e.map((function(t){return t.load()}));return this._load=Promise.all(n).then((function(){var n=e[0],r=n.width,i=n.height;return t.resize(r,i),Promise.resolve(t)})),this._load},e.prototype.upload=function(t,e,n){var r=this.length,i=this.itemDirtyIds,o=this.items,s=t.gl;n.dirtyId<0&&s.texImage3D(s.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var u=o[a];i[a]<u.dirtyId&&(i[a]=u.dirtyId,u.valid&&s.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,a,u.resource.width,u.resource.height,1,e.format,e.type,u.resource.source))}return!0},e}(l),_=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(p),x=function(t){function e(n,r){if(r=r||{},t.call(this,n,r),this.length!==e.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<e.SIDES;i++)this.items[i].target=o.l.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=o.l.TEXTURE_CUBE_MAP},e.prototype.upload=function(t,n,r){for(var i=this.itemDirtyIds,o=0;o<e.SIDES;o++){var s=this.items[o];i[o]<s.dirtyId&&(i[o]=s.dirtyId,s.valid&&s.resource.upload(t,s,r))}return!0},e}(b);x.SIDES=6;var w=function(t){function e(e,n){n=n||{},t.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=e,this.scale=n.scale||1,this._overrideWidth=n.width,this._overrideHeight=n.height,this._resolve=null,this._crossorigin=n.crossorigin,this._load=null,!1!==n.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;return this._load||(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}))),this._load},e.prototype._loadSvg=function(){var e=this,n=new Image;t.crossOrigin(n,this.svg,this._crossorigin),n.src=this.svg,n.onerror=function(t){e._resolve&&(n.onerror=null,e.onError.run(t))},n.onload=function(){if(e._resolve){var t=n.width,r=n.height;if(!t||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var o=t*e.scale,s=r*e.scale;(e._overrideWidth||e._overrideHeight)&&(o=e._overrideWidth||e._overrideHeight/r*t,s=e._overrideHeight||e._overrideWidth/t*r),o=Math.round(o),s=Math.round(s);var a=e.source;a.width=o,a.height=s,a._pixiId="canvas_"+Object(i.uid)(),a.getContext("2d").drawImage(n,0,0,t,r,0,0,o,s),e._resolve(),e._resolve=null}}},e.getSize=function(t){var n=e.SVG_SIZE.exec(t),r={};return n&&(r[n[1]]=Math.round(parseFloat(n[3])),r[n[5]]=Math.round(parseFloat(n[7]))),r},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e}(p);w.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var T=function(t){function e(e,n){if(n=n||{},!(e instanceof HTMLVideoElement)){var r=document.createElement("video");r.setAttribute("preload","auto"),r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]),t.crossOrigin(r,e[0].src||e[0],n.crossorigin);for(var i=0;i<e.length;++i){var o=document.createElement("source"),s=e[i],a=s.src,u=s.mime,h=(a=a||e[i]).split("?").shift().toLowerCase(),l=h.substr(h.lastIndexOf(".")+1);u=u||"video/"+l,o.src=a,o.type=u,r.appendChild(o)}e=r}t.call(this,e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=n.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==n.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==n.autoLoad&&this.load()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var n=a.a.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-n),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this,e),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(n){t.valid?n(t):(t._resolve=n,e.load())})),this._load},e.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(a.a.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(a.a.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&a.a.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),this.source.src="",this.source.load()),t.prototype.dispose.call(this)},n.autoUpdate.get=function(){return this._autoUpdate},n.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(a.a.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(a.a.shared.add(this.update,this),this._isConnectedToTicker=!0))},n.updateFPS.get=function(){return this._updateFPS},n.updateFPS.set=function(t){t!==this._updateFPS&&(this._updateFPS=t)},e.test=function(t,n){return t instanceof HTMLVideoElement||e.TYPES.indexOf(n)>-1},Object.defineProperties(e.prototype,n),e}(p);T.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var S=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(p);f.push(d,S,_,T,w,y,x,b);var E={INSTALLED:f,autoDetectResource:g,ArrayResource:b,BufferResource:y,CanvasResource:_,CubeResource:x,ImageResource:d,ImageBitmapResource:S,SVGResource:w,VideoResource:T,Resource:l,BaseImageResource:p},P=function(t){this.renderer=t};P.prototype.destroy=function(){this.renderer=null};var C=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,n){var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===o.a.UNPACK),n.width===e.width&&n.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(n.width=e.width,n.height=e.height,r.texImage2D(e.target,0,1===t.context.webGLVersion?r.DEPTH_COMPONENT:r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(y),k=function(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new r.a("disposeFramebuffer",2)},A={colorTexture:{configurable:!0}};A.colorTexture.get=function(){return this.colorTextures[0]},k.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new v(null,{scaleMode:o.k.NEAREST,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},k.prototype.addDepthTexture=function(t){return this.depthTexture=t||new v(new C(null,{width:this.width,height:this.height}),{scaleMode:o.k.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:!1,format:o.e.DEPTH_COMPONENT,type:o.m.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},k.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},k.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},k.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var n=0;n<this.colorTextures.length;n++){var r=this.colorTextures[n],i=r.resolution;r.setSize(t/i,e/i)}if(this.depthTexture){var o=this.depthTexture.resolution;this.depthTexture.setSize(t/o,e/o)}}},k.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(k.prototype,A);var I=function(t){function e(e){if("number"==typeof e){var n=arguments[0],r=arguments[1],i=arguments[2],o=arguments[3];e={width:n,height:r,scaleMode:i,resolution:o}}t.call(this,null,e);var s=e||{},a=s.width,u=s.height;this.mipmap=!1,this.width=Math.ceil(a)||100,this.height=Math.ceil(u)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new k(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.framebuffer=null},e}(v),O=function(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};O.prototype.set=function(t,e,n){var r=e.width,i=e.height;if(n){var o=t.width/2/r,s=t.height/2/i,a=t.x/r+o,h=t.y/i+s;n=u.n.add(n,u.n.NW),this.x0=a+o*u.n.uX(n),this.y0=h+s*u.n.uY(n),n=u.n.add(n,2),this.x1=a+o*u.n.uX(n),this.y1=h+s*u.n.uY(n),n=u.n.add(n,2),this.x2=a+o*u.n.uX(n),this.y2=h+s*u.n.uY(n),n=u.n.add(n,2),this.x3=a+o*u.n.uX(n),this.y3=h+s*u.n.uY(n)}else this.x0=t.x/r,this.y0=t.y/i,this.x1=(t.x+t.width)/r,this.y1=t.y/i,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/i,this.x3=t.x/r,this.y3=(t.y+t.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var L=new O,M=function(t){function e(n,r,i,o,s,a){if(t.call(this),this.noFrame=!1,r||(this.noFrame=!0,r=new u.j(0,0,1,1)),n instanceof e&&(n=n.baseTexture),this.baseTexture=n,this._frame=r,this.trim=o,this.valid=!1,this.requiresUpdate=!1,this._uvs=L,this.uvMatrix=null,this.orig=i||r,this._rotate=Number(s||0),!0===s)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new u.g(a.x,a.y):new u.g(0,0),this._updateID=0,this.textureCacheIds=[],n.valid?this.noFrame?n.valid&&this.onBaseTextureUpdated(n):this.frame=r:n.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&n.on("update",this.onBaseTextureUpdated,this)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var n=this.baseTexture.resource;n&&i.TextureCache[n.url]&&e.removeFromCache(n.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===L&&(this._uvs=new O),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,n,r){void 0===n&&(n={}),void 0===r&&(r=s.b.STRICT_TEXTURE_CACHE);var o="string"==typeof t,a=null;o?a=t:(t._pixiId||(t._pixiId="pixiid_"+Object(i.uid)()),a=t._pixiId);var u=i.TextureCache[a];if(o&&r&&!u)throw new Error('The cacheId "'+a+'" does not exist in TextureCache.');return u||(n.resolution||(n.resolution=Object(i.getResolutionOfUrl)(t)),(u=new e(new v(t,n))).baseTexture.cacheId=a,v.addToCache(u.baseTexture,a),e.addToCache(u,a)),u},e.fromBuffer=function(t,n,r,i){return new e(v.fromBuffer(t,n,r,i))},e.fromLoader=function(t,n,r){var o=new d(t);o.url=n;var a=new e(new v(o,{scaleMode:s.b.SCALE_MODE,resolution:Object(i.getResolutionOfUrl)(n)}));return r||(r=n),v.addToCache(a.baseTexture,r),e.addToCache(a,r),r!==n&&(v.addToCache(a.baseTexture,n),e.addToCache(a,n)),a},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),i.TextureCache[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),i.TextureCache[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=i.TextureCache[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete i.TextureCache[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)i.TextureCache[t.textureCacheIds[r]]===t&&delete i.TextureCache[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},n.resolution.get=function(){return this.baseTexture.resolution},n.frame.get=function(){return this._frame},n.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,n=t.y,r=t.width,i=t.height,o=e+r>this.baseTexture.width,s=n+i>this.baseTexture.height;if(o||s){var a=o&&s?"and":"or",u="X: "+e+" + "+r+" = "+(e+r)+" > "+this.baseTexture.width,h="Y: "+n+" + "+i+" = "+(n+i)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+u+" "+a+" "+h)}this.valid=r&&i&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},n.rotate.get=function(){return this._rotate},n.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},n.width.get=function(){return this.orig.width},n.height.get=function(){return this.orig.height},Object.defineProperties(e.prototype,n),e}(i.EventEmitter);function B(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}M.EMPTY=new M(new v),B(M.EMPTY),B(M.EMPTY.baseTexture),M.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new M(new v(new _(t)))}(),B(M.WHITE),B(M.WHITE.baseTexture);var D=function(t){function e(e,n){var r=null;if(!(e instanceof I)){var i=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4];console.warn("Please use RenderTexture.create("+i+", "+o+") instead of the ctor directly."),r=arguments[0],n=null,e=new I({width:i,height:o,scaleMode:s,resolution:a})}t.call(this,e,n),this.legacyRenderer=r,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e,n){void 0===n&&(n=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,n&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new I(t))},e}(M),F=function(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0};F.prototype.createTexture=function(t,e){var n=new I(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new D(n)},F.prototype.getOptimalTexture=function(t,e,n){void 0===n&&(n=1);var r=F.SCREEN_KEY;t*=n,e*=n,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=Object(i.nextPow2)(t)))<<16|65535&(e=Object(i.nextPow2)(e))),this.texturePool[r]||(this.texturePool[r]=[]);var o=this.texturePool[r].pop();return o||(o=this.createTexture(t,e)),o.filterPoolKey=r,o.setResolution(n),o},F.prototype.getFilterTexture=function(t,e){var n=this.getOptimalTexture(t.width,t.height,e||t.resolution);return n.filterFrame=t.filterFrame,n},F.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},F.prototype.returnFilterTexture=function(t){this.returnTexture(t)},F.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var n=this.texturePool[e];if(n)for(var r=0;r<n.length;r++)n[r].destroy(!0)}this.texturePool={}},F.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=F.SCREEN_KEY,n=this.texturePool[e];if(this.enableFullScreen=t.width>0&&t.height>0,n)for(var r=0;r<n.length;r++)n[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},F.SCREEN_KEY="screen";var R=function(t,e,n,r,i,o,s){void 0===n&&(n=!1),void 0===r&&(r=5126),this.buffer=t,this.size=e,this.normalized=n,this.type=r,this.stride=i,this.start=o,this.instance=s};R.prototype.destroy=function(){this.buffer=null},R.from=function(t,e,n,r,i){return new R(t,e,n,r,i)};var N=0,V=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=e,this.id=N++,this.disposeRunner=new r.a("disposeBuffer",2)};function j(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}V.prototype.update=function(t){this.data=t||this.data,this._updateID++},V.prototype.dispose=function(){this.disposeRunner.run(this,!1)},V.prototype.destroy=function(){this.dispose(),this.data=null},V.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new V(t)};var U={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var X={5126:4,5123:2,5121:1},H=0,G={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},Y=function(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=H++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new r.a("disposeGeometry",2),this.refCount=0};Y.prototype.addAttribute=function(t,e,n,r,i,o,s,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new V(e));var u=t.split("|");if(u.length>1){for(var h=0;h<u.length;h++)this.addAttribute(u[h],e,n,r,i);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new R(l,n,r,i,o,s,a),this.instanced=this.instanced||a,this},Y.prototype.getAttribute=function(t){return this.attributes[t]},Y.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},Y.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new V(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},Y.prototype.getIndex=function(){return this.indexBuffer},Y.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],n=[],r=new V;for(t in this.attributes){var i=this.attributes[t],o=this.buffers[i.buffer];e.push(o.data),n.push(i.size*X[i.type]/4),i.buffer=0}for(r.data=function(t,e){for(var n=0,r=0,i={},o=0;o<t.length;o++)r+=e[o],n+=t[o].length;for(var s=new ArrayBuffer(4*n),a=null,u=0,h=0;h<t.length;h++){var l=e[h],c=t[h],p=j(c);i[p]||(i[p]=new U[p](s)),a=i[p];for(var d=0;d<c.length;d++){a[(d/l|0)*r+u+d%l]=c[d]}u+=l}return new Float32Array(s)}(e,n),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},Y.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},Y.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Y.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},Y.prototype.clone=function(){for(var t=new Y,e=0;e<this.buffers.length;e++)t.buffers[e]=new V(this.buffers[e].data.slice());for(var n in this.attributes){var r=this.attributes[n];t.attributes[n]=new R(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},Y.merge=function(t){for(var e,n=new Y,r=[],i=[],o=[],s=0;s<t.length;s++){e=t[s];for(var a=0;a<e.buffers.length;a++)i[a]=i[a]||0,i[a]+=e.buffers[a].data.length,o[a]=0}for(var u=0;u<e.buffers.length;u++)r[u]=new(G[j(e.buffers[u].data)])(i[u]),n.buffers[u]=new V(r[u]);for(var h=0;h<t.length;h++){e=t[h];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,o[l]),o[l]+=e.buffers[l].data.length}if(n.attributes=e.attributes,e.indexBuffer){n.indexBuffer=n.buffers[e.buffers.indexOf(e.indexBuffer)],n.indexBuffer.index=!0;for(var c=0,p=0,d=0,f=0,g=0;g<e.buffers.length;g++)if(e.buffers[g]!==e.indexBuffer){f=g;break}for(var y in e.attributes){var m=e.attributes[y];(0|m.buffer)===f&&(p+=m.size*X[m.type]/4)}for(var v=0;v<t.length;v++){for(var b=t[v].indexBuffer.data,_=0;_<b.length;_++)n.indexBuffer.data[_+d]+=c;c+=e.buffers[f].data.length/p,d+=b.length}}return n};var W=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Y),z=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new V(this.vertices),this.uvBuffer=new V(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,e){var n=0,r=0;return this.uvs[0]=n,this.uvs[1]=r,this.uvs[2]=n+e.width/t.width,this.uvs[3]=r,this.uvs[4]=n+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=n,this.uvs[7]=r+e.height/t.height,n=e.x,r=e.y,this.vertices[0]=n,this.vertices[1]=r,this.vertices[2]=n+e.width,this.vertices[3]=r,this.vertices[4]=n+e.width,this.vertices[5]=r+e.height,this.vertices[6]=n,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(Y),q=0,K=function(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=q++,this.static=!!e};K.prototype.update=function(){this.dirtyId++},K.prototype.add=function(t,e,n){this.uniforms[t]=new K(e,n)},K.from=function(t,e){return new K(t,e)};var J=function(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new u.j,this.destinationFrame=new u.j,this.filters=[]};J.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};var Z=function(t){function e(e){t.call(this,e),this.defaultFilterStack=[{}],this.texturePool=new F,this.texturePool.setScreenSize(e.view),this.statePool=[],this.quad=new W,this.quadUv=new z,this.tempRect=new u.j,this.activeState={},this.globalUniforms=new K({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e){for(var n=this.renderer,r=this.defaultFilterStack,i=this.statePool.pop()||new J,o=e[0].resolution,s=e[0].padding,a=e[0].autoFit,u=e[0].legacy,h=1;h<e.length;h++){var l=e[h];o=Math.min(o,l.resolution),s=this.useMaxPadding?Math.max(s,l.padding):s+l.padding,a=a||l.autoFit,u=u||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=n.renderTexture.current),r.push(i),i.resolution=o,i.legacy=u,i.target=t,i.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),i.sourceFrame.pad(s),a&&i.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),i.sourceFrame.ceil(o),i.renderTexture=this.getOptimalFilterTexture(i.sourceFrame.width,i.sourceFrame.height,o),i.filters=e,i.destinationFrame.width=i.renderTexture.width,i.destinationFrame.height=i.renderTexture.height,i.renderTexture.filterFrame=i.sourceFrame,n.renderTexture.bind(i.renderTexture,i.sourceFrame),n.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),n=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var i=r.inputSize,o=r.inputPixel,s=r.inputClamp;if(i[0]=e.destinationFrame.width,i[1]=e.destinationFrame.height,i[2]=1/i[0],i[3]=1/i[1],o[0]=i[0]*e.resolution,o[1]=i[1]*e.resolution,o[2]=1/o[0],o[3]=1/o[1],s[0]=.5*o[2],s[1]=.5*o[3],s[2]=e.sourceFrame.width*i[2]-.5*o[2],s[3]=e.sourceFrame.height*i[3]-.5*o[3],e.legacy){var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var u=t[t.length-1];if(1===n.length)n[0].apply(this,e.renderTexture,u.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var h=e.renderTexture,l=this.getOptimalFilterTexture(h.width,h.height,e.resolution);l.filterFrame=h.filterFrame;var c=0;for(c=0;c<n.length-1;++c){n[c].apply(this,h,l,!0,e);var p=h;h=l,l=p}n[c].apply(this,h,u.renderTexture,!1,e),this.returnFilterTexture(h),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},e.prototype.applyFilter=function(t,e,n,r){var i=this.renderer;i.renderTexture.bind(n,n?n.filterFrame:null),r&&i.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,i.state.set(t.state),i.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),i.geometry.bind(this.quadUv),i.geometry.draw(o.c.TRIANGLES)):(i.geometry.bind(this.quad),i.geometry.draw(o.c.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var n=this.activeState,r=n.sourceFrame,i=n.destinationFrame,o=e._texture.orig,s=t.set(i.width,0,0,i.height,r.x,r.y),a=e.worldTransform.copyTo(u.d.TEMP_MATRIX);return a.invert(),s.prepend(a),s.scale(1/o.width,1/o.height),s.translate(e.anchor.x,e.anchor.y),s},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,e,n){return void 0===n&&(n=1),this.texturePool.getOptimalTexture(t,e,n)},e.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var n=t;t=e,e=n}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return r.filterFrame=t.filterFrame,r},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e}(P),Q=function(t){this.renderer=t};Q.prototype.flush=function(){},Q.prototype.destroy=function(){this.renderer=null},Q.prototype.start=function(){},Q.prototype.stop=function(){this.flush()},Q.prototype.render=function(t){};var $=function(t){function e(e){t.call(this,e),this.emptyRenderer=new Q(e),this.currentRenderer=this.emptyRenderer}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var n=this.renderer.texture.boundTextures,r=e-1;r>=0;--r)t[r]=n[r]||null,t[r]&&(t[r]._batchLocation=r)},e.prototype.boundArray=function(t,e,n,r){for(var i=t.elements,o=t.ids,s=t.count,a=0,u=0;u<s;u++){var h=i[u],l=h._batchLocation;if(l>=0&&l<r&&e[l]===h)o[u]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==n||c._batchLocation!==a){o[u]=a,h._batchLocation=a,e[a]=h;break}a++}}},e}(P);s.b.PREFER_ENV=i.isMobile.any?o.d.WEBGL:o.d.WEBGL2,s.b.STRICT_TEXTURE_CACHE=!1;var tt=0,et=function(t){function e(e){t.call(this,e),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={isLost:{configurable:!0}};return n.isLost.get=function(){return!this.gl||this.gl.isContextLost()},e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=tt++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=tt++,this.renderer.runners.contextChange.run(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var n;if(s.b.PREFER_ENV>=o.d.WEBGL2&&(n=t.getContext("webgl2",e)),n)this.webGLVersion=2;else if(this.webGLVersion=1,!(n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),n},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(e.prototype,n),e}(P),nt=function(t){function e(e){t.call(this,e),this.managedFramebuffers=[],this.unknownFramebuffer=new k(10,10)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0}};return e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new u.j,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;s.b.PREFER_ENV===o.d.WEBGL_LEGACY&&(e=null,n=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),n||(this.writeDepthTexture=!1)}},e.prototype.bind=function(t,e){var n=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,n.bindFramebuffer(n.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var i=0;i<t.colorTextures.length;i++)t.colorTextures[i].texturePart?this.renderer.texture.unbind(t.colorTextures[i].texture):this.renderer.texture.unbind(t.colorTextures[i]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,n,r){var i=this.viewport;i.width===n&&i.height===r&&i.x===t&&i.y===e||(i.x=t,i.y=e,i.width=n,i.height=r,this.gl.viewport(t,e,n,r))},n.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},e.prototype.clear=function(t,e,n,r){var i=this.gl;i.clearColor(t,e,n,r),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT)},e.prototype.initFramebuffer=function(t){var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},e.prototype.resizeFramebuffer=function(t){var e=this.gl,n=t.glFramebuffers[this.CONTEXT_UID];n.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,i=0;i<r.length;i++)this.renderer.texture.bind(r[i],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,n=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var i=[],o=0;o<r;o++){var s=t.colorTextures[o];s.texturePart?(this.renderer.texture.bind(s.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+o,e.TEXTURE_CUBE_MAP_NEGATIVE_X+s.side,s.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(s,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+o,e.TEXTURE_2D,s._glTextures[this.CONTEXT_UID].texture,0)),i.push(e.COLOR_ATTACHMENT0+o)}if((i.length>1&&e.drawBuffers(i),t.depthTexture)&&this.writeDepthTexture){var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}n.stencil||!t.stencil&&!t.depth||(n.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,n.stencil))},e.prototype.disposeFramebuffer=function(t,e){var n=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(n){delete t.glFramebuffers[this.CONTEXT_UID];var i=this.managedFramebuffers.indexOf(t);i>=0&&this.managedFramebuffers.splice(i,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(n.framebuffer),n.stencil&&r.deleteRenderbuffer(n.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var n=t.width,r=t.height,i=this.gl,o=i.createRenderbuffer();i.bindRenderbuffer(i.RENDERBUFFER,o),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,n,r),e.stencil=o,i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,o)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new u.j},Object.defineProperties(e.prototype,n),e}(P),rt=function(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0},it={5126:4,5123:2,5121:1},ot=function(t){function e(e){t.call(this,e),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var n=this.renderer.context.extensions.vertexArrayObject;s.b.PREFER_ENV===o.d.WEBGL_LEGACY&&(n=null),n?(t.createVertexArray=function(){return n.createVertexArrayOES()},t.bindVertexArray=function(t){return n.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return n.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var r=t.getExtension("ANGLE_instanced_arrays");r?(t.vertexAttribDivisor=function(t,e){return r.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,n,i,o){return r.drawElementsInstancedANGLE(t,e,n,i,o)},t.drawArraysInstanced=function(t,e,n,i){return r.drawArraysInstancedANGLE(t,e,n,i)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var n=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var i=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==i&&(this._activeVao=i,this.hasVao?n.bindVertexArray(i):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,n=0;n<t.buffers.length;n++){var r=t.buffers[n],i=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==i.updateID){i.updateID=r._updateID;var o=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(o,i.buffer),this._boundBuffer=i,i.byteLength>=r.data.byteLength)e.bufferSubData(o,0,r.data);else{var s=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;i.byteLength=r.data.byteLength,e.bufferData(o,r.data,s)}}}},e.prototype.checkCompatibility=function(t,e){var n=t.attributes,r=e.attributeData;for(var i in r)if(!n[i])throw new Error('shader and geometry incompatible, geometry missing the "'+i+'" attribute')},e.prototype.getSignature=function(t,e){var n=t.attributes,r=e.attributeData,i=["g",t.id];for(var o in n)r[o]&&i.push(o);return i.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var n=this.gl,r=this.CONTEXT_UID,i=this.getSignature(t,e),o=t.glVertexArrayObjects[this.CONTEXT_UID],s=o[i];if(s)return o[e.id]=s,s;var a=t.buffers,u=t.attributes,h={},l={};for(var c in a)h[c]=0,l[c]=0;for(var p in u)!u[p].size&&e.attributeData[p]?u[p].size=e.attributeData[p].size:u[p].size||console.warn("PIXI Geometry attribute '"+p+"' size cannot be determined (likely the bound shader does not have the attribute)"),h[u[p].buffer]+=u[p].size*it[u[p].type];for(var d in u){var f=u[d],g=f.size;void 0===f.stride&&(h[f.buffer]===g*it[f.type]?f.stride=0:f.stride=h[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=g*it[f.type])}s=n.createVertexArray(),n.bindVertexArray(s);for(var y=0;y<a.length;y++){var m=a[y];m._glBuffers[r]||(m._glBuffers[r]=new rt(n.createBuffer()),this.managedBuffers[m.id]=m,m.disposeRunner.add(this)),m._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=s,o[e.id]=s,o[i]=s,s},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var n=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),n&&(e||r.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var n=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,i=t.buffers;if(t.disposeRunner.remove(this),n){for(var o=0;o<i.length;o++){var s=i[o]._glBuffers[this.CONTEXT_UID];s.refCount--,0!==s.refCount||e||this.disposeBuffer(i[o],e)}if(!e)for(var a in n)if("g"===a[0]){var u=n[a];this._activeVao===u&&this.unbind(),r.deleteVertexArray(u)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},e.prototype.activateVao=function(t,e){var n=this.gl,r=this.CONTEXT_UID,i=t.buffers,o=t.attributes;t.indexBuffer&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var s=null;for(var a in o){var u=o[a],h=i[u.buffer]._glBuffers[r];if(e.attributeData[a]){s!==h&&(n.bindBuffer(n.ARRAY_BUFFER,h.buffer),s=h);var l=e.attributeData[a].location;if(n.enableVertexAttribArray(l),n.vertexAttribPointer(l,u.size,u.type||n.FLOAT,u.normalized,u.stride,u.start),u.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");n.vertexAttribDivisor(l,1)}}}},e.prototype.draw=function(t,e,n,r){var i=this.gl,o=this._activeGeometry;if(o.indexBuffer){var s=o.indexBuffer.data.BYTES_PER_ELEMENT,a=2===s?i.UNSIGNED_SHORT:i.UNSIGNED_INT;2===s||4===s&&this.canUseUInt32ElementIndex?o.instanced?i.drawElementsInstanced(t,e||o.indexBuffer.data.length,a,(n||0)*s,r||1):i.drawElements(t,e||o.indexBuffer.data.length,a,(n||0)*s):console.warn("unsupported index buffer type: uint32")}else o.instanced?i.drawArraysInstanced(t,n,e||o.getSize(),r||1):i.drawArrays(t,n,e||o.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(P),st=function(t){this.type=o.g.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null};function at(t,e,n,r){var i=ut(t,t.VERTEX_SHADER,e),o=ut(t,t.FRAGMENT_SHADER,n),s=t.createProgram();if(t.attachShader(s,i),t.attachShader(s,o),r)for(var a in r)t.bindAttribLocation(s,r[a],a);return t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)||(t.getShaderParameter(i,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(i))),t.getShaderParameter(o,t.COMPILE_STATUS)||(console.warn(n),console.error(t.getShaderInfoLog(o))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(s,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(s)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(s)),t.deleteProgram(s),s=null),t.deleteShader(i),t.deleteShader(o),s}function ut(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}function ht(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return lt(2*e);case"bvec3":return lt(3*e);case"bvec4":return lt(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function lt(t){for(var e=new Array(t),n=0;n<e.length;n++)e[n]=!1;return e}st.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=o.g.NONE,this.autoDetect=!0),this._target=null},st.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var ct,pt={},dt=pt;function ft(){if(dt===pt||dt&&dt.isContextLost()){var t,e=document.createElement("canvas");s.b.PREFER_ENV>=o.d.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),dt=t}return dt}function gt(t,e,n){if("precision"!==t.substring(0,9)){var r=e;return e===o.i.HIGH&&n!==o.i.HIGH&&(r=o.i.MEDIUM),"precision "+r+" float;\n"+t}return n!==o.i.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var yt={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function mt(t){return yt[t]}var vt=null,bt={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function _t(t,e){if(!vt){var n=Object.keys(bt);vt={};for(var r=0;r<n.length;++r){var i=n[r];vt[t[i]]=bt[i]}}return vt[e]}var xt={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},wt={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Tt,St=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Et(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var n=e.createShader(e.FRAGMENT_SHADER);;){var r=St.replace(/%forloop%/gi,Pt(t));if(e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))break;t=t/2|0}return t}function Pt(t){for(var e="",n=0;n<t;++n)n>0&&(e+="\nelse "),n<t-1&&(e+="if(test == "+n+".0){}");return e}var Ct=0,kt={},At=function t(e,n,r){void 0===r&&(r="pixi-shader"),this.id=Ct++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=n||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(r=r.replace(/\s+/g,"-"),kt[r]?(kt[r]++,r+="-"+kt[r]):kt[r]=1,this.vertexSrc="#define SHADER_NAME "+r+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+r+"\n"+this.fragmentSrc,this.vertexSrc=gt(this.vertexSrc,s.b.PRECISION_VERTEX,o.i.HIGH),this.fragmentSrc=gt(this.fragmentSrc,s.b.PRECISION_FRAGMENT,function(){if(!ct){ct=o.i.MEDIUM;var t=ft();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);ct=e.precision?o.i.HIGH:o.i.MEDIUM}}return ct}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},It={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};At.prototype.extractData=function(t,e){var n=ft();if(n){var r=at(n,t,e);this.attributeData=this.getAttributeData(r,n),this.uniformData=this.getUniformData(r,n),n.deleteProgram(r)}else this.uniformData={},this.attributeData={}},At.prototype.getAttributeData=function(t,e){for(var n={},r=[],i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<i;o++){var s=e.getActiveAttrib(t,o),a=_t(e,s.type),u={type:a,name:s.name,size:mt(a),location:0};n[s.name]=u,r.push(u)}r.sort((function(t,e){return t.name>e.name?1:-1}));for(var h=0;h<r.length;h++)r[h].location=h;return n},At.prototype.getUniformData=function(t,e){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<r;i++){var o=e.getActiveUniform(t,i),s=o.name.replace(/\[.*?\]/,""),a=o.name.match(/\[.*?\]/,""),u=_t(e,o.type);n[s]={type:u,size:o.size,isArray:a,value:ht(u,o.size)}}return n},It.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},It.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},At.from=function(t,e,n){var r=t+e,o=i.ProgramCache[r];return o||(i.ProgramCache[r]=o=new At(t,e,n)),o},Object.defineProperties(At,It);var Ot=function(t,e){for(var n in this.program=t,this.uniformGroup=e?e instanceof K?e:new K(e):new K({}),t.uniformData)this.uniformGroup.uniforms[n]instanceof Array&&(this.uniformGroup.uniforms[n]=new Float32Array(this.uniformGroup.uniforms[n]))},Lt={uniforms:{configurable:!0}};Ot.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var n in e.uniforms){var r=e.uniforms[n];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},Ot.prototype.destroy=function(){this.uniformGroup=null},Lt.uniforms.get=function(){return this.uniformGroup.uniforms},Ot.from=function(t,e,n){var r=At.from(t,e);return new Ot(r,n)},Object.defineProperties(Ot.prototype,Lt);var Mt=function(){this.data=0,this.blendMode=o.b.NORMAL,this.polygonOffset=0,this.blend=!0},Bt={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};Bt.blend.get=function(){return!!(1&this.data)},Bt.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},Bt.offsets.get=function(){return!!(2&this.data)},Bt.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},Bt.culling.get=function(){return!!(4&this.data)},Bt.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},Bt.depthTest.get=function(){return!!(8&this.data)},Bt.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},Bt.clockwiseFrontFace.get=function(){return!!(16&this.data)},Bt.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},Bt.blendMode.get=function(){return this._blendMode},Bt.blendMode.set=function(t){this.blend=t!==o.b.NONE,this._blendMode=t},Bt.polygonOffset.get=function(){return this._polygonOffset},Bt.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},Mt.for2d=function(){var t=new Mt;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(Mt.prototype,Bt);var Dt=function(t){function e(n,r,i){var o=At.from(n||e.defaultVertexSrc,r||e.defaultFragmentSrc);t.call(this,o,i),this.padding=0,this.resolution=s.b.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new Mt}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={blendMode:{configurable:!0}},r={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return e.prototype.apply=function(t,e,n,r,i){t.applyFilter(this,e,n,r,i)},n.blendMode.get=function(){return this.state.blendMode},n.blendMode.set=function(t){this.state.blendMode=t},r.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},r.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(e.prototype,n),Object.defineProperties(e,r),e}(Ot);Dt.SOURCE_KEY_MAP={};var Ft=new u.d,Rt=function(t,e){this._texture=t,this.mapCoord=new u.d,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1},Nt={texture:{configurable:!0}};Nt.texture.get=function(){return this._texture},Nt.texture.set=function(t){this._texture=t,this._updateID=-1},Rt.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var n=this.mapCoord,r=0;r<t.length;r+=2){var i=t[r],o=t[r+1];e[r]=i*n.a+o*n.c+n.tx,e[r+1]=i*n.b+o*n.d+n.ty}return e},Rt.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);var r=e.orig,i=e.trim;i&&(Ft.set(r.width/i.width,0,0,r.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(Ft));var o=e.baseTexture,s=this.uClampFrame,a=this.clampMargin/o.resolution,u=this.clampOffset;return s[0]=(e._frame.x+a+u)/o.width,s[1]=(e._frame.y+a+u)/o.height,s[2]=(e._frame.x+e._frame.width-a+u)/o.width,s[3]=(e._frame.y+e._frame.height-a+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&0===e.rotate,!0},Object.defineProperties(Rt.prototype,Nt);var Vt=function(t){function e(e){var n=new u.d;t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"),e.renderable=!1,this.maskSprite=e,this.maskMatrix=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t,e,n,r){var i=this.maskSprite,o=this.maskSprite.texture;o.valid&&(o.transform||(o.transform=new Rt(o,0)),o.transform.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,i).prepend(o.transform.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=o.transform.uClampFrame,t.applyFilter(this,e,n,r))},e}(Dt),jt=function(t){function e(e){t.call(this,e),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,e){if(!e.isMaskData){var n=this.maskDataPool.pop()||new st;n.pooled=!0,n.maskObject=e,e=n}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case o.g.SCISSOR:this.maskStack.push(e),this.renderer.scissor.push(e);break;case o.g.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case o.g.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},e.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case o.g.SCISSOR:this.renderer.scissor.pop();break;case o.g.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case o.g.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},e.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=o.g.SPRITE;else if(t.type=o.g.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var n=e.worldTransform,r=Math.atan2(n.b,n.a),i=Math.atan2(n.d,n.c);r=Math.round(r*(180/Math.PI)*100),i=((i=Math.round(i*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===i&&(t.type=o.g.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var e=t.maskObject,n=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new Vt(e)]),r[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var i=n.filterArea;n.filterArea=e.getBounds(!0),this.renderer.filter.push(n,r),n.filterArea=i,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(P),Ut=function(t){function e(e){t.call(this,e),this.maskStack=[],this.glConst=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,n=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==n&&(0===r?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this,this),this.maskStack=null},e}(P),Xt=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.SCISSOR_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var n=t._scissorRect,r=e.getBounds(!0),i=this.renderer.gl;e.renderable=!1,n?r.fit(n):i.enable(i.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,n=this.renderer.projection,r=n.transform,i=n.sourceFrame,o=n.destinationFrame,s=e?e.resolution:this.renderer.resolution,a=(t.x-i.x)*s+o.x,u=(t.y-i.y)*s+o.y,h=t.width*s,l=t.height*s;r&&(a+=r.tx*s,u+=r.ty*s),e||(u=this.renderer.height-l-u),this.renderer.gl.scissor(a,u,h,l)},e}(Ut),Ht=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.STENCIL_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,n=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),n.enable(n.STENCIL_TEST)),t._stencilCounter++,n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.EQUAL,r,this._getBitwiseMask()),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(Ut),Gt=function(t){function e(e){t.call(this,e),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new u.d,this.transform=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(t,e,n,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,r),this.transform&&this.projectionMatrix.append(this.transform);var i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,n,r){var i=this.projectionMatrix;r?(i.a=1/t.width*2*n,i.d=-1/t.height*2*n,i.tx=-1-e.x*i.a,i.ty=1-e.y*i.d):(i.a=1/t.width*2*n,i.d=1/t.height*2*n,i.tx=-1-e.x*i.a,i.ty=-1-e.y*i.d)},e.prototype.setTransform=function(){},e}(P),Yt=new u.j,Wt=function(t){function e(e){t.call(this,e),this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new u.j,this.destinationFrame=new u.j}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(t,e,n){void 0===t&&(t=null),this.current=t;var r,i=this.renderer;if(t){var o=t.baseTexture;r=o.resolution,n||(Yt.width=o.realWidth,Yt.height=o.realHeight,n=Yt),e||(e=n),this.renderer.framebuffer.bind(o.framebuffer,n),this.renderer.projection.update(n,e,r,!1),this.renderer.mask.setMaskStack(o.maskStack)}else r=this.renderer.resolution,n||(Yt.width=i.width,Yt.height=i.height,n=Yt),e||(e=n),i.framebuffer.bind(null,n),this.renderer.projection.update(n,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=n.x/r,this.destinationFrame.y=n.y/r,this.destinationFrame.width=n.width/r,this.destinationFrame.height=n.height/r,e===n&&this.sourceFrame.copyFrom(this.destinationFrame)},e.prototype.clear=function(t){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(P),zt=function(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}};zt.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var qt=0,Kt={textureCount:0},Jt=function(t){function e(e){t.call(this,e),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=qt++}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Tt)return Tt;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");Tt=!0===t({a:"b"},"a","b")}catch(t){Tt=!1}return Tt}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var n=t.program,r=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(r.program)),e||(Kt.textureCount=0,this.syncUniformGroup(t.uniformGroup,Kt)),r},e.prototype.setUniforms=function(t){var e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var n=this.getglProgram();t.static&&t.dirtyId===n.uniformGroups[t.id]||(n.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e))},e.prototype.syncUniforms=function(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var n="var v = null;\n    var cv = null\n    var t = 0;\n    var gl = renderer.gl\n    ";for(var r in t.uniforms){var i=e[r];if(i)if("float"===i.type&&1===i.size)n+="\n            if(uv."+r+" !== ud."+r+".value)\n            {\n                ud."+r+".value = uv."+r+"\n                gl.uniform1f(ud."+r+".location, uv."+r+")\n            }\n";else if("sampler2D"!==i.type&&"samplerCube"!==i.type&&"sampler2DArray"!==i.type||1!==i.size||i.isArray)if("mat3"===i.type&&1===i.size)void 0!==t.uniforms[r].a?n+="\n                gl.uniformMatrix3fv(ud."+r+".location, false, uv."+r+".toArray(true));\n                \n":n+="\n                gl.uniformMatrix3fv(ud."+r+".location, false, uv."+r+");\n                \n";else if("vec2"===i.type&&1===i.size)void 0!==t.uniforms[r].x?n+="\n                cv = ud."+r+".value;\n                v = uv."+r+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+r+".location, v.x, v.y);\n                }\n":n+="\n                cv = ud."+r+".value;\n                v = uv."+r+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+r+".location, v[0], v[1]);\n                }\n                \n";else if("vec4"===i.type&&1===i.size)void 0!==t.uniforms[r].width?n+="\n                cv = ud."+r+".value;\n                v = uv."+r+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+r+".location, v.x, v.y, v.width, v.height)\n                }\n":n+="\n                cv = ud."+r+".value;\n                v = uv."+r+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+r+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{n+="\n            cv = ud."+r+".value;\n            v = uv."+r+";\n            "+(1===i.size?xt:wt)[i.type].replace("location","ud."+r+".location")+";\n"}else n+="\n\n            t = syncData.textureCount++;\n\n            renderer.texture.bind(uv."+r+", t);\n            \n            if(ud."+r+".value !== t)\n            {\n                ud."+r+".value = t;\n                gl.uniform1i(ud."+r+".location, t);\n; // eslint-disable-line max-len\n            }\n";else t.uniforms[r].group&&(n+="\n                    renderer.shader.syncUniformGroup(uv."+r+", syncData);\n                ")}return new Function("ud","uv","renderer","syncData",n)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var n=t.uniforms,r=[];for(var i in n)r.push(i),e[i]&&r.push(e[i].type);return r.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,n=t.program,r={};for(var i in n.attributeData)r[i]=n.attributeData[i].location;var o=at(e,n.vertexSrc,n.fragmentSrc,r),s={};for(var a in n.uniformData){var u=n.uniformData[a];s[a]={location:e.getUniformLocation(o,a),value:ht(u.type,u.size)}}var h=new zt(o,s);return n.glPrograms[this.renderer.CONTEXT_UID]=h,h},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(P);var Zt=function(t){function e(e){t.call(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=o.b.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new Mt,this.defaultState.blend=!0,this.defaultState.depth=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[o.b.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.ADD]=[t.ONE,t.ONE],e[o.b.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.NONE]=[0,0],e[o.b.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[o.b.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.b.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[o.b.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[o.b.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[o.b.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[o.b.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[o.b.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[o.b.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[o.b.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[o.b.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,n=0;e;)1&e&&this.map[n].call(this,!!(t.data&1<<n)),e>>=1,n++;this.stateId=t.data}for(var r=0;r<this.checks.length;r++)this.checks[r](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var n=0;n<this.checks.length;n++)this.checks[n](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],n=this.gl;2===e.length?n.blendFunc(e[0],e[1]):n.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,n.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var n=this.checks.indexOf(t);e&&-1===n?this.checks.push(t):e||-1===n||this.checks.splice(n,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},e}(P),Qt=function(t){function e(e){t.call(this,e),this.count=0,this.checkCount=0,this.maxIdle=s.b.GC_MAX_IDLE,this.checkCountMax=s.b.GC_MAX_CHECK_COUNT,this.mode=s.b.GC_MODE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==o.f.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,n=!1,r=0;r<e.length;r++){var i=e[r];!i.framebuffer&&this.count-i.touched>this.maxIdle&&(t.destroyTexture(i,!0),e[r]=null,n=!0)}if(n){for(var o=0,s=0;s<e.length;s++)null!==e[s]&&(e[o++]=e[s]);e.length=o}},e.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var n=t.children.length-1;n>=0;n--)this.unload(t.children[n])},e}(P),$t=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},te=function(t){function e(e){t.call(this,e),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new v}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var n=0;n<e;n++)this.boundTextures[n]=null;this.emptyTextures={};var r=new $t(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new $t(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var i=0;i<6;i++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var o=0;o<this.boundTextures.length;o++)this.bind(null,o)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var n=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,n=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<n.length;r++)n[r]===this.unknownTexture&&this.bind(null,r)}for(var i=0;i<n.length;i++)n[i]===t&&(this.currentLocation!==i&&(e.activeTexture(e.TEXTURE0+i),this.currentLocation=i),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),n[i]=null)},e.prototype.initTexture=function(t){var e=new $t(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var n=this.renderer.gl;t.type===n.FLOAT&&t.format===n.RGBA&&(e.internalFormat=n.RGBA32F),t.type===o.m.HALF_FLOAT&&(e.type=n.HALF_FLOAT),e.type===n.HALF_FLOAT&&t.format===n.RGBA&&(e.internalFormat=n.RGBA16F)}},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var n=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(n,t,e));else{var r=t.realWidth,i=t.realHeight,o=n.gl;(e.width!==r||e.height!==i||e.dirtyId<0)&&(e.width=r,e.height=i,o.texImage2D(t.target,0,e.internalFormat,r,i,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,e){var n=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&Object(i.removeItems)(this.managedTextures,r,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==o.h.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=o.n.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var n=this.gl;if(e.mipmap&&n.generateMipmap(t.target),n.texParameteri(t.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(t.target,n.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===o.k.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&t.anisotropicLevel>0&&t.scaleMode===o.k.LINEAR){var i=Math.min(t.anisotropicLevel,n.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,i)}}else n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===o.k.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(t.target,n.TEXTURE_MAG_FILTER,t.scaleMode===o.k.LINEAR?n.LINEAR:n.NEAREST)},e}(P),ee={FilterSystem:Z,BatchSystem:$,ContextSystem:et,FramebufferSystem:nt,GeometrySystem:ot,MaskSystem:jt,ScissorSystem:Xt,StencilSystem:Ht,ProjectionSystem:Gt,RenderTextureSystem:Wt,ShaderSystem:Jt,StateSystem:Zt,TextureGCSystem:Qt,TextureSystem:te},ne=new u.d,re=function(t){function e(e,n){t.call(this),(n=Object.assign({},s.b.RENDER_OPTIONS,n)).roundPixels&&(s.b.ROUND_PIXELS=n.roundPixels,Object(i.deprecation)("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),this.options=n,this.type=o.j.UNKNOWN,this.screen=new u.j(0,0,n.width,n.height),this.view=n.view||document.createElement("canvas"),this.resolution=n.resolution||s.b.RESOLUTION,this.transparent=n.transparent,this.autoDensity=n.autoDensity||n.autoResize||!1,this.preserveDrawingBuffer=n.preserveDrawingBuffer,this.clearBeforeRender=n.clearBeforeRender,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,0],this._backgroundColorString="#000000",this.backgroundColor=n.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent=new h.b,this._lastObjectRendered=this._tempDisplayObjectParent,this.plugins={}}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={width:{configurable:!0},height:{configurable:!0},backgroundColor:{configurable:!0}};return e.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},n.width.get=function(){return this.view.width},n.height.get=function(){return this.view.height},e.prototype.resize=function(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoDensity&&(this.view.style.width=t+"px",this.view.style.height=e+"px")},e.prototype.generateTexture=function(t,e,n,r){0===(r=r||t.getLocalBounds()).width&&(r.width=1),0===r.height&&(r.height=1);var i=D.create({width:0|r.width,height:0|r.height,scaleMode:e,resolution:n});return ne.tx=-r.x,ne.ty=-r.y,this.render(t,i,!1,ne,!!t.parent),i},e.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=o.j.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoDensity=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},n.backgroundColor.get=function(){return this._backgroundColor},n.backgroundColor.set=function(t){this._backgroundColor=t,this._backgroundColorString=Object(i.hex2string)(t),Object(i.hex2rgb)(t,this._backgroundColorRgba)},Object.defineProperties(e.prototype,n),e}(i.EventEmitter),ie=function(t){function e(n){void 0===n&&(n={}),t.call(this,"WebGL",n),n=this.options,this.type=o.j.WEBGL,this.gl=null,this.CONTEXT_UID=0,this.runners={destroy:new r.a("destroy"),contextChange:new r.a("contextChange",1),reset:new r.a("reset"),update:new r.a("update"),postrender:new r.a("postrender"),prerender:new r.a("prerender"),resize:new r.a("resize",2)},this.globalUniforms=new K({projectionMatrix:new u.d},!0),this.addSystem(jt,"mask").addSystem(et,"context").addSystem(Zt,"state").addSystem(Jt,"shader").addSystem(te,"texture").addSystem(ot,"geometry").addSystem(nt,"framebuffer").addSystem(Xt,"scissor").addSystem(Ht,"stencil").addSystem(Gt,"projection").addSystem(Qt,"textureGC").addSystem(Z,"filter").addSystem(Wt,"renderTexture").addSystem($,"batch"),this.initPlugins(e.__plugins),n.context?this.context.initFromContext(n.context):this.context.initFromOptions({alpha:this.transparent,antialias:n.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:n.preserveDrawingBuffer,powerPreference:this.options.powerPreference}),this.renderingToScreen=!0,Object(i.sayHello)(2===this.context.webGLVersion?"WebGL 2":"WebGL 1"),this.resize(this.options.width,this.options.height)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.create=function(t){if(Object(i.isWebGLSupported)())return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.addSystem=function(t,e){e||(e=t.name);var n=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var r in this[e]=n,this.runners)this.runners[r].add(n);return this},e.prototype.render=function(t,e,n,r,i){if(this.renderingToScreen=!e,this.runners.prerender.run(),this.emit("prerender"),this.projection.transform=r,!this.context.isLost){if(e||(this._lastObjectRendered=t),!i){var o=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=o}this.renderTexture.bind(e),this.batch.currentRenderer.start(),(void 0!==n?n:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),e&&e.baseTexture.update(),this.runners.postrender.run(),this.projection.transform=null,this.emit("postrender")}},e.prototype.resize=function(e,n){t.prototype.resize.call(this,e,n),this.runners.resize.run(e,n)},e.prototype.reset=function(){return this.runners.reset.run(),this},e.prototype.clear=function(){this.framebuffer.bind(),this.framebuffer.clear()},e.prototype.destroy=function(e){for(var n in this.runners.destroy.run(),this.runners)this.runners[n].destroy();t.prototype.destroy.call(this,e),this.gl=null},e.registerPlugin=function(t,n){e.__plugins=e.__plugins||{},e.__plugins[t]=n},e}(re);function oe(t){return ie.create(t)}var se="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",ae="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",ue=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.from=function(t,n){return new e(new x(t,n))},e}(v),he=function(){this.texArray=null,this.blend=0,this.type=o.c.TRIANGLES,this.start=0,this.size=0,this.data=null},le=function(){this.elements=[],this.ids=[],this.count=0};le.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0};var ce=function(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)},pe={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};pe.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},pe.uint8View.get=function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},pe.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},pe.uint16View.get=function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},pe.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},ce.prototype.view=function(t){return this[t+"View"]},ce.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},ce.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(ce.prototype,pe);var de=function(t){function e(e){t.call(this,e),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=Mt.for2d(),this.size=4*s.b.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.renderer.gl;s.b.PREFER_ENV===o.d.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),s.b.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=Et(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,n=e._textureArrayPool,r=this.size/4,i=Math.floor(r/this.MAX_TEXTURES)+1;t.length<r;)t.push(new he);for(;n.length<i;)n.push(new le);for(var o=0;o<this.MAX_TEXTURES;o++)this._tempBoundTextures[o]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,n=this.MAX_TEXTURES,r=e._textureArrayPool,i=this.renderer.batch,o=this._tempBoundTextures,s=this.renderer.textureGC.count,a=++v._globalBatch,u=0,h=r[0],l=0;i.copyBoundTextures(o,n);for(var c=0;c<this._bufferSize;++c){var p=t[c];t[c]=null,p._batchEnabled!==a&&(h.count>=n&&(i.boundArray(h,o,a,n),this.buildDrawCalls(h,l,c),l=c,h=r[++u],++a),p._batchEnabled=a,p.touched=s,h.elements[h.count++]=p)}h.count>0&&(i.boundArray(h,o,a,n),this.buildDrawCalls(h,l,this._bufferSize),++u,++a);for(var d=0;d<o.length;d++)o[d]=null;v._globalBatch=a},e.prototype.buildDrawCalls=function(t,n,r){var o=this._bufferedElements,s=this._attributeBuffer,a=this._indexBuffer,u=this.vertexSize,h=e._drawCallPool,l=this._dcIndex,c=this._aIndex,p=this._iIndex,d=h[l];d.start=this._iIndex,d.texArray=t;for(var f=n;f<r;++f){var g=o[f],y=g._texture.baseTexture,m=i.premultiplyBlendMode[y.alphaMode?1:0][g.blendMode];o[f]=null,n<f&&d.blend!==m&&(d.size=p-d.start,n=f,(d=h[++l]).texArray=t,d.start=p),this.packInterleavedGeometry(g,s,a,c,p),c+=g.vertexData.length/2*u,p+=g.indices.length,d.blend=m}n<r&&(d.size=p-d.start,++l),this._dcIndex=l,this._aIndex=c,this._iIndex=p},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,n=0;n<t.count;n++)e.bind(t.elements[n],t.ids[n]),t.elements[n]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,n=this._indexBuffer;s.b.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,n=this.renderer,r=n.gl,i=n.state,o=e._drawCallPool,s=null,a=0;a<t;a++){var u=o[a],h=u.texArray,l=u.type,c=u.size,p=u.start,d=u.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),this.state.blendMode=d,i.set(this.state),r.drawElements(l,c,r.UNSIGNED_SHORT,2*p)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),s.b.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=Object(i.nextPow2)(Math.ceil(t/8)),n=Object(i.log2)(e),r=8*e;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);var o=this._aBuffers[r];return o||(this._aBuffers[r]=o=new ce(r*this.vertexSize*4)),o},e.prototype.getIndexBuffer=function(t){var e=Object(i.nextPow2)(Math.ceil(t/12)),n=Object(i.log2)(e),r=12*e;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);var o=this._iBuffers[n];return o||(this._iBuffers[n]=o=new Uint16Array(r)),o},e.prototype.packInterleavedGeometry=function(t,e,n,r,o){for(var s=e.uint32View,a=e.float32View,u=r/this.vertexSize,h=t.uvs,l=t.indices,c=t.vertexData,p=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),f=d<1&&t._texture.baseTexture.alphaMode?Object(i.premultiplyTint)(t._tintRGB,d):t._tintRGB+(255*d<<24),g=0;g<c.length;g+=2)a[r++]=c[g],a[r++]=c[g+1],a[r++]=h[g],a[r++]=h[g+1],s[r++]=f,a[r++]=p;for(var y=0;y<l.length;y++)n[o++]=u+l[y]},e}(Q);de._drawCallPool=[],de._textureArrayPool=[];var fe=function(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')};fe.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),n=0;n<t;n++)e[n]=n;this.defaultGroupCache[t]=K.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new At(this.vertexSrc,r)}var i={tint:new Float32Array([1,1,1,1]),translationMatrix:new u.d,default:this.defaultGroupCache[t]};return new Ot(this.programCache[t],i)},fe.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var n=0;n<t;n++)n>0&&(e+="\nelse "),n<t-1&&(e+="if(vTextureId < "+n+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+n+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"};var ge=function(t){function e(e){void 0===e&&(e=!1),t.call(this),this._buffer=new V(null,e,!1),this._indexBuffer=new V(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,o.m.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,o.m.FLOAT).addAttribute("aColor",this._buffer,4,!0,o.m.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,o.m.FLOAT).addIndex(this._indexBuffer)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Y),ye="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",me="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",ve=function(){},be={defaultVertexSrc:{configurable:!0},defaultFragmentTemplate:{configurable:!0}};ve.create=function(t){var e=Object.assign({vertex:ye,fragment:me,geometryClass:ge,vertexSize:6},t),n=e.vertex,r=e.fragment,i=e.vertexSize,o=e.geometryClass;return function(t){function e(e){t.call(this,e),this.shaderGenerator=new fe(n,r),this.geometryClass=o,this.vertexSize=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(de)},be.defaultVertexSrc.get=function(){return ye},be.defaultFragmentTemplate.get=function(){return me},Object.defineProperties(ve,be);var _e=ve.create()},function(t,e,n){"use strict";n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return _}));var r=/iPhone/i,i=/iPod/i,o=/iPad/i,s=/\biOS-universal(?:.+)Mac\b/i,a=/\bAndroid(?:.+)Mobile\b/i,u=/Android/i,h=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,l=/Silk/i,c=/Windows Phone/i,p=/\bWindows(?:.+)ARM\b/i,d=/BlackBerry/i,f=/BB10/i,g=/Opera Mini/i,y=/\b(CriOS|Chrome)(?:.+)Mobile/i,m=/Mobile(?:.+)Firefox\b/i,v=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};
/*!
 * @pixi/settings - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var b=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var n=e.userAgent,b=n.split("[FBAN");void 0!==b[1]&&(n=b[0]),void 0!==(b=n.split("Twitter"))[1]&&(n=b[0]);var _=function(t){return function(e){return e.test(t)}}(n),x={apple:{phone:_(r)&&!_(c),ipod:_(i),tablet:!_(r)&&(_(o)||v(e))&&!_(c),universal:_(s),device:(_(r)||_(i)||_(o)||_(s)||v(e))&&!_(c)},amazon:{phone:_(h),tablet:!_(h)&&_(l),device:_(h)||_(l)},android:{phone:!_(c)&&_(h)||!_(c)&&_(a),tablet:!_(c)&&!_(h)&&!_(a)&&(_(l)||_(u)),device:!_(c)&&(_(h)||_(l)||_(a)||_(u))||_(/\bokhttp\b/i)},windows:{phone:_(c),tablet:_(p),device:_(c)||_(p)},other:{blackberry:_(d),blackberry10:_(f),opera:_(g),firefox:_(m),chrome:_(y),device:_(d)||_(f)||_(g)||_(m)||_(y)},any:!1,phone:!1,tablet:!1};return x.any=x.apple.device||x.android.device||x.windows.device||x.other.device,x.phone=x.apple.phone||x.android.phone||x.windows.phone,x.tablet=x.apple.tablet||x.android.tablet||x.windows.tablet,x}(window.navigator);var _={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(b.tablet||b.phone){if(e=!1,b.apple.device){var n=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(n)parseInt(n[1],10)>=11&&(e=!0)}if(b.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)parseInt(r[1],10)>=7&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:b.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!b.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return a}));var r=n(4),i=n(2),o=n(0);
/*!
 * @pixi/display - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
r.b.SORTABLE_CHILDREN=!1;var s=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};s.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},s.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},s.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?i.j.EMPTY:((t=t||new i.j(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},s.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},s.prototype.addQuad=function(t){var e=this.minX,n=this.minY,r=this.maxX,i=this.maxY,o=t[0],s=t[1];e=o<e?o:e,n=s<n?s:n,r=o>r?o:r,i=s>i?s:i,e=(o=t[2])<e?o:e,n=(s=t[3])<n?s:n,r=o>r?o:r,i=s>i?s:i,e=(o=t[4])<e?o:e,n=(s=t[5])<n?s:n,r=o>r?o:r,i=s>i?s:i,e=(o=t[6])<e?o:e,n=(s=t[7])<n?s:n,r=o>r?o:r,i=s>i?s:i,this.minX=e,this.minY=n,this.maxX=r,this.maxY=i},s.prototype.addFrame=function(t,e,n,r,i){this.addFrameMatrix(t.worldTransform,e,n,r,i)},s.prototype.addFrameMatrix=function(t,e,n,r,i){var o=t.a,s=t.b,a=t.c,u=t.d,h=t.tx,l=t.ty,c=this.minX,p=this.minY,d=this.maxX,f=this.maxY,g=o*e+a*n+h,y=s*e+u*n+l;c=g<c?g:c,p=y<p?y:p,d=g>d?g:d,f=y>f?y:f,c=(g=o*r+a*n+h)<c?g:c,p=(y=s*r+u*n+l)<p?y:p,d=g>d?g:d,f=y>f?y:f,c=(g=o*e+a*i+h)<c?g:c,p=(y=s*e+u*i+l)<p?y:p,d=g>d?g:d,f=y>f?y:f,c=(g=o*r+a*i+h)<c?g:c,p=(y=s*r+u*i+l)<p?y:p,d=g>d?g:d,f=y>f?y:f,this.minX=c,this.minY=p,this.maxX=d,this.maxY=f},s.prototype.addVertexData=function(t,e,n){for(var r=this.minX,i=this.minY,o=this.maxX,s=this.maxY,a=e;a<n;a+=2){var u=t[a],h=t[a+1];r=u<r?u:r,i=h<i?h:i,o=u>o?u:o,s=h>s?h:s}this.minX=r,this.minY=i,this.maxX=o,this.maxY=s},s.prototype.addVertices=function(t,e,n,r){this.addVerticesMatrix(t.worldTransform,e,n,r)},s.prototype.addVerticesMatrix=function(t,e,n,r,i,o){var s=t.a,a=t.b,u=t.c,h=t.d,l=t.tx,c=t.ty;i=i||0,o=o||0;for(var p=this.minX,d=this.minY,f=this.maxX,g=this.maxY,y=n;y<r;y+=2){var m=e[y],v=e[y+1],b=s*m+u*v+l,_=h*v+a*m+c;p=Math.min(p,b-i),f=Math.max(f,b+i),d=Math.min(d,_-o),g=Math.max(g,_+o)}this.minX=p,this.minY=d,this.maxX=f,this.maxY=g},s.prototype.addBounds=function(t){var e=this.minX,n=this.minY,r=this.maxX,i=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>i?t.maxY:i},s.prototype.addBoundsMask=function(t,e){var n=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,i=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=i&&r<=o){var s=this.minX,a=this.minY,u=this.maxX,h=this.maxY;this.minX=n<s?n:s,this.minY=r<a?r:a,this.maxX=i>u?i:u,this.maxY=o>h?o:h}},s.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},s.prototype.addBoundsArea=function(t,e){var n=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,i=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=i&&r<=o){var s=this.minX,a=this.minY,u=this.maxX,h=this.maxY;this.minX=n<s?n:s,this.minY=r<a?r:a,this.maxX=i>u?i:u,this.maxY=o>h?o:h}},s.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},s.prototype.addFramePad=function(t,e,n,r,i,o){t-=i,e-=o,n+=i,r+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var a=function(t){function e(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new i.m,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new s,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return e.mixin=function(t){for(var n=Object.keys(t),r=0;r<n.length;++r){var i=n[r];Object.defineProperty(e.prototype,i,Object.getOwnPropertyDescriptor(t,i))}},n._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.calculateBounds=function(){},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new i.j),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new i.j),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=n,this.transform=e,r},e.prototype.toGlobal=function(t,e,n){return void 0===n&&(n=!1),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,n,r){return e&&(t=e.toGlobal(t,n,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)},e.prototype.render=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,n,r,i,o,s,a,u){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===u&&(u=0),this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=r||1,this.rotation=i,this.skew.x=o,this.skew.y=s,this.pivot.x=a,this.pivot.y=u,this},e.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},n.x.get=function(){return this.position.x},n.x.set=function(t){this.transform.position.x=t},n.y.get=function(){return this.position.y},n.y.set=function(t){this.transform.position.y=t},n.worldTransform.get=function(){return this.transform.worldTransform},n.localTransform.get=function(){return this.transform.localTransform},n.position.get=function(){return this.transform.position},n.position.set=function(t){this.transform.position.copyFrom(t)},n.scale.get=function(){return this.transform.scale},n.scale.set=function(t){this.transform.scale.copyFrom(t)},n.pivot.get=function(){return this.transform.pivot},n.pivot.set=function(t){this.transform.pivot.copyFrom(t)},n.skew.get=function(){return this.transform.skew},n.skew.set=function(t){this.transform.skew.copyFrom(t)},n.rotation.get=function(){return this.transform.rotation},n.rotation.set=function(t){this.transform.rotation=t},n.angle.get=function(){return this.transform.rotation*i.i},n.angle.set=function(t){this.transform.rotation=t*i.b},n.zIndex.get=function(){return this._zIndex},n.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},n.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},n.mask.get=function(){return this._mask},n.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var n=this._mask.maskObject||this._mask;n.renderable=!1,n.isMask=!0}},Object.defineProperties(e.prototype,n),e}(o.EventEmitter);function u(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}a.prototype.displayObjectUpdateTransform=a.prototype.updateTransform;var h=function(t){function e(){t.call(this),this.children=[],this.sortableChildren=r.b.SORTABLE_CHILDREN,this.sortDirty=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={width:{configurable:!0},height:{configurable:!0}};return e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments,n=arguments.length;if(n>1)for(var r=0;r<n;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var n=this.getChildIndex(t),r=this.getChildIndex(e);this.children[n]=e,this.children[r]=t,this.onChildrenChange(n<r?n:r)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var n=this.getChildIndex(t);Object(o.removeItems)(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments,n=arguments.length;if(n>1)for(var r=0;r<n;r++)this.removeChild(e[r]);else{var i=this.children.indexOf(t);if(-1===i)return null;t.parent=null,t.transform._parentID=-1,Object(o.removeItems)(this.children,i,1),this._boundsID++,this.onChildrenChange(i),t.emit("removed",this),this.emit("childRemoved",t,this,i)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Object(o.removeItems)(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var n,r=t,i="number"==typeof e?e:this.children.length,o=i-r;if(o>0&&o<=i){n=this.children.splice(r,o);for(var s=0;s<n.length;++s)n[s].parent=null,n[s].transform&&(n[s].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<n.length;++a)n[a].emit("removed",this),this.emit("childRemoved",n[a],this,a);return n}if(0===o&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,n=this.children.length;e<n;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(u),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var n=this.children[t];n.visible&&n.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var n=e._mask.maskObject||e._mask;n.calculateBounds(),this._bounds.addBoundsMask(e._bounds,n._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,n=this.children.length;e<n;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,n=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var r=0;r<e.length;r++)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}n&&t.mask.push(this,this._mask),this._render(t);for(var i=0,o=this.children.length;i<o;i++)this.children[i].render(t);t.batch.flush(),n&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var n="boolean"==typeof e?e:e&&e.children,r=this.removeChildren(0,this.children.length);if(n)for(var i=0;i<r.length;++i)r[i].destroy(e)},n.width.get=function(){return this.scale.x*this.getLocalBounds().width},n.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},n.height.get=function(){return this.scale.y*this.getLocalBounds().height},n.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(e.prototype,n),e}(a);h.prototype.containerUpdateTransform=h.prototype.updateTransform},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return r}));var r,i=n(4);
/*!
 * @pixi/ticker - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */i.b.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(r||(r={}));var o=function(){function t(t,e,n,r){void 0===e&&(e=null),void 0===n&&(n=0),void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=n,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),s=function(){function t(){var t=this;this._head=new o(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/i.b.TARGET_FPMS,this.elapsedMS=1/i.b.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,n){return void 0===n&&(n=r.NORMAL),this._addListener(new o(t,e,n))},t.prototype.addOnce=function(t,e,n){return void 0===n&&(n=r.NORMAL),this._addListener(new o(t,e,n,!0))},t.prototype._addListener=function(t){var e=this._head.next,n=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(n);break}n=e,e=e.next}t.previous||t.connect(n)}else t.connect(n);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var n=this._head.next;n;)n=n.match(t,e)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*i.b.TARGET_FPMS;for(var r=this._head,o=r.next;o;)o=o.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,e)/1e3,i.b.TARGET_FPMS);this._maxElapsedMS=1/n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!0,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!0,configurable:!0}),t}(),a=function(){function t(){}return t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,r.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?s.shared:new s,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));
/*!
 * @pixi/runner - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var r=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,n,r,i,o,s,a){if(arguments.length>8)throw new Error("max arguments reached");var u=this,h=u.name,l=u.items;this._aliasCount++;for(var c=0,p=l.length;c<p;c++)l[c][h](t,e,n,r,i,o,s,a);return l===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t}();Object.defineProperties(r.prototype,{dispatch:{value:r.prototype.emit},run:{value:r.prototype.emit}})},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=function(t,e,n,r){this.name=t,this.type=e,this.required=n,this.defaultValue=r};e.TagValue=i;var o=function(t,e,n){this.names=t,this.values=e,this.action=n};e.TagAction=o,e.applyJsEntity=function(t,e){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=""+e[n];if(0===r.indexOf("&")&&r.length>=2){var i=r.substring(1);e[n]=t.evalJs(i)}}},e.castTagValues=function(t,e){e.values.forEach((function(e){var n=t.values[e.name];if(null!=n&&typeof n!==e.type){var r=""+n;switch(e.type){case"number":if(t.values[e.name]=+r,isNaN(t.values[e.name]))throw new Error(t.name+"タグの"+e.name+"を数値に変換できませんでした("+r+")");break;case"boolean":t.values[e.name]="true"===r;break;case"string":t.values[e.name]=r;break;case"function":t.values[e.name]=n;break;case"string|function":t.values[e.name]="string"==typeof n?r:n;break;case"number|array":if("number"==typeof n||"string"==typeof n){if(t.values[e.name]=+r,isNaN(t.values[e.name]))throw new Error(t.name+"タグの"+e.name+"を数値に変換できませんでした("+r+")")}else t.values[e.name]=n;break;case"string|array":t.values[e.name]="string"==typeof n?r:n;break;case"array":if(!Array.isArray(n))throw new Error(t.name+"タグの"+e.name+"は配列である必要があります");t.values[e.name]=n;break;case"object":if("object"!=typeof n||Array.isArray(n))throw new Error(t.name+"タグの"+e.name+"はオブジェクトである必要があります");t.values[e.name]=n}}}))};var s=r(n(41)),a=r(n(42)),u=r(n(43)),h=r(n(44)),l=r(n(45)),c=r(n(46)),p=r(n(47)),d=r(n(48)),f=r(n(49)),g=r(n(50)),y=r(n(51)),m=r(n(52)),v=r(n(53));e.generateTagActions=function(t){return(new Array).concat(y.default(t)).concat(f.default(t)).concat(c.default(t)).concat(p.default(t)).concat(l.default(t)).concat(a.default(t)).concat(s.default(t)).concat(h.default(t)).concat(g.default(t)).concat(m.default(t)).concat(u.default(t)).concat(v.default(t)).concat(d.default(t))}},function(t,e,n){"use strict";n.r(e),n.d(e,"accessibility",(function(){return r})),n.d(e,"interaction",(function(){return i})),n.d(e,"utils",(function(){return o})),n.d(e,"Application",(function(){return x})),n.d(e,"AbstractBatchRenderer",(function(){return _.a})),n.d(e,"AbstractRenderer",(function(){return _.b})),n.d(e,"Attribute",(function(){return _.c})),n.d(e,"BaseRenderTexture",(function(){return _.d})),n.d(e,"BaseTexture",(function(){return _.e})),n.d(e,"BatchDrawCall",(function(){return _.f})),n.d(e,"BatchGeometry",(function(){return _.g})),n.d(e,"BatchPluginFactory",(function(){return _.h})),n.d(e,"BatchRenderer",(function(){return _.i})),n.d(e,"BatchShaderGenerator",(function(){return _.j})),n.d(e,"BatchTextureArray",(function(){return _.k})),n.d(e,"Buffer",(function(){return _.l})),n.d(e,"CubeTexture",(function(){return _.m})),n.d(e,"Filter",(function(){return _.n})),n.d(e,"Framebuffer",(function(){return _.o})),n.d(e,"GLProgram",(function(){return _.p})),n.d(e,"GLTexture",(function(){return _.q})),n.d(e,"Geometry",(function(){return _.r})),n.d(e,"MaskData",(function(){return _.s})),n.d(e,"ObjectRenderer",(function(){return _.t})),n.d(e,"Program",(function(){return _.u})),n.d(e,"Quad",(function(){return _.v})),n.d(e,"QuadUv",(function(){return _.w})),n.d(e,"RenderTexture",(function(){return _.x})),n.d(e,"RenderTexturePool",(function(){return _.y})),n.d(e,"Renderer",(function(){return _.z})),n.d(e,"Shader",(function(){return _.A})),n.d(e,"SpriteMaskFilter",(function(){return _.B})),n.d(e,"State",(function(){return _.C})),n.d(e,"System",(function(){return _.D})),n.d(e,"Texture",(function(){return _.E})),n.d(e,"TextureMatrix",(function(){return _.F})),n.d(e,"TextureUvs",(function(){return _.G})),n.d(e,"UniformGroup",(function(){return _.H})),n.d(e,"ViewableBuffer",(function(){return _.I})),n.d(e,"autoDetectRenderer",(function(){return _.J})),n.d(e,"checkMaxIfStatementsInShader",(function(){return _.K})),n.d(e,"defaultFilterVertex",(function(){return _.L})),n.d(e,"defaultVertex",(function(){return _.M})),n.d(e,"resources",(function(){return _.N})),n.d(e,"systems",(function(){return _.O})),n.d(e,"Extract",(function(){return E})),n.d(e,"AppLoaderPlugin",(function(){return K})),n.d(e,"Loader",(function(){return q})),n.d(e,"LoaderResource",(function(){return J})),n.d(e,"TextureLoader",(function(){return z})),n.d(e,"ParticleContainer",(function(){return Q})),n.d(e,"ParticleRenderer",(function(){return tt})),n.d(e,"BasePrepare",(function(){return Gt})),n.d(e,"CountLimiter",(function(){return Ht})),n.d(e,"Prepare",(function(){return Qt})),n.d(e,"TimeLimiter",(function(){return ne})),n.d(e,"Spritesheet",(function(){return re})),n.d(e,"SpritesheetLoader",(function(){return oe})),n.d(e,"TilingSprite",(function(){return ae})),n.d(e,"TilingSpriteRenderer",(function(){return le})),n.d(e,"BitmapFontLoader",(function(){return pe})),n.d(e,"BitmapText",(function(){return ce})),n.d(e,"Ticker",(function(){return l.a})),n.d(e,"TickerPlugin",(function(){return l.b})),n.d(e,"UPDATE_PRIORITY",(function(){return l.c})),n.d(e,"ALPHA_MODES",(function(){return Z.a})),n.d(e,"BLEND_MODES",(function(){return Z.b})),n.d(e,"DRAW_MODES",(function(){return Z.c})),n.d(e,"ENV",(function(){return Z.d})),n.d(e,"FORMATS",(function(){return Z.e})),n.d(e,"GC_MODES",(function(){return Z.f})),n.d(e,"MASK_TYPES",(function(){return Z.g})),n.d(e,"MIPMAP_MODES",(function(){return Z.h})),n.d(e,"PRECISION",(function(){return Z.i})),n.d(e,"RENDERER_TYPE",(function(){return Z.j})),n.d(e,"SCALE_MODES",(function(){return Z.k})),n.d(e,"TARGETS",(function(){return Z.l})),n.d(e,"TYPES",(function(){return Z.m})),n.d(e,"WRAP_MODES",(function(){return Z.n})),n.d(e,"Bounds",(function(){return s.a})),n.d(e,"Container",(function(){return s.b})),n.d(e,"DisplayObject",(function(){return s.c})),n.d(e,"FillStyle",(function(){return rt})),n.d(e,"GRAPHICS_CURVES",(function(){return nt})),n.d(e,"Graphics",(function(){return Ct})),n.d(e,"GraphicsData",(function(){return _t})),n.d(e,"GraphicsGeometry",(function(){return Tt})),n.d(e,"LineStyle",(function(){return St})),n.d(e,"graphicsUtils",(function(){return bt})),n.d(e,"Circle",(function(){return h.a})),n.d(e,"DEG_TO_RAD",(function(){return h.b})),n.d(e,"Ellipse",(function(){return h.c})),n.d(e,"Matrix",(function(){return h.d})),n.d(e,"ObservablePoint",(function(){return h.e})),n.d(e,"PI_2",(function(){return h.f})),n.d(e,"Point",(function(){return h.g})),n.d(e,"Polygon",(function(){return h.h})),n.d(e,"RAD_TO_DEG",(function(){return h.i})),n.d(e,"Rectangle",(function(){return h.j})),n.d(e,"RoundedRectangle",(function(){return h.k})),n.d(e,"SHAPES",(function(){return h.l})),n.d(e,"Transform",(function(){return h.m})),n.d(e,"groupD8",(function(){return h.n})),n.d(e,"Mesh",(function(){return Ce})),n.d(e,"MeshBatchUvs",(function(){return Se})),n.d(e,"MeshGeometry",(function(){return Ae})),n.d(e,"MeshMaterial",(function(){return ke})),n.d(e,"NineSlicePlane",(function(){return De})),n.d(e,"PlaneGeometry",(function(){return Ie})),n.d(e,"RopeGeometry",(function(){return Oe})),n.d(e,"SimpleMesh",(function(){return Be})),n.d(e,"SimplePlane",(function(){return Me})),n.d(e,"SimpleRope",(function(){return Le})),n.d(e,"Runner",(function(){return Fe.a})),n.d(e,"Sprite",(function(){return It})),n.d(e,"AnimatedSprite",(function(){return Re})),n.d(e,"TEXT_GRADIENT",(function(){return Ot})),n.d(e,"Text",(function(){return Xt})),n.d(e,"TextMetrics",(function(){return Vt})),n.d(e,"TextStyle",(function(){return Bt})),n.d(e,"isMobile",(function(){return et.a})),n.d(e,"settings",(function(){return et.b})),n.d(e,"VERSION",(function(){return je})),n.d(e,"filters",(function(){return Ue})),n.d(e,"useDeprecated",(function(){return Ve}));var r={};n.r(r),n.d(r,"AccessibilityManager",(function(){return u})),n.d(r,"accessibleTarget",(function(){return a}));var i={};n.r(i),n.d(i,"InteractionData",(function(){return c})),n.d(i,"InteractionEvent",(function(){return d})),n.d(i,"InteractionManager",(function(){return b})),n.d(i,"InteractionTrackingData",(function(){return f})),n.d(i,"interactiveTarget",(function(){return m}));n(30);var o=n(0),s=n(5),a={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0};s.c.mixin(a);var u=function(t){this._hookDiv=null,(o.isMobile.tablet||o.isMobile.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2,this.div=e,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=t,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessibility=!1,this.androidUpdateCount=0,this.androidUpdateFrequency=500,window.addEventListener("keydown",this._onKeyDown,!1)};u.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2,e.style.backgroundColor="#FF0000",e.title="select to enable accessability for this content",e.addEventListener("focus",(function(){t.isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()})),document.body.appendChild(e),this._hookDiv=e},u.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},u.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},u.prototype.deactivate=function(){this.isActive&&!this.isMobileAccessibility&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},u.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}},u.prototype.update=function(){var t=performance.now();if(!(o.isMobile.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),n=this.renderer.resolution,r=e.width/this.renderer.width*n,i=e.height/this.renderer.height*n,s=this.div;s.style.left=e.left+"px",s.style.top=e.top+"px",s.style.width=this.renderer.width+"px",s.style.height=this.renderer.height+"px";for(var a=0;a<this.children.length;a++){var u=this.children[a];if(u.renderId!==this.renderId)u._accessibleActive=!1,Object(o.removeItems)(this.children,a,1),this.div.removeChild(u._accessibleDiv),this.pool.push(u._accessibleDiv),u._accessibleDiv=null,a--;else{s=u._accessibleDiv;var h=u.hitArea,l=u.worldTransform;u.hitArea?(s.style.left=(l.tx+h.x*l.a)*r+"px",s.style.top=(l.ty+h.y*l.d)*i+"px",s.style.width=h.width*l.a*r+"px",s.style.height=h.height*l.d*i+"px"):(h=u.getBounds(),this.capHitArea(h),s.style.left=h.x*r+"px",s.style.top=h.y*i+"px",s.style.width=h.width*r+"px",s.style.height=h.height*i+"px",s.title!==u.accessibleTitle&&null!==u.accessibleTitle&&(s.title=u.accessibleTitle),s.getAttribute("aria-label")!==u.accessibleHint&&null!==u.accessibleHint&&s.setAttribute("aria-label",u.accessibleHint)),u.accessibleTitle===s.title&&u.tabIndex===s.tabIndex||(s.title=u.accessibleTitle,s.tabIndex=u.tabIndex,this.debug&&this.updateDebugHTML(s))}}this.renderId++}},u.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},u.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},u.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2,e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},u.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData),e.dispatchEvent(t.target.displayObject,"pointertap",e.eventData),e.dispatchEvent(t.target.displayObject,"tap",e.eventData)},u.prototype._onFocus=function(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},u.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},u.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},u.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},u.prototype.destroy=function(){this.destroyTouchHook(),this.div=null;for(var t=0;t<this.children.length;t++)this.children[t].div=null;window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null};var h=n(2),l=n(6),c=function(){this.global=new h.g,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0},p={pointerId:{configurable:!0}};p.pointerId.get=function(){return this.identifier},c.prototype.getLocalPosition=function(t,e,n){return t.worldTransform.applyInverse(n||this.global,e)},c.prototype.copyEvent=function(t){t.isPrimary&&(this.isPrimary=!0),this.button=t.button,this.buttons=Number.isInteger(t.buttons)?t.buttons:t.which,this.width=t.width,this.height=t.height,this.tiltX=t.tiltX,this.tiltY=t.tiltY,this.pointerType=t.pointerType,this.pressure=t.pressure,this.rotationAngle=t.rotationAngle,this.twist=t.twist||0,this.tangentialPressure=t.tangentialPressure||0},c.prototype.reset=function(){this.isPrimary=!1},Object.defineProperties(c.prototype,p);var d=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null};d.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},d.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null};var f=function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE},g={pointerId:{configurable:!0},flags:{configurable:!0},none:{configurable:!0},over:{configurable:!0},rightDown:{configurable:!0},leftDown:{configurable:!0}};f.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},g.pointerId.get=function(){return this._pointerId},g.flags.get=function(){return this._flags},g.flags.set=function(t){this._flags=t},g.none.get=function(){return this._flags===this.constructor.FLAGS.NONE},g.over.get=function(){return 0!=(this._flags&this.constructor.FLAGS.OVER)},g.over.set=function(t){this._doSet(this.constructor.FLAGS.OVER,t)},g.rightDown.get=function(){return 0!=(this._flags&this.constructor.FLAGS.RIGHT_DOWN)},g.rightDown.set=function(t){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,t)},g.leftDown.get=function(){return 0!=(this._flags&this.constructor.FLAGS.LEFT_DOWN)},g.leftDown.set=function(t){this._doSet(this.constructor.FLAGS.LEFT_DOWN,t)},Object.defineProperties(f.prototype,g),f.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4});var y=function(){this._tempPoint=new h.g};y.prototype.recursiveFindHit=function(t,e,n,r,i){if(!e||!e.visible)return!1;var o=t.data.global,s=!1,a=i=e.interactive||i,u=!0;if(e.hitArea?(r&&(e.worldTransform.applyInverse(o,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?s=!0:(r=!1,u=!1)),a=!1):e._mask&&r&&(e._mask.containsPoint&&e._mask.containsPoint(o)||(r=!1)),u&&e.interactiveChildren&&e.children)for(var h=e.children,l=h.length-1;l>=0;l--){var c=h[l],p=this.recursiveFindHit(t,c,n,r,a);if(p){if(!c.parent)continue;a=!1,p&&(t.target&&(r=!1),s=!0)}}return i&&(r&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(o)&&(s=!0),e.interactive&&(s&&!t.target&&(t.target=e),n&&n(t,e,!!s))),s},y.prototype.findHit=function(t,e,n,r){this.recursiveFindHit(t,e,n,r,!1)};var m={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};s.c.mixin(m);var v={target:null,data:{global:null}},b=function(t){function e(e,n){t.call(this),n=n||{},this.renderer=e,this.autoPreventDefault=void 0===n.autoPreventDefault||n.autoPreventDefault,this.interactionFrequency=n.interactionFrequency||10,this.mouse=new c,this.mouse.identifier=1,this.mouse.global.set(-999999),this.activeInteractionData={},this.activeInteractionData[1]=this.mouse,this.interactionDataPool=[],this.eventData=new d,this.interactionDOMElement=null,this.moveWhenInside=!1,this.eventsAdded=!1,this.tickerAdded=!1,this.mouseOverRenderer=!1,this.supportsTouchEvents="ontouchstart"in window,this.supportsPointerEvents=!!window.PointerEvent,this.onPointerUp=this.onPointerUp.bind(this),this.processPointerUp=this.processPointerUp.bind(this),this.onPointerCancel=this.onPointerCancel.bind(this),this.processPointerCancel=this.processPointerCancel.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.processPointerDown=this.processPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.processPointerMove=this.processPointerMove.bind(this),this.onPointerOut=this.onPointerOut.bind(this),this.processPointerOverOut=this.processPointerOverOut.bind(this),this.onPointerOver=this.onPointerOver.bind(this),this.cursorStyles={default:"inherit",pointer:"pointer"},this.currentCursorMode=null,this.cursor=null,this.resolution=1,this.delayedEvents=[],this.search=new y,this._useSystemTicker=void 0===n.useSystemTicker||n.useSystemTicker,this.setTargetElement(this.renderer.view,this.renderer.resolution)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={useSystemTicker:{configurable:!0}};return n.useSystemTicker.get=function(){return this._useSystemTicker},n.useSystemTicker.set=function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},e.prototype.hitTest=function(t,e){return v.target=null,v.data.global=t,e||(e=this.renderer._lastObjectRendered),this.processInteractive(v,e,null,!0),v.target},e.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(l.a.system.add(this.tickerUpdate,this,l.c.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){this.tickerAdded&&(l.a.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){!this.eventsAdded&&this.interactionDOMElement&&(window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0)},e.prototype.removeEvents=function(){this.eventsAdded&&this.interactionDOMElement&&(window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement)if(this.didMove)this.didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var e=this.activeInteractionData[t];if(e.originalEvent&&"touch"!==e.pointerType){var n=this.configureInteractionEventForDOMEvent(this.eventData,e.originalEvent,e);this.processInteractive(n,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){if(t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch(typeof e){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(this.interactionDOMElement.style,e)}else"string"!=typeof t||Object.prototype.hasOwnProperty.call(this.cursorStyles,t)||(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,n){n.stopPropagationHint&&t!==n.stopsPropagatingAt||(n.currentTarget=t,n.type=e,t.emit(e,n),t[e]&&t[e](n))},e.prototype.delayDispatchEvent=function(t,e,n){this.delayedEvents.push({displayObject:t,eventString:e,eventData:n})},e.prototype.mapPositionToPoint=function(t,e,n){var r;r=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var i=1/this.resolution;t.x=(e-r.left)*(this.interactionDOMElement.width/r.width)*i,t.y=(n-r.top)*(this.interactionDOMElement.height/r.height)*i},e.prototype.processInteractive=function(t,e,n,r){var i=this.search.findHit(t,e,n,r),o=this.delayedEvents;if(!o.length)return i;t.stopPropagationHint=!1;var s=o.length;this.delayedEvents=[];for(var a=0;a<s;a++){var u=o[a],h=u.displayObject,l=u.eventString,c=u.eventData;c.stopsPropagatingAt===h&&(c.stopPropagationHint=!0),this.dispatchEvent(h,l,c)}return i},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var n=e.length,r=0;r<n;r++){var i=e[r],o=this.getInteractionDataForPointerId(i),s=this.configureInteractionEventForDOMEvent(this.eventData,i,o);if(s.data.originalEvent=t,this.processInteractive(s,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",s),"touch"===i.pointerType)this.emit("touchstart",s);else if("mouse"===i.pointerType||"pen"===i.pointerType){var a=2===i.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,e,n){var r=t.data,i=t.data.identifier;if(n)if(e.trackedPointers[i]||(e.trackedPointers[i]=new f(i)),this.dispatchEvent(e,"pointerdown",t),"touch"===r.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===r.pointerType||"pen"===r.pointerType){var o=2===r.button;o?e.trackedPointers[i].rightDown=!0:e.trackedPointers[i].leftDown=!0,this.dispatchEvent(e,o?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,n){for(var r=this.normalizeToPointerData(t),i=r.length,o=t.target!==this.interactionDOMElement?"outside":"",s=0;s<i;s++){var a=r[s],u=this.getInteractionDataForPointerId(a),h=this.configureInteractionEventForDOMEvent(this.eventData,a,u);if(h.data.originalEvent=t,this.processInteractive(h,this.renderer._lastObjectRendered,n,e||!o),this.emit(e?"pointercancel":"pointerup"+o,h),"mouse"===a.pointerType||"pen"===a.pointerType){var l=2===a.button;this.emit(l?"rightup"+o:"mouseup"+o,h)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+o,h),this.releaseInteractionDataForPointerId(a.pointerId,u))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var n=t.data,r=t.data.identifier;void 0!==e.trackedPointers[r]&&(delete e.trackedPointers[r],this.dispatchEvent(e,"pointercancel",t),"touch"===n.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,n){var r=t.data,i=t.data.identifier,o=e.trackedPointers[i],s="touch"===r.pointerType,a="mouse"===r.pointerType||"pen"===r.pointerType,u=!1;if(a){var h=2===r.button,l=f.FLAGS,c=h?l.RIGHT_DOWN:l.LEFT_DOWN,p=void 0!==o&&o.flags&c;n?(this.dispatchEvent(e,h?"rightup":"mouseup",t),p&&(this.dispatchEvent(e,h?"rightclick":"click",t),u=!0)):p&&this.dispatchEvent(e,h?"rightupoutside":"mouseupoutside",t),o&&(h?o.rightDown=!1:o.leftDown=!1)}n?(this.dispatchEvent(e,"pointerup",t),s&&this.dispatchEvent(e,"touchend",t),o&&(a&&!u||this.dispatchEvent(e,"pointertap",t),s&&(this.dispatchEvent(e,"tap",t),o.over=!1))):o&&(this.dispatchEvent(e,"pointerupoutside",t),s&&this.dispatchEvent(e,"touchendoutside",t)),o&&o.none&&delete e.trackedPointers[i]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this.didMove=!0,this.cursor=null);for(var n=e.length,r=0;r<n;r++){var i=e[r],o=this.getInteractionDataForPointerId(i),s=this.configureInteractionEventForDOMEvent(this.eventData,i,o);s.data.originalEvent=t,this.processInteractive(s,this.renderer._lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",s),"touch"===i.pointerType&&this.emit("touchmove",s),"mouse"!==i.pointerType&&"pen"!==i.pointerType||this.emit("mousemove",s)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,n){var r=t.data,i="touch"===r.pointerType,o="mouse"===r.pointerType||"pen"===r.pointerType;o&&this.processPointerOverOut(t,e,n),this.moveWhenInside&&!n||(this.dispatchEvent(e,"pointermove",t),i&&this.dispatchEvent(e,"touchmove",t),o&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var n=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,n);r.data.originalEvent=e,this.processInteractive(r,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",r),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",r):this.releaseInteractionDataForPointerId(n.identifier)}},e.prototype.processPointerOverOut=function(t,e,n){var r=t.data,i=t.data.identifier,o="mouse"===r.pointerType||"pen"===r.pointerType,s=e.trackedPointers[i];n&&!s&&(s=e.trackedPointers[i]=new f(i)),void 0!==s&&(n&&this.mouseOverRenderer?(s.over||(s.over=!0,this.delayDispatchEvent(e,"pointerover",t),o&&this.delayDispatchEvent(e,"mouseover",t)),o&&null===this.cursor&&(this.cursor=e.cursor)):s.over&&(s.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),o&&this.dispatchEvent(e,"mouseout",t),s.none&&delete e.trackedPointers[i]))},e.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],n=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,n);r.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",r),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",r)},e.prototype.getInteractionDataForPointerId=function(t){var e,n=t.pointerId;return 1===n||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[n]?e=this.activeInteractionData[n]:((e=this.interactionDataPool.pop()||new c).identifier=n,this.activeInteractionData[n]=e),e.copyEvent(t),e},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,n){return t.data=n,this.mapPositionToPoint(n.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=n.global.x,e.globalY=n.global.y),n.originalEvent=e,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var n=0,r=t.changedTouches.length;n<r;n++){var i=t.changedTouches[n];void 0===i.button&&(i.button=t.touches.length?1:0),void 0===i.buttons&&(i.buttons=t.touches.length?1:0),void 0===i.isPrimary&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===i.width&&(i.width=i.radiusX||1),void 0===i.height&&(i.height=i.radiusY||1),void 0===i.tiltX&&(i.tiltX=0),void 0===i.tiltY&&(i.tiltY=0),void 0===i.pointerType&&(i.pointerType="touch"),void 0===i.pointerId&&(i.pointerId=i.identifier||0),void 0===i.pressure&&(i.pressure=i.force||.5),void 0===i.twist&&(i.twist=0),void 0===i.tangentialPressure&&(i.tangentialPressure=0),void 0===i.layerX&&(i.layerX=i.offsetX=i.clientX),void 0===i.layerY&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,e.push(i)}else!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent||(void 0===t.isPrimary&&(t.isPrimary=!0),void 0===t.width&&(t.width=1),void 0===t.height&&(t.height=1),void 0===t.tiltX&&(t.tiltX=0),void 0===t.tiltY&&(t.tiltY=0),void 0===t.pointerType&&(t.pointerType="mouse"),void 0===t.pointerId&&(t.pointerId=1),void 0===t.pressure&&(t.pressure=.5),void 0===t.twist&&(t.twist=0),void 0===t.tangentialPressure&&(t.tangentialPressure=0),t.isNormalized=!0),e.push(t);return e},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},Object.defineProperties(e.prototype,n),e}(o.EventEmitter),_=n(3),x=function t(e){var n=this;e=Object.assign({forceCanvas:!1},e),this.renderer=Object(_.J)(e),this.stage=new s.b,t._plugins.forEach((function(t){t.init.call(n,e)}))},w={view:{configurable:!0},screen:{configurable:!0}};x.registerPlugin=function(t){x._plugins.push(t)},x.prototype.render=function(){this.renderer.render(this.stage)},w.view.get=function(){return this.renderer.view},w.screen.get=function(){return this.renderer.screen},x.prototype.destroy=function(t,e){var n=this,r=x._plugins.slice(0);r.reverse(),r.forEach((function(t){t.destroy.call(n)})),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null,this._options=null},Object.defineProperties(x.prototype,w),x._plugins=[];var T=function(){};T.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(t){window.removeEventListener("resize",this.resize),this._resizeTo=t,t&&(window.addEventListener("resize",this.resize),this.resize())},get:function(){return this._resizeTo}}),this.resize=function(){e._resizeTo&&(e._resizeTo===window?e.renderer.resize(window.innerWidth,window.innerHeight):e.renderer.resize(e._resizeTo.clientWidth,e._resizeTo.clientHeight))},this._resizeTo=null,this.resizeTo=t.resizeTo||null},T.destroy=function(){this.resizeTo=null,this.resize=null},x.registerPlugin(T);
/*!
 * @pixi/extract - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var S=new h.j,E=function(t){this.renderer=t,t.extract=this};E.prototype.image=function(t,e,n){var r=new Image;return r.src=this.base64(t,e,n),r},E.prototype.base64=function(t,e,n){return this.canvas(t).toDataURL(e,n)},E.prototype.canvas=function(t){var e,n,r,i=this.renderer,s=!1,a=!1;t&&(t instanceof _.x?r=t:(r=this.renderer.generateTexture(t),a=!0)),r?(e=r.baseTexture.resolution,n=r.frame,s=!1,i.renderTexture.bind(r)):(e=this.renderer.resolution,s=!0,(n=S).width=this.renderer.width,n.height=this.renderer.height,i.renderTexture.bind(null));var u=Math.floor(n.width*e+1e-4),h=Math.floor(n.height*e+1e-4),l=new o.CanvasRenderTarget(u,h,1),c=new Uint8Array(4*u*h),p=i.gl;p.readPixels(n.x*e,n.y*e,u,h,p.RGBA,p.UNSIGNED_BYTE,c);var d=l.context.getImageData(0,0,u,h);if(E.arrayPostDivide(c,d.data),l.context.putImageData(d,0,0),s){var f=new o.CanvasRenderTarget(l.width,l.height,1);f.context.scale(1,-1),f.context.drawImage(l.canvas,0,-h),l.destroy(),l=f}return a&&r.destroy(!0),l.canvas},E.prototype.pixels=function(t){var e,n,r,i=this.renderer,o=!1;t&&(t instanceof _.x?r=t:(r=this.renderer.generateTexture(t),o=!0)),r?(e=r.baseTexture.resolution,n=r.frame,i.renderTexture.bind(r)):(e=i.resolution,(n=S).width=i.width,n.height=i.height,i.renderTexture.bind(null));var s=n.width*e,a=n.height*e,u=new Uint8Array(4*s*a),h=i.gl;return h.readPixels(n.x*e,n.y*e,s,a,h.RGBA,h.UNSIGNED_BYTE,u),o&&r.destroy(!0),E.arrayPostDivide(u,u),u},E.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},E.arrayPostDivide=function(t,e){for(var n=0;n<t.length;n+=4){var r=e[n+3]=t[n+3];0!==r?(e[n]=Math.round(Math.min(255*t[n]/r,255)),e[n+1]=Math.round(Math.min(255*t[n+1]/r,255)),e[n+2]=Math.round(Math.min(255*t[n+2]/r,255))):(e[n]=t[n],e[n+1]=t[n+1],e[n+2]=t[n+2])}};var P=n(21),C=n.n(P),k=n(10),A=n.n(k);
/*!
 * resource-loader - v3.0.1
 * https://github.com/pixijs/pixi-sound
 * Compiled Tue, 02 Jul 2019 14:06:18 UTC
 *
 * resource-loader is licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license
 */
function I(){}function O(t,e,n,r){var i=0,o=t.length;!function s(a){a||i===o?n&&n(a):r?setTimeout((function(){e(t[i++],s)}),1):e(t[i++],s)}()}function L(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}function M(t,e){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var n=0,r={_tasks:[],concurrency:e,saturated:I,unsaturated:I,buffer:e/4,empty:I,drain:I,error:I,started:!1,paused:!1,push:function(t,e){i(t,!1,e)},kill:function(){n=0,r.drain=I,r.started=!1,r._tasks=[]},unshift:function(t,e){i(t,!0,e)},process:function(){for(;!r.paused&&n<r.concurrency&&r._tasks.length;){var e=r._tasks.shift();0===r._tasks.length&&r.empty(),(n+=1)===r.concurrency&&r.saturated(),t(e.data,L(o(e)))}},length:function(){return r._tasks.length},running:function(){return n},idle:function(){return r._tasks.length+n===0},pause:function(){!0!==r.paused&&(r.paused=!0)},resume:function(){if(!1!==r.paused){r.paused=!1;for(var t=1;t<=r.concurrency;t++)r.process()}}};function i(t,e,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(r.started=!0,null==t&&r.idle())setTimeout((function(){return r.drain()}),1);else{var i={data:t,callback:"function"==typeof n?n:I};e?r._tasks.unshift(i):r._tasks.push(i),setTimeout((function(){return r.process()}),1)}}function o(t){return function(){n-=1,t.callback.apply(t,arguments),null!=arguments[0]&&r.error(arguments[0],t.data),n<=r.concurrency-r.buffer&&r.unsaturated(),r.idle()&&r.drain(),r.process()}}return r}var B={};function D(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function F(t,e,n){return e&&D(t.prototype,e),n&&D(t,n),t}var R=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),N=null;function V(){}var j=function(){function t(e,n,r){if("string"!=typeof e||"string"!=typeof n)throw new Error("Both name and url are required for constructing a resource.");r=r||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===n.indexOf("data:")),this.name=e,this.url=n,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===r.crossOrigin?"anonymous":r.crossOrigin,this.timeout=r.timeout||0,this.loadType=r.loadType||this._determineLoadType(),this.xhrType=r.xhrType,this.metadata=r.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=V,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new A.a,this.onProgress=new A.a,this.onComplete=new A.a,this.onAfterMiddleware=new A.a}t.setExtensionLoadType=function(e,n){U(t._loadTypeMap,e,n)},t.setExtensionXhrType=function(e,n){U(t._xhrTypeMap,e,n)};var e=t.prototype;return e.complete=function(){this._clearEvents(),this._finish()},e.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},e.load=function(e){var n=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout((function(){return e(n)}),1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:R&&this.crossOrigin?this._loadXdr():this._loadXhr()}},e._hasFlag=function(t){return 0!=(this._flags&t)},e._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},e._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},e._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},e._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},e._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,n=0;n<this.url.length;++n)this.data.appendChild(this._createSource(t,this.url[n],Array.isArray(e)?e[n]:e));else{var r=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(r)?r[0]:r))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},e._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},e._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout((function(){return t.send()}),1)},e._createSource=function(t,e,n){n||(n=t+"/"+this._getExtension(e));var r=document.createElement("source");return r.src=e,r.type=n,r},e._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},e._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},e._onTimeout=function(){this.abort("Load timed out.")},e._xhrOnError=function(){var t=this.xhr;this.abort(X(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},e._xhrOnTimeout=function(){var t=this.xhr;this.abort(X(t)+" Request timed out.")},e._xhrOnAbort=function(){var t=this.xhr;this.abort(X(t)+" Request was aborted by the user.")},e._xhrOnLoad=function(){var e=this.xhr,n="",r=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(n=e.responseText),0===r&&(n.length>0||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?r=200:1223===r&&(r=204),2===(r/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=n,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(n),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var i=new DOMParser;this.data=i.parseFromString(n,"text/xml")}else{var o=document.createElement("div");o.innerHTML=n,this.data=o}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||n;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},e._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";e=e||window.location,N||(N=document.createElement("a")),N.href=t;var n=!(t=C()(N.href,{strictMode:!0})).port&&""===e.port||t.port===e.port,r=t.protocol?t.protocol+":":"";return t.host===e.hostname&&n&&r===e.protocol?"":"anonymous"},e._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},e._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},e._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var n=t.indexOf("/");e=t.substring(n+1,t.indexOf(";",n))}else{var r=t.indexOf("?"),i=t.indexOf("#"),o=Math.min(r>-1?r:t.length,i>-1?i:t.length);e=(t=t.substring(0,o)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},e._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},F(t,[{key:"isDataUrl",get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)}}]),t}();function U(t,e,n){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=n)}function X(t){return t.toString().replace("object ","")}j.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},j.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},j.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},j.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},j._loadTypeMap={gif:j.LOAD_TYPE.IMAGE,png:j.LOAD_TYPE.IMAGE,bmp:j.LOAD_TYPE.IMAGE,jpg:j.LOAD_TYPE.IMAGE,jpeg:j.LOAD_TYPE.IMAGE,tif:j.LOAD_TYPE.IMAGE,tiff:j.LOAD_TYPE.IMAGE,webp:j.LOAD_TYPE.IMAGE,tga:j.LOAD_TYPE.IMAGE,svg:j.LOAD_TYPE.IMAGE,"svg+xml":j.LOAD_TYPE.IMAGE,mp3:j.LOAD_TYPE.AUDIO,ogg:j.LOAD_TYPE.AUDIO,wav:j.LOAD_TYPE.AUDIO,mp4:j.LOAD_TYPE.VIDEO,webm:j.LOAD_TYPE.VIDEO},j._xhrTypeMap={xhtml:j.XHR_RESPONSE_TYPE.DOCUMENT,html:j.XHR_RESPONSE_TYPE.DOCUMENT,htm:j.XHR_RESPONSE_TYPE.DOCUMENT,xml:j.XHR_RESPONSE_TYPE.DOCUMENT,tmx:j.XHR_RESPONSE_TYPE.DOCUMENT,svg:j.XHR_RESPONSE_TYPE.DOCUMENT,tsx:j.XHR_RESPONSE_TYPE.DOCUMENT,gif:j.XHR_RESPONSE_TYPE.BLOB,png:j.XHR_RESPONSE_TYPE.BLOB,bmp:j.XHR_RESPONSE_TYPE.BLOB,jpg:j.XHR_RESPONSE_TYPE.BLOB,jpeg:j.XHR_RESPONSE_TYPE.BLOB,tif:j.XHR_RESPONSE_TYPE.BLOB,tiff:j.XHR_RESPONSE_TYPE.BLOB,webp:j.XHR_RESPONSE_TYPE.BLOB,tga:j.XHR_RESPONSE_TYPE.BLOB,json:j.XHR_RESPONSE_TYPE.JSON,text:j.XHR_RESPONSE_TYPE.TEXT,txt:j.XHR_RESPONSE_TYPE.TEXT,ttf:j.XHR_RESPONSE_TYPE.BUFFER,otf:j.XHR_RESPONSE_TYPE.BUFFER},j.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var H=window.URL||window.webkitURL;var G={caching:function(t,e){var n=this;B[t.url]?(t.data=B[t.url],t.complete()):t.onComplete.once((function(){return B[n.url]=n.data})),e()},parsing:function(t,e){if(t.data){if(t.xhr&&t.xhrType===j.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var n=H.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=n,t.type=j.TYPE.IMAGE,void(t.data.onload=function(){H.revokeObjectURL(n),t.data.onload=null,e()})}}else{var r=t.xhr.getResponseHeader("content-type");if(r&&0===r.indexOf("image"))return t.data=new Image,t.data.src="data:"+r+";base64,"+function(t){for(var e="",n=0;n<t.length;){for(var r=[0,0,0],i=[0,0,0,0],o=0;o<r.length;++o)n<t.length?r[o]=255&t.charCodeAt(n++):r[o]=0;switch(i[0]=r[0]>>2,i[1]=(3&r[0])<<4|r[1]>>4,i[2]=(15&r[1])<<2|r[2]>>6,i[3]=63&r[2],n-(t.length-1)){case 2:i[3]=64,i[2]=64;break;case 1:i[3]=64}for(var s=0;s<i.length;++s)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(i[s])}return e}(t.xhr.responseText),t.type=j.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}},Y=/(#[\w-]+)?$/,W=function(){function t(e,n){var r=this;void 0===e&&(e=""),void 0===n&&(n=10),this.baseUrl=e,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return r._loadResource(t,e)},this._queue=M(this._boundLoadResource,n),this._queue.pause(),this.resources={},this.onProgress=new A.a,this.onError=new A.a,this.onLoad=new A.a,this.onStart=new A.a,this.onComplete=new A.a;for(var i=0;i<t._defaultBeforeMiddleware.length;++i)this.pre(t._defaultBeforeMiddleware[i]);for(var o=0;o<t._defaultAfterMiddleware.length;++o)this.use(t._defaultAfterMiddleware[o])}var e=t.prototype;return e.add=function(t,e,n,r){if(Array.isArray(t)){for(var i=0;i<t.length;++i)this.add(t[i]);return this}if("object"==typeof t&&(r=e||t.callback||t.onComplete,n=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(r=n,n=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof n&&(r=n,n=null),this.loading&&(!n||!n.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new j(t,e,n),"function"==typeof r&&this.resources[t].onAfterMiddleware.once(r),this.loading){for(var o=n.parentResource,s=[],a=0;a<o.children.length;++a)o.children[a].isComplete||s.push(o.children[a]);var u=o.progressChunk*(s.length+1)/(s.length+2);o.children.push(this.resources[t]),o.progressChunk=u;for(var h=0;h<s.length;++h)s[h].progressChunk=u;this.resources[t].progressChunk=u}return this._queue.push(this.resources[t]),this},e.pre=function(t){return this._beforeMiddleware.push(t),this},e.use=function(t){return this._afterMiddleware.push(t),this},e.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},e.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,n=0;n<this._queue._tasks.length;++n)this._queue._tasks[n].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},e._prepareUrl=function(t){var e,n=C()(t,{strictMode:!0});if(e=n.protocol||!n.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var r=Y.exec(e)[0];-1!==(e=e.substr(0,e.length-r.length)).indexOf("?")?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=r}return e},e._loadResource=function(t,e){var n=this;t._dequeue=e,O(this._beforeMiddleware,(function(e,r){e.call(n,t,(function(){r(t.isComplete?{}:null)}))}),(function(){t.isComplete?n._onLoad(t):(t._onLoadBinding=t.onComplete.once(n._onLoad,n),t.load())}),!0)},e._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},e._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},e._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),O(this._afterMiddleware,(function(n,r){n.call(e,t,r)}),(function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()}),!0)},F(t,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t}}]),t}();W._defaultBeforeMiddleware=[],W._defaultAfterMiddleware=[],W.pre=function(t){return W._defaultBeforeMiddleware.push(t),W},W.use=function(t){return W._defaultAfterMiddleware.push(t),W};
/*!
 * @pixi/loaders - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/loaders is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var z=function(){};z.use=function(t,e){t.data&&t.type===j.TYPE.IMAGE&&(t.texture=_.E.fromLoader(t.data,t.url,t.name)),e()};var q=function(t){function e(n,r){var i=this;t.call(this,n,r),o.EventEmitter.call(this);for(var s=0;s<e._plugins.length;++s){var a=e._plugins[s],u=a.pre,h=a.use;u&&this.pre(u),h&&this.use(h)}this.onStart.add((function(t){return i.emit("start",t)})),this.onProgress.add((function(t,e){return i.emit("progress",t,e)})),this.onError.add((function(t,e,n){return i.emit("error",t,e,n)})),this.onLoad.add((function(t,e){return i.emit("load",t,e)})),this.onComplete.add((function(t,e){return i.emit("complete",t,e)})),this._protected=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={shared:{configurable:!0}};return e.prototype.destroy=function(){this._protected||(this.removeAllListeners(),this.reset())},n.shared.get=function(){var t=e._shared;return t||((t=new e)._protected=!0,e._shared=t),t},Object.defineProperties(e,n),e}(W);Object.assign(q.prototype,o.EventEmitter.prototype),q._plugins=[],q.registerPlugin=function(t){return q._plugins.push(t),t.add&&t.add(),q},q.registerPlugin({use:G.parsing}),q.registerPlugin(z);var K=function(){};K.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?q.shared:new q},K.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)};var J=j,Z=n(1),Q=function(t){function e(e,n,r,i){void 0===e&&(e=1500),void 0===r&&(r=16384),void 0===i&&(i=!1),t.call(this);r>16384&&(r=16384),this._properties=[!1,!0,!1,!1,!1],this._maxSize=e,this._batchSize=r,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=Z.b.NORMAL,this.autoResize=i,this.roundPixels=!0,this.baseTexture=null,this.setProperties(n),this._tint=0,this.tintRgb=new Float32Array(4),this.tint=16777215}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={tint:{configurable:!0}};return e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},n.tint.get=function(){return this._tint},n.tint.set=function(t){this._tint=t,Object(o.hex2rgb)(t,this.tintRgb)},e.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return e.onChildrenChange(0)}))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},e.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},Object.defineProperties(e.prototype,n),e}(s.b),$=function(t,e,n){this.geometry=new _.r,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var r=0;r<t.length;++r){var i=t[r];i={attributeName:i.attributeName,size:i.size,uploadFunction:i.uploadFunction,type:i.type||Z.m.FLOAT,offset:i.offset},e[r]?this.dynamicProperties.push(i):this.staticProperties.push(i)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()};$.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new _.l(Object(o.createIndicesForQuads)(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var n=0;n<this.dynamicProperties.length;++n){var r=this.dynamicProperties[n];r.offset=e,e+=r.size,this.dynamicStride+=r.size}var i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new _.l(this.dynamicData,!1,!1);var s=0;this.staticStride=0;for(var a=0;a<this.staticProperties.length;++a){var u=this.staticProperties[a];u.offset=s,s+=u.size,this.staticStride+=u.size}var h=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(h),this.staticDataUint32=new Uint32Array(h),this.staticBuffer=new _.l(this.staticData,!0,!1);for(var l=0;l<this.dynamicProperties.length;++l){var c=this.dynamicProperties[l];t.addAttribute(c.attributeName,this.dynamicBuffer,0,c.type===Z.m.UNSIGNED_BYTE,c.type,4*this.dynamicStride,4*c.offset)}for(var p=0;p<this.staticProperties.length;++p){var d=this.staticProperties[p];t.addAttribute(d.attributeName,this.staticBuffer,0,d.type===Z.m.UNSIGNED_BYTE,d.type,4*this.staticStride,4*d.offset)}},$.prototype.uploadDynamic=function(t,e,n){for(var r=0;r<this.dynamicProperties.length;r++){var i=this.dynamicProperties[r];i.uploadFunction(t,e,n,i.type===Z.m.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,i.offset)}this.dynamicBuffer._updateID++},$.prototype.uploadStatic=function(t,e,n){for(var r=0;r<this.staticProperties.length;r++){var i=this.staticProperties[r];i.uploadFunction(t,e,n,i.type===Z.m.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,i.offset)}this.staticBuffer._updateID++},$.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()};var tt=function(t){function e(e){t.call(this,e),this.shader=null,this.properties=null,this.tempMatrix=new h.d,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:Z.m.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=_.A.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),this.state=_.C.for2d()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.render=function(t){var e=t.children,n=t._maxSize,r=t._batchSize,i=this.renderer,s=e.length;if(0!==s){s>n&&!t.autoResize&&(s=n);var a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));var u=e[0]._texture.baseTexture;this.state.blendMode=Object(o.correctBlendMode)(t.blendMode,u.alphaMode),i.state.set(this.state);var h=i.gl,l=t.worldTransform.copyTo(this.tempMatrix);l.prepend(i.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=l.toArray(!0),this.shader.uniforms.uColor=Object(o.premultiplyRgba)(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,u.alphaMode),this.shader.uniforms.uSampler=u,this.renderer.shader.bind(this.shader);for(var c=!1,p=0,d=0;p<s;p+=r,d+=1){var f=s-p;f>r&&(f=r),d>=a.length&&a.push(this._generateOneMoreBuffer(t));var g=a[d];g.uploadDynamic(e,p,f);var y=t._bufferUpdateIDs[d]||0;(c=c||g._updateID<y)&&(g._updateID=t._updateID,g.uploadStatic(e,p,f)),i.geometry.bind(g.geometry),h.drawElements(h.TRIANGLES,6*f,h.UNSIGNED_SHORT,0)}}},e.prototype.generateBuffers=function(t){for(var e=[],n=t._maxSize,r=t._batchSize,i=t._properties,o=0;o<n;o+=r)e.push(new $(this.properties,i,r));return e},e.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,n=t._properties;return new $(this.properties,n,e)},e.prototype.uploadVertices=function(t,e,n,r,i,o){for(var s=0,a=0,u=0,h=0,l=0;l<n;++l){var c=t[e+l],p=c._texture,d=c.scale.x,f=c.scale.y,g=p.trim,y=p.orig;g?(s=(a=g.x-c.anchor.x*y.width)+g.width,u=(h=g.y-c.anchor.y*y.height)+g.height):(s=y.width*(1-c.anchor.x),a=y.width*-c.anchor.x,u=y.height*(1-c.anchor.y),h=y.height*-c.anchor.y),r[o]=a*d,r[o+1]=h*f,r[o+i]=s*d,r[o+i+1]=h*f,r[o+2*i]=s*d,r[o+2*i+1]=u*f,r[o+3*i]=a*d,r[o+3*i+1]=u*f,o+=4*i}},e.prototype.uploadPosition=function(t,e,n,r,i,o){for(var s=0;s<n;s++){var a=t[e+s].position;r[o]=a.x,r[o+1]=a.y,r[o+i]=a.x,r[o+i+1]=a.y,r[o+2*i]=a.x,r[o+2*i+1]=a.y,r[o+3*i]=a.x,r[o+3*i+1]=a.y,o+=4*i}},e.prototype.uploadRotation=function(t,e,n,r,i,o){for(var s=0;s<n;s++){var a=t[e+s].rotation;r[o]=a,r[o+i]=a,r[o+2*i]=a,r[o+3*i]=a,o+=4*i}},e.prototype.uploadUvs=function(t,e,n,r,i,o){for(var s=0;s<n;++s){var a=t[e+s]._texture._uvs;a?(r[o]=a.x0,r[o+1]=a.y0,r[o+i]=a.x1,r[o+i+1]=a.y1,r[o+2*i]=a.x2,r[o+2*i+1]=a.y2,r[o+3*i]=a.x3,r[o+3*i+1]=a.y3,o+=4*i):(r[o]=0,r[o+1]=0,r[o+i]=0,r[o+i+1]=0,r[o+2*i]=0,r[o+2*i+1]=0,r[o+3*i]=0,r[o+3*i+1]=0,o+=4*i)}},e.prototype.uploadTint=function(t,e,n,r,i,s){for(var a=0;a<n;++a){var u=t[e+a],h=u._texture.baseTexture.alphaMode>0,l=u.alpha,c=l<1&&h?Object(o.premultiplyTint)(u._tintRGB,l):u._tintRGB+(255*l<<24);r[s]=c,r[s+i]=c,r[s+2*i]=c,r[s+3*i]=c,s+=4*i}},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},e}(_.t),et=n(4),nt={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var n=Math.ceil(t/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}},rt=function(){this.reset()};rt.prototype.clone=function(){var t=new rt;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},rt.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=_.E.WHITE,this.matrix=null,this.visible=!1},rt.prototype.destroy=function(){this.texture=null,this.matrix=null};var it={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var n=t.points,r=t.holes,i=e.points,s=e.indices;if(n.length>=6){for(var a=[],u=0;u<r.length;u++){var h=r[u];a.push(n.length/2),n=n.concat(h.points)}var l=Object(o.earcut)(n,a,2);if(!l)return;for(var c=i.length/2,p=0;p<l.length;p+=3)s.push(l[p]+c),s.push(l[p+1]+c),s.push(l[p+2]+c);for(var d=0;d<n.length;d++)i.push(n[d])}}},ot={build:function(t){var e,n,r=t.shape,i=t.points,o=r.x,s=r.y;if(i.length=0,t.type===h.l.CIRC?(e=r.radius,n=r.radius):(e=r.width,n=r.height),0!==e&&0!==n){var a=Math.floor(30*Math.sqrt(r.radius))||Math.floor(15*Math.sqrt(r.width+r.height));a/=2.3;for(var u=2*Math.PI/a,l=0;l<a-.5;l++)i.push(o+Math.sin(-u*l)*e,s+Math.cos(-u*l)*n);i.push(i[0],i[1])}},triangulate:function(t,e){var n=t.points,r=e.points,i=e.indices,o=r.length/2,s=o,a=t.shape,u=t.matrix,h=a.x,l=a.y;r.push(t.matrix?u.a*h+u.c*l+u.tx:h,t.matrix?u.b*h+u.d*l+u.ty:l);for(var c=0;c<n.length;c+=2)r.push(n[c],n[c+1]),i.push(o++,s,o)}},st={build:function(t){var e=t.shape,n=e.x,r=e.y,i=e.width,o=e.height,s=t.points;s.length=0,s.push(n,r,n+i,r,n+i,r+o,n,r+o)},triangulate:function(t,e){var n=t.points,r=e.points,i=r.length/2;r.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},at={build:function(t){var e=t.shape,n=t.points,r=e.x,i=e.y,o=e.width,s=e.height,a=Math.max(0,Math.min(e.radius,Math.min(o,s)/2));n.length=0,a?(ht(r,i+a,r,i,r+a,i,n),ht(r+o-a,i,r+o,i,r+o,i+a,n),ht(r+o,i+s-a,r+o,i+s,r+o-a,i+s,n),ht(r+a,i+s,r,i+s,r,i+s-a,n)):n.push(r,i,r+o,i,r+o,i+s,r,i+s)},triangulate:function(t,e){for(var n=t.points,r=e.points,i=e.indices,s=r.length/2,a=Object(o.earcut)(n,null,2),u=0,h=a.length;u<h;u+=3)i.push(a[u]+s),i.push(a[u+1]+s),i.push(a[u+2]+s);for(var l=0,c=n.length;l<c;l++)r.push(n[l],n[++l])}};function ut(t,e,n){return t+(e-t)*n}function ht(t,e,n,r,i,o,s){void 0===s&&(s=[]);for(var a=s,u=0,h=0,l=0,c=0,p=0,d=0,f=0,g=0;f<=20;++f)u=ut(t,n,g=f/20),h=ut(e,r,g),l=ut(n,i,g),c=ut(r,o,g),p=ut(u,l,g),d=ut(h,c,g),a.push(p,d);return a}function lt(t,e){t.lineStyle.native?function(t,e){var n=0,r=t.shape,i=t.points||r.points,o=r.type!==h.l.POLY||r.closeStroke;if(0===i.length)return;var s=e.points,a=e.indices,u=i.length/2,l=s.length/2,c=l;for(s.push(i[0],i[1]),n=1;n<u;n++)s.push(i[2*n],i[2*n+1]),a.push(c,c+1),c++;o&&a.push(c,l)}(t,e):function(t,e){var n=t.shape,r=t.points||n.points.slice(),i=e.closePointEps;if(0===r.length)return;var o=t.lineStyle,s=new h.g(r[0],r[1]),a=new h.g(r[r.length-2],r[r.length-1]),u=n.type!==h.l.POLY||n.closeStroke,l=Math.abs(s.x-a.x)<i&&Math.abs(s.y-a.y)<i;if(u){r=r.slice(),l&&(r.pop(),r.pop(),a.set(r[r.length-2],r[r.length-1]));var c=a.x+.5*(s.x-a.x),p=a.y+.5*(s.y-a.y);r.unshift(c,p),r.push(c,p)}var d=e.points,f=r.length/2,g=r.length,y=d.length/2,m=o.width/2,v=r[0],b=r[1],_=r[2],x=r[3],w=0,T=0,S=-(b-x),E=v-_,P=0,C=0,k=0,A=0,I=Math.sqrt(S*S+E*E);S/=I,E/=I,S*=m,E*=m;var O=o.alignment,L=2*(1-O),M=2*O;d.push(v-S*L,b-E*L),d.push(v+S*M,b+E*M);for(var B=1;B<f-1;++B){v=r[2*(B-1)],b=r[2*(B-1)+1],_=r[2*B],x=r[2*B+1],w=r[2*(B+1)],T=r[2*(B+1)+1],S=-(b-x),E=v-_,I=Math.sqrt(S*S+E*E),S/=I,E/=I,S*=m,E*=m,P=-(x-T),C=_-w,I=Math.sqrt(P*P+C*C),P/=I,C/=I;var D=-E+b-(-E+x),F=-S+_-(-S+v),R=(-S+v)*(-E+x)-(-S+_)*(-E+b),N=-(C*=m)+T-(-C+x),V=-(P*=m)+_-(-P+w),j=(-P+w)*(-C+x)-(-P+_)*(-C+T),U=D*V-N*F;if(Math.abs(U)<.1)U+=10.1,d.push(_-S*L,x-E*L),d.push(_+S*M,x+E*M);else{var X=(F*j-V*R)/U,H=(N*R-D*j)/U;(X-_)*(X-_)+(H-x)*(H-x)>196*m*m?(k=S-P,A=E-C,I=Math.sqrt(k*k+A*A),k/=I,A/=I,k*=m,A*=m,d.push(_-k*L,x-A*L),d.push(_+k*M,x+A*M),d.push(_-k*M*L,x-A*L),g++):(d.push(_+(X-_)*L,x+(H-x)*L),d.push(_-(X-_)*M,x-(H-x)*M))}}v=r[2*(f-2)],b=r[2*(f-2)+1],_=r[2*(f-1)],x=r[2*(f-1)+1],S=-(b-x),E=v-_,I=Math.sqrt(S*S+E*E),S/=I,E/=I,S*=m,E*=m,d.push(_-S*L,x-E*L),d.push(_+S*M,x+E*M);for(var G=e.indices,Y=0;Y<g-2;++Y)G.push(y,y+1,y+2),y++}(t,e)}var ct=function(t){function e(e,n,r,i,o,s){o=o||i/2;for(var a=-1*Math.PI/2+s,u=2*r,l=h.f/u,c=[],p=0;p<u;p++){var d=p%2?o:i,f=p*l+a;c.push(e+d*Math.cos(f),n+d*Math.sin(f))}t.call(this,c)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(h.h),pt=function(){};pt.curveTo=function(t,e,n,r,i,o){var s=o[o.length-2],a=o[o.length-1]-e,u=s-t,h=r-e,l=n-t,c=Math.abs(a*l-u*h);if(c<1e-8||0===i)return o[o.length-2]===t&&o[o.length-1]===e||o.push(t,e),null;var p=a*a+u*u,d=h*h+l*l,f=a*h+u*l,g=i*Math.sqrt(p)/c,y=i*Math.sqrt(d)/c,m=g*f/p,v=y*f/d,b=g*l+y*u,_=g*h+y*a,x=u*(y+m),w=a*(y+m),T=l*(g+v),S=h*(g+v);return{cx:b+t,cy:_+e,radius:i,startAngle:Math.atan2(w-_,x-b),endAngle:Math.atan2(S-_,T-b),anticlockwise:u*h>l*a}},pt.arc=function(t,e,n,r,i,o,s,a,u){for(var l=s-o,c=nt._segmentsCount(Math.abs(l)*i,40*Math.ceil(Math.abs(l)/h.f)),p=l/(2*c),d=2*p,f=Math.cos(p),g=Math.sin(p),y=c-1,m=y%1/y,v=0;v<=y;++v){var b=p+o+d*(v+m*v),_=Math.cos(b),x=-Math.sin(b);u.push((f*_+g*x)*i+n,(f*-x+g*_)*i+r)}};var dt=function(){};dt.curveLength=function(t,e,n,r,i,o,s,a){for(var u=0,h=0,l=0,c=0,p=0,d=0,f=0,g=0,y=0,m=0,v=0,b=t,_=e,x=1;x<=10;++x)m=b-(g=(f=(d=(p=1-(h=x/10))*p)*p)*t+3*d*h*n+3*p*(l=h*h)*i+(c=l*h)*s),v=_-(y=f*e+3*d*h*r+3*p*l*o+c*a),b=g,_=y,u+=Math.sqrt(m*m+v*v);return u},dt.curveTo=function(t,e,n,r,i,o,s){var a=s[s.length-2],u=s[s.length-1];s.length-=2;var h=nt._segmentsCount(dt.curveLength(a,u,t,e,n,r,i,o)),l=0,c=0,p=0,d=0,f=0;s.push(a,u);for(var g=1,y=0;g<=h;++g)p=(c=(l=1-(y=g/h))*l)*l,f=(d=y*y)*y,s.push(p*a+3*c*y*t+3*l*d*n+f*i,p*u+3*c*y*e+3*l*d*r+f*o)};var ft=function(){};ft.curveLength=function(t,e,n,r,i,o){var s=t-2*n+i,a=e-2*r+o,u=2*n-2*t,h=2*r-2*e,l=4*(s*s+a*a),c=4*(s*u+a*h),p=u*u+h*h,d=2*Math.sqrt(l+c+p),f=Math.sqrt(l),g=2*l*f,y=2*Math.sqrt(p),m=c/f;return(g*d+f*c*(d-y)+(4*p*l-c*c)*Math.log((2*f+m+d)/(m+y)))/(4*g)},ft.curveTo=function(t,e,n,r,i){for(var o=i[i.length-2],s=i[i.length-1],a=nt._segmentsCount(ft.curveLength(o,s,t,e,n,r)),u=0,h=0,l=1;l<=a;++l){var c=l/a;u=o+(t-o)*c,h=s+(e-s)*c,i.push(u+(t+(n-t)*c-u)*c,h+(e+(r-e)*c-h)*c)}};var gt=function(){this.reset()};gt.prototype.begin=function(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n},gt.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},gt.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0};var yt={};yt[h.l.POLY]=it,yt[h.l.CIRC]=ot,yt[h.l.ELIP]=ot,yt[h.l.RECT]=st,yt[h.l.RREC]=at;var mt=[],vt=[],bt={buildPoly:it,buildCircle:ot,buildRectangle:st,buildRoundedRectangle:at,FILL_COMMANDS:yt,BATCH_POOL:mt,DRAW_CALL_POOL:vt,buildLine:lt,buildComplexPoly:function(t,e){var n=t.points.slice();if(!(n.length<6)){var r=e.indices;e.points=n,e.alpha=t.fillAlpha,e.color=Object(o.hex2rgb)(t.fillColor);for(var i=1/0,s=-1/0,a=1/0,u=-1/0,h=0,l=0,c=0;c<n.length;c+=2)i=(h=n[c])<i?h:i,s=h>s?h:s,a=(l=n[c+1])<a?l:a,u=l>u?l:u;n.push(i,a,s,a,s,u,i,u);for(var p=n.length/2,d=0;d<p;d++)r.push(d)}},bezierCurveTo:function(t,e,n,r,i,o,s,a,u,h){void 0===h&&(h=[]);var l=0,c=0,p=0,d=0,f=0;h.push(t,e);for(var g=1,y=0;g<=u;++g)p=(c=(l=1-(y=g/u))*l)*l,f=(d=y*y)*y,h.push(p*t+3*c*y*n+3*l*d*i+f*s,p*e+3*c*y*r+3*l*d*o+f*a);return h},Star:ct,ArcUtils:pt,BezierUtils:dt,QuadraticUtils:ft,BatchPart:gt},_t=function(t,e,n,r){void 0===e&&(e=null),void 0===n&&(n=null),void 0===r&&(r=null),this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=r,this.type=t.type,this.points=[],this.holes=[]};_t.prototype.clone=function(){return new _t(this.shape,this.fillStyle,this.lineStyle,this.matrix)},_t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null};var xt=new h.g,wt=new s.a,Tt=function(t){function e(){t.call(this),this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.dirty=0,this.batchDirty=-1,this.cacheDirty=-1,this.clearDirty=0,this.drawCalls=[],this.batches=[],this.shapeIndex=0,this._bounds=new s.a,this.boundsDirty=-1,this.boundsPadding=0,this.batchable=!1,this.indicesUint16=null,this.uvsFloat32=null,this.closePointEps=1e-4}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={bounds:{configurable:!0}};return n.bounds.get=function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].textures.length=0,vt.push(this.drawCalls[t]);this.drawCalls.length=0;for(var e=0;e<this.batches.length;e++){var n=this.batches[e];n.reset(),mt.push(n)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,n,r){var i=new _t(t,e,n,r);return this.graphicsData.push(i),this.dirty++,this},e.prototype.drawHole=function(t,e){if(!this.graphicsData.length)return null;var n=new _t(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=r.lineStyle,r.holes.push(n),this.dirty++,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e);for(var n=0;n<this.graphicsData.length;++n)this.graphicsData[n].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,n=0;n<e.length;++n){var r=e[n];if(r.fillStyle.visible&&(r.shape&&(r.matrix?r.matrix.applyInverse(t,xt):xt.copyFrom(t),r.shape.contains(xt.x,xt.y)))){var i=!1;if(r.holes)for(var o=0;o<r.holes.length;o++){if(r.holes[o].shape.contains(xt.x,xt.y)){i=!0;break}}if(!i)return!0}}return!1},e.prototype.updateBatches=function(){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var t=this.uvs,e=this.graphicsData,n=null,r=null;this.batches.length>0&&(r=(n=this.batches[this.batches.length-1]).style);for(var i=this.shapeIndex;i<e.length;i++){this.shapeIndex++;var o=e[i],s=o.fillStyle,a=o.lineStyle;yt[o.type].build(o),o.matrix&&this.transformPoints(o.points,o.matrix);for(var u=0;u<2;u++){var h=0===u?s:a;if(h.visible){var l=h.texture.baseTexture,c=this.indices.length,p=this.points.length/2;l.wrapMode=Z.n.REPEAT,0===u?this.processFill(o):this.processLine(o);var d=this.points.length/2-p;0!==d&&(n&&!this._compareStyles(r,h)&&(n.end(c,p),n=null),n||((n=mt.pop()||new gt).begin(h,c,p),this.batches.push(n),r=h),this.addUvs(this.points,t,h.texture,p,d,h.matrix))}}}if(n){var f=this.indices.length,g=this.points.length/2;n.end(f,g)}0!==this.batches.length?(this.indicesUint16=new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()):this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var n=this.graphicsData[t],r=n.fillStyle,i=n.lineStyle;if(r&&!r.texture.baseTexture.valid)return!1;if(i&&!i.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,n=t.length;e<n;e++)for(var r=t[e],i=0;i<r.size;i++){var o=r.start+i;this.indicesUint16[o]=this.indicesUint16[o]-r.attribStart}},e.prototype.isBatchable=function(){for(var t=this.batches,n=0;n<t.length;n++)if(t[n].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++_.e._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].textures.length=0,vt.push(this.drawCalls[e]);this.drawCalls.length=0;var n=this.colors,r=this.textureIds,i=vt.pop();i||((i=new _.f).textures=new _.k),i.textures.count=0,i.start=0,i.size=0,i.type=Z.c.TRIANGLES;var o=0,s=null,a=0,u=!1,h=Z.c.TRIANGLES,l=0;this.drawCalls.push(i);for(var c=0;c<this.batches.length;c++){var p=this.batches[c],d=p.style,f=d.texture.baseTexture;u!==!!d.native&&(h=(u=!!d.native)?Z.c.LINES:Z.c.TRIANGLES,s=null,o=8,t++),s!==f&&(s=f,f._batchEnabled!==t&&(8===o&&(t++,o=0,i.size>0&&((i=vt.pop())||((i=new _.f).textures=new _.k),this.drawCalls.push(i)),i.start=l,i.size=0,i.textures.count=0,i.type=h),f.touched=1,f._batchEnabled=t,f._batchLocation=o,f.wrapMode=10497,i.textures.elements[i.textures.count++]=f,o++)),i.size+=p.size,l+=p.size,a=f._batchLocation,this.addColors(n,d.color,d.alpha,p.attribSize),this.addTextureIds(r,a,p.attribSize)}_.e._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,n=this.colors,r=this.textureIds,i=new ArrayBuffer(3*t.length*4),o=new Float32Array(i),s=new Uint32Array(i),a=0,u=0;u<t.length/2;u++)o[a++]=t[2*u],o[a++]=t[2*u+1],o[a++]=e[2*u],o[a++]=e[2*u+1],s[a++]=n[u],o[a++]=r[u];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),it.triangulate(t,this)):yt[t.type].triangulate(t,this)},e.prototype.processLine=function(t){lt(t,this);for(var e=0;e<t.holes.length;e++)lt(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var n=t[e];yt[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,e=wt,n=h.d.IDENTITY;this._bounds.clear(),e.clear();for(var r=0;r<this.graphicsData.length;r++){var i=this.graphicsData[r],o=i.shape,s=i.type,a=i.lineStyle,u=i.matrix||h.d.IDENTITY,l=0;if(a&&a.visible){var c=a.alignment;l=a.width,s===h.l.POLY?l*=.5+Math.abs(.5-c):l*=Math.max(0,c)}n!==u&&(e.isEmpty()||(t.addBoundsMatrix(e,n),e.clear()),n=u),s===h.l.RECT||s===h.l.RREC?e.addFramePad(o.x,o.y,o.x+o.width,o.y+o.height,l,l):s===h.l.CIRC?e.addFramePad(o.x,o.y,o.x,o.y,o.radius+l,o.radius+l):s===h.l.ELIP?e.addFramePad(o.x,o.y,o.x,o.y,o.width+l,o.height+l):t.addVerticesMatrix(n,o.points,0,o.points.length,l,l)}e.isEmpty()||t.addBoundsMatrix(e,n),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var n=0;n<t.length/2;n++){var r=t[2*n],i=t[2*n+1];t[2*n]=e.a*r+e.c*i+e.tx,t[2*n+1]=e.b*r+e.d*i+e.ty}},e.prototype.addColors=function(t,e,n,r){for(var i=(e>>16)+(65280&e)+((255&e)<<16),s=Object(o.premultiplyTint)(i,n);r-- >0;)t.push(s)},e.prototype.addTextureIds=function(t,e,n){for(;n-- >0;)t.push(e)},e.prototype.addUvs=function(t,e,n,r,i,o){for(var s=0,a=e.length,u=n.frame;s<i;){var h=t[2*(r+s)],l=t[2*(r+s)+1];if(o){var c=o.a*h+o.c*l+o.tx;l=o.b*h+o.d*l+o.ty,h=c}s++,e.push(h/u.width,l/u.height)}var p=n.baseTexture;(u.width<p.width||u.height<p.height)&&this.adjustUvs(e,n,a,i)},e.prototype.adjustUvs=function(t,e,n,r){for(var i=e.baseTexture,o=1e-6,s=n+2*r,a=e.frame,u=a.width/i.width,h=a.height/i.height,l=a.x/a.width,c=a.y/a.height,p=Math.floor(t[n]+o),d=Math.floor(t[n+1]+o),f=n+2;f<s;f+=2)p=Math.min(p,Math.floor(t[f]+o)),d=Math.min(d,Math.floor(t[f+1]+o));l-=p,c-=d;for(var g=n;g<s;g+=2)t[g]=(t[g]+l)*u,t[g+1]=(t[g+1]+c)*h},Object.defineProperties(e.prototype,n),e}(_.g);Tt.BATCHABLE_SIZE=100;var St=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.width=0,this.alignment=.5,this.native=!1},e}(rt),Et=new Float32Array(3),Pt={},Ct=function(t){function e(e){void 0===e&&(e=null),t.call(this),this.geometry=e||new Tt,this.geometry.refCount++,this.shader=null,this.state=_.C.for2d(),this._fillStyle=new rt,this._lineStyle=new St,this._matrix=null,this._holeMode=!1,this.currentPath=null,this.batches=[],this.batchTint=-1,this.vertexData=null,this._transformID=-1,this.batchDirty=-1,this.pluginName="batch",this.tint=16777215,this.blendMode=Z.b.NORMAL}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={blendMode:{configurable:!0},tint:{configurable:!0},fill:{configurable:!0},line:{configurable:!0}};return e.prototype.clone=function(){return this.finishPoly(),new e(this.geometry)},n.blendMode.set=function(t){this.state.blendMode=t},n.blendMode.get=function(){return this.state.blendMode},n.tint.get=function(){return this._tint},n.tint.set=function(t){this._tint=t},n.fill.get=function(){return this._fillStyle},n.line.get=function(){return this._lineStyle},e.prototype.lineStyle=function(t){if("number"==typeof t){var e=arguments;t={width:e[0]||0,color:e[1]||0,alpha:void 0!==e[2]?e[2]:1,alignment:void 0!==e[3]?e[3]:.5,native:!!e[4]}}return this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){if("number"==typeof t){Object(o.deprecation)("v5.2.0","Please use object-based options for Graphics#lineTextureStyle");var e=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3],s=arguments[4],a=arguments[5],u=arguments[6];t={width:e,texture:n,color:r,alpha:i,matrix:s,alignment:a,native:u},Object.keys(t).forEach((function(e){return void 0===t[e]&&delete t[e]}))}t=Object.assign({width:0,texture:_.E.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1},t),this.currentPath&&this.startPoly();var h=t.width>0&&t.alpha>0;return h?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:h},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new h.h,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new h.h,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var n=this.currentPath.points,r=n[n.length-2],i=n[n.length-1];return r===t&&i===e||n.push(t,e),this},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,n,r){this._initCurve();var i=this.currentPath.points;return 0===i.length&&this.moveTo(0,0),ft.curveTo(t,e,n,r,i),this},e.prototype.bezierCurveTo=function(t,e,n,r,i,o){return this._initCurve(),dt.curveTo(t,e,n,r,i,o,this.currentPath.points),this},e.prototype.arcTo=function(t,e,n,r,i){this._initCurve(t,e);var o=this.currentPath.points,s=pt.curveTo(t,e,n,r,i,o);if(s){var a=s.cx,u=s.cy,h=s.radius,l=s.startAngle,c=s.endAngle,p=s.anticlockwise;this.arc(a,u,h,l,c,p)}return this},e.prototype.arc=function(t,e,n,r,i,o){if(void 0===o&&(o=!1),r===i)return this;if(!o&&i<=r?i+=h.f:o&&r<=i&&(r+=h.f),0===i-r)return this;var s=t+Math.cos(r)*n,a=e+Math.sin(r)*n,u=this.geometry.closePointEps,l=this.currentPath?this.currentPath.points:null;if(l){var c=Math.abs(l[l.length-2]-s),p=Math.abs(l[l.length-1]-a);c<u&&p<u||l.push(s,a)}else this.moveTo(s,a),l=this.currentPath.points;return pt.arc(s,a,t,e,n,r,i,o,l),this},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:_.E.WHITE,color:t,alpha:e})},e.prototype.beginTextureFill=function(t){if(t instanceof _.E){Object(o.deprecation)("v5.2.0","Please use object-based options for Graphics#beginTextureFill");var e=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3];t={texture:e,color:n,alpha:r,matrix:i},Object.keys(t).forEach((function(e){return void 0===t[e]&&delete t[e]}))}t=Object.assign({texture:_.E.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var s=t.alpha>0;return s?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:s},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,e,n,r){return this.drawShape(new h.j(t,e,n,r))},e.prototype.drawRoundedRect=function(t,e,n,r,i){return this.drawShape(new h.k(t,e,n,r,i))},e.prototype.drawCircle=function(t,e,n){return this.drawShape(new h.a(t,e,n))},e.prototype.drawEllipse=function(t,e,n,r){return this.drawShape(new h.c(t,e,n,r))},e.prototype.drawPolygon=function(t){var e=arguments,n=t,r=!0;if(n.points&&(r=n.closeStroke,n=n.points),!Array.isArray(n)){n=new Array(arguments.length);for(var i=0;i<n.length;++i)n[i]=e[i]}var o=new h.h(n);return o.closeStroke=r,this.drawShape(o),this},e.prototype.drawShape=function(t){return this._holeMode?this.geometry.drawHole(t,this._matrix):this.geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.drawStar=function(t,e,n,r,i,o){return void 0===o&&(o=0),this.drawPolygon(new ct(t,e,n,r,i,o))},e.prototype.clear=function(){return this.geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){return 1===this.geometry.graphicsData.length&&this.geometry.graphicsData[0].shape.type===h.l.RECT&&!this.geometry.graphicsData[0].lineWidth},e.prototype._render=function(t){this.finishPoly();var e=this.geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this.geometry,e=this.blendMode;this.batches=[],this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.vertexData=new Float32Array(t.points);for(var n=0,r=t.batches.length;n<r;n++){var i=t.batches[n],s=i.style.color,a=new Float32Array(this.vertexData.buffer,4*i.attribStart*2,2*i.attribSize),u=new Float32Array(t.uvsFloat32.buffer,4*i.attribStart*2,2*i.attribSize),h={vertexData:a,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*i.start,i.size),uvs:u,_batchRGB:Object(o.hex2rgb)(s),_tintRGB:s,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[n]=h}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,n=this.batches.length;e<n;e++){var r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}},e.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),n=this.geometry,r=this.tint,i=this.worldAlpha,o=e.uniforms,s=n.drawCalls;o.translationMatrix=this.transform.worldTransform,o.tint[0]=(r>>16&255)/255*i,o.tint[1]=(r>>8&255)/255*i,o.tint[2]=(255&r)/255*i,o.tint[3]=i,t.shader.bind(e),t.geometry.bind(n,e),t.state.set(this.state);for(var a=0,u=s.length;a<u;a++)this._renderDrawCallDirect(t,n.drawCalls[a])},e.prototype._renderDrawCallDirect=function(t,e){for(var n=e.textures,r=e.type,i=e.size,o=e.start,s=n.count,a=0;a<s;a++)t.texture.bind(n.elements[a],a);t.geometry.draw(r,i,o)},e.prototype._resolveDirectShader=function(t){var e=this.shader,n=this.pluginName;if(!e){if(!Pt[n]){for(var r=new Int32Array(16),i=0;i<16;i++)r[i]=i;var o={tint:new Float32Array([1,1,1,1]),translationMatrix:new h.d,default:_.H.from({uSamplers:r},!0)},s=t.plugins[n]._shader.program;Pt[n]=new _.A(s,o)}e=Pt[n]}return e},e.prototype._calculateBounds=function(){this.finishPoly();var t=this.geometry;if(t.graphicsData.length){var e=t.bounds,n=e.minX,r=e.minY,i=e.maxX,o=e.maxY;this._bounds.addFrame(this.transform,n,r,i,o)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this.geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=Object(o.hex2rgb)(this.tint,Et),e=0;e<this.batches.length;e++){var n=this.batches[e],r=n._batchRGB,i=(t[0]*r[0]*255<<16)+(t[1]*r[1]*255<<8)+(0|t[2]*r[2]*255);n._tintRGB=(i>>16)+(65280&i)+((255&i)<<16)}}},e.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID;for(var t=this.transform.worldTransform,e=t.a,n=t.b,r=t.c,i=t.d,o=t.tx,s=t.ty,a=this.geometry.points,u=this.vertexData,h=0,l=0;l<a.length;l+=2){var c=a[l],p=a[l+1];u[h++]=e*c+r*p+o,u[h++]=i*p+n*c+s}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this.geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},Object.defineProperties(e.prototype,n),e}(s.b);Ct._TEMP_POINT=new h.g;
/*!
 * @pixi/sprite - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var kt=new h.g,At=new Uint16Array([0,1,2,0,2,3]),It=function(t){function e(e){t.call(this),this._anchor=new h.e(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=Z.b.NORMAL,this.shader=null,this._cachedTint=16777215,this.uvs=null,this.texture=e||_.E.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=At,this.pluginName="batch",this.isSprite=!0,this._roundPixels=et.b.ROUND_PIXELS}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={roundPixels:{configurable:!0},width:{configurable:!0},height:{configurable:!0},anchor:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Object(o.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Object(o.sign)(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,n=e.a,r=e.b,i=e.c,o=e.d,s=e.tx,a=e.ty,u=this.vertexData,h=t.trim,l=t.orig,c=this._anchor,p=0,d=0,f=0,g=0;if(h?(p=(d=h.x-c._x*l.width)+h.width,f=(g=h.y-c._y*l.height)+h.height):(p=(d=-c._x*l.width)+l.width,f=(g=-c._y*l.height)+l.height),u[0]=n*d+i*g+s,u[1]=o*g+r*d+a,u[2]=n*p+i*g+s,u[3]=o*g+r*p+a,u[4]=n*p+i*f+s,u[5]=o*f+r*p+a,u[6]=n*d+i*f+s,u[7]=o*f+r*d+a,this._roundPixels)for(var y=et.b.RESOLUTION,m=0;m<u.length;++m)u[m]=Math.round((u[m]*y|0)/y)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,n=t.orig,r=this._anchor,i=this.transform.worldTransform,o=i.a,s=i.b,a=i.c,u=i.d,h=i.tx,l=i.ty,c=-r._x*n.width,p=c+n.width,d=-r._y*n.height,f=d+n.height;e[0]=o*c+a*d+h,e[1]=u*d+s*c+l,e[2]=o*p+a*d+h,e[3]=u*d+s*p+l,e[4]=o*p+a*f+h,e[5]=u*f+s*p+l,e[6]=o*c+a*f+h,e[7]=u*f+s*c+l},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new h.j),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,kt);var e=this._texture.orig.width,n=this._texture.orig.height,r=-e*this.anchor.x,i=0;return kt.x>=r&&kt.x<r+e&&(i=-n*this.anchor.y,kt.y>=i&&kt.y<i+n)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var n="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!n)}this._texture=null,this.shader=null},e.from=function(t,n){return new e(t instanceof _.E?t:_.E.from(t,n))},n.roundPixels.set=function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},n.roundPixels.get=function(){return this._roundPixels},n.width.get=function(){return Math.abs(this.scale.x)*this._texture.orig.width},n.width.set=function(t){var e=Object(o.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},n.height.get=function(){return Math.abs(this.scale.y)*this._texture.orig.height},n.height.set=function(t){var e=Object(o.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},n.anchor.get=function(){return this._anchor},n.anchor.set=function(t){this._anchor.copyFrom(t)},n.tint.get=function(){return this._tint},n.tint.set=function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},n.texture.get=function(){return this._texture},n.texture.set=function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||_.E.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},Object.defineProperties(e.prototype,n),e}(s.b),Ot={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1},Lt={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Ot.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},Mt=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Bt=function(t){this.styleID=0,this.reset(),Nt(this,t,t)},Dt={align:{configurable:!0},breakWords:{configurable:!0},dropShadow:{configurable:!0},dropShadowAlpha:{configurable:!0},dropShadowAngle:{configurable:!0},dropShadowBlur:{configurable:!0},dropShadowColor:{configurable:!0},dropShadowDistance:{configurable:!0},fill:{configurable:!0},fillGradientType:{configurable:!0},fillGradientStops:{configurable:!0},fontFamily:{configurable:!0},fontSize:{configurable:!0},fontStyle:{configurable:!0},fontVariant:{configurable:!0},fontWeight:{configurable:!0},letterSpacing:{configurable:!0},lineHeight:{configurable:!0},leading:{configurable:!0},lineJoin:{configurable:!0},miterLimit:{configurable:!0},padding:{configurable:!0},stroke:{configurable:!0},strokeThickness:{configurable:!0},textBaseline:{configurable:!0},trim:{configurable:!0},whiteSpace:{configurable:!0},wordWrap:{configurable:!0},wordWrapWidth:{configurable:!0}};function Ft(t){return"number"==typeof t?Object(o.hex2string)(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function Rt(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=Ft(t[e]);return t}return Ft(t)}function Nt(t,e,n){for(var r in n)Array.isArray(e[r])?t[r]=e[r].slice():t[r]=e[r]}Bt.prototype.clone=function(){var t={};return Nt(t,this,Lt),new Bt(t)},Bt.prototype.reset=function(){Nt(this,Lt,Lt)},Dt.align.get=function(){return this._align},Dt.align.set=function(t){this._align!==t&&(this._align=t,this.styleID++)},Dt.breakWords.get=function(){return this._breakWords},Dt.breakWords.set=function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},Dt.dropShadow.get=function(){return this._dropShadow},Dt.dropShadow.set=function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},Dt.dropShadowAlpha.get=function(){return this._dropShadowAlpha},Dt.dropShadowAlpha.set=function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},Dt.dropShadowAngle.get=function(){return this._dropShadowAngle},Dt.dropShadowAngle.set=function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},Dt.dropShadowBlur.get=function(){return this._dropShadowBlur},Dt.dropShadowBlur.set=function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},Dt.dropShadowColor.get=function(){return this._dropShadowColor},Dt.dropShadowColor.set=function(t){var e=Rt(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},Dt.dropShadowDistance.get=function(){return this._dropShadowDistance},Dt.dropShadowDistance.set=function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},Dt.fill.get=function(){return this._fill},Dt.fill.set=function(t){var e=Rt(t);this._fill!==e&&(this._fill=e,this.styleID++)},Dt.fillGradientType.get=function(){return this._fillGradientType},Dt.fillGradientType.set=function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},Dt.fillGradientStops.get=function(){return this._fillGradientStops},Dt.fillGradientStops.set=function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},Dt.fontFamily.get=function(){return this._fontFamily},Dt.fontFamily.set=function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},Dt.fontSize.get=function(){return this._fontSize},Dt.fontSize.set=function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},Dt.fontStyle.get=function(){return this._fontStyle},Dt.fontStyle.set=function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},Dt.fontVariant.get=function(){return this._fontVariant},Dt.fontVariant.set=function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},Dt.fontWeight.get=function(){return this._fontWeight},Dt.fontWeight.set=function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},Dt.letterSpacing.get=function(){return this._letterSpacing},Dt.letterSpacing.set=function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},Dt.lineHeight.get=function(){return this._lineHeight},Dt.lineHeight.set=function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},Dt.leading.get=function(){return this._leading},Dt.leading.set=function(t){this._leading!==t&&(this._leading=t,this.styleID++)},Dt.lineJoin.get=function(){return this._lineJoin},Dt.lineJoin.set=function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},Dt.miterLimit.get=function(){return this._miterLimit},Dt.miterLimit.set=function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},Dt.padding.get=function(){return this._padding},Dt.padding.set=function(t){this._padding!==t&&(this._padding=t,this.styleID++)},Dt.stroke.get=function(){return this._stroke},Dt.stroke.set=function(t){var e=Rt(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},Dt.strokeThickness.get=function(){return this._strokeThickness},Dt.strokeThickness.set=function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},Dt.textBaseline.get=function(){return this._textBaseline},Dt.textBaseline.set=function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},Dt.trim.get=function(){return this._trim},Dt.trim.set=function(t){this._trim!==t&&(this._trim=t,this.styleID++)},Dt.whiteSpace.get=function(){return this._whiteSpace},Dt.whiteSpace.set=function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},Dt.wordWrap.get=function(){return this._wordWrap},Dt.wordWrap.set=function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},Dt.wordWrapWidth.get=function(){return this._wordWrapWidth},Dt.wordWrapWidth.set=function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},Bt.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var n=e.length-1;n>=0;n--){var r=e[n].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&Mt.indexOf(r)<0&&(r='"'+r+'"'),e[n]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},Object.defineProperties(Bt.prototype,Dt);var Vt=function(t,e,n,r,i,o,s,a,u){this.text=t,this.style=e,this.width=n,this.height=r,this.lines=i,this.lineWidths=o,this.lineHeight=s,this.maxLineWidth=a,this.fontProperties=u};Vt.measureText=function(t,e,n,r){void 0===r&&(r=Vt._canvas),n=null==n?e.wordWrap:n;var i=e.toFontString(),o=Vt.measureFont(i);0===o.fontSize&&(o.fontSize=e.fontSize,o.ascent=e.fontSize);var s=r.getContext("2d");s.font=i;for(var a=(n?Vt.wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),u=new Array(a.length),h=0,l=0;l<a.length;l++){var c=s.measureText(a[l]).width+(a[l].length-1)*e.letterSpacing;u[l]=c,h=Math.max(h,c)}var p=h+e.strokeThickness;e.dropShadow&&(p+=e.dropShadowDistance);var d=e.lineHeight||o.fontSize+e.strokeThickness,f=Math.max(d,o.fontSize+e.strokeThickness)+(a.length-1)*(d+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new Vt(t,e,p,f,a,u,d+e.leading,h,o)},Vt.wordWrap=function(t,e,n){void 0===n&&(n=Vt._canvas);for(var r=n.getContext("2d"),i=0,o="",s="",a={},u=e.letterSpacing,h=e.whiteSpace,l=Vt.collapseSpaces(h),c=Vt.collapseNewlines(h),p=!l,d=e.wordWrapWidth+u,f=Vt.tokenize(t),g=0;g<f.length;g++){var y=f[g];if(Vt.isNewline(y)){if(!c){s+=Vt.addLine(o),p=!l,o="",i=0;continue}y=" "}if(l){var m=Vt.isBreakingSpace(y),v=Vt.isBreakingSpace(o[o.length-1]);if(m&&v)continue}var b=Vt.getFromCache(y,u,a,r);if(b>d)if(""!==o&&(s+=Vt.addLine(o),o="",i=0),Vt.canBreakWords(y,e.breakWords))for(var _=Vt.wordWrapSplit(y),x=0;x<_.length;x++){for(var w=_[x],T=1;_[x+T];){var S=_[x+T],E=w[w.length-1];if(Vt.canBreakChars(E,S,y,x,e.breakWords))break;w+=S,T++}x+=w.length-1;var P=Vt.getFromCache(w,u,a,r);P+i>d&&(s+=Vt.addLine(o),p=!1,o="",i=0),o+=w,i+=P}else{o.length>0&&(s+=Vt.addLine(o),o="",i=0);var C=g===f.length-1;s+=Vt.addLine(y,!C),p=!1,o="",i=0}else b+i>d&&(p=!1,s+=Vt.addLine(o),o="",i=0),(o.length>0||!Vt.isBreakingSpace(y)||p)&&(o+=y,i+=b)}return s+=Vt.addLine(o,!1)},Vt.addLine=function(t,e){return void 0===e&&(e=!0),t=Vt.trimRight(t),t=e?t+"\n":t},Vt.getFromCache=function(t,e,n,r){var i=n[t];if(void 0===i){var o=t.length*e;i=r.measureText(t).width+o,n[t]=i}return i},Vt.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},Vt.collapseNewlines=function(t){return"normal"===t},Vt.trimRight=function(t){if("string"!=typeof t)return"";for(var e=t.length-1;e>=0;e--){var n=t[e];if(!Vt.isBreakingSpace(n))break;t=t.slice(0,-1)}return t},Vt.isNewline=function(t){return"string"==typeof t&&Vt._newlines.indexOf(t.charCodeAt(0))>=0},Vt.isBreakingSpace=function(t){return"string"==typeof t&&Vt._breakingSpaces.indexOf(t.charCodeAt(0))>=0},Vt.tokenize=function(t){var e=[],n="";if("string"!=typeof t)return e;for(var r=0;r<t.length;r++){var i=t[r];Vt.isBreakingSpace(i)||Vt.isNewline(i)?(""!==n&&(e.push(n),n=""),e.push(i)):n+=i}return""!==n&&e.push(n),e},Vt.canBreakWords=function(t,e){return e},Vt.canBreakChars=function(t,e,n,r,i){return!0},Vt.wordWrapSplit=function(t){return t.split("")},Vt.measureFont=function(t){if(Vt._fonts[t])return Vt._fonts[t];var e={},n=Vt._canvas,r=Vt._context;r.font=t;var i=Vt.METRICS_STRING+Vt.BASELINE_SYMBOL,o=Math.ceil(r.measureText(i).width),s=Math.ceil(r.measureText(Vt.BASELINE_SYMBOL).width),a=2*s;s=s*Vt.BASELINE_MULTIPLIER|0,n.width=o,n.height=a,r.fillStyle="#f00",r.fillRect(0,0,o,a),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(i,0,s);var u=r.getImageData(0,0,o,a).data,h=u.length,l=4*o,c=0,p=0,d=!1;for(c=0;c<s;++c){for(var f=0;f<l;f+=4)if(255!==u[p+f]){d=!0;break}if(d)break;p+=l}for(e.ascent=s-c,p=h-l,d=!1,c=a;c>s;--c){for(var g=0;g<l;g+=4)if(255!==u[p+g]){d=!0;break}if(d)break;p-=l}return e.descent=c-s,e.fontSize=e.ascent+e.descent,Vt._fonts[t]=e,e},Vt.clearMetrics=function(t){void 0===t&&(t=""),t?delete Vt._fonts[t]:Vt._fonts={}};var jt=function(){try{var t=new OffscreenCanvas(0,0),e=t.getContext("2d");return e&&e.measureText?t:document.createElement("canvas")}catch(t){return document.createElement("canvas")}}();jt.width=jt.height=10,Vt._canvas=jt,Vt._context=jt.getContext("2d"),Vt._fonts={},Vt.METRICS_STRING="|ÉqÅ",Vt.BASELINE_SYMBOL="M",Vt.BASELINE_MULTIPLIER=1.4,Vt._newlines=[10,13],Vt._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var Ut={texture:!0,children:!1,baseTexture:!0},Xt=function(t){function e(e,n,r){var i=!1;r||(r=document.createElement("canvas"),i=!0),r.width=3,r.height=3;var o=_.E.from(r);o.orig=new h.j,o.trim=new h.j,t.call(this,o),this._ownCanvas=i,this.canvas=r,this.context=this.canvas.getContext("2d"),this._resolution=et.b.RESOLUTION,this._autoResolution=!0,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=n,this.localStyleID=-1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={width:{configurable:!0},height:{configurable:!0},style:{configurable:!0},text:{configurable:!0},resolution:{configurable:!0}};return e.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var n,r,i=this.context,s=Vt.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),a=s.width,u=s.height,h=s.lines,l=s.lineHeight,c=s.lineWidths,p=s.maxLineWidth,d=s.fontProperties;this.canvas.width=Math.ceil((Math.max(1,a)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,u)+2*e.padding)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=e.strokeThickness,i.textBaseline=e.textBaseline,i.lineJoin=e.lineJoin,i.miterLimit=e.miterLimit;for(var f=e.dropShadow?2:1,g=0;g<f;++g){var y=e.dropShadow&&0===g,m=y?2*u:0,v=m*this.resolution;if(y){i.fillStyle="black",i.strokeStyle="black";var b=e.dropShadowColor,_=Object(o.hex2rgb)("number"==typeof b?b:Object(o.string2hex)(b));i.shadowColor="rgba("+255*_[0]+","+255*_[1]+","+255*_[2]+","+e.dropShadowAlpha+")",i.shadowBlur=e.dropShadowBlur,i.shadowOffsetX=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,i.shadowOffsetY=Math.sin(e.dropShadowAngle)*e.dropShadowDistance+v}else i.fillStyle=this._generateFillStyle(e,h,s),i.strokeStyle=e.stroke,i.shadowColor=0,i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;for(var x=0;x<h.length;x++)n=e.strokeThickness/2,r=e.strokeThickness/2+x*l+d.ascent,"right"===e.align?n+=p-c[x]:"center"===e.align&&(n+=(p-c[x])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(h[x],n+e.padding,r+e.padding-m,!0),e.fill&&this.drawLetterSpacing(h[x],n+e.padding,r+e.padding-m)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,e,n,r){void 0===r&&(r=!1);var i=this._style.letterSpacing;if(0!==i)for(var o=e,s=Array.from?Array.from(t):t.split(""),a=this.context.measureText(t).width,u=0,h=0;h<s.length;++h){var l=s[h];r?this.context.strokeText(l,o,n):this.context.fillText(l,o,n),o+=a-(u=this.context.measureText(t.substring(h+1)).width)+i,a=u}else r?this.context.strokeText(t,e,n):this.context.fillText(t,e,n)},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=Object(o.trimCanvas)(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var n=this._texture,r=this._style,i=r.trim?0:r.padding,s=n.baseTexture;n.trim.width=n._frame.width=Math.ceil(t.width/this._resolution),n.trim.height=n._frame.height=Math.ceil(t.height/this._resolution),n.trim.x=-i,n.trim.y=-i,n.orig.width=n._frame.width-2*i,n.orig.height=n._frame.height-2*i,this._onTextureUpdate(),s.setRealSize(t.width,t.height,this._resolution),this.dirty=!1},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._render.call(this,e)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._onStyleChange=function(){this.dirty=!0},e.prototype._generateFillStyle=function(t,e,n){if(!Array.isArray(t.fill))return t.fill;if(1===t.fill.length)return t.fill[0];var r,i=t.dropShadow?t.dropShadowDistance:0,o=t.padding||0,s=Math.ceil(this.canvas.width/this._resolution)-i-2*o,a=Math.ceil(this.canvas.height/this._resolution)-i-2*o,u=t.fill.slice(),h=t.fillGradientStops.slice();if(!h.length)for(var l=u.length+1,c=1;c<l;++c)h.push(c/l);if(u.unshift(t.fill[0]),h.unshift(0),u.push(t.fill[t.fill.length-1]),h.push(1),t.fillGradientType===Ot.LINEAR_VERTICAL){r=this.context.createLinearGradient(s/2,o,s/2,a+o);for(var p=0,d=(n.fontProperties.fontSize+t.strokeThickness)/a,f=0;f<e.length;f++)for(var g=n.lineHeight*f,y=0;y<u.length;y++){var m=g/a+("number"==typeof h[y]?h[y]:y/u.length)*d,v=Math.max(p,m);v=Math.min(v,1),r.addColorStop(v,u[y]),p=v}}else{r=this.context.createLinearGradient(o,a/2,s+o,a/2);for(var b=u.length+1,_=1,x=0;x<u.length;x++){var w=void 0;w="number"==typeof h[x]?h[x]:_/b,r.addColorStop(w,u[x]),_++}}return r},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},Ut,e),t.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},n.width.get=function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},n.width.set=function(t){this.updateText(!0);var e=Object(o.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},n.height.get=function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},n.height.set=function(t){this.updateText(!0);var e=Object(o.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},n.style.get=function(){return this._style},n.style.set=function(t){t=t||{},this._style=t instanceof Bt?t:new Bt(t),this.localStyleID=-1,this.dirty=!0},n.text.get=function(){return this._text},n.text.set=function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},n.resolution.get=function(){return this._resolution},n.resolution.set=function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},Object.defineProperties(e.prototype,n),e}(It);
/*!
 * @pixi/prepare - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
et.b.UPLOADS_PER_FRAME=4;var Ht=function(t){this.maxItemsPerFrame=t,this.itemsLeft=0};Ht.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},Ht.prototype.allowedToUpload=function(){return this.itemsLeft-- >0};var Gt=function(t){var e=this;this.limiter=new Ht(et.b.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(Jt),this.registerFindHook(Zt),this.registerFindHook(Yt),this.registerFindHook(Wt),this.registerFindHook(zt),this.registerUploadHook(qt),this.registerUploadHook(Kt)};function Yt(t,e){var n=!1;if(t&&t._textures&&t._textures.length)for(var r=0;r<t._textures.length;r++)if(t._textures[r]instanceof _.E){var i=t._textures[r].baseTexture;-1===e.indexOf(i)&&(e.push(i),n=!0)}return n}function Wt(t,e){if(t.baseTexture instanceof _.e){var n=t.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function zt(t,e){if(t._texture&&t._texture instanceof _.E){var n=t._texture.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function qt(t,e){return e instanceof Xt&&(e.updateText(!0),!0)}function Kt(t,e){if(e instanceof Bt){var n=e.toFontString();return Vt.measureFont(n),!0}return!1}function Jt(t,e){if(t instanceof Xt){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var n=t._texture.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function Zt(t,e){return t instanceof Bt&&(-1===e.indexOf(t)&&e.push(t),!0)}Gt.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,l.a.system.addOnce(this.tick,this,l.c.UTILITY))):e&&e()},Gt.prototype.tick=function(){setTimeout(this.delayedTick,0)},Gt.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var n=0,r=this.uploadHooks.length;n<r;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)l.a.system.addOnce(this.tick,this,l.c.UTILITY);else{this.ticking=!1;var i=this.completes.slice(0);this.completes.length=0;for(var o=0,s=i.length;o<s;o++)i[o]()}},Gt.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},Gt.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},Gt.prototype.add=function(t){for(var e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof s.b)for(var r=t.children.length-1;r>=0;r--)this.add(t.children[r]);return this},Gt.prototype.destroy=function(){this.ticking&&l.a.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null};var Qt=function(t){function e(e){t.call(this,e),this.uploadHookHelper=this.renderer,this.registerFindHook(ee),this.registerUploadHook($t),this.registerUploadHook(te)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Gt);function $t(t,e){return e instanceof _.e&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function te(t,e){if(!(e instanceof Ct))return!1;var n=e.geometry;e.finishPoly(),n.updateBatches();for(var r=n.batches,i=0;i<r.length;i++){var o=r[i].style.texture;o&&$t(t,o.baseTexture)}return n.batchable||t.geometry.bind(n,e._resolveDirectShader(t)),!0}function ee(t,e){return t instanceof Ct&&(e.push(t),!0)}var ne=function(t){this.maxMilliseconds=t,this.frameStart=0};ne.prototype.beginFrame=function(){this.frameStart=Date.now()},ne.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds};
/*!
 * @pixi/spritesheet - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/spritesheet is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var re=function(t,e,n){void 0===n&&(n=null),this._texture=t instanceof _.E?t:null,this.baseTexture=t instanceof _.e?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e,this.resolution=this._updateResolution(n||(this.baseTexture.resource?this.baseTexture.resource.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null},ie={BATCH_SIZE:{configurable:!0}};ie.BATCH_SIZE.get=function(){return 1e3},re.prototype._updateResolution=function(t){var e=this.data.meta.scale,n=Object(o.getResolutionOfUrl)(t,null);return null===n&&(n=void 0!==e?parseFloat(e):1),1!==n&&this.baseTexture.setResolution(n),n},re.prototype.parse=function(t){this._batchIndex=0,this._callback=t,this._frameKeys.length<=re.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},re.prototype._processFrames=function(t){for(var e=t,n=re.BATCH_SIZE;e-t<n&&e<this._frameKeys.length;){var r=this._frameKeys[e],i=this._frames[r],o=i.frame;if(o){var s=null,a=null,u=!1!==i.trimmed&&i.sourceSize?i.sourceSize:i.frame,l=new h.j(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);s=i.rotated?new h.j(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):new h.j(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),!1!==i.trimmed&&i.spriteSourceSize&&(a=new h.j(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[r]=new _.E(this.baseTexture,s,l,a,i.rotated?2:0,i.anchor),_.E.addToCache(this.textures[r],r)}e++}},re.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var n=0;n<t[e].length;n++){var r=t[e][n];this.animations[e].push(this.textures[r])}}},re.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},re.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*re.BATCH_SIZE),this._batchIndex++,setTimeout((function(){t._batchIndex*re.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())}),0)},re.prototype.destroy=function(t){for(var e in void 0===t&&(t=!1),this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(this._texture&&this._texture.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},Object.defineProperties(re,ie);var oe=function(){};oe.use=function(t,e){var n=t.name+"_image";if(t.data&&t.type===J.TYPE.JSON&&t.data.frames&&!this.resources[n]){var r={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},i=oe.getResourcePath(t,this.baseUrl);this.add(n,i,r,(function(n){if(n.error)e(n.error);else{var r=new re(n.texture,t.data,t.url);r.parse((function(){t.spritesheet=r,t.textures=r.textures,e()}))}}))}else e()},oe.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:o.url.resolve(t.url.replace(e,""),t.data.meta.image)};
/*!
 * @pixi/sprite-tiling - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/sprite-tiling is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var se=new h.g,ae=function(t){function e(e,n,r){void 0===n&&(n=100),void 0===r&&(r=100),t.call(this,e),this.tileTransform=new h.m,this._width=n,this._height=r,this._canvasPattern=null,this.uvMatrix=e.uvMatrix||new _.F(e),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={clampMargin:{configurable:!0},tileScale:{configurable:!0},tilePosition:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return n.clampMargin.get=function(){return this.uvMatrix.clampMargin},n.clampMargin.set=function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},n.tileScale.get=function(){return this.tileTransform.scale},n.tileScale.set=function(t){this.tileTransform.scale.copyFrom(t)},n.tilePosition.get=function(){return this.tileTransform.position},n.tilePosition.set=function(t){this.tileTransform.position.copyFrom(t)},e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,n=this._width*(1-this._anchor._x),r=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,n,r)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new h.j),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,se);var e=this._width,n=this._height,r=-e*this.anchor._x;if(se.x>=r&&se.x<r+e){var i=-n*this.anchor._y;if(se.y>=i&&se.y<i+n)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,n,r){return new e(_.E.from(t),n,r)},e.fromFrame=function(t,n,r){var i=o.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new e(i,n,r)},e.fromImage=function(t,n,r,i){return i&&"object"!=typeof i&&(i={scaleMode:arguments[4],resourceOptions:{crossorigin:arguments[3]}}),new e(_.E.from(t,i),n,r)},n.width.get=function(){return this._width},n.width.set=function(t){this._width=t},n.height.get=function(){return this._height},n.height.set=function(t){this._height=t},Object.defineProperties(e.prototype,n),e}(It),ue="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",he=new h.d,le=function(t){function e(e){t.call(this,e);var n={globals:this.renderer.globalUniforms};this.shader=_.A.from(ue,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord - floor(vTextureCoord - uClampOffset);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture2D(uSampler, coord);\n    gl_FragColor = texSample * uColor;\n}\n",n),this.simpleShader=_.A.from(ue,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n",n),this.quad=new _.w,this.state=_.C.for2d()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.render=function(t){var e=this.renderer,n=this.quad,r=n.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x),r[5]=r[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((r=n.uvs)[0]=r[6]=-t.anchor.x,r[1]=r[3]=-t.anchor.y,r[2]=r[4]=1-t.anchor.x,r[5]=r[7]=1-t.anchor.y),n.invalidate();var i=t._texture,s=i.baseTexture,a=t.tileTransform.localTransform,u=t.uvMatrix,h=s.isPowerOfTwo&&i.frame.width===s.width&&i.frame.height===s.height;h&&(s._glTextures[e.CONTEXT_UID]?h=s.wrapMode!==Z.n.CLAMP:s.wrapMode===Z.n.CLAMP&&(s.wrapMode=Z.n.REPEAT));var l=h?this.simpleShader:this.shader,c=i.width,p=i.height,d=t._width,f=t._height;he.set(a.a*c/d,a.b*c/f,a.c*p/d,a.d*p/f,a.tx/d,a.ty/f),he.invert(),h?he.prepend(u.mapCoord):(l.uniforms.uMapCoord=u.mapCoord.toArray(!0),l.uniforms.uClampFrame=u.uClampFrame,l.uniforms.uClampOffset=u.uClampOffset),l.uniforms.uTransform=he.toArray(!0),l.uniforms.uColor=Object(o.premultiplyTintToRgba)(t.tint,t.worldAlpha,l.uniforms.uColor,s.alphaMode),l.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),l.uniforms.uSampler=i,e.shader.bind(l),e.geometry.bind(n),this.state.blendMode=Object(o.correctBlendMode)(t.blendMode,s.alphaMode),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},e}(_.t),ce=function(t){function e(e,n){var r=this;void 0===n&&(n={}),t.call(this),this._textWidth=0,this._textHeight=0,this._glyphs=[],this._font={tint:void 0!==n.tint?n.tint:16777215,align:n.align||"left",name:null,size:0},this.font=n.font,this._text=e,this._maxWidth=0,this._maxLineHeight=0,this._letterSpacing=0,this._anchor=new h.e((function(){r.dirty=!0}),this,0,0),this.dirty=!1,this.roundPixels=et.b.ROUND_PIXELS,this.updateText()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={tint:{configurable:!0},align:{configurable:!0},anchor:{configurable:!0},font:{configurable:!0},text:{configurable:!0},maxWidth:{configurable:!0},maxLineHeight:{configurable:!0},textWidth:{configurable:!0},letterSpacing:{configurable:!0},textHeight:{configurable:!0}};return e.prototype.updateText=function(){for(var t=e.fonts[this._font.name],n=this._font.size/t.size,r=new h.g,i=[],s=[],a=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",u=a.length,l=this._maxWidth*t.size/this._font.size,c=null,p=0,d=0,f=0,g=-1,y=0,m=0,v=0,b=0;b<u;b++){var _=a.charCodeAt(b),x=a.charAt(b);if(/(?:\s)/.test(x)&&(g=b,y=p),"\r"!==x&&"\n"!==x){var w=t.chars[_];w&&(c&&w.kerning[c]&&(r.x+=w.kerning[c]),i.push({texture:w.texture,line:f,charCode:_,position:new h.g(r.x+w.xOffset+this._letterSpacing/2,r.y+w.yOffset)}),r.x+=w.xAdvance+this._letterSpacing,p=r.x,v=Math.max(v,w.yOffset+w.texture.height),c=_,-1!==g&&l>0&&r.x>l&&(++m,Object(o.removeItems)(i,1+g-m,1+b-g),b=g,g=-1,s.push(y),d=Math.max(d,y),f++,r.x=0,r.y+=t.lineHeight,c=null))}else s.push(p),d=Math.max(d,p),++f,++m,r.x=0,r.y+=t.lineHeight,c=null}var T=a.charAt(a.length-1);"\r"!==T&&"\n"!==T&&(/(?:\s)/.test(T)&&(p=y),s.push(p),d=Math.max(d,p));for(var S=[],E=0;E<=f;E++){var P=0;"right"===this._font.align?P=d-s[E]:"center"===this._font.align&&(P=(d-s[E])/2),S.push(P)}for(var C=i.length,k=this.tint,A=0;A<C;A++){var I=this._glyphs[A];I?I.texture=i[A].texture:((I=new It(i[A].texture)).roundPixels=this.roundPixels,this._glyphs.push(I)),I.position.x=(i[A].position.x+S[i[A].line])*n,I.position.y=i[A].position.y*n,I.scale.x=I.scale.y=n,I.tint=k,I.parent||this.addChild(I)}for(var O=C;O<this._glyphs.length;++O)this.removeChild(this._glyphs[O]);if(this._textWidth=d*n,this._textHeight=(r.y+t.lineHeight)*n,0!==this.anchor.x||0!==this.anchor.y)for(var L=0;L<C;L++)this._glyphs[L].x-=this._textWidth*this.anchor.x,this._glyphs[L].y-=this._textHeight*this.anchor.y;this._maxLineHeight=v*n},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},n.tint.get=function(){return this._font.tint},n.tint.set=function(t){this._font.tint="number"==typeof t&&t>=0?t:16777215,this.dirty=!0},n.align.get=function(){return this._font.align},n.align.set=function(t){this._font.align=t||"left",this.dirty=!0},n.anchor.get=function(){return this._anchor},n.anchor.set=function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},n.font.get=function(){return this._font},n.font.set=function(t){t&&("string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),this._font.size=t.length>=2?parseInt(t[0],10):e.fonts[this._font.name].size):(this._font.name=t.name,this._font.size="number"==typeof t.size?t.size:parseInt(t.size,10)),this.dirty=!0)},n.text.get=function(){return this._text},n.text.set=function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},n.maxWidth.get=function(){return this._maxWidth},n.maxWidth.set=function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},n.maxLineHeight.get=function(){return this.validate(),this._maxLineHeight},n.textWidth.get=function(){return this.validate(),this._textWidth},n.letterSpacing.get=function(){return this._letterSpacing},n.letterSpacing.set=function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},n.textHeight.get=function(){return this.validate(),this._textHeight},e.registerFont=function(t,n){var r={},i=t.getElementsByTagName("info")[0],s=t.getElementsByTagName("common")[0],a=t.getElementsByTagName("page"),u=Object(o.getResolutionOfUrl)(a[0].getAttribute("file")),l={};r.font=i.getAttribute("face"),r.size=parseInt(i.getAttribute("size"),10),r.lineHeight=parseInt(s.getAttribute("lineHeight"),10)/u,r.chars={},n instanceof _.E&&(n=[n]);for(var c=0;c<a.length;c++){var p=a[c].getAttribute("id"),d=a[c].getAttribute("file");l[p]=n instanceof Array?n[c]:n[d]}for(var f=t.getElementsByTagName("char"),g=0;g<f.length;g++){var y=f[g],m=parseInt(y.getAttribute("id"),10),v=y.getAttribute("page")||0,b=new h.j(parseInt(y.getAttribute("x"),10)/u+l[v].frame.x/u,parseInt(y.getAttribute("y"),10)/u+l[v].frame.y/u,parseInt(y.getAttribute("width"),10)/u,parseInt(y.getAttribute("height"),10)/u);r.chars[m]={xOffset:parseInt(y.getAttribute("xoffset"),10)/u,yOffset:parseInt(y.getAttribute("yoffset"),10)/u,xAdvance:parseInt(y.getAttribute("xadvance"),10)/u,kerning:{},texture:new _.E(l[v].baseTexture,b),page:v}}for(var x=t.getElementsByTagName("kerning"),w=0;w<x.length;w++){var T=x[w],S=parseInt(T.getAttribute("first"),10)/u,E=parseInt(T.getAttribute("second"),10)/u,P=parseInt(T.getAttribute("amount"),10)/u;r.chars[E]&&(r.chars[E].kerning[S]=P)}return e.fonts[r.font]=r,r},Object.defineProperties(e.prototype,n),e}(s.b);ce.fonts={};var pe=function(){};pe.parse=function(t,e){t.bitmapFont=ce.registerFont(t.data,e)},pe.add=function(){J.setExtensionXhrType("fnt",J.XHR_RESPONSE_TYPE.DOCUMENT)},pe.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},pe.use=function(t,e){if(t.data&&t.type===J.TYPE.XML)if(0!==t.data.getElementsByTagName("page").length&&0!==t.data.getElementsByTagName("info").length&&null!==t.data.getElementsByTagName("info")[0].getAttribute("face")){var n=t.isDataUrl?"":pe.dirname(t.url);t.isDataUrl&&("."===n&&(n=""),this.baseUrl&&n&&"/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(n+="/")),(n=n.replace(this.baseUrl,""))&&"/"!==n.charAt(n.length-1)&&(n+="/");for(var r=t.data.getElementsByTagName("page"),i={},o=function(n){i[n.metadata.pageFile]=n.texture,Object.keys(i).length===r.length&&(pe.parse(t,i),e())},s=0;s<r.length;++s){var a=r[s].getAttribute("file"),u=n+a,h=!1;for(var l in this.resources){var c=this.resources[l];if(c.url===u){c.metadata.pageFile=a,c.texture?o(c):c.onAfterMiddleware.add(o),h=!0;break}}if(!h){var p={crossOrigin:t.crossOrigin,loadType:J.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:a},t.metadata.imageMetadata),parentResource:t};this.add(u,p,o)}}}else e();else e()};
/*!
 * @pixi/filter-alpha - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/filter-alpha is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var de=function(t){function e(e){void 0===e&&(e=1),t.call(this,_.M,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1}),this.alpha=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={alpha:{configurable:!0}};return n.alpha.get=function(){return this.uniforms.uAlpha},n.alpha.set=function(t){this.uniforms.uAlpha=t},Object.defineProperties(e.prototype,n),e}(_.n);var fe={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},ge=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");var ye=function(t){function e(e,n,r,i,o){var s=function(t,e){var n,r=Math.ceil(t/2),i="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",o="";n=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var s=0;s<t;s++){var a=n.replace("%index%",s);o+=a=a.replace("%sampleIndex%",s-(r-1)+".0"),o+="\n"}return i=(i=i.replace("%blur%",o)).replace("%size%",t)}(o=o||5,e),a=function(t){for(var e,n=fe[t],r=n.length,i=ge,o="",s=0;s<t;s++){var a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",s);e=s,s>=r&&(e=t-s-1),o+=a=a.replace("%value%",n[e]),o+="\n"}return i=(i=i.replace("%blur%",o)).replace("%size%",t)}(o);t.call(this,s,a),this.horizontal=e,this.resolution=i||et.b.RESOLUTION,this._quality=0,this.quality=r||4,this.blur=n||8}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={blur:{configurable:!0},quality:{configurable:!0}};return e.prototype.apply=function(t,e,n,r){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/e.width):this.uniforms.strength=1/n.height*(n.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,n,r);else{var i=t.getFilterTexture(),o=t.renderer,s=e,a=i;this.state.blend=!1,t.applyFilter(this,s,a,!0);for(var u=1;u<this.passes-1;u++){o.renderTexture.bind(s,s.filterFrame),this.uniforms.uSampler=a;var h=a;a=s,s=h,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,a,n,r),t.returnFilterTexture(i)}},n.blur.get=function(){return this.strength},n.blur.set=function(t){this.padding=1+2*Math.abs(t),this.strength=t},n.quality.get=function(){return this._quality},n.quality.set=function(t){this._quality=t,this.passes=t},Object.defineProperties(e.prototype,n),e}(_.n),me=function(t){function e(e,n,r,i){t.call(this),this.blurXFilter=new ye(!0,e,n,r,i),this.blurYFilter=new ye(!1,e,n,r,i),this.resolution=r||et.b.RESOLUTION,this.quality=n||4,this.blur=e||8,this.repeatEdgePixels=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={blur:{configurable:!0},quality:{configurable:!0},blurX:{configurable:!0},blurY:{configurable:!0},blendMode:{configurable:!0},repeatEdgePixels:{configurable:!0}};return e.prototype.apply=function(t,e,n,r){var i=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(i&&o){var s=t.getFilterTexture();this.blurXFilter.apply(t,e,s,!0),this.blurYFilter.apply(t,s,n,r),t.returnFilterTexture(s)}else o?this.blurYFilter.apply(t,e,n,r):this.blurXFilter.apply(t,e,n,r)},e.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},n.blur.get=function(){return this.blurXFilter.blur},n.blur.set=function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},n.quality.get=function(){return this.blurXFilter.quality},n.quality.set=function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},n.blurX.get=function(){return this.blurXFilter.blur},n.blurX.set=function(t){this.blurXFilter.blur=t,this.updatePadding()},n.blurY.get=function(){return this.blurYFilter.blur},n.blurY.set=function(t){this.blurYFilter.blur=t,this.updatePadding()},n.blendMode.get=function(){return this.blurYFilter.blendMode},n.blendMode.set=function(t){this.blurYFilter.blendMode=t},n.repeatEdgePixels.get=function(){return this._repeatEdgePixels},n.repeatEdgePixels.set=function(t){this._repeatEdgePixels=t,this.updatePadding()},Object.defineProperties(e.prototype,n),e}(_.n),ve=function(t){function e(){var e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};t.call(this,_.L,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",e),this.alpha=1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={matrix:{configurable:!0},alpha:{configurable:!0}};return e.prototype._loadMatrix=function(t,e){void 0===e&&(e=!1);var n=t;e&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n},e.prototype._multiply=function(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.greyscale=function(t,e){var n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var n=Math.cos(t),r=Math.sin(t),i=1/3,o=(0,Math.sqrt)(i),s=[n+(1-n)*i,i*(1-n)-o*r,i*(1-n)+o*r,0,0,i*(1-n)+o*r,n+i*(1-n),i*(1-n)-o*r,0,0,i*(1-n)-o*r,i*(1-n)+o*r,n+i*(1-n),0,0,0,0,0,1,0];this._loadMatrix(s,e)},e.prototype.contrast=function(t,e){var n=(t||0)+1,r=-.5*(n-1),i=[n,0,0,0,r,0,n,0,0,r,0,0,n,0,r,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.saturate=function(t,e){void 0===t&&(t=0);var n=2*t/3+1,r=-.5*(n-1),i=[n,r,r,0,0,r,n,r,0,0,r,r,n,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,n,r,i){var o=((n=n||16770432)>>16&255)/255,s=(n>>8&255)/255,a=(255&n)/255,u=((r=r||3375104)>>16&255)/255,h=(r>>8&255)/255,l=(255&r)/255,c=[.3,.59,.11,0,0,o,s,a,t=t||.2,0,u,h,l,e=e||.15,0,o-u,s-h,a-l,0,0];this._loadMatrix(c,i)},e.prototype.night=function(t,e){var n=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.predator=function(t,e){var n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},n.matrix.get=function(){return this.uniforms.m},n.matrix.set=function(t){this.uniforms.m=t},n.alpha.get=function(){return this.uniforms.uAlpha},n.alpha.set=function(t){this.uniforms.uAlpha=t},Object.defineProperties(e.prototype,n),e}(_.n);ve.prototype.grayscale=ve.prototype.greyscale;
/*!
 * @pixi/filter-displacement - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/filter-displacement is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var be=function(t){function e(e,n){var r=new h.d;e.renderable=!1,t.call(this,"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=r,null==n&&(n=20),this.scale=new h.g(n,n)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={map:{configurable:!0}};return e.prototype.apply=function(t,e,n,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var i=this.maskSprite.transform.worldTransform,o=Math.sqrt(i.a*i.a+i.b*i.b),s=Math.sqrt(i.c*i.c+i.d*i.d);0!==o&&0!==s&&(this.uniforms.rotation[0]=i.a/o,this.uniforms.rotation[1]=i.b/o,this.uniforms.rotation[2]=i.c/s,this.uniforms.rotation[3]=i.d/s),t.applyFilter(this,e,n,r)},n.map.get=function(){return this.uniforms.mapSampler},n.map.set=function(t){this.uniforms.mapSampler=t},Object.defineProperties(e.prototype,n),e}(_.n),_e=function(t){function e(){t.call(this,"\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputPixel;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputPixel;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(_.n),xe=function(t){function e(e,n){void 0===e&&(e=.5),void 0===n&&(n=Math.random()),t.call(this,_.L,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0}),this.noise=e,this.seed=n}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={noise:{configurable:!0},seed:{configurable:!0}};return n.noise.get=function(){return this.uniforms.uNoise},n.noise.set=function(t){this.uniforms.uNoise=t},n.seed.get=function(){return this.uniforms.uSeed},n.seed.set=function(t){this.uniforms.uSeed=t},Object.defineProperties(e.prototype,n),e}(_.n),we=new h.d;s.c.prototype._cacheAsBitmap=!1,s.c.prototype._cacheData=!1;var Te=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null};Object.defineProperties(s.c.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var e;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new Te),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),s.c.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},s.c.prototype._initCachedDisplayObject=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,t.batch.flush();var n=this.getLocalBounds().clone();if(this.filters){var r=this.filters[0].padding;n.pad(r)}n.ceil(et.b.RESOLUTION);var i=t.renderTexture.current,s=t.renderTexture.sourceFrame.clone(),a=t.projection.transform,u=_.x.create(n.width,n.height),h="cacheAsBitmap_"+Object(o.uid)();this._cacheData.textureCacheId=h,_.e.addToCache(u.baseTexture,h),_.E.addToCache(u,h);var l=we;l.tx=-n.x,l.ty=-n.y,this.transform.worldTransform.identity(),this.render=this._cacheData.originalRender,t.render(this,u,!0,l,!0),t.projection.transform=a,t.renderTexture.bind(i,s),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var c=new It(u);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-n.x/n.width,c.anchor.y=-n.y/n.height,c.alpha=e,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=c.containsPoint.bind(c)}},s.c.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},s.c.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(),n=this.alpha;this.alpha=1;var r=t.context,i=t._projTransform;e.ceil(et.b.RESOLUTION);var s=_.x.create(e.width,e.height),a="cacheAsBitmap_"+Object(o.uid)();this._cacheData.textureCacheId=a,_.e.addToCache(s.baseTexture,a),_.E.addToCache(s,a);var u=we;this.transform.localTransform.copyTo(u),u.invert(),u.tx-=e.x,u.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,s,!0,u,!1),t.context=r,t._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var h=new It(s);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-e.x/e.width,h.anchor.y=-e.y/e.height,h.alpha=n,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)}},s.c.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._lastBoundsID=this._boundsID},s.c.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()},s.c.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,_.e.removeFromCache(this._cacheData.textureCacheId),_.E.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},s.c.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},
/*!
 * @pixi/mixin-get-child-by-name - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/mixin-get-child-by-name is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
s.c.prototype.name=null,s.b.prototype.getChildByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null},
/*!
 * @pixi/mixin-get-global-position - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/mixin-get-global-position is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
s.c.prototype.getGlobalPosition=function(t,e){return void 0===t&&(t=new h.g),void 0===e&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};
/*!
 * @pixi/mesh - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/mesh is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var Se=function(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0};Se.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}};var Ee=new h.g,Pe=new h.h,Ce=function(t){function e(e,n,r,i){void 0===i&&(i=Z.c.TRIANGLES),t.call(this),this.geometry=e,e.refCount++,this.shader=n,this.state=r||_.C.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=0,this._transformID=-1,this.tint=16777215,this.blendMode=Z.b.NORMAL,this._roundPixels=et.b.ROUND_PIXELS,this.batchUvs=null}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={uvBuffer:{configurable:!0},verticesBuffer:{configurable:!0},material:{configurable:!0},blendMode:{configurable:!0},roundPixels:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return n.uvBuffer.get=function(){return this.geometry.buffers[1]},n.verticesBuffer.get=function(){return this.geometry.buffers[0]},n.material.set=function(t){this.shader=t},n.material.get=function(){return this.shader},n.blendMode.set=function(t){this.state.blendMode=t},n.blendMode.get=function(){return this.state.blendMode},n.roundPixels.set=function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},n.roundPixels.get=function(){return this._roundPixels},n.tint.get=function(){return this.shader.tint},n.tint.set=function(t){this.shader.tint=t},n.texture.get=function(){return this.shader.texture},n.texture.set=function(t){this.shader.texture=t},e.prototype._render=function(t){var n=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Z.c.TRIANGLES&&n.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.program.uniformData.translationMatrix&&(e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var e=this.geometry;this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=this.shader._tintRGB,this._texture=this.shader.texture;var n=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[n]),t.plugins[n].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry,e=t.buffers[0].data;if(t.vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var n=this.transform.worldTransform,r=n.a,i=n.b,o=n.c,s=n.d,a=n.tx,u=n.ty,h=this.vertexData,l=0;l<h.length/2;l++){var c=e[2*l],p=e[2*l+1];h[2*l]=r*c+o*p+a,h[2*l+1]=i*c+s*p+u}if(this._roundPixels)for(var d=et.b.RESOLUTION,f=0;f<h.length;++f)h[f]=Math.round((h[f]*d|0)/d);this.vertexDirty=t.vertexDirtyId}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1];this.shader.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new Se(t,this.shader.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Ee);for(var e=this.geometry.getBuffer("aVertexPosition").data,n=Pe.points,r=this.geometry.getIndex().data,i=r.length,o=4===this.drawMode?3:1,s=0;s+2<i;s+=o){var a=2*r[s],u=2*r[s+1],h=2*r[s+2];if(n[0]=e[a],n[1]=e[a+1],n[2]=e[u],n[3]=e[u+1],n[4]=e[h],n[5]=e[h+1],Pe.contains(Ee.x,Ee.y))return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},Object.defineProperties(e.prototype,n),e}(s.b);Ce.BATCHABLE_SIZE=100;var ke=function(t){function e(e,n){var r={uSampler:e,alpha:1,uTextureMatrix:h.d.IDENTITY,uColor:new Float32Array([1,1,1,1])};(n=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},n)).uniforms&&Object.assign(r,n.uniforms),t.call(this,n.program||_.u.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),r),this._colorDirty=!1,this.uvMatrix=new _.F(e),this.batchable=void 0===n.program,this.pluginName=n.pluginName,this.tint=n.tint,this.alpha=n.alpha}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={texture:{configurable:!0},alpha:{configurable:!0},tint:{configurable:!0}};return n.texture.get=function(){return this.uniforms.uSampler},n.texture.set=function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},n.alpha.set=function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},n.alpha.get=function(){return this._alpha},n.tint.set=function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},n.tint.get=function(){return this._tint},e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;Object(o.premultiplyTintToRgba)(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},Object.defineProperties(e.prototype,n),e}(_.A),Ae=function(t){function e(e,n,r){t.call(this);var i=new _.l(e),o=new _.l(n,!0),s=new _.l(r,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,Z.m.FLOAT).addAttribute("aTextureCoord",o,2,!1,Z.m.FLOAT).addIndex(s),this._updateId=-1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={vertexDirtyId:{configurable:!0}};return n.vertexDirtyId.get=function(){return this.buffers[0]._updateID},Object.defineProperties(e.prototype,n),e}(_.r),Ie=function(t){function e(e,n,r,i){void 0===e&&(e=100),void 0===n&&(n=100),void 0===r&&(r=10),void 0===i&&(i=10),t.call(this),this.segWidth=r,this.segHeight=i,this.width=e,this.height=n,this.build()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],n=[],r=[],i=this.segWidth-1,o=this.segHeight-1,s=this.width/i,a=this.height/o,u=0;u<t;u++){var h=u%this.segWidth,l=u/this.segWidth|0;e.push(h*s,l*a),n.push(h/i,l/o)}for(var c=i*o,p=0;p<c;p++){var d=p%i,f=p/i|0,g=f*this.segWidth+d,y=f*this.segWidth+d+1,m=(f+1)*this.segWidth+d,v=(f+1)*this.segWidth+d+1;r.push(g,y,m,y,v,m)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(n),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(Ae),Oe=function(t){function e(e,n,r){void 0===e&&(e=200),void 0===r&&(r=0),t.call(this,new Float32Array(4*n.length),new Float32Array(4*n.length),new Uint16Array(6*(n.length-1))),this.points=n,this.width=e,this.textureScale=r,this.build()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),n=this.getBuffer("aTextureCoord"),r=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),n.data=new Float32Array(4*t.length),r.data=new Uint16Array(6*(t.length-1)));var i=n.data,o=r.data;i[0]=0,i[1]=0,i[2]=0,i[3]=1;for(var s=0,a=t[0],u=this.width*this.textureScale,h=t.length,l=0;l<h;l++){var c=4*l;if(this.textureScale>0){var p=a.x-t[l].x,d=a.y-t[l].y,f=Math.sqrt(p*p+d*d);a=t[l],s+=f/u}else s=l/(h-1);i[c]=s,i[c+1]=0,i[c+2]=s,i[c+3]=1}for(var g=0,y=0;y<h-1;y++){var m=2*y;o[g++]=m,o[g++]=m+1,o[g++]=m+2,o[g++]=m+2,o[g++]=m+1,o[g++]=m+3}n.update(),r.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,n=t[0],r=0,i=0,o=this.buffers[0].data,s=t.length,a=0;a<s;a++){var u=t[a],h=4*a;i=-((e=a<t.length-1?t[a+1]:u).x-n.x),r=e.y-n.y;var l=Math.sqrt(r*r+i*i),c=this.textureScale>0?this.textureScale*this.width/2:this.width/2;r/=l,i/=l,r*=c,i*=c,o[h]=u.x+r,o[h+1]=u.y+i,o[h+2]=u.x-r,o[h+3]=u.y-i,n=u}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(Ae),Le=function(t){function e(e,n,r){void 0===r&&(r=0);var i=new Oe(e.height,n,r),o=new ke(e);r>0&&(e.baseTexture.wrapMode=Z.n.REPEAT),t.call(this,i,o),this.autoUpdate=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._render=function(e){(this.autoUpdate||this.geometry.width!==this.shader.texture.height)&&(this.geometry.width=this.shader.texture.height,this.geometry.update()),t.prototype._render.call(this,e)},e}(Ce),Me=function(t){function e(e,n,r){var i=new Ie(e.width,e.height,n,r),o=new ke(_.E.WHITE);t.call(this,i,o),this.texture=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={texture:{configurable:!0}};return e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this.geometry.width=this.shader.texture.width,this.geometry.height=this.shader.texture.height,this.geometry.build()},n.texture.set=function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},n.texture.get=function(){return this.shader.texture},e.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),t.prototype._render.call(this,e)},Object.defineProperties(e.prototype,n),e}(Ce),Be=function(t){function e(e,n,r,i,o){void 0===e&&(e=_.E.EMPTY);var s=new Ae(n,r,i);s.getBuffer("aVertexPosition").static=!1;var a=new ke(e);t.call(this,s,a,null,o),this.autoUpdate=!0}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={vertices:{configurable:!0}};return n.vertices.get=function(){return this.geometry.getBuffer("aVertexPosition").data},n.vertices.set=function(t){this.geometry.getBuffer("aVertexPosition").data=t},e.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),t.prototype._render.call(this,e)},Object.defineProperties(e.prototype,n),e}(Ce),De=function(t){function e(e,n,r,i,o){t.call(this,_.E.WHITE,4,4),this._origWidth=e.orig.width,this._origHeight=e.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=void 0!==n?n:10,this._rightWidth=void 0!==i?i:10,this._topHeight=void 0!==r?r:10,this._bottomHeight=void 0!==o?o:10,this.texture=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={vertices:{configurable:!0},width:{configurable:!0},height:{configurable:!0},leftWidth:{configurable:!0},rightWidth:{configurable:!0},topHeight:{configurable:!0},bottomHeight:{configurable:!0}};return e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},n.vertices.get=function(){return this.geometry.getBuffer("aVertexPosition").data},n.vertices.set=function(t){this.geometry.getBuffer("aVertexPosition").data=t},e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,n=this._topHeight+this._bottomHeight,r=this._height>n?1:this._height/n;return Math.min(e,r)},n.width.get=function(){return this._width},n.width.set=function(t){this._width=t,this._refresh()},n.height.get=function(){return this._height},n.height.set=function(t){this._height=t,this._refresh()},n.leftWidth.get=function(){return this._leftWidth},n.leftWidth.set=function(t){this._leftWidth=t,this._refresh()},n.rightWidth.get=function(){return this._rightWidth},n.rightWidth.set=function(t){this._rightWidth=t,this._refresh()},n.topHeight.get=function(){return this._topHeight},n.topHeight.set=function(t){this._topHeight=t,this._refresh()},n.bottomHeight.get=function(){return this._bottomHeight},n.bottomHeight.set=function(t){this._bottomHeight=t,this._refresh()},e.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var n=1/this._origWidth,r=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=n*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-n*this._rightWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},Object.defineProperties(e.prototype,n),e}(Me),Fe=n(7),Re=function(t){function e(e,n){t.call(this,e[0]instanceof _.E?e[0]:e[0].texture),this._textures=null,this._durations=null,this._autoUpdate=!1!==n,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={totalFrames:{configurable:!0},textures:{configurable:!0},currentFrame:{configurable:!0},playing:{configurable:!0},autoUpdate:{configurable:!0}};return e.prototype.stop=function(){this.playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(l.a.shared.remove(this.update,this),this._isConnectedToTicker=!1))},e.prototype.play=function(){this.playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(l.a.shared.add(this.update,this,l.c.HIGH),this._isConnectedToTicker=!0))},e.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){var e=this.animationSpeed*t,n=this.currentFrame;if(null!==this._durations){var r=this._currentTime%1*this._durations[this.currentFrame];for(r+=e/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];var i=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*i,this._currentTime+=i;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this.updateTexture())},e.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},e.prototype.destroy=function(e){this.stop(),t.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},e.fromFrames=function(t){for(var n=[],r=0;r<t.length;++r)n.push(_.E.from(t[r]));return new e(n)},e.fromImages=function(t){for(var n=[],r=0;r<t.length;++r)n.push(_.E.from(t[r]));return new e(n)},n.totalFrames.get=function(){return this._textures.length},n.textures.get=function(){return this._textures},n.textures.set=function(t){if(t[0]instanceof _.E)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},n.currentFrame.get=function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},n.playing.get=function(){return this._playing},n.autoUpdate.get=function(){return this._autoUpdate},n.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(l.a.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(l.a.shared.add(this.update,this),this._isConnectedToTicker=!0))},Object.defineProperties(e.prototype,n),e}(It),Ne="5.0.0";function Ve(){var t=this;Object.defineProperties(t,{SVG_SIZE:{get:function(){return Object(o.deprecation)(Ne,"PIXI.utils.SVG_SIZE property has moved to PIXI.resources.SVGResource.SVG_SIZE"),t.SVGResource.SVG_SIZE}},TransformStatic:{get:function(){return Object(o.deprecation)(Ne,"PIXI.TransformStatic class has been removed, use PIXI.Transform"),t.Transform}},TransformBase:{get:function(){return Object(o.deprecation)(Ne,"PIXI.TransformBase class has been removed, use PIXI.Transform"),t.Transform}},TRANSFORM_MODE:{get:function(){return Object(o.deprecation)(Ne,"PIXI.TRANSFORM_MODE property has been removed"),{STATIC:0,DYNAMIC:1}}},WebGLRenderer:{get:function(){return Object(o.deprecation)(Ne,"PIXI.WebGLRenderer class has moved to PIXI.Renderer"),t.Renderer}},CanvasRenderTarget:{get:function(){return Object(o.deprecation)(Ne,"PIXI.CanvasRenderTarget class has moved to PIXI.utils.CanvasRenderTarget"),t.utils.CanvasRenderTarget}},loader:{get:function(){return Object(o.deprecation)(Ne,"PIXI.loader instance has moved to PIXI.Loader.shared"),t.Loader.shared}},FilterManager:{get:function(){return Object(o.deprecation)(Ne,"PIXI.FilterManager class has moved to PIXI.systems.FilterSystem"),t.systems.FilterSystem}},CanvasTinter:{get:function(){return Object(o.deprecation)("5.2.0","PIXI.CanvasTinter namespace has moved to PIXI.canvasUtils"),t.canvasUtils}},GroupD8:{get:function(){return Object(o.deprecation)("5.2.0","PIXI.GroupD8 namespace has moved to PIXI.groupD8"),t.groupD8}}}),t.prepare={},Object.defineProperties(t.prepare,{BasePrepare:{get:function(){return Object(o.deprecation)("5.2.1","PIXI.prepare.BasePrepare moved to PIXI.BasePrepare"),t.BasePrepare}},Prepare:{get:function(){return Object(o.deprecation)("5.2.1","PIXI.prepare.Prepare moved to PIXI.Prepare"),t.Prepare}},CanvasPrepare:{get:function(){return Object(o.deprecation)("5.2.1","PIXI.prepare.CanvasPrepare moved to PIXI.CanvasPrepare"),t.CanvasPrepare}}}),t.extract={},Object.defineProperties(t.extract,{Extract:{get:function(){return Object(o.deprecation)("5.2.1","PIXI.extract.Extract moved to PIXI.Extract"),t.Extract}},CanvasExtract:{get:function(){return Object(o.deprecation)("5.2.1","PIXI.extract.CanvasExtract moved to PIXI.CanvasExtract"),t.CanvasExtract}}}),t.extras={},Object.defineProperties(t.extras,{TilingSprite:{get:function(){return Object(o.deprecation)(Ne,"PIXI.extras.TilingSprite class has moved to PIXI.TilingSprite"),t.TilingSprite}},TilingSpriteRenderer:{get:function(){return Object(o.deprecation)(Ne,"PIXI.extras.TilingSpriteRenderer class has moved to PIXI.TilingSpriteRenderer"),t.TilingSpriteRenderer}},AnimatedSprite:{get:function(){return Object(o.deprecation)(Ne,"PIXI.extras.AnimatedSprite class has moved to PIXI.AnimatedSprite"),t.AnimatedSprite}},BitmapText:{get:function(){return Object(o.deprecation)(Ne,"PIXI.extras.BitmapText class has moved to PIXI.BitmapText"),t.BitmapText}}}),Object.defineProperties(t.utils,{getSvgSize:{get:function(){return Object(o.deprecation)(Ne,"PIXI.utils.getSvgSize function has moved to PIXI.resources.SVGResource.getSize"),t.SVGResource.getSize}}}),t.mesh={},Object.defineProperties(t.mesh,{Mesh:{get:function(){return Object(o.deprecation)(Ne,"PIXI.mesh.Mesh class has moved to PIXI.SimpleMesh"),t.SimpleMesh}},NineSlicePlane:{get:function(){return Object(o.deprecation)(Ne,"PIXI.mesh.NineSlicePlane class has moved to PIXI.NineSlicePlane"),t.NineSlicePlane}},Plane:{get:function(){return Object(o.deprecation)(Ne,"PIXI.mesh.Plane class has moved to PIXI.SimplePlane"),t.SimplePlane}},Rope:{get:function(){return Object(o.deprecation)(Ne,"PIXI.mesh.Rope class has moved to PIXI.SimpleRope"),t.SimpleRope}},RawMesh:{get:function(){return Object(o.deprecation)(Ne,"PIXI.mesh.RawMesh class has moved to PIXI.Mesh"),t.Mesh}},CanvasMeshRenderer:{get:function(){return Object(o.deprecation)(Ne,"PIXI.mesh.CanvasMeshRenderer class has moved to PIXI.CanvasMeshRenderer"),t.CanvasMeshRenderer}},MeshRenderer:{get:function(){return Object(o.deprecation)(Ne,"PIXI.mesh.MeshRenderer class has moved to PIXI.MeshRenderer"),t.MeshRenderer}}}),t.particles={},Object.defineProperties(t.particles,{ParticleContainer:{get:function(){return Object(o.deprecation)(Ne,"PIXI.particles.ParticleContainer class has moved to PIXI.ParticleContainer"),t.ParticleContainer}},ParticleRenderer:{get:function(){return Object(o.deprecation)(Ne,"PIXI.particles.ParticleRenderer class has moved to PIXI.ParticleRenderer"),t.ParticleRenderer}}}),t.ticker={},Object.defineProperties(t.ticker,{Ticker:{get:function(){return Object(o.deprecation)(Ne,"PIXI.ticker.Ticker class has moved to PIXI.Ticker"),t.Ticker}},shared:{get:function(){return Object(o.deprecation)(Ne,"PIXI.ticker.shared instance has moved to PIXI.Ticker.shared"),t.Ticker.shared}}}),t.loaders={},Object.defineProperties(t.loaders,{Loader:{get:function(){return Object(o.deprecation)(Ne,"PIXI.loaders.Loader class has moved to PIXI.Loader"),t.Loader}},Resource:{get:function(){return Object(o.deprecation)(Ne,"PIXI.loaders.Resource class has moved to PIXI.LoaderResource"),t.LoaderResource}},bitmapFontParser:{get:function(){return Object(o.deprecation)(Ne,"PIXI.loaders.bitmapFontParser function has moved to PIXI.BitmapFontLoader.use"),t.BitmapFontLoader.use}},parseBitmapFontData:{get:function(){return Object(o.deprecation)(Ne,"PIXI.loaders.parseBitmapFontData function has moved to PIXI.BitmapFontLoader.parse"),t.BitmapFontLoader.parse}},spritesheetParser:{get:function(){return Object(o.deprecation)(Ne,"PIXI.loaders.spritesheetParser function has moved to PIXI.SpritesheetLoader.use"),t.SpritesheetLoader.use}},getResourcePath:{get:function(){return Object(o.deprecation)(Ne,"PIXI.loaders.getResourcePath property has moved to PIXI.SpritesheetLoader.getResourcePath"),t.SpritesheetLoader.getResourcePath}}}),t.Loader.addPixiMiddleware=function(e){return Object(o.deprecation)(Ne,"PIXI.loaders.Loader.addPixiMiddleware function is deprecated, use PIXI.loaders.Loader.registerPlugin"),t.loaders.Loader.registerPlugin({use:e()})},Object.defineProperty(t.extract,"WebGLExtract",{get:function(){return Object(o.deprecation)(Ne,"PIXI.extract.WebGLExtract method has moved to PIXI.Extract"),t.Extract}}),Object.defineProperty(t.prepare,"WebGLPrepare",{get:function(){return Object(o.deprecation)(Ne,"PIXI.prepare.WebGLPrepare class has moved to PIXI.Prepare"),t.Prepare}}),t.Container.prototype._renderWebGL=function(t){Object(o.deprecation)(Ne,"PIXI.Container._renderWebGL method has moved to PIXI.Container._render"),this._render(t)},t.Container.prototype.renderWebGL=function(t){Object(o.deprecation)(Ne,"PIXI.Container.renderWebGL method has moved to PIXI.Container.render"),this.render(t)},t.DisplayObject.prototype.renderWebGL=function(t){Object(o.deprecation)(Ne,"PIXI.DisplayObject.renderWebGL method has moved to PIXI.DisplayObject.render"),this.render(t)},t.Container.prototype.renderAdvancedWebGL=function(t){Object(o.deprecation)(Ne,"PIXI.Container.renderAdvancedWebGL method has moved to PIXI.Container.renderAdvanced"),this.renderAdvanced(t)},Object.defineProperties(t.settings,{TRANSFORM_MODE:{get:function(){return Object(o.deprecation)(Ne,"PIXI.settings.TRANSFORM_MODE property has been removed"),0},set:function(){Object(o.deprecation)(Ne,"PIXI.settings.TRANSFORM_MODE property has been removed")}}});var e=t.BaseTexture;e.prototype.loadSource=function(e){Object(o.deprecation)(Ne,"PIXI.BaseTexture.loadSource method has been deprecated");var n=t.resources.autoDetectResource(e);n.internal=!0,this.setResource(n),this.update()};var n=!1;Object.defineProperties(e.prototype,{hasLoaded:{get:function(){return Object(o.deprecation)(Ne,"PIXI.BaseTexture.hasLoaded property has been removed, use PIXI.BaseTexture.valid"),this.valid}},imageUrl:{get:function(){return Object(o.deprecation)(Ne,"PIXI.BaseTexture.imageUrl property has been removed, use PIXI.BaseTexture.resource.url"),this.resource&&this.resource.url},set:function(t){Object(o.deprecation)(Ne,"PIXI.BaseTexture.imageUrl property has been removed, use PIXI.BaseTexture.resource.url"),this.resource&&(this.resource.url=t)}},source:{get:function(){return Object(o.deprecation)(Ne,"PIXI.BaseTexture.source property has been moved, use `PIXI.BaseTexture.resource.source`"),this.resource&&this.resource.source},set:function(t){Object(o.deprecation)(Ne,"PIXI.BaseTexture.source property has been moved, use `PIXI.BaseTexture.resource.source` if you want to set HTMLCanvasElement. Otherwise, create new BaseTexture."),this.resource&&(this.resource.source=t)}},premultiplyAlpha:{get:function(){return Object(o.deprecation)("5.2.0","PIXI.BaseTexture.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),0!==this.alphaMode},set:function(t){Object(o.deprecation)("5.2.0","PIXI.BaseTexture.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode=Number(t)}},_id:{get:function(){return n||(Object(o.deprecation)("5.2.0","PIXI.BaseTexture._id batch local field has been changed to `_batchLocation`"),n=!0),this._batchLocation},set:function(t){this._batchLocation=t}}}),e.fromImage=function(t,n,r,i){Object(o.deprecation)(Ne,"PIXI.BaseTexture.fromImage method has been replaced with PIXI.BaseTexture.from");var s={scale:i,crossorigin:n};return e.from(t,{scaleMode:r,resourceOptions:s})},e.fromCanvas=function(t,n){return Object(o.deprecation)(Ne,"PIXI.BaseTexture.fromCanvas method has been replaced with PIXI.BaseTexture.from"),e.from(t,{scaleMode:n})},e.fromSVG=function(t,n,r,i){Object(o.deprecation)(Ne,"PIXI.BaseTexture.fromSVG method has been replaced with PIXI.BaseTexture.from");var s={scale:i,crossorigin:n};return e.from(t,{scaleMode:r,resourceOptions:s})},Object.defineProperties(t.resources.ImageResource.prototype,{premultiplyAlpha:{get:function(){return Object(o.deprecation)("5.2.0","PIXI.resources.ImageResource.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),0!==this.alphaMode},set:function(t){Object(o.deprecation)("5.2.0","PIXI.resources.ImageResource.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode=Number(t)}}}),t.Point.prototype.copy=function(t){return Object(o.deprecation)(Ne,"PIXI.Point.copy method has been replaced with PIXI.Point.copyFrom"),this.copyFrom(t)},t.ObservablePoint.prototype.copy=function(t){return Object(o.deprecation)(Ne,"PIXI.ObservablePoint.copy method has been replaced with PIXI.ObservablePoint.copyFrom"),this.copyFrom(t)},t.Rectangle.prototype.copy=function(t){return Object(o.deprecation)(Ne,"PIXI.Rectangle.copy method has been replaced with PIXI.Rectangle.copyFrom"),this.copyFrom(t)},t.Matrix.prototype.copy=function(t){return Object(o.deprecation)(Ne,"PIXI.Matrix.copy method has been replaced with PIXI.Matrix.copyTo"),this.copyTo(t)},t.systems.StateSystem.prototype.setState=function(t){return Object(o.deprecation)("v5.1.0","StateSystem.setState has been renamed to StateSystem.set"),this.set(t)},Object.assign(t.systems.FilterSystem.prototype,{getRenderTarget:function(t,e){return Object(o.deprecation)(Ne,"PIXI.FilterManager.getRenderTarget method has been replaced with PIXI.systems.FilterSystem#getFilterTexture"),this.getFilterTexture(e)},returnRenderTarget:function(t){Object(o.deprecation)(Ne,"PIXI.FilterManager.returnRenderTarget method has been replaced with PIXI.systems.FilterSystem.returnFilterTexture"),this.returnFilterTexture(t)},calculateScreenSpaceMatrix:function(t){Object(o.deprecation)(Ne,"PIXI.systems.FilterSystem.calculateScreenSpaceMatrix method is removed, use `(vTextureCoord * inputSize.xy) + outputFrame.xy` instead");var e=t.identity(),n=this.activeState,r=n.sourceFrame,i=n.destinationFrame;return e.translate(r.x/i.width,r.y/i.height),e.scale(i.width,i.height),e},calculateNormalizedScreenSpaceMatrix:function(t){Object(o.deprecation)(Ne,"PIXI.systems.FilterManager.calculateNormalizedScreenSpaceMatrix method is removed, use `((vTextureCoord * inputSize.xy) + outputFrame.xy) / outputFrame.zw` instead.");var e=this.activeState,n=e.sourceFrame,r=e.destinationFrame,i=t.identity();i.translate(n.x/r.width,n.y/r.height);var s=r.width/n.width,a=r.height/n.height;return i.scale(s,a),i}}),Object.defineProperties(t.RenderTexture.prototype,{sourceFrame:{get:function(){return Object(o.deprecation)(Ne,"PIXI.RenderTexture.sourceFrame property has been removed"),this.filterFrame}},size:{get:function(){return Object(o.deprecation)(Ne,"PIXI.RenderTexture.size property has been removed"),this._frame}}});var r=function(t){function e(e,n,r,i){Object(o.deprecation)(Ne,"PIXI.filters.BlurXFilter class is deprecated, use PIXI.filters.BlurFilterPass"),t.call(this,!0,e,n,r,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(t.filters.BlurFilterPass),i=function(t){function e(e,n,r,i){Object(o.deprecation)(Ne,"PIXI.filters.BlurYFilter class is deprecated, use PIXI.filters.BlurFilterPass"),t.call(this,!1,e,n,r,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(t.filters.BlurFilterPass);Object.assign(t.filters,{BlurXFilter:r,BlurYFilter:i});var s=t.Sprite,a=t.Texture,u=t.Graphics;function h(t,e,n,r){return Object(o.deprecation)(Ne,"PIXI.Sprite."+t+" method is deprecated, use PIXI.Sprite.from"),s.from(e,{resourceOptions:{scale:r,crossorigin:n}})}function l(t,e,n,r){return Object(o.deprecation)(Ne,"PIXI.Texture."+t+" method is deprecated, use PIXI.Texture.from"),a.from(e,{resourceOptions:{scale:r,crossorigin:n}})}u.prototype.generateCanvasTexture||(u.prototype.generateCanvasTexture=function(){Object(o.deprecation)(Ne,'PIXI.Graphics.generateCanvasTexture method is only available in "pixi.js-legacy"')}),Object.defineProperty(t.Graphics.prototype,"graphicsData",{get:function(){return Object(o.deprecation)(Ne,"PIXI.Graphics.graphicsData property is deprecated, use PIXI.Graphics.geometry.graphicsData"),this.geometry.graphicsData}}),Object.defineProperty(t.SimpleRope.prototype,"points",{get:function(){return Object(o.deprecation)(Ne,"PIXI.SimpleRope.points property is deprecated, use PIXI.SimpleRope.geometry.points"),this.geometry.points},set:function(t){Object(o.deprecation)(Ne,"PIXI.SimpleRope.points property is deprecated, use PIXI.SimpleRope.geometry.points"),this.geometry.points=t}}),s.fromImage=h.bind(null,"fromImage"),s.fromSVG=h.bind(null,"fromSVG"),s.fromCanvas=h.bind(null,"fromCanvas"),s.fromVideo=h.bind(null,"fromVideo"),s.fromFrame=h.bind(null,"fromFrame"),a.fromImage=l.bind(null,"fromImage"),a.fromSVG=l.bind(null,"fromSVG"),a.fromCanvas=l.bind(null,"fromCanvas"),a.fromVideo=l.bind(null,"fromVideo"),a.fromFrame=l.bind(null,"fromFrame"),Object.defineProperty(t.AbstractRenderer.prototype,"autoResize",{get:function(){return Object(o.deprecation)(Ne,"PIXI.AbstractRenderer.autoResize property is deprecated, use PIXI.AbstractRenderer.autoDensity"),this.autoDensity},set:function(t){Object(o.deprecation)(Ne,"PIXI.AbstractRenderer.autoResize property is deprecated, use PIXI.AbstractRenderer.autoDensity"),this.autoDensity=t}}),Object.defineProperty(t.Renderer.prototype,"textureManager",{get:function(){return Object(o.deprecation)(Ne,"PIXI.Renderer.textureManager property is deprecated, use PIXI.Renderer.texture"),this.texture}}),t.utils.mixins={mixin:function(){Object(o.deprecation)(Ne,"PIXI.utils.mixins.mixin function is no longer available")},delayMixin:function(){Object(o.deprecation)(Ne,"PIXI.utils.mixins.delayMixin function is no longer available")},performMixins:function(){Object(o.deprecation)(Ne,"PIXI.utils.mixins.performMixins function is no longer available")}}}_.z.registerPlugin("accessibility",u),_.z.registerPlugin("extract",E),_.z.registerPlugin("interaction",b),_.z.registerPlugin("particle",tt),_.z.registerPlugin("prepare",Qt),_.z.registerPlugin("batch",_.i),_.z.registerPlugin("tilingSprite",le),q.registerPlugin(pe),q.registerPlugin(oe),x.registerPlugin(l.b),x.registerPlugin(K);var je="5.2.3",Ue={AlphaFilter:de,BlurFilter:me,BlurFilterPass:ye,ColorMatrixFilter:ve,DisplacementFilter:be,FXAAFilter:_e,NoiseFilter:xe}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(e,n,r){void 0===n&&(n=!1),i(this,t),this._fn=e,this._once=n,this._thisArg=r,this._next=this._prev=this._owner=null}return r(t,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),t}();function s(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var a=function(){function t(){i(this,t),this._head=this._tail=void 0}return r(t,[{key:"handlers",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var n=[];e;)n.push(e),e=e._next;return n}},{key:"has",value:function(t){if(!(t instanceof o))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=this._head;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return s(this,new o(t,!1,e))}},{key:"once",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return s(this,new o(t,!0,e))}},{key:"detach",value:function(t){if(!(t instanceof o))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),t}();a.MiniSignalBinding=o,e.default=a,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.level<=t.LEVEL_ERROR&&console.error.apply(console,e)},t.WARN=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.level<=t.LEVEL_WARN&&(window.console.warn?console.warn.apply(console,e):console.log.apply(console,e))},t.info=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.level<=t.LEVEL_INFO&&console.log.apply(console,e)},t.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.level<=t.LEVEL_DEBUG&&console.log.apply(console,e)},t.trace=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.level<=t.LEVEL_TRACE&&console.log.apply(console,e)},t.LEVEL_ERROR=4,t.LEVEL_WARN=3,t.LEVEL_INFO=2,t.LEVEL_DEBUG=1,t.LEVEL_TRACE=0,t.level=t.LEVEL_INFO,t}();e.Logger=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n){this.eventName=t,this.callback=e,this.info=n}return t.prototype.fire=function(){this.callback()},t}();e.PonEventHandler=r},function(t,e,n){"use strict";function r(t,e){return Object.keys(e).forEach((function(n){Array.isArray(e[n])?t[n]=e[n].slice():"object"==typeof e[n]?t[n]=Object.assign({},e[n]):t[n]=e[n]})),t}function i(t){if(null==t||"object"!=typeof t)return t;var e={};return Object.keys(t).sort().forEach((function(n){e[n]=t[n]})),t}Object.defineProperty(e,"__esModule",{value:!0}),e.objExtend=r,e.objClone=function(t){return r({},t)},e.objSort=i,e.objEquals=function(t,e){return t===e||JSON.stringify(i(t))===JSON.stringify(i(e))},e.Ease={in:function(t){return t*t},out:function(t){return t*(2-t)},inOut:function(t){return t*t*(3-2*t)}}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(9)),a=n(19),u=n(66),h=n(67),l=n(11),c=n(68),p=function(){function t(t,e,n){var r=this;this.parent=null,this.maskSibling=null,this.childrenMaskUpdated=!1,this.debugTextStyle=new s.TextStyle({fontFamily:["GenShinGothic","monospace"],fontSize:12,fontWeight:"normal",fontStyle:"normal",fill:16777215,stroke:0,strokeThickness:3,trim:!0}),this.hasBackgroundColor=!1,this._backgroundColor=0,this._backgroundAlpha=1,this._x=0,this._y=0,this._quakeOffsetX=0,this._quakeOffsetY=0,this.ignoreQuake=!1,this.image=null,this.imageFilePath=null,this.imageSprite=null,this.canvas=null,this.canvasSprite=null,this.videoFilePath=null,this.video=null,this._children=[],this.blockLeftClickFlag=!1,this.blockRightClickFlag=!1,this.blockCenterClickFlag=!1,this.blockMouseMove=!1,this.blockWheelFlag=!1,this.textCanvas=new c.LayerTextCanvas,this.isInsideBuffer=!1,this.callMouseEnterTargetChild=[],this.callMouseLeaveTargetChild=[],this.name=t,this.resource=e,this.owner=n,this._container=new s.Container,this.defaultMaskSprite=new s.Sprite(s.Texture.WHITE),this.defaultMaskSprite.width=32,this.defaultMaskSprite.height=32,this.container.addChild(this.defaultMaskSprite),this.container.mask=this.defaultMaskSprite,this.imageContainer=new s.Container,this.container.addChild(this.imageContainer),this.imageSpriteCallbacks={pixiContainerAddChild:function(t){r.imageContainer.addChild(t)},pixiContainerRemoveChild:function(t){r.imageContainer.removeChild(t)}},this.textSpriteCallbacks={pixiContainerAddChild:function(t){r.textContainer.addChild(t)},pixiContainerRemoveChild:function(t){r.textContainer.removeChild(t)}},this.canvasSpriteCallbacks={pixiContainerAddChild:function(t){r.imageContainer.addChild(t)},pixiContainerRemoveChild:function(t){r.imageContainer.removeChild(t)}},this.videoCallbacks={pixiContainerAddChild:function(t){r.imageContainer.addChild(t)},pixiContainerRemoveChild:function(t){r.imageContainer.removeChild(t)}},this.backgroundSprite=new u.PonSprite(this.imageSpriteCallbacks),this.textContainer=new s.Container,this.container.addChild(this.textContainer),this.textCanvas.width=this.width,this.textCanvas.height=this.height,this.textCanvas.addTo(this.textContainer),this.clearText(),this.childContainer=new s.Container,this.container.addChild(this.childContainer),this.childSpriteCallbacks={pixiContainerAddChild:function(t){r.childContainer.addChild(t)},pixiContainerRemoveChild:function(t){r.childContainer.removeChild(t)}},this.debugContainer=new s.Container,this.debugContainer.visible=!1,this.container.addChild(this.debugContainer),this.debugBorder=new s.Graphics,this.debugContainer.addChild(this.debugBorder),this.debugText=new s.Text(this.name,this.debugTextStyle),this.debugContainer.addChild(this.debugText),this.visible=!1}return Object.defineProperty(t.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"debugInfoVisible",{get:function(){return this.debugContainer.visible},set:function(t){this.debugContainer.visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return null!==this.image?this.image.width:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return null!==this.image?this.image.height:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvasWidth",{get:function(){return null!==this.canvas?this.canvas.width:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvasHeight",{get:function(){return null!==this.canvas?this.canvas.height:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"videoWidth",{get:function(){return null!=this.video?this.video.width:0},set:function(t){null!=this.video&&(this.video.width=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"videoHeight",{get:function(){return null!=this.video?this.video.height:0},set:function(t){null!=this.video&&(this.video.height=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"videoLoop",{get:function(){return null!=this.video&&this.video.loop},set:function(t){null!=this.video&&(this.video.loop=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"videoVolume",{get:function(){return null!=this.video?this.video.volume:0},set:function(t){null!=this.video&&(this.video.volume=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this.container.x=this._x+this._quakeOffsetX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this.container.y=this._y+this._quakeOffsetY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"quakeOffsetX",{get:function(){return this._quakeOffsetX},set:function(t){this._quakeOffsetX=t,this.container.x=this._x+this._quakeOffsetX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"quakeOffsetY",{get:function(){return this._quakeOffsetY},set:function(t){this._quakeOffsetY=t,this.container.y=this._y+this._quakeOffsetY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.defaultMaskSprite.width},set:function(t){this.defaultMaskSprite.width=t,this.backgroundSprite.width=t,this.textCanvas.width!=t&&(this.clearText(),this.textCanvas.width=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.defaultMaskSprite.height},set:function(t){this.defaultMaskSprite.height=t,this.backgroundSprite.height=t,this.textCanvas.height!=t&&(this.clearText(),this.textCanvas.height=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this.container.visible},set:function(t){this.container.visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.container.alpha},set:function(t){this.container.alpha=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this.setBackgroundColor(t,this._backgroundAlpha)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"backgroundAlpha",{get:function(){return this._backgroundAlpha},set:function(t){this.setBackgroundColor(this._backgroundColor,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageX",{get:function(){return null===this.imageSprite?0:this.imageSprite.x},set:function(t){null!=this.imageSprite&&(this.imageSprite.x=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageY",{get:function(){return null===this.imageSprite?0:this.imageSprite.y},set:function(t){null!=this.imageSprite&&(this.imageSprite.y=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvasX",{get:function(){return null===this.canvasSprite?0:this.canvasSprite.x},set:function(t){null!=this.canvasSprite&&(this.canvasSprite.x=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvasY",{get:function(){return null===this.canvasSprite?0:this.canvasSprite.y},set:function(t){null!=this.canvasSprite&&(this.canvasSprite.y=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleX",{get:function(){return this.container.scale.x},set:function(t){this.container.scale.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleY",{get:function(){return this.container.scale.y},set:function(t){this.container.scale.y=t},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.clearText(),this.freeImage(),this.freeCanvas(),this.freeVideo(),this.defaultMaskSprite.destroy(),this.backgroundSprite.destroy(),null!=this.imageSprite&&this.imageSprite.destroy(),null!=this.canvasSprite&&this.canvasSprite.destroy(),null!=this.video&&this.video.destroy(),this.textContainer.destroy(),this.imageContainer.destroy(),this.childContainer.destroy(),this.debugContainer.destroy(),this.container.destroy(),this.children.forEach((function(t){t.destroy()})),this._children=[]},t.prototype.addChild=function(t){return this.children.push(t),this.container.addChild(t.container),t.parent=this,t},t.prototype.deleteChildLayer=function(t){var e=this._children.indexOf(t);e>=0&&(this._children.splice(e,1),t.parent=null)},t.prototype.deleteAllChildren=function(){for(var t=0,e=this._children;t<e.length;t++){e[t].parent=null}this._children=[]},t.prototype.child=function(t){return this.children[t]},t.prototype.setMaskSibling=function(t){this.maskSibling=t,null!=this.parent&&(this.parent.childrenMaskUpdated=!0)},t.prototype.clearMaskSibling=function(){this.maskSibling=null,null!=this.parent&&(this.parent.childrenMaskUpdated=!0)},t.prototype.applyChildrenMask=function(){for(var t,e=0,n=this.children;e<n.length;e++){var r=n[e];if(null==r.maskSibling)r.container.mask=r.defaultMaskSprite;else{var i=this.children[r.maskSibling];null==i||null==i.imageSprite?r.container.mask=r.defaultMaskSprite:r.container.mask=null===(t=i.imageSprite)||void 0===t?void 0:t.pixiDisplayObject}}},t.prototype.update=function(t){for(var e=0,n=this.children;e<n.length;e++){n[e].update(t)}},t.prototype.beforeDraw=function(t){this.visible&&this.debugContainer.visible&&(this.debugBorder.width=this.width,this.debugBorder.height=this.height,this.debugBorder.x=0,this.debugBorder.y=0,this.debugBorder.lineStyle(2,16711680),this.debugBorder.drawRect(0,0,this.debugBorder.width,this.debugBorder.height),this.debugText.text=this.name+": x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height),this.textCanvas.beforeDraw(t),this.visible&&null!==this.canvas&&null!==this.canvasSprite&&this.canvasSprite.beforeDraw(t),this.childrenMaskUpdated&&(this.applyChildrenMask(),this.childrenMaskUpdated=!1);for(var e=0,n=this.children;e<n.length;e++){n[e].beforeDraw(t)}},t.prototype.applyQuake=function(t,e){this.ignoreQuake?(this.quakeOffsetX=0,this.quakeOffsetY=0):(this.quakeOffsetX=t,this.quakeOffsetY=e)},t.prototype.clearQuake=function(){this.quakeOffsetX=0,this.quakeOffsetY=0},t.isInsideOfLayer=function(t,e,n){var r=t.y,i=t.x+t.width,o=t.y+t.height;return t.x<=e&&e<=i&&r<=n&&n<=o},t.prototype.isInsideEvent=function(t){var e=t.x,n=t.y;return 0<=e&&e<=this.width&&0<=n&&n<=this.height},t.prototype.isBlockedEvent=function(t,e){if(t instanceof a.PonMouseEvent){if("down"===e||"up"===e){if(this.blockLeftClickFlag&&t.isLeft)return!0;if(this.blockRightClickFlag&&t.isRight)return!0;if(this.blockCenterClickFlag&&t.isCenter)return!0}if("move"===e&&this.blockMouseMove)return!0}else if(this.blockWheelFlag)return!0;return!1},t.prototype.onMouseEnter=function(t){},t.prototype._onMouseEnter=function(t){this.onMouseEnter(t)},t.prototype.onMouseLeave=function(t){},t.prototype._onMouseLeave=function(t){this.onMouseLeave(t)},t.prototype.onMouseMove=function(t){},t.prototype._onMouseMove=function(e){for(var n=this.children.length-1;n>=0;n--){var r=this.children[n];if(r.visible){r.isInsideBuffer=t.isInsideOfLayer(r,e.x,e.y);var i=new a.PonMouseEvent(e.x-r.x,e.y-r.y,e.button);if(r._onMouseMove(i),i.stopPropagationFlag&&e.stopPropagation(),i.forceStopFlag)return void e.forceStop()}}e.stopPropagationFlag||e.forceStopFlag||this.onMouseMove(e)},t.prototype._preCallMouseEnterLeave=function(e){for(var n=this.children.length-1;n>=0;n--){var r=this.children[n],i=new a.PonMouseEvent(e.x-r.x,e.y-r.y,e.button);r._preCallMouseEnterLeave(i)}this.callMouseEnterTargetChild=[],this.callMouseLeaveTargetChild=[];for(n=this.children.length-1;n>=0;n--){if((r=this.children[n]).visible){var o=t.isInsideOfLayer(r,e.x,e.y);o!==r.isInsideBuffer&&(o?this.callMouseEnterTargetChild.push(r):this.callMouseLeaveTargetChild.push(r)),r.isInsideBuffer=o}}},t.prototype._callOnMouseEnter=function(t){for(var e=this.children.length-1;e>=0;e--){if((r=this.children[e]).visible){var n=new a.PonMouseEvent(t.x-r.x,t.y-r.y,t.button);if(r._callOnMouseEnter(n),n.stopPropagationFlag&&t.stopPropagation(),n.forceStopFlag)return void t.forceStop()}}if(!t.stopPropagationFlag&&!t.forceStopFlag)for(e=this.callMouseEnterTargetChild.length-1;e>=0;e--){var r;if((r=this.callMouseEnterTargetChild[e]).visible){n=new a.PonMouseEvent(t.x-r.x,t.y-r.y,t.button);if(r._onMouseEnter(n),n.stopPropagationFlag&&t.stopPropagation(),n.forceStopFlag)return void t.forceStop()}}},t.prototype._callOnMouseLeave=function(t){for(var e=this.children.length-1;e>=0;e--){if((r=this.children[e]).visible){var n=new a.PonMouseEvent(t.x-r.x,t.y-r.y,t.button);if(r._callOnMouseLeave(n),n.stopPropagationFlag&&t.stopPropagation(),n.forceStopFlag)return void t.forceStop()}}if(!t.stopPropagationFlag&&!t.forceStopFlag)for(e=this.callMouseLeaveTargetChild.length-1;e>=0;e--){var r=this.callMouseLeaveTargetChild[e];n=new a.PonMouseEvent(t.x-r.x,t.y-r.y,t.button);if(r._onMouseLeave(n),n.stopPropagationFlag&&t.stopPropagation(),n.forceStopFlag)return void t.forceStop()}},t.prototype.onMouseDown=function(t){},t.prototype._onMouseDown=function(t){for(var e=this.children.length-1;e>=0;e--){var n=this.children[e];if(n.visible){var r=new a.PonMouseEvent(t.x-n.x,t.y-n.y,t.button);if(n._onMouseDown(r),r.stopPropagationFlag&&t.stopPropagation(),r.forceStopFlag)return void t.forceStop()}}t.stopPropagationFlag||t.forceStopFlag||this.onMouseDown(t)},t.prototype.onMouseUp=function(t){},t.prototype._onMouseUp=function(t){for(var e=this.children.length-1;e>=0;e--){var n=this.children[e];if(n.visible){var r=new a.PonMouseEvent(t.x-n.x,t.y-n.y,t.button);if(n._onMouseUp(r),r.stopPropagationFlag&&t.stopPropagation(),r.forceStopFlag)return void t.forceStop()}}t.stopPropagationFlag||t.forceStopFlag||this.onMouseUp(t)},t.prototype.onMouseWheel=function(t){for(var e=this.children.length-1;e>=0;e--){var n=this.children[e];n.visible&&n.onMouseWheel(t)}return!this.isBlockedEvent(t,"wheel")},t.prototype.onChangeStable=function(t){for(var e=this.children.length-1;e>=0;e--)this.children[e].onChangeStable(t)},t.prototype.setBackgroundColor=function(t,e){void 0===e&&(e=1),this.freeImage(),this.freeCanvas(),this.freeVideo(),this.backgroundSprite.fillColor(t,e),this._backgroundColor=t,this._backgroundAlpha=e,this.hasBackgroundColor=!0},t.prototype.clearBackgroundColor=function(){this.backgroundSprite.clearColor(),this.hasBackgroundColor=!1},Object.defineProperty(t.prototype,"text",{get:function(){return this.textCanvas.text},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"messageText",{get:function(){return this.text},enumerable:!0,configurable:!0}),t.prototype.addText=function(t){this.textCanvas.addText(t)},t.prototype.addChar=function(t){this.textCanvas.addChar(t)},t.prototype.getNextTextPos=function(t){return this.textCanvas.getNextTextPos(t)},t.prototype.addTextReturn=function(){this.textCanvas.addTextReturn()},t.prototype.setCharLocate=function(t,e){this.textCanvas.setCharLocate(t,e)},t.prototype.setIndentPoint=function(){this.textCanvas.setIndentPoint()},t.prototype.clearIndentPoint=function(){this.textCanvas.clearIndentPoint()},t.prototype.reserveRubyText=function(t){this.textCanvas.reserveRubyText(t)},t.prototype.clearText=function(){this.textCanvas.clear()},t.prototype.loadImage=function(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:this.clearBackgroundColor(),this.freeImage(),this.freeCanvas(),this.freeVideo(),r.label=1;case 1:return r.trys.push([1,3,,4]),e=this,[4,this.resource.loadImage(t)];case 2:return e.image=r.sent(),this.imageFilePath=t,this.imageSprite=new u.PonSprite(this.imageSpriteCallbacks),this.imageSprite.setImage(this.image),this.width=this.imageSprite.width,this.height=this.imageSprite.height,this.imageX=0,this.imageY=0,null!=this.parent&&(this.parent.childrenMaskUpdated=!0),[3,4];case 3:throw n=r.sent(),l.Logger.error(n),n;case 4:return[2]}}))}))},t.prototype.freeImage=function(){null!=this.imageSprite&&this.imageSprite.destroy(),this.imageSprite=null,this.image=null,this.imageFilePath=null,null!=this.parent&&(this.parent.childrenMaskUpdated=!0)},t.prototype.loadCanvas=function(t){this.clearBackgroundColor(),this.freeImage(),this.freeCanvas(),this.freeVideo();try{this.canvas=t,this.canvasSprite=new u.PonSprite(this.canvasSpriteCallbacks),this.canvasSprite.setCanvas(t),this.width=this.canvasSprite.width,this.height=this.canvasSprite.height,this.canvasX=0,this.canvasY=0}catch(t){throw l.Logger.error(t),t}},t.prototype.freeCanvas=function(){null!=this.canvasSprite&&this.canvasSprite.destroy(),this.canvasSprite=null,this.canvas=null},t.prototype.loadVideo=function(t,e,n,r,i,o){var s=this;this.clearBackgroundColor(),this.freeImage(),this.freeCanvas(),this.freeVideo();var a=this.resource.loadVideoTexture(t,r),u=new h.PonVideo(a,this.videoCallbacks);return u.width=e,u.height=n,u.loop=i,u.volume=o,u.source.autoplay=r,new Promise((function(e,n){var r=-1,i=function(){-1!=r&&window.clearTimeout(r),u.source.removeEventListener("canplaythrough",i),s.video=u,s.videoFilePath=t,s.width=s.video.width,s.height=s.video.height,e(s)};u.source.addEventListener("canplaythrough",i),r=window.setTimeout((function(){u.source.removeEventListener("canplaythrough",i),n(s)}),3e4),u.source.addEventListener("ended",(function(){s.owner.conductor.trigger("video")}))}))},t.prototype.playVideo=function(){null!=this.video&&this.video.play()},t.prototype.pauseVideo=function(){null!=this.video&&this.video.pause()},t.prototype.stopVideo=function(){null!=this.video&&this.video.stop()},t.prototype.freeVideo=function(){null!=this.video&&(this.video.stop(),this.video.destroy()),this.video=null,this.videoFilePath=null},Object.defineProperty(t.prototype,"isPlayingVideo",{get:function(){return null!=this.video&&this.video.playing},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoopPlayingVideo",{get:function(){return null!=this.video&&this.video.loop},enumerable:!0,configurable:!0}),t.prototype.store=function(e){var n={},r=this;return t.baseLayerStoreParams.forEach((function(t){return n[t]=r[t]})),n.textCanvas=this.textCanvas.store(e),n},t.prototype.restore=function(e,n,o){return r(this,void 0,void 0,(function(){var r,s=this;return i(this,(function(i){switch(i.label){case 0:return r=function(){var n=s;t.baseLayerStoreParams.filter((function(e){return-1===t.baseLayerIgnoreParams.indexOf(e)})).forEach((function(t){return n[t]=e[t]}))},this.textCanvas.restore(e.textCanvas,n,o),this.clearBackgroundColor(),e.hasBackgroundColor&&this.setBackgroundColor(e.backgroundColor,e.backgroundAlpha),this.freeImage(),this.freeCanvas(),this.freeVideo(),null==e.imageFilePath||""===e.imageFilePath||e.imageFilePath===this.imageFilePath?[3,2]:[4,this.loadImage(e.imageFilePath)];case 1:return i.sent(),r(),this.restoreAfterLoadImage(e,n),[3,5];case 2:return null!=e.videoFilePath&&""!=e.videoFilePath&&e.videoFilePath!=this.videoFilePath&&e.videoLoop?(this.freeVideo(),[4,this.loadVideo(e.videoFilePath,e.videoWidth,e.videoHeight,e.isPlayingVideo,e.videoLoop,e.videoVolume)]):[3,4];case 3:return i.sent(),r(),this.restoreAfterLoadImage(e,n),[3,5];case 4:r(),this.restoreAfterLoadImage(e,n),i.label=5;case 5:return[2]}}))}))},t.prototype.restoreAfterLoadImage=function(t,e){},t.prototype.copyTo=function(e){if(e.clearBackgroundColor(),this.hasBackgroundColor&&e.setBackgroundColor(this.backgroundColor,this.backgroundAlpha),e.freeImage(),null!==this.image&&(e.imageSprite=new u.PonSprite(e.imageSpriteCallbacks),e.imageSprite.setImage(this.image),e.image=this.image),e.freeCanvas(),null!==this.canvas&&(e.canvasSprite=new u.PonSprite(e.canvasSpriteCallbacks),e.canvasSprite.setCanvas(this.canvas),e.canvas=this.canvas),e.freeVideo(),null!==this.video&&null!=this.videoFilePath&&this.videoFilePath!==e.videoFilePath){var n=this.resource.cloneVideoTexture(this.video.texture);e.video=new h.PonVideo(n,e.videoCallbacks)}var r=this,i=e;t.baseLayerStoreParams.filter((function(e){return-1===t.baseLayerIgnoreParams.indexOf(e)})).forEach((function(t){return i[t]=r[t]})),e.clearText(),this.textCanvas.copyTo(e.textCanvas)},t.prototype.applyConfig=function(t){if(null!=t){var e=this;Object.keys(t).forEach((function(n){n in e&&(e[n]=t[n])})),null!=t.textCanvasConfig&&this.textCanvas.applyConfig(t.textCanvasConfig)}},t.baseLayerStoreParams=["name","maskSibling","x","y","quakeOffsetX","quakeOffsetY","scaleX","scaleY","width","height","visible","alpha","backgroundColor","backgroundAlpha","hasBackgroundColor","ignoreQuake","imageFilePath","imageX","imageY","canvasX","canvasY","videoFilePath","videoWidth","videoHeight","videoLoop","videoVolume","isPlayingVideo"],t.baseLayerIgnoreParams=["backgroundColor","backgroundAlpha","hasBackgroundColor","isPlayingVideo"],t}();e.BaseLayer=p},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isButton=!1,e.insideFlag=!1,e.buttonStatus="disabled",e.down=!1,e.keyIndex=0,e}return i(e,t),Object.defineProperty(e.prototype,"isButton",{get:function(){return this._isButton},enumerable:!0,configurable:!0}),e.prototype.initButton=function(t){this.clearButton(),this._isButton=!0,this.keyIndex=t},e.prototype.clearButton=function(){this.setButtonStatus("disabled"),this._isButton=!1,this.insideFlag=!1,this.down=!1,this.keyIndex=0},e.prototype.setButtonStatus=function(t){this.buttonStatus=t,"disabled"===this.buttonStatus&&(this.down=!1),this.resource.getCanvasElm().style.cursor=this.resource.cursor[t]},e.prototype.getButtonStatus=function(){return this.isButton?this.buttonStatus:"disabled"},Object.defineProperty(e.prototype,"isFocused",{get:function(){return"over"===this.getButtonStatus()},enumerable:!0,configurable:!0}),e.prototype.focus=function(){"disabled"!==this.buttonStatus&&this.setButtonStatus("over"),this.insideFlag=!0},e.prototype.blur=function(){"disabled"!==this.buttonStatus&&this.setButtonStatus("normal"),this.insideFlag=!1},e.prototype.onMouseEnter=function(e){t.prototype.onMouseEnter.call(this,e),this.focus()},e.prototype.onMouseLeave=function(e){t.prototype.onMouseLeave.call(this,e),this.blur()},e.prototype.onMouseMove=function(e){t.prototype.onMouseMove.call(this,e),"disabled"!==this.buttonStatus&&this.isInsideEvent(e)&&(this.resource.getCanvasElm().style.cursor=this.resource.cursor[this.buttonStatus])},e.prototype.onMouseDown=function(e){t.prototype.onMouseDown.call(this,e),this.isInsideEvent(e)&&"disabled"!==this.buttonStatus&&(this.setButtonStatus("on"),this.down=!0)},e.prototype.onMouseUp=function(e){t.prototype.onMouseUp.call(this,e),this.down=!1},e.prototype.submit=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2]}))}))},e.prototype.store=function(n){var r=t.prototype.store.call(this,n),i=this;return e.buttonStoreParams.forEach((function(t){r[t]=i[t]})),r},e.prototype.restore=function(n,r,i){return o(this,void 0,void 0,(function(){var o;return s(this,(function(s){switch(s.label){case 0:return this.clearButton(),[4,t.prototype.restore.call(this,n,r,i)];case 1:return s.sent(),o=this,e.buttonStoreParams.forEach((function(t){o[t]=n[t]})),this.insideFlag=!1,this.setButtonStatus(n.buttonStatus),[2]}}))}))},e.prototype.copyTo=function(n){t.prototype.copyTo.call(this,n);var r=this,i=n;e.buttonStoreParams.forEach((function(t){i[t]=r[t]}))},e.buttonStoreParams=["insideFlag","buttonStatus","keyIndex"],e}(n(15).BaseLayer);e.Button=a;var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.jump=!0,e.call=!1,e.filePath=null,e.label=null,e.countPage=!0,e.isSystemButton=!1,e.onEnterExp=null,e.onLeaveExp=null,e.onClickExp=null,e.onEnterSoundBuf=null,e.onLeaveSoundBuf=null,e.onClickSoundBuf=null,e.systemButtonLocked=!1,e}return i(e,t),e.prototype.initCommandButton=function(t,e,n,r,i,o,s,a,u,h,l,c,p){void 0===t&&(t=!0),void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=!0),void 0===o&&(o=!1),void 0===s&&(s=null),void 0===a&&(a=null),void 0===u&&(u=null),void 0===h&&(h=null),void 0===l&&(l=null),void 0===c&&(c=null),void 0===p&&(p=null),this.initButton(null!=p?p:0),this.jump=t,this.call=e,this.filePath=n,this.label=r,this.countPage=i,this.isSystemButton=o,this.onEnterExp=s,this.onLeaveExp=a,this.onClickExp=u,this.visible=!0,this.onEnterSoundBuf=h,this.onLeaveSoundBuf=l,this.onClickSoundBuf=c},e.prototype.clearCommandButton=function(){this.clearButton(),this.jump=!0,this.call=!1,this.filePath=null,this.label=null,this.onClickExp=null,this.onEnterSoundBuf="",this.onLeaveSoundBuf="",this.onClickSoundBuf=""},e.prototype.lockSystemButton=function(){this.isSystemButton&&(this.systemButtonLocked=!0,this.setButtonStatus("disabled"))},e.prototype.unlockSystemButton=function(){this.isSystemButton&&(this.systemButtonLocked=!1,this.setButtonStatus("normal"))},e.prototype.onChangeStable=function(e){t.prototype.onChangeStable.call(this,e),this.isSystemButton&&(this.systemButtonLocked||(e?this.insideFlag?this.setButtonStatus("over"):this.setButtonStatus("normal"):this.setButtonStatus("disabled")))},e.prototype.onMouseEnter=function(e){(t.prototype.onMouseEnter.call(this,e),"disabled"!==this.buttonStatus)&&(null!=this.onEnterExp&&""!==this.onEnterExp&&this.resource.evalJs(this.onEnterExp),null!=this.onEnterSoundBuf&&""!==this.onEnterSoundBuf&&this.owner.getSoundBuffer(this.onEnterSoundBuf).play())},e.prototype.onMouseLeave=function(e){(t.prototype.onMouseLeave.call(this,e),"disabled"!==this.buttonStatus)&&(null!=this.onLeaveExp&&""!==this.onLeaveExp&&this.resource.evalJs(this.onLeaveExp),null!=this.onLeaveSoundBuf&&""!==this.onLeaveSoundBuf&&this.owner.getSoundBuffer(this.onLeaveSoundBuf).play())},e.prototype.onMouseUp=function(e){return o(this,void 0,void 0,(function(){var n;return s(this,(function(r){return n=this.down,t.prototype.onMouseUp.call(this,e),e.isLeft&&n&&this.isInsideEvent(e)&&"disabled"!==this.buttonStatus?(e.stopPropagation(),e.forceStop(),[2,this.submit()]):[2]}))}))},e.prototype.submit=function(){return o(this,void 0,void 0,(function(){var t,e,n;return s(this,(function(r){switch(r.label){case 0:if(t=this.owner,null!==this.onClickExp&&""!==this.onClickExp&&this.resource.evalJs(this.onClickExp),null!=this.onClickSoundBuf&&""!==this.onClickSoundBuf&&t.getSoundBuffer(this.onClickSoundBuf).play(),null==this.filePath&&null==this.label)return[3,10];if(!this.call)return[3,5];t.conductor.stop(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.callSubroutine(this.filePath,this.label,this.countPage)];case 2:return r.sent(),[3,4];case 3:return e=r.sent(),t.error(e),[3,4];case 4:return t.conductor.start(),[3,10];case 5:if(!this.jump)return[3,10];t.conductor.stop(),r.label=6;case 6:return r.trys.push([6,8,,9]),[4,t.conductor.jump(this.filePath,this.label,this.countPage)];case 7:return r.sent(),[3,9];case 8:return n=r.sent(),t.error(n),[3,9];case 9:t.conductor.start(),r.label=10;case 10:return this.isSystemButton?this.setButtonStatus("normal"):this.setButtonStatus("disabled"),[2]}}))}))},e.prototype.store=function(n){var r=t.prototype.store.call(this,n),i=this;return e.commandButtonStoreParams.forEach((function(t){r[t]=i[t]})),r},e.prototype.restore=function(e,n,r){return o(this,void 0,void 0,(function(){return s(this,(function(i){switch(i.label){case 0:return this.clearCommandButton(),[4,t.prototype.restore.call(this,e,n,r)];case 1:return i.sent(),[2]}}))}))},e.prototype.restoreAfterLoadImage=function(n,r){t.prototype.restoreAfterLoadImage.call(this,n,r);var i=this;e.commandButtonStoreParams.forEach((function(t){i[t]=n[t]})),this.insideFlag=!1,this.setButtonStatus(n.buttonStatus)},e.prototype.copyTo=function(n){t.prototype.copyTo.call(this,n);var r=this,i=n;e.commandButtonStoreParams.forEach((function(t){i[t]=r[t]}))},e.commandButtonStoreParams=["jump","call","filePath","label","countPage","isSystemButton","onC","onEnterExp","onLeaveExp","onClickExp","onEnterSoundBuf","onLeaveSoundBuf","onClickSoundBuf","systemButtonLocked"],e}(a);e.CommandButton=u},function(t,e,n){"use strict";var r=n(34),i=n(36);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=b,e.resolve=function(t,e){return b(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?b(t,!1,!0).resolveObject(e):e},e.format=function(t){i.isString(t)&&(t=b(t));return t instanceof o?t.format():o.prototype.format.call(t)},e.Url=o;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,h=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(h),c=["%","/","?",";","#"].concat(l),p=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=n(37);function b(t,e,n){if(t&&i.isObject(t)&&t instanceof o)return t;var r=new o;return r.parse(t,e,n),r}o.prototype.parse=function(t,e,n){if(!i.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var o=t.indexOf("?"),a=-1!==o&&o<t.indexOf("#")?"?":"#",h=t.split(a);h[0]=h[0].replace(/\\/g,"/");var b=t=h.join(a);if(b=b.trim(),!n&&1===t.split("#").length){var _=u.exec(b);if(_)return this.path=b,this.href=b,this.pathname=_[1],_[2]?(this.search=_[2],this.query=e?v.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var x=s.exec(b);if(x){var w=(x=x[0]).toLowerCase();this.protocol=w,b=b.substr(x.length)}if(n||x||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var T="//"===b.substr(0,2);!T||x&&y[x]||(b=b.substr(2),this.slashes=!0)}if(!y[x]&&(T||x&&!m[x])){for(var S,E,P=-1,C=0;C<p.length;C++){-1!==(k=b.indexOf(p[C]))&&(-1===P||k<P)&&(P=k)}-1!==(E=-1===P?b.lastIndexOf("@"):b.lastIndexOf("@",P))&&(S=b.slice(0,E),b=b.slice(E+1),this.auth=decodeURIComponent(S)),P=-1;for(C=0;C<c.length;C++){var k;-1!==(k=b.indexOf(c[C]))&&(-1===P||k<P)&&(P=k)}-1===P&&(P=b.length),this.host=b.slice(0,P),b=b.slice(P),this.parseHost(),this.hostname=this.hostname||"";var A="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!A)for(var I=this.hostname.split(/\./),O=(C=0,I.length);C<O;C++){var L=I[C];if(L&&!L.match(d)){for(var M="",B=0,D=L.length;B<D;B++)L.charCodeAt(B)>127?M+="x":M+=L[B];if(!M.match(d)){var F=I.slice(0,C),R=I.slice(C+1),N=L.match(f);N&&(F.push(N[1]),R.unshift(N[2])),R.length&&(b="/"+R.join(".")+b),this.hostname=F.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),A||(this.hostname=r.toASCII(this.hostname));var V=this.port?":"+this.port:"",j=this.hostname||"";this.host=j+V,this.href+=this.host,A&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!g[w])for(C=0,O=l.length;C<O;C++){var U=l[C];if(-1!==b.indexOf(U)){var X=encodeURIComponent(U);X===U&&(X=escape(U)),b=b.split(U).join(X)}}var H=b.indexOf("#");-1!==H&&(this.hash=b.substr(H),b=b.slice(0,H));var G=b.indexOf("?");if(-1!==G?(this.search=b.substr(G),this.query=b.substr(G+1),e&&(this.query=v.parse(this.query)),b=b.slice(0,G)):e&&(this.search="",this.query={}),b&&(this.pathname=b),m[w]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){V=this.pathname||"";var Y=this.search||"";this.path=V+Y}return this.href=this.format(),this},o.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,s="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(s=v.stringify(this.query));var a=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||m[e])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),e+o+(n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+r},o.prototype.resolve=function(t){return this.resolveObject(b(t,!1,!0)).format()},o.prototype.resolveObject=function(t){if(i.isString(t)){var e=new o;e.parse(t,!1,!0),t=e}for(var n=new o,r=Object.keys(this),s=0;s<r.length;s++){var a=r[s];n[a]=this[a]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var u=Object.keys(t),h=0;h<u.length;h++){var l=u[h];"protocol"!==l&&(n[l]=t[l])}return m[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!m[t.protocol]){for(var c=Object.keys(t),p=0;p<c.length;p++){var d=c[p];n[d]=t[d]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||y[t.protocol])n.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),n.pathname=f.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var g=n.pathname||"",v=n.search||"";n.path=g+v}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),_=t.host||t.pathname&&"/"===t.pathname.charAt(0),x=_||b||n.host&&t.pathname,w=x,T=n.pathname&&n.pathname.split("/")||[],S=(f=t.pathname&&t.pathname.split("/")||[],n.protocol&&!m[n.protocol]);if(S&&(n.hostname="",n.port=null,n.host&&(""===T[0]?T[0]=n.host:T.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),x=x&&(""===f[0]||""===T[0])),_)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,T=f;else if(f.length)T||(T=[]),T.pop(),T=T.concat(f),n.search=t.search,n.query=t.query;else if(!i.isNullOrUndefined(t.search)){if(S)n.hostname=n.host=T.shift(),(A=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=A.shift(),n.host=n.hostname=A.shift());return n.search=t.search,n.query=t.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!T.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var E=T.slice(-1)[0],P=(n.host||t.host||T.length>1)&&("."===E||".."===E)||""===E,C=0,k=T.length;k>=0;k--)"."===(E=T[k])?T.splice(k,1):".."===E?(T.splice(k,1),C++):C&&(T.splice(k,1),C--);if(!x&&!w)for(;C--;C)T.unshift("..");!x||""===T[0]||T[0]&&"/"===T[0].charAt(0)||T.unshift(""),P&&"/"!==T.join("/").substr(-1)&&T.push("");var A,I=""===T[0]||T[0]&&"/"===T[0].charAt(0);S&&(n.hostname=n.host=I?"":T.length?T.shift():"",(A=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=A.shift(),n.host=n.hostname=A.shift()));return(x=x||n.host&&T.length)&&!I&&T.unshift(""),T.length?n.pathname=T.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var t=this.host,e=a.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(11),i=n(13),o=function(){function t(t,e,n){this.name=t,this.values=e,this.line=n}return t.prototype.debugPrint=function(){r.Logger.debug("TAG: ",this.name,this.values)},t.prototype.clone=function(){var e={};for(var n in this.values)Object.prototype.hasOwnProperty.call(this.values,n)&&(e[n]=this.values[n]);return new t(this.name,e,this.line)},t.prototype.equals=function(t){return t.name===this.name&&i.objEquals(t.values,this.values)},t}();e.Tag=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n){this._stopPropagationFlag=!1,this._forceStopFlag=!1,t instanceof MouseEvent?(this.x=t.offsetX,this.y=t.offsetY,this.button=t.button):null!=t&&null!=e&&null!=n?(this.x=t,this.y=e,this.button=n):(this.x=0,this.y=0,this.button=0)}return Object.defineProperty(t.prototype,"isLeft",{get:function(){return 0===this.button},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCenter",{get:function(){return 1===this.button},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRight",{get:function(){return 2===this.button},enumerable:!0,configurable:!0}),t.prototype.stopPropagation=function(){this._stopPropagationFlag=!0},Object.defineProperty(t.prototype,"stopPropagationFlag",{get:function(){return this._stopPropagationFlag},enumerable:!0,configurable:!0}),t.prototype.forceStop=function(){this._forceStopFlag=!0},Object.defineProperty(t.prototype,"forceStopFlag",{get:function(){return this._forceStopFlag},enumerable:!0,configurable:!0}),t}();e.PonMouseEvent=r},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function e(e,n){void 0===n&&(n=[]),this.params={},this._filter=new t.filters.AlphaFilter(1),n.length>0&&(e=this.permitParams(e,n)),this.params=e}return Object.defineProperty(e.prototype,"filterName",{get:function(){return e.filterName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pixiFilter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),e.prototype.permitParams=function(t,e){var n={};return e.forEach((function(e){null!=t[e]&&(n[e]=t[e])})),n},e.prototype.store=function(){return this.params},e.filterName="LayerFilter(base class)",e}();e.LayerFilter=n}).call(this,n(9))},function(t,e,n){"use strict";t.exports=function(t,e){e=e||{};for(var n={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},r=n.parser[e.strictMode?"strict":"loose"].exec(t),i={},o=14;o--;)i[n.key[o]]=r[o]||"";return i[n.q.name]={},i[n.key[12]].replace(n.q.parser,(function(t,e,r){e&&(i[n.q.name][e]=r)})),i}},function(t,e,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function o(){}function s(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function a(t,e,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new s(n,r||t,o),u=i?i+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],a]:t._events[u].push(a):(t._events[u]=a,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new o:delete t._events[e]}function h(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),h.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)r.call(t,e)&&n.push(i?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},h.prototype.listeners=function(t){var e=i?i+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,s=new Array(o);r<o;r++)s[r]=n[r].fn;return s},h.prototype.listenerCount=function(t){var e=i?i+t:t,n=this._events[e];return n?n.fn?1:n.length:0},h.prototype.emit=function(t,e,n,r,o,s){var a=i?i+t:t;if(!this._events[a])return!1;var u,h,l=this._events[a],c=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,n),!0;case 4:return l.fn.call(l.context,e,n,r),!0;case 5:return l.fn.call(l.context,e,n,r,o),!0;case 6:return l.fn.call(l.context,e,n,r,o,s),!0}for(h=1,u=new Array(c-1);h<c;h++)u[h-1]=arguments[h];l.fn.apply(l.context,u)}else{var p,d=l.length;for(h=0;h<d;h++)switch(l[h].once&&this.removeListener(t,l[h].fn,void 0,!0),c){case 1:l[h].fn.call(l[h].context);break;case 2:l[h].fn.call(l[h].context,e);break;case 3:l[h].fn.call(l[h].context,e,n);break;case 4:l[h].fn.call(l[h].context,e,n,r);break;default:if(!u)for(p=1,u=new Array(c-1);p<c;p++)u[p-1]=arguments[p];l[h].fn.apply(l[h].context,u)}}return!0},h.prototype.on=function(t,e,n){return a(this,t,e,n,!1)},h.prototype.once=function(t,e,n){return a(this,t,e,n,!0)},h.prototype.removeListener=function(t,e,n,r){var o=i?i+t:t;if(!this._events[o])return this;if(!e)return u(this,o),this;var s=this._events[o];if(s.fn)s.fn!==e||r&&!s.once||n&&s.context!==n||u(this,o);else{for(var a=0,h=[],l=s.length;a<l;a++)(s[a].fn!==e||r&&!s[a].once||n&&s[a].context!==n)&&h.push(s[a]);h.length?this._events[o]=1===h.length?h[0]:h:u(this,o)}return this},h.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&u(this,e)):(this._events=new o,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=i,h.EventEmitter=h,t.exports=h},function(t,e,n){"use strict";function r(t,e,n){n=n||2;var r,a,u,h,l,d,g,y=e&&e.length,m=y?e[0]*n:t.length,v=i(t,0,m,n,!0),b=[];if(!v||v.next===v.prev)return b;if(y&&(v=function(t,e,n,r){var s,a,u,h,l,d=[];for(s=0,a=e.length;s<a;s++)u=e[s]*r,h=s<a-1?e[s+1]*r:t.length,(l=i(t,u,h,r,!1))===l.next&&(l.steiner=!0),d.push(f(l));for(d.sort(c),s=0;s<d.length;s++)p(d[s],n),n=o(n,n.next);return n}(t,e,v,n)),t.length>80*n){r=u=t[0],a=h=t[1];for(var _=n;_<m;_+=n)(l=t[_])<r&&(r=l),(d=t[_+1])<a&&(a=d),l>u&&(u=l),d>h&&(h=d);g=0!==(g=Math.max(u-r,h-a))?1/g:0}return s(v,b,n,r,a,g),b}function i(t,e,n,r,i){var o,s;if(i===E(t,e,n,r)>0)for(o=e;o<n;o+=r)s=w(o,t[o],t[o+1],s);else for(o=n-r;o>=e;o-=r)s=w(o,t[o],t[o+1],s);return s&&v(s,s.next)&&(T(s),s=s.next),s}function o(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!v(r,r.next)&&0!==m(r.prev,r,r.next))r=r.next;else{if(T(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function s(t,e,n,r,i,c,p){if(t){!p&&c&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=d(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,s,a,u,h=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,r=n,a=0,e=0;e<h&&(a++,r=r.nextZ);e++);for(u=h;a>0||u>0&&r;)0!==a&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,h*=2}while(s>1)}(i)}(t,r,i,c);for(var f,g,y=t;t.prev!==t.next;)if(f=t.prev,g=t.next,c?u(t,r,i,c):a(t))e.push(f.i/n),e.push(t.i/n),e.push(g.i/n),T(t),t=g.next,y=g.next;else if((t=g)===y){p?1===p?s(t=h(t,e,n),e,n,r,i,c,2):2===p&&l(t,e,n,r,i,c):s(o(t),e,n,r,i,c,1);break}}}function a(t){var e=t.prev,n=t,r=t.next;if(m(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(g(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&m(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(t,e,n,r){var i=t.prev,o=t,s=t.next;if(m(i,o,s)>=0)return!1;for(var a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,u=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,h=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,l=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,c=d(a,u,e,n,r),p=d(h,l,e,n,r),f=t.prevZ,y=t.nextZ;f&&f.z>=c&&y&&y.z<=p;){if(f!==t.prev&&f!==t.next&&g(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&m(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,y!==t.prev&&y!==t.next&&g(i.x,i.y,o.x,o.y,s.x,s.y,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;f&&f.z>=c;){if(f!==t.prev&&f!==t.next&&g(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&m(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;y&&y.z<=p;){if(y!==t.prev&&y!==t.next&&g(i.x,i.y,o.x,o.y,s.x,s.y,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function h(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!v(i,o)&&b(i,r,r.next,o)&&_(i,o)&&_(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),T(r),T(r.next),r=t=o),r=r.next}while(r!==t);return r}function l(t,e,n,r,i,a){var u=t;do{for(var h=u.next.next;h!==u.prev;){if(u.i!==h.i&&y(u,h)){var l=x(u,h);return u=o(u,u.next),l=o(l,l.next),s(u,e,n,r,i,a),void s(l,e,n,r,i,a)}h=h.next}u=u.next}while(u!==t)}function c(t,e){return t.x-e.x}function p(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,s=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>s){if(s=a,a===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===s)return n.prev;var u,h=n,l=n.x,c=n.y,p=1/0;r=n.next;for(;r!==h;)i>=r.x&&r.x>=l&&i!==r.x&&g(o<c?i:s,o,l,c,o<c?s:i,o,r.x,r.y)&&((u=Math.abs(o-r.y)/(i-r.x))<p||u===p&&r.x>n.x)&&_(r,t)&&(n=r,p=u),r=r.next;return n}(t,e)){var n=x(e,t);o(n,n.next)}}function d(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function f(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function g(t,e,n,r,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function y(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&b(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&_(t,e)&&_(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function b(t,e,n,r){return!!(v(t,e)&&v(n,r)||v(t,r)&&v(n,e))||m(t,e,n)>0!=m(t,e,r)>0&&m(n,r,t)>0!=m(n,r,e)>0}function _(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function x(t,e){var n=new S(t.i,t.x,t.y),r=new S(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function w(t,e,n,r){var i=new S(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function T(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function S(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function E(t,e,n,r){for(var i=0,o=e,s=n-r;o<n;o+=r)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}t.exports=r,t.exports.default=r,r.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,s=Math.abs(E(t,0,o,n));if(i)for(var a=0,u=e.length;a<u;a++){var h=e[a]*n,l=a<u-1?e[a+1]*n:t.length;s-=Math.abs(E(t,h,l,n))}var c=0;for(a=0;a<r.length;a+=3){var p=r[a]*n,d=r[a+1]*n,f=r[a+2]*n;c+=Math.abs((t[p]-t[f])*(t[d+1]-t[p+1])-(t[p]-t[d])*(t[f+1]-t[p+1]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[i][o][s]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o,s=n(40),a=n(25);!function(t){t[t.Stop=0]="Stop",t[t.Run=1]="Run",t[t.Sleep=2]="Sleep"}(o=e.ConductorState||(e.ConductorState={}));var u=function(){function t(t,e,n){this.latestScriptFilePath="",this._status=o.Stop,this.sleepStartTick=-1,this.sleepTime=-1,this.sleepSender="",this.stableBuffer=!1,this.eventHandlers={},this.eventHandlersStack=[],this.latestSaveMarkName="",this.resource=t,this.name=e,this.eventCallbacks=n,this._script=new a.Script(this.resource,"__dummy__",";s"),this.readUnread=new s.ReadUnread(this.resource)}return Object.defineProperty(t.prototype,"script",{get:function(){return this._script},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),t.prototype.loadScript=function(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.latestScriptFilePath=t,e=this,[4,this.resource.loadScript(t)];case 1:return e._script=r.sent(),[3,3];case 2:throw n=r.sent(),this.eventCallbacks.onError(n),n;case 3:return[2]}}))}))},t.prototype.jump=function(t,e,n){return void 0===e&&(e=null),void 0===n&&(n=!0),r(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return n&&(this.passLatestSaveMark(),this.latestSaveMarkName=""),null==t||""===t?[3,2]:[4,this.loadScript(t)];case 1:return r.sent(),null!=e&&this.script.goToLabel(e),[3,3];case 2:null!=e&&this.script.goToLabel(e),r.label=3;case 3:return[2]}}))}))},t.prototype.isPassed=function(t){return this.readUnread.isPassed(this.script,t)},t.prototype.isPassedLatestSaveMark=function(){return this.isPassed(this.latestSaveMarkName)},t.prototype.passSaveMark=function(t){this.readUnread.pass(this.script,t)},t.prototype.passLatestSaveMark=function(){this.passSaveMark(this.latestSaveMarkName)},t.prototype.conduct=function(t){if(this.status!==o.Stop){if(this.status===o.Sleep){if(t-this.sleepStartTick<this.sleepTime)return;this.start()}for(this.callOnChangeStable();;){var e=this.script.getNextTag();if(null==e)return void this.stop();var n=void 0;switch((e=e.clone()).name){case"__label__":n=this.eventCallbacks.onLabel(e.values.__body__,e.line,t);break;case"__save_mark__":this.passLatestSaveMark(),this.latestSaveMarkName=e.values.name,n=this.eventCallbacks.onSaveMark(e.values.name,e.values.comment,e.line,t);break;case"__js__":n=this.eventCallbacks.onJs(e.values.__body__,e.values.print,e.line,t);break;case"__line_break__":null!=this.resource.commandShortcut["\n"]?(e=this.script.callCommandShortcut(e,this.resource.commandShortcut["\n"]),n=this.eventCallbacks.onTag(e,e.line,t)):n="continue";break;case"ch":null!=this.resource.commandShortcut[e.values.text]&&(e=this.script.callCommandShortcut(e,this.resource.commandShortcut[e.values.text])),n=this.eventCallbacks.onTag(e,e.line,t);break;default:n=this.eventCallbacks.onTag(e,e.line,t)}if("break"===n)break;if(this.status!==o.Run)break}this.callOnChangeStable()}},t.prototype.applyJsEntity=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var n=t[e];if("string"!=typeof n)continue;var r=""+n;if(r.length>=2&&"&"===t.charAt(0)){var i=r.substring(1);t[e]=this.resource.evalJs(i)}}},t.prototype.callOnChangeStable=function(){this.stableBuffer!==this.isStable&&this.eventCallbacks.onChangeStable(this.isStable),this.stableBuffer=this.isStable},t.prototype.start=function(){return this._status=o.Run,this.sleepTime=-1,this.sleepStartTick=-1,this.sleepSender="","continue"},t.prototype.stop=function(){return this._status=o.Stop,"break"},t.prototype.sleep=function(t,e,n){return this._status=o.Sleep,this.sleepStartTick=t,this.sleepTime=e,this.sleepSender=n,"break"},Object.defineProperty(t.prototype,"isStable",{get:function(){return!(this._status!==o.Stop||this.hasEventHandler("move")||this.hasEventHandler("trans")||this.hasEventHandler("frameanim")||this.hasEventHandler("soundstop")||this.hasEventHandler("soundfade"))},enumerable:!0,configurable:!0}),t.prototype.addEventHandler=function(t){var e=t.eventName;null==this.eventHandlers[e]&&(this.eventHandlers[e]=[]),this.eventHandlers[e].push(t)},t.prototype.hasEventHandler=function(t){return null!=this.eventHandlers[t]},t.prototype.trigger=function(t){var e=this.eventHandlers[t];return null!=e&&(this.clearEventHandlerByName(t),e.forEach((function(t){t.fire()})),!0)},t.prototype.clearAllEventHandler=function(){this.eventHandlers={}},t.prototype.clearEventHandler=function(t){var e=this;Object.keys(this.eventHandlers).forEach((function(n){e.eventHandlers[n].forEach((function(r,i){r!==t||e.eventHandlers[n].splice(i,1)}))}))},t.prototype.clearEventHandlerByName=function(t){delete this.eventHandlers[t]},t.prototype.store=function(e,n){var r={},i=this;if(t.conductorStoreParams.forEach((function(t){r[t]=i[t]})),r.scriptFilePath=this.script.filePath,r.saveMarkName=e,this.script.isInsideOfMacro())throw new Error("マクロの中でセーブすることはできません");if(this.script.isInsideOfForLoop())throw new Error("for〜endforの中でセーブすることはできません");if(this.script.isInsideOfIf())throw new Error("if〜endifの中でセーブすることはできません");return r},t.prototype.restore=function(e,n){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return n=this,t.conductorStoreParams.forEach((function(t){n[t]=e[t]})),this.stop(),[4,this.loadScript(e.scriptFilePath)];case 1:return r.sent(),this.script.goToSaveMark(e.saveMarkName),[2]}}))}))},t.conductorStoreParams=["_status","sleepStartTick","sleepTime","sleepSender"],t}();e.Conductor=u},function(t,e,n){"use strict";var r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=n(8),o=n(11),s=n(54),a=n(55),u=n(18),h=r(n(13)),l=function(){function t(t,e,n){this.tagPoint=0,this.latestTagBuffer=null,this.forLoopStack=[],this.ifDepth=0,this.macroStack=[],this.resource=t,this._filePath=e,this.parser=null!=n?new a.ScriptParser(this.resource,n):new a.ScriptParser(this.resource,"")}return Object.defineProperty(t.prototype,"filePath",{get:function(){return this._filePath},enumerable:!0,configurable:!0}),t.prototype.debugPrint=function(){o.Logger.debug("============================================"),this.parser.debugPrint(),o.Logger.debug("Script current point: ",this.tagPoint),o.Logger.debug("============================================")},t.prototype.clone=function(){var e=new t(this.resource,this.filePath,null);return e.parser=this.parser,e},t.prototype.goToStart=function(){this.goTo(0)},t.prototype.goTo=function(t){t<0&&(t=0),t>=this.parser.tags.length&&(t=this.parser.tags.length-1),this.tagPoint=t},t.prototype.getPoint=function(){return this.tagPoint},t.prototype.goToLabel=function(t){var e=this.parser.getLabelPos(t);if(-1===e)throw new Error(this.filePath+"内に、ラベル "+t+" が見つかりませんでした");this.goTo(e+1)},t.prototype.goToSaveMark=function(t){var e=this.parser.getSaveMarkPos(t);if(-1===e)throw new Error(this.filePath+"内に、セーブマーク "+t+" が見つかりませんでした");this.goTo(e+1)},t.prototype.getCurrentTag=function(){if(0===this.macroStack.length){var t=this.parser.tags;return t.length<=this.tagPoint?null:t[this.tagPoint]}return this.macroStack[this.macroStack.length-1].getCurrentTag()},t.prototype.getNextTag=function(){if(0===this.macroStack.length){var t=this.parser.tags;if(t.length<=this.tagPoint)return null;var e=this.latestTagBuffer=t[this.tagPoint++];return this.resource.hasMacro(e.name)?(this.callMacro(e),this.getNextTag()):e}var n=this.macroStack[this.macroStack.length-1];e=this.latestTagBuffer=n.getNextTag();return this.resource.setMacroParams(n.params),null!=e?this.resource.hasMacro(e.name)?(this.callMacro(e),this.getNextTag()):e:(this.macroStack.pop(),this.resource.clearMacroParams(),this.getNextTag())},t.prototype.callMacro=function(t){var e=this.resource.getMacro(t.name).clone();e.clearTagPoint(),e.params=h.objClone(t.values),i.applyJsEntity(this.resource,e.params),this.macroStack.push(e)},t.prototype.isInsideOfMacro=function(){return 0!==this.macroStack.length},t.prototype.callCommandShortcut=function(t,e){var n=new u.Tag(e,{},t.line);if(this.resource.hasMacro(n.name)){this.callMacro(n);var r=this.getNextTag();if(null==r)throw new Error("コマンドショートカットの呼び出しに失敗しました");return r}return n},t.prototype.getLatestTag=function(){return this.latestTagBuffer},t.prototype.defineMacro=function(t){if(this.resource.hasMacro(t))throw new Error(t+"マクロはすでに登録されています");for(var e=[];;){var n=this.getNextTagWithoutMacro();if(null===n)throw new Error("マクロ定義エラー。macroとendmacroの対応が取れていません");if("macro"===n.name)throw new Error("マクロ定義エラー。マクロの中でmacroは使用できません");if("__label__"===n.name)throw new Error("マクロ定義エラー。マクロの中でラベルは使用できません");if("__save_mark__"===n.name)throw new Error("マクロ定義エラー。マクロの中でセーブマークは使用できません");if("endmacro"===n.name)break;e.push(n.clone())}if(0===e.length)throw new Error("マクロ定義の中身が空です");var r=new s.Macro(t,e);return this.resource.macroInfo[t]=r,r},t.prototype.getNextTagWithoutMacro=function(){var t=this.parser.tags;return t.length<=this.tagPoint?null:t[this.tagPoint++]},t.prototype.getNextTagForIf=function(){if(0===this.macroStack.length){var t=this.parser.tags;return t.length<=this.tagPoint?null:t[this.tagPoint++]}return this.macroStack[this.macroStack.length-1].getNextTag()},t.prototype.ifJump=function(t,e){this.ifDepth++,this.resource.evalJs(t)||this.goToElseFromIf(e)},t.prototype.goToElseFromIf=function(t){for(var e=0;;){var n=this.getNextTagForIf();if(null===n)throw new Error("条件分岐エラー。if/else/elsif/endifの対応が取れていません");if("if"===n.name)e++;else if("else"===n.name){if(0===e)break}else if("endif"===n.name){if(0===e){if(this.ifDepth--,this.ifDepth<0)throw new Error("条件分岐エラー。if/else/elsif/endifの対応が取れていません");break}e--}else if("elsif"===n.name&&0===e){var r=n.clone();if(i.applyJsEntity(this.resource,r.values),i.castTagValues(r,t.elsif),this.resource.evalJs(r.values.exp))break}if(e<0)throw new Error("条件分岐エラー。if/else/elsif/endifの対応が取れていません")}},t.prototype.elsifJump=function(){this.goToEndifFromElse()},t.prototype.elseJump=function(){this.goToEndifFromElse()},t.prototype.endif=function(){if(this.ifDepth--,this.ifDepth<0)throw new Error("条件分岐エラー。if/else/elsif/endifの対応が取れていません")},t.prototype.goToEndifFromElse=function(){for(var t=0;;){var e=this.getNextTagForIf();if(null===e)throw new Error("条件分岐エラー。if/else/elsif/endifの対応が取れていません");if("if"===e.name)t++;else if("endif"===e.name){if(0===t){if(this.ifDepth--,this.ifDepth<0)throw new Error("条件分岐エラー。if/else/elsif/endifの対応が取れていません");break}t--}if(t<0)throw new Error("条件分岐エラー。if/else/elsif/endifの対応が取れていません")}},t.prototype.isInsideOfIf=function(){return 0!==this.ifDepth},t.prototype.startForLoop=function(t,e){void 0===e&&(e="__index__");var n={startTagPoint:this.tagPoint,indexVarName:e,loops:t,count:0};this.forLoopStack.push(n),this.resource.evalJs('tv["'+n.indexVarName+'"] = '+n.count+";")},t.prototype.endForLoop=function(){var t=this.forLoopStack[this.forLoopStack.length-1];if(null==t)throw new Error("予期しないendforです。forとendforの対応が取れていません");++t.count<t.loops?(this.resource.tmpVar[t.indexVarName]=t.count,this.goTo(t.startTagPoint)):this.forLoopStack.pop()},t.prototype.breakForLoop=function(){for(var t=0;;){var e=this.getNextTagForIf();if(null===e)throw new Error("breakforの動作エラー。forとendforの対応が取れていません");if("for"===e.name)t++;else if("endfor"===e.name){if(0===t)break;t--}if(t<0)throw new Error("breakforの動作エラー。forとendforの対応が取れていません")}},t.prototype.isInsideOfForLoop=function(){return 0!==this.forLoopStack.length},t}();e.Script=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(15),u=n(16),h=n(72),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initSliderButton=function(t,e){return o(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this.loadImage(t)];case 1:return n.sent(),this.initButton(e),this.width=Math.floor(this.imageWidth/3),[2]}}))}))},e.prototype.clearSliderButton=function(){this.clearButton(),this.freeImage()},e.prototype.setButtonStatus=function(e){switch(t.prototype.setButtonStatus.call(this,e),e){case"normal":case"disabled":this.imageX=0;break;case"over":this.imageX=-Math.floor(this.imageWidth/3);break;case"on":this.imageX=-Math.floor(this.imageWidth/3*2)}},e.prototype.setCallbacks=function(t){this.callbacks=t},e.prototype.onMouseDown=function(e){t.prototype.onMouseDown.call(this,e),this.isInsideEvent(e)&&e.isLeft&&this.callbacks.onMouseDown&&this.callbacks.onMouseDown(e)},e.prototype.onMouseUp=function(e){t.prototype.onMouseUp.call(this,e),this.callbacks.onMouseUp&&this.callbacks.onMouseUp(e)},e.prototype.submit=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){return t.prototype.submit.call(this),this.callbacks.submit&&this.callbacks.submit(),[2]}))}))},e.prototype.slideToLeft=function(){this.callbacks.slideToLeft&&this.callbacks.slideToLeft()},e.prototype.slideToRight=function(){this.callbacks.slideToRight&&this.callbacks.slideToRight()},e}(u.Button);e.SliderButton=l;var c=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.locked=!1,i.value=0,i.onStart="",i.onSlide="",i.onEnd="",i.onChange="",i.down=!1,i.foreImage=new a.BaseLayer("slider fore",n,r),i.addChild(i.foreImage),i.button=new l("slider button",n,r),i.addChild(i.button),i.button.setCallbacks({onMouseDown:function(t){i.onButtonDown(t)},onMouseUp:function(t){i.onButtonUp(t)},submit:function(){i.submit()},slideToLeft:function(){i.setValue(i.value-.04),i.submit()},slideToRight:function(){i.setValue(i.value+.04),i.submit()}}),i}return i(e,t),e.prototype.initSlider=function(t,e,n,r,i,a,u,h,l){return o(this,void 0,void 0,(function(){var o,c=this;return s(this,(function(s){return this.clearSlider(),t<0&&(t=0),t>1&&(t=1),this.value=t,this.onStart=e,this.onSlide=n,this.onEnd=r,this.onChange=i,(o=[]).push(this.loadImage(a)),o.push(this.foreImage.loadImage(u).then((function(){c.foreImage.x=0,c.foreImage.y=0,c.foreImage.visible=!0}))),o.push(this.button.initSliderButton(h,l).then((function(){c.button.x=0,c.button.y=0,c.button.visible=!0,c.button.setButtonStatus("normal")}))),[2,Promise.all(o).then((function(){c.setValue(t),c.visible=!0,c.lock()}))]}))}))},e.prototype.clearSlider=function(){this.freeImage(),this.value=0,this.onStart="",this.onSlide="",this.onEnd="",this.onChange="",this.down=!1,this.foreImage.freeImage(),this.foreImage.visible=!1,this.button.clearSliderButton(),this.button.freeImage(),this.button.visible=!1},e.prototype.lock=function(){this.locked=!0,this.button.setButtonStatus("disabled")},e.prototype.unlock=function(){this.locked=!1,this.button.setButtonStatus("normal")},e.prototype.setValueX=function(t){var e=t-this.button.width/2;e<0&&(e=0),e>this.width-this.button.width&&(e=this.width-this.button.width),this.foreImage.width=e,this.button.x=e;var n=e/(this.width-this.button.width);n<0&&(n=0),n>1&&(n=1),this.value=n},e.prototype.setValue=function(t){t<0&&(t=0),t>1&&(t=1);var e=t*(this.width-this.button.width);this.value=t,this.foreImage.width=e,this.button.x=e},e.prototype.onButtonDown=function(t){this.locked||(this.down=!0)},e.prototype.onButtonUp=function(t){},e.prototype.onMouseEnter=function(e){t.prototype.onMouseEnter.call(this,e)},e.prototype.onMouseLeave=function(e){t.prototype.onMouseLeave.call(this,e)},e.prototype.onMouseDown=function(e){t.prototype.onMouseDown.call(this,e),!this.locked&&e.isLeft&&this.isInsideEvent(e)&&(this.down=!0,this.setValueX(e.x),this.executeSliderCallback(this.onStart),e.stopPropagation(),e.forceStop())},e.prototype.onMouseMove=function(e){t.prototype.onMouseMove.call(this,e),!this.locked&&this.down&&(this.setValueX(e.x),this.executeSliderCallback(this.onSlide),this.resource.getCanvasElm().style.cursor=this.resource.cursor.over)},e.prototype.onMouseUp=function(e){t.prototype.onMouseUp.call(this,e),this.down&&(this.down=!1,this.resource.getCanvasElm().style.cursor=this.resource.cursor.normal,e.stopPropagation(),e.forceStop(),this.executeSliderCallback(this.onEnd),this.submit())},e.prototype.submit=function(){this.executeSliderCallback(this.onChange)},e.prototype.executeSliderCallback=function(t){null!=t&&""!==t&&("function"==typeof t?t(this.value):this.resource.evalJs(t))},e.prototype.store=function(n){var r=t.prototype.store.call(this,n),i=this;return e.sliderStoreParams.forEach((function(t){r[t]=i[t]})),r.foreImage=this.foreImage.store(n),r.button=this.button.store(n),r},e.prototype.restore=function(n,r,i){return o(this,void 0,void 0,(function(){var o,a=this;return s(this,(function(s){switch(s.label){case 0:return this.clearSlider(),[4,t.prototype.restore.call(this,n,r,i)];case 1:return s.sent(),o=this,e.sliderStoreParams.forEach((function(t){o[t]=n[t]})),[4,this.foreImage.restore(n.foreImage,r,i)];case 2:return s.sent(),[4,this.button.restore(n.button,r,i)];case 3:return s.sent(),this.button.setCallbacks({onMouseDown:function(t){a.onButtonDown(t)},onMouseUp:function(t){a.onButtonUp(t)}}),[2]}}))}))},e.prototype.restoreAfterLoadImage=function(e,n){t.prototype.restoreAfterLoadImage.call(this,e,n),this.setValue(e.value),e.locked?this.lock():this.unlock()},e.prototype.copyTo=function(n){t.prototype.copyTo.call(this,n);var r=this,i=n;e.sliderStoreParams.forEach((function(t){i[t]=r[t]})),this.foreImage.copyTo(n.foreImage),this.button.copyTo(n.button)},e.sliderStoreParams=["locked","value","exp"],e}(a.BaseLayer);e.Slider=c;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sliders=[],e}return i(e,t),e.prototype.addSlider=function(t,e,n,r,i,a,u,h,l,p,d){return o(this,void 0,void 0,(function(){var o,f;return s(this,(function(s){return o="Slider "+this.sliders.length,f=new c(o,this.resource,this.owner),this.addChild(f),this.sliders.push(f),f.x=t,f.y=e,[2,f.initSlider(n,r,i,a,u,h,l,p,d)]}))}))},e.prototype.clearSliders=function(){var t=this;this.sliders.forEach((function(e){e.clearSlider(),e.destroy(),t.deleteChildLayer(e)})),this.sliders=[]},e.prototype.hasSlider=function(){return this.sliders.length>0},e.prototype.lockSliders=function(){this.sliders.forEach((function(t){return t.lock()}))},e.prototype.unlockSliders=function(){this.sliders.forEach((function(t){return t.unlock()}))},e.prototype.getButtons=function(){var e=t.prototype.getButtons.call(this);return this.sliders.forEach((function(t){e.push(t.button)})),e},e.prototype.store=function(e){var n=t.prototype.store.call(this,e);return n.sliders=this.sliders.map((function(t){return t.store(e)})),n},e.prototype.restore=function(e,n,r){return o(this,void 0,void 0,(function(){var i=this;return s(this,(function(o){switch(o.label){case 0:return[4,t.prototype.restore.call(this,e,n,r)];case 1:return o.sent(),null!=e.sliders&&e.sliders.length>0?e.sliders.length!==this.sliders.length?[3,3]:[4,Promise.all(e.sliders.map((function(t,e){return i.sliders[e].restore(t,n,r)})))]:[3,6];case 2:return o.sent(),[3,5];case 3:return this.clearSliders(),[4,Promise.all(e.sliders.map((function(t){var e=new c(t.name,i.resource,i.owner);return i.addChild(e),i.sliders.push(e),e.restore(t,n,r)})))];case 4:o.sent(),o.label=5;case 5:return[3,7];case 6:this.clearSliders(),o.label=7;case 7:return[2]}}))}))},e.prototype.restoreAfterLoadImage=function(e,n){if(t.prototype.restoreAfterLoadImage.call(this,e,n),null!=e.sliders&&e.sliders.length>0)for(var r=0;r<e.sliders.length;r++)this.sliders[r].restoreAfterLoadImage(e.sliders[r],n)},e.prototype.copyTo=function(e){var n=this;t.prototype.copyTo.call(this,e),e.clearSliders(),this.sliders.forEach((function(t){var r=new c(n.name,e.resource,e.owner);e.addChild(r),e.sliders.push(r),t.copyTo(r)}))},e}(h.ToggleButtonLayer);e.SliderLayer=p},function(t,e,n){(function(r,i){var o;!function(r){var s=r.Promise,a=s&&"resolve"in s&&"reject"in s&&"all"in s&&"race"in s&&function(){var t;return new s((function(e){t=e})),"function"==typeof t}();e?(e.Promise=a?s:T,e.Polyfill=T):void 0===(o=function(){return a?s:T}.call(e,n,e,t))||(t.exports=o);var u=function(){};function h(t){return"[object Array]"===Object.prototype.toString.call(t)}var l,c=void 0!==i?i:setTimeout,p=[];function d(){for(var t=0;t<p.length;t++)p[t][0](p[t][1]);p=[],l=!1}function f(t,e){p.push([t,e]),l||(l=!0,c(d,0))}function g(t){var e=t.owner,n=e.state_,r=e.data_,i=t[n],o=t.then;if("function"==typeof i){n="fulfilled";try{r=i(r)}catch(t){b(o,t)}}y(o,r)||("fulfilled"===n&&m(o,r),"rejected"===n&&b(o,r))}function y(t,e){var n;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&("function"==typeof e||"object"==typeof e)){var r=e.then;if("function"==typeof r)return r.call(e,(function(r){n||(n=!0,e!==r?m(t,r):v(t,r))}),(function(e){n||(n=!0,b(t,e))})),!0}}catch(e){return n||b(t,e),!0}return!1}function m(t,e){t!==e&&y(t,e)||v(t,e)}function v(t,e){"pending"===t.state_&&(t.state_="sealed",t.data_=e,f(x,t))}function b(t,e){"pending"===t.state_&&(t.state_="sealed",t.data_=e,f(w,t))}function _(t){var e=t.then_;t.then_=void 0;for(var n=0;n<e.length;n++)g(e[n])}function x(t){t.state_="fulfilled",_(t)}function w(t){t.state_="rejected",_(t)}function T(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof T==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(t,e){function n(t){b(e,t)}try{t((function(t){m(e,t)}),n)}catch(t){n(t)}}(t,this)}T.prototype={constructor:T,state_:"pending",then_:null,data_:void 0,then:function(t,e){var n={owner:this,then:new this.constructor(u),fulfilled:t,rejected:e};return"fulfilled"===this.state_||"rejected"===this.state_?f(g,n):this.then_.push(n),n.then},catch:function(t){return this.then(null,t)}},T.all=function(t){if(!h(t))throw new TypeError("You must pass an array to Promise.all().");return new this((function(e,n){var r=[],i=0;function o(t){return i++,function(n){r[t]=n,--i||e(r)}}for(var s,a=0;a<t.length;a++)(s=t[a])&&"function"==typeof s.then?s.then(o(a),n):r[a]=s;i||e(r)}))},T.race=function(t){if(!h(t))throw new TypeError("You must pass an array to Promise.race().");return new this((function(e,n){for(var r,i=0;i<t.length;i++)(r=t[i])&&"function"==typeof r.then?r.then(e,n):e(r)}))},T.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this((function(e){e(t)}))},T.reject=function(t){return new this((function(e,n){n(t)}))}}("undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:this)}).call(this,n(14),n(31).setImmediate)},function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function s(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,a,u=s(t),h=1;h<arguments.length;h++){for(var l in n=Object(arguments[h]))i.call(n,l)&&(u[l]=n[l]);if(r){a=r(n);for(var c=0;c<a.length;c++)o.call(n,a[c])&&(u[a[c]]=n[a[c]])}}return u}},function(t,e,n){"use strict";(function(t){var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var u,h=n(24),l=n(11),c=n(56),p=n(64),d=n(18),f=a(n(13)),g=n(65),y=n(69),m=n(8),v=n(26);!function(t){t[t.INVALID=0]="INVALID",t[t.UNTIL_CLICK_WAIT=1]="UNTIL_CLICK_WAIT",t[t.UNTIL_S=2]="UNTIL_S",t[t.WHILE_PRESSING_CTRL=3]="WHILE_PRESSING_CTRL"}(u=e.SkipType||(e.SkipType={}));var b=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this,e,n)||this;return r.raiseError={unknowncommand:!0},r.skipMode=u.INVALID,r.canSkipUnreadPart=!1,r.canSkipUnreadPartByCtrl=!0,r.autoModeFlag=!1,r.autoModeInterval=1e3,r.autoModeStartTick=-1,r.autoModeLayerNum=23,r.waitUntilStartTick=-1,r.waitUntilTime=0,r.tagActions={},r._layerCount=40,r.layerAlias={},r.currentPage="fore",r.isQuaking=!1,r.quakeStartTick=-1,r.quakeTime=0,r.quakeMaxX=20,r.quakeMaxY=20,r.isQuakePhase=!0,r.quakeFrameCount=0,r.quakeIntervalFrame=4,r.textSpeedMode="user",r.unreadTextSpeed=20,r.readTextSpeed=20,r.userUnreadTextSpeed=20,r.userReadTextSpeed=20,r.clickSkipEnabled=!0,r.nowaitModeFlag=!1,r.addCharWithBackFlag=!1,r.hideMessageFlag=!1,r.hideMessageByRClickFlag=!1,r._messageLayerNum=20,r._lineBreakGlyphLayerNum=21,r.lineBreakGlyphPos="eol",r.lineBreakGlyphVerticalAlign="bottom",r.lineBreakGlyphX=0,r.lineBreakGlyphY=0,r.lineBreakGlyphMarginX=10,r.lineBreakGlyphMarginY=0,r._pageBreakGlyphLayerNum=22,r.pageBreakGlyphPos="eol",r.pageBreakGlyphVerticalAlign="bottom",r.pageBreakGlyphX=0,r.pageBreakGlyphY=0,r.pageBreakGlyphMarginX=10,r.pageBreakGlyphMarginY=0,r.rightClickJump=!1,r.rightClickCall=!1,r.rightClickFilePath=null,r.rightClickLabel=null,r.rightClickEnabled=!0,r.enabledHistory=!0,r.soundBufferAlias={},r.soundBufferCount=5,r.soundBuffers=[],r.onSoundStopParamsList=[],r.currentOnSoundStopParams=null,r.saveDataPrefix="ponkan-game",r.latestSaveComment="",r.latestSaveData={},r.tempSaveData={},r.pluginMap={},r.plugins=[],r.onMouseWheelLocked=!1,null!=n.saveDataPrefix&&(r.saveDataPrefix=n.saveDataPrefix),null!=n.text&&(null!=n.text.unread&&(r.userUnreadTextSpeed=n.text.unread),null!=n.text.read&&(r.userReadTextSpeed=n.text.read)),r.initTagAction(),r.forePrimaryLayer=r.addForePrimaryLayer(new y.PonLayer("Fore primary layer",r.resource,r)),r.backPrimaryLayer=r.addBackPrimaryLayer(new y.PonLayer("Back primary layer",r.resource,r)),r.initLayers(n),r.historyLayer=new g.HistoryLayer("HistoryLayer",r.resource,r),r.addForePrimaryLayer(r.historyLayer),r.historyLayer.visible=!1,r.initSoundBuffers(n),r}return i(e,t),Object.defineProperty(e.prototype,"foreLayers",{get:function(){return this.forePrimaryLayer.children},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backLayers",{get:function(){return this.backPrimaryLayer.children},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"messageLayerNum",{get:function(){return this._messageLayerNum},set:function(t){this._messageLayerNum=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineBreakGlyphLayerNum",{get:function(){return this._lineBreakGlyphLayerNum},set:function(t){this._lineBreakGlyphLayerNum=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageBreakGlyphLayerNum",{get:function(){return this._pageBreakGlyphLayerNum},set:function(t){this._pageBreakGlyphLayerNum=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tmpVar",{get:function(){return this.resource.tmpVar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gameVar",{get:function(){return this.resource.gameVar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"systemVar",{get:function(){return this.resource.systemVar},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.stop(),this.forePrimaryLayer.destroy(),this.backPrimaryLayer.destroy(),this.plugins.forEach((function(t){null!=t.destroy&&t.destroy()})),this.pluginMap={},t.prototype.destroy.call(this)},e.prototype.start=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return t.prototype.start.call(this),this.resource.existSystemData(this.saveDataPrefix)&&this.loadSystemData(this.saveDataPrefix),[4,this.historyLayer.init(this.config)];case 1:return e.sent(),[4,this.conductor.loadScript("start.pon")];case 2:return e.sent(),this.conductor.start(),[2]}}))}))},e.prototype.stop=function(){t.prototype.stop.call(this)},e.prototype.pause=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!0),t&&this.conductor.passLatestSaveMark(),this.conductor.stop(),e&&this.stopSkip(),this.lock()},e.prototype.resume=function(){this.conductor.start(),this.unlock()},e.prototype.addPlugin=function(t,e){if(null!=this.pluginMap[t])throw new Error("プラグイン"+t+"はすでに登録済みです。");this.pluginMap[t]=e,this.plugins.push(e)},e.prototype.removePlugin=function(t){var e=this.pluginMap[t];this.plugins=this.plugins.filter((function(t){return t!=e})),delete this.pluginMap[t]},e.prototype.getPlugin=function(t){if(null==this.pluginMap[t])throw new Error("プラグイン"+t+"は登録されていません。");return this.pluginMap[t]},e.prototype.update=function(t){var e=this;this.autoModeFlag&&this.autoModeStartTick>=0&&(t-this.autoModeStartTick>=this.autoModeInterval&&(this.autoModeStartTick=-1,this.onPrimaryClick(),this.startAutoMode()));if(this.conductor.conduct(t),this.conductor.isStable&&this.onSoundStopParamsList.length>0&&null==this.currentOnSoundStopParams){var n=this.currentOnSoundStopParams=this.onSoundStopParamsList.pop();if(null!=n)this.conductor.stop(),(n.call?this.callSubroutine(n.file,n.label):this.conductor.jump(n.file,n.label)).then((function(){e.conductor.start(),e.currentOnSoundStopParams=null}))}this.forePrimaryLayer.update(t),this.backPrimaryLayer.update(t),this.historyLayer.update(t),this.autoModeLayer.visible=this.autoModeFlag,this.resetLineBreakGlyphPos(),this.resetPageBreakGlyphPos(),this.plugins.forEach((function(e){null!=e.onUpdate&&e.onUpdate(t)}))},e.prototype.beforeDraw=function(t){this.forePrimaryLayer.beforeDraw(t),this.backPrimaryLayer.beforeDraw(t),this.historyLayer.beforeDraw(t),this.quake(t),this.plugins.forEach((function(e){null!=e.beforeDraw&&e.beforeDraw(t)}))},e.prototype.error=function(e){this.conductor.stop();var n=e.message,r=this.conductor.latestScriptFilePath,i=this.conductor.script.getLatestTag();n=null!==i?"("+r+":"+i.line+") "+n:"("+r+":1) "+n,t.prototype.error.call(this,new Error(n))},e.prototype.showLayerDebugInfo=function(){this.foreLayers.forEach((function(t){return t.debugInfoVisible=!0})),this.backLayers.forEach((function(t){return t.debugInfoVisible=!0}))},e.prototype.hideLayerDebugInfo=function(){this.foreLayers.forEach((function(t){return t.debugInfoVisible=!1})),this.backLayers.forEach((function(t){return t.debugInfoVisible=!1}))},e.prototype.getDebugInfo=function(){var t=Date.now();return{latestSaveData:this.latestSaveData,systemVar:this.systemVar,foreLayers:this.foreLayers,backLayers:this.backLayers,foreLayerStoredData:this.forePrimaryLayer.store(t),backLayerStoredData:this.backPrimaryLayer.store(t)}},e.prototype.dumpDebugInfo=function(){var t=this.getDebugInfo();console.info("========================================="),console.info("latestSaveData",t.latestSaveData),console.info("systemVar",t.systemVar),console.info("foreLayers(current object)",t.foreLayers),console.info("backLayers(current object)",t.backLayers),console.info("foreLayers(stored data)",t.foreLayerStoredData),console.info("backLayers(stored data)",t.backLayerStoredData),console.info("=========================================")},Object.defineProperty(e.prototype,"eventReceivesLayer",{get:function(){return this.historyLayer.visible?this.historyLayer:this.forePrimaryLayer},enumerable:!0,configurable:!0}),e.prototype.onMouseEnter=function(t){this.eventReceivesLayer._onMouseEnter(t)},e.prototype.onMouseLeave=function(t){this.eventReceivesLayer._onMouseLeave(t)},e.prototype.onMouseMove=function(t){var e=this.eventReceivesLayer;e._preCallMouseEnterLeave(t),e._callOnMouseLeave(t),e._callOnMouseEnter(t),e._onMouseMove(t)},e.prototype.onMouseDown=function(t){this.eventReceivesLayer._onMouseDown(t)},e.prototype.onMouseUp=function(t){this.eventReceivesLayer._onMouseUp(t),t.stopPropagationFlag||t.forceStopFlag||(t.isRight?this.onPrimaryRightClick():this.onPrimaryClick())},e.prototype.onMouseWheel=function(t){var e=this;return this.historyLayer.visible?this.historyLayer.onMouseWheel(t):!!this.forePrimaryLayer.onMouseWheel(t)&&(this.conductor.isStable&&this.enabledHistory&&t.isUp?(this.showHistoryLayer(),!1):!(!this.onMouseWheelLocked&&t.isDown)||(this.onMouseWheelLocked=!0,window.setTimeout((function(){e.onMouseWheelLocked=!1}),500),this.onPrimaryClick()))},e.prototype.onPrimaryClick=function(){return this.hideMessageByRClickFlag?(this.showMessages(),this.hideMessageByRClickFlag=!1,!0):(this.conductor.trigger("click")||(this.skipMode=u.INVALID,this.stopAutoMode(),this.clickSkipEnabled&&this.conductor.status===h.ConductorState.Sleep&&"ch"===this.conductor.sleepSender&&(this.conductor.start(),this.skipMode=u.UNTIL_CLICK_WAIT)),!0)},e.prototype.onPrimaryRightClick=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this.rightClickEnabled&&this.conductor.isStable?(this.autoModeFlag&&this.stopAutoMode(),this.isSkipping&&this.stopSkip(),this.rightClickJump?[4,this.conductor.jump(this.rightClickFilePath,this.rightClickLabel,!1)]:[3,2]):[2,!1];case 1:return t.sent(),this.conductor.start(),[3,3];case 2:this.rightClickCall?this.callSubroutine(this.rightClickFilePath,this.rightClickLabel,!1):this.hideMessageFlag?this.hideMessageByRClickFlag?this.showMessagesByRightClick():this.conductor.trigger("click"):this.hideMessagesByRightClick(),t.label=3;case 3:return[2,!1]}}))}))},e.prototype.onKeyDown=function(t){if(this.historyLayer.visible)switch(t.key.toLowerCase()){case"esc":case"escape":this.hideHistoryLayer();break;case"arrowup":case"pageup":this.conductor.isStable&&this.historyLayer.scrollUpPage();break;case"arrowdown":case"pagedown":this.conductor.isStable&&this.historyLayer.scrollDownPage()}else switch(t.key.toLowerCase()){case"esc":case"escape":this.onPrimaryRightClick();break;case"ctrl":case"control":this.onPrimaryClick(),this.startSkipByCtrl();break;case"arrowup":this.focusPrevButton();break;case"arrowdown":this.focusNextButton();break;case"arrowleft":this.slideToLeft();break;case"arrowright":this.slideToRight();break;case"pageup":this.conductor.isStable&&this.enabledHistory&&this.showHistoryLayer();break;case"pagedown":this.onPrimaryClick();break;case"enter":this.onKeyDownEnter()}return!0},e.prototype.onKeyUp=function(t){if(this.historyLayer.visible);else switch(t.key.toLowerCase()){case"ctrl":case"control":this.stopWhilePressingCtrlSkip()}return!0},e.prototype.onKeyDownEnter=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return(t=this.getPageButtons(this.foreLayers).filter((function(t){return"over"===t.getButtonStatus()}))).length>0?[4,t[0].submit()]:[3,2];case 1:return e.sent(),[3,3];case 2:this.onPrimaryClick(),e.label=3;case 3:return[2]}}))}))},e.prototype.getButtonKeyIndex=function(t){var e=this.getPageLayers(t),n=0;return this.getPageButtons(e).forEach((function(t){n=Math.max(n,t.keyIndex)})),n+1},e.prototype.getPageButtons=function(t){void 0===t&&(t=this.foreLayers);var e=[];return t.forEach((function(t){t.visible&&t.getButtons().forEach((function(t){e.push(t)}))})),e},e.prototype.focusNextButton=function(){var t=this.getPageButtons(this.foreLayers).filter((function(t){return"disabled"!=t.getButtonStatus()}));if(0!=t.length){var e=t.sort((function(t,e){return t.keyIndex-e.keyIndex})),n=t.filter((function(t){return t.isFocused}));if(0==n.length)e[0].focus();else{var r=n[0];r.blur();for(var i=0;i<e.length;i++){var o=e[i];if(r!=o&&o.keyIndex>=r.keyIndex)return void o.focus()}e[0].focus()}}},e.prototype.focusPrevButton=function(){var t=this.getPageButtons(this.foreLayers).filter((function(t){return"disabled"!=t.getButtonStatus()}));if(0!=t.length){var e=t.sort((function(t,e){return t.keyIndex-e.keyIndex})).reverse(),n=t.filter((function(t){return t.isFocused}));if(0==n.length)e[0].focus();else{var r=n[0];r.blur();for(var i=0;i<e.length;i++){var o=e[i];if(r!=o&&(r!=o&&o.keyIndex<=r.keyIndex))return void o.focus()}e[0].focus()}}},e.prototype.slideToLeft=function(){var t=this.getPageButtons(this.foreLayers).filter((function(t){return t instanceof v.SliderButton&&t.isFocused}));t.length>0&&t[0].slideToLeft()},e.prototype.slideToRight=function(){var t=this.getPageButtons(this.foreLayers).filter((function(t){return t instanceof v.SliderButton&&t.isFocused}));t.length>0&&t[0].slideToRight()},e.prototype.initTagAction=function(){var t=this;m.generateTagActions(this).forEach((function(e){e.names.forEach((function(n){t.addTagAction(n,e)}))}))},e.prototype.addTagAction=function(t,e){null==this.tagActions[t]?this.tagActions[t]=e:this.error(new Error(t+"はすでに存在しています。"))},e.prototype.addCommandShortcut=function(t,e){if(1!==t.length)throw new Error("コマンドショートカットには1文字しか指定できません");this.resource.commandShortcut[t]=e},e.prototype.delCommandShortcut=function(t){delete this.resource.commandShortcut[t]},e.prototype.execCommand=function(t,e){void 0===e&&(e={});var n=this.conductor.script.getCurrentTag(),r=null!=n?n.line:0;this.onTag(new d.Tag(t,e,r),r,Date.now())},e.prototype.onTag=function(t,e,n){l.Logger.debug("onTag: ",t.name,t.values,t);var r=this.tagActions[t.name];if(null==r){if(this.raiseError.unknowncommand)throw new Error(t.name+"というタグは存在しません");return"continue"}return null==t.values.cond||""==t.values.cond||this.resource.evalJs(t.values.cond)?(m.applyJsEntity(this.resource,t.values),m.castTagValues(t,r),r.values.forEach((function(e){var n=t.values[e.name];if(null==n){if(e.required)throw new Error(t.name+"タグの"+e.name+"は必須です。");null!=e.defaultValue&&(t.values[e.name]=e.defaultValue)}})),r.action(t.values,n)):"continue"},e.prototype.onLabel=function(t,e,n){return"continue"},e.prototype.onSaveMark=function(t,e,n,r){return this.conductor.isPassed(t)||(this.skipMode===u.WHILE_PRESSING_CTRL?this.canSkipUnreadPartByCtrl||this.stopSkip():this.isSkipping&&(this.canSkipUnreadPart||this.stopSkip())),null!=e&&""!==e&&(this.latestSaveComment=e),this.latestSaveData=this.generateSaveData(t,this.latestSaveComment,r),"continue"},e.prototype.onJs=function(t,e,n,r){var i=this.resource.evalJs(t);if(e){var o=new d.Tag("ch",{text:""+i},n);return this.onTag(o,n,r)}return"continue"},e.prototype.onChangeStable=function(t){this.forePrimaryLayer.onChangeStable(t),this.backPrimaryLayer.onChangeStable(t),this.plugins.forEach((function(e){null!=e.onChangeStable&&e.onChangeStable(t)}))},e.prototype.onReturnSubroutin=function(t){void 0===t&&(t=!1),this.conductor.trigger("return_subroutin"),t&&this.hideBreakGlyph()},Object.defineProperty(e.prototype,"isSkipping",{get:function(){return this.skipMode!==u.INVALID},enumerable:!0,configurable:!0}),e.prototype.startSkipByTag=function(){(this.conductor.isPassedLatestSaveMark()||this.canSkipUnreadPart)&&(this.skipMode=u.UNTIL_S)},e.prototype.startSkipByCtrl=function(){(this.conductor.isPassedLatestSaveMark()||this.canSkipUnreadPartByCtrl)&&(this.skipMode=u.WHILE_PRESSING_CTRL)},e.prototype.stopWhilePressingCtrlSkip=function(){this.skipMode===u.WHILE_PRESSING_CTRL&&this.stopSkip()},e.prototype.stopUntilClickSkip=function(){this.skipMode===u.UNTIL_CLICK_WAIT&&this.stopSkip()},e.prototype.stopSkip=function(){this.skipMode=u.INVALID},Object.defineProperty(e.prototype,"autoModeLayer",{get:function(){return this.foreLayers[this.autoModeLayerNum]},enumerable:!0,configurable:!0}),e.prototype.startAutoMode=function(){this.autoModeFlag=!0,this.autoModeStartTick=-1,this.autoModeLayer.visible=!0},e.prototype.stopAutoMode=function(){this.autoModeFlag=!1,this.autoModeStartTick=-1,this.autoModeLayer.visible=!1},e.prototype.reserveAutoClick=function(t){this.autoModeFlag&&(this.autoModeStartTick=t)},e.prototype.initSoundBuffers=function(t){var e=this;null!=t.soundBufferCount&&(this.soundBufferCount=+t.soundBufferCount);for(var n={onStop:function(t){e.onSoundStop(t)},onFadeComplete:function(t){e.onSoundFadeComplete(t)}},r=0;r<this.soundBufferCount;r++)this.soundBuffers.push(new p.SoundBuffer(this.resource,r,n))},e.prototype.getSoundBuffer=function(t){if(null!=this.soundBufferAlias[t])return this.getSoundBuffer(this.soundBufferAlias[t]);var e=this.soundBuffers[+t];if(null==e)throw new Error("音声バッファ"+t+"は範囲外です");return e},e.prototype.onSoundStop=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){return this.conductor.trigger("soundstop"),"onEndEvent"!==t.stopBy||null==t.file&&null==t.label||this.onSoundStopParamsList.push(t),[2]}))}))},e.prototype.onSoundFadeComplete=function(t){this.conductor.trigger("soundfade")},e.prototype.waitSoundCompleteCallback=function(t){this.conductor.clearEventHandlerByName("click"),this.conductor.start()},e.prototype.waitSoundStopClickCallback=function(t){this.conductor.clearEventHandlerByName("soundstop"),t.stop(),this.conductor.start()},e.prototype.waitSoundFadeCompleteCallback=function(t){this.conductor.clearEventHandlerByName("click"),this.conductor.start()},e.prototype.waitSoundFadeClickCallback=function(t){this.conductor.clearEventHandlerByName("soundfade"),t.endFade(),this.conductor.start()},e.prototype.initLayers=function(t){var e=this;[this.forePrimaryLayer,this.backPrimaryLayer].forEach((function(t){t.x=0,t.y=0,t.width=e.width,t.height=e.height,t.visible=!0,t.setBackgroundColor(0,1)}));for(var n=0;n<this.layerCount;n++)this.forePrimaryLayer.addChild(this.createLayer("pageA layer "+n)),this.backPrimaryLayer.addChild(this.createLayer("pageB layer "+n));null!=t.layersDefault&&(this.foreLayers.forEach((function(e){return e.applyConfig(t.layersDefault)})),this.backLayers.forEach((function(e){return e.applyConfig(t.layersDefault)})))},Object.defineProperty(e.prototype,"layerCount",{get:function(){return this._layerCount},set:function(t){if(t<this._layerCount)[this.forePrimaryLayer,this.backPrimaryLayer].forEach((function(e){for(var n=e.children,r=0;r<n.length;r++)r<t?e.addChild(n[r]):n[r].destroy()}));else for(var e=this.forePrimaryLayer.name.substring(0,"pageA layer ".length),n=this.forePrimaryLayer.name.substring(0,"pageB layer ".length),r=this.foreLayers.length;r<t;r++)this.forePrimaryLayer.addChild(this.createLayer(""+e+r)),this.backPrimaryLayer.addChild(this.createLayer(""+n+r));this._layerCount=t},enumerable:!0,configurable:!0}),e.prototype.createLayer=function(t){var e=new y.PonLayer(t,this.resource,this);return e.visible=!1,e},e.prototype.getTargetLayers=function(t,e){var n=this,r=[];if(null==e||""===e||"all"===e)return t;if(-1!==e.indexOf(","))e.split(",").forEach((function(e){n.getTargetLayers(t,e.trim()).forEach((function(t){r.push(t)}))}));else if(-1!==e.indexOf("-")){var i=e.split("-"),o=parseInt(i[0],10),s=parseInt(i[1],10);if(o<0)throw new Error("レイヤ指定が範囲外です");if(s>=this.layerCount)throw new Error("レイヤ指定が範囲外です");for(var a=o;a<=s;a++)r.push(t[a])}else if("mes"===e||"message"===e)r.push(t[this.messageLayerNum]);else if("linebreak"===e)r.push(t[this.lineBreakGlyphLayerNum]);else if("pagebreak"===e)r.push(t[this.pageBreakGlyphLayerNum]);else if("auto"===e||"automode"===e)r.push(t[this.autoModeLayerNum]);else{if(null!=this.layerAlias[e])return this.getTargetLayers(t,this.layerAlias[e]);var u=parseInt(e,10);if(isNaN(u)||u<0||this.layerCount<=u)throw new Error("レイヤー指定が存在しないエイリアスか、または範囲外です("+e+")");r.push(t[u])}return r},e.prototype.getPageLayers=function(t){var e=""+t.page;return null!=t.page&&"current"!==t.page||(e=this.currentPage),"back"===e?this.backLayers:this.foreLayers},e.prototype.getPagePrimaryLayer=function(t){var e=""+t.page;return null!=t.page&&"current"!==t.page||(e=this.currentPage),"back"===e?this.backPrimaryLayer:this.forePrimaryLayer},e.prototype.getLayers=function(t){var e=""+t.lay,n=this.getPageLayers(t),r=this.getTargetLayers(n,e);if(null==t.exclude||""===t.exclude)return r;var i=""+t.exclude,o=this.getTargetLayers(n,i);return r.filter((function(t){return!o.includes(t)}))},Object.defineProperty(e.prototype,"hasMovingLayer",{get:function(){return this.foreLayers.filter((function(t){return t.isMoving&&!t.isLoopMoving})).length>0||this.backLayers.filter((function(t){return t.isMoving&&!t.isLoopMoving})).length>0},enumerable:!0,configurable:!0}),e.prototype.waitMoveClickCallback=function(){this.conductor.clearEventHandlerByName("move"),this.foreLayers.forEach((function(t){return t.stopMove()})),this.backLayers.forEach((function(t){return t.stopMove()})),this.conductor.start()},e.prototype.waitMoveCompleteCallback=function(){this.conductor.clearEventHandlerByName("click"),this.conductor.start()},e.prototype.waitFrameAnimClickCallback=function(t){this.conductor.clearEventHandlerByName("frameanim"),t.forEach((function(t){t.stopFrameAnim()})),this.conductor.start()},e.prototype.waitFrameAnimCompleteCallback=function(t){0===t.filter((function(t){return t.frameAnimRunning})).length&&(this.conductor.clearEventHandlerByName("click"),this.conductor.start())},Object.defineProperty(e.prototype,"hasPlayingVideoLayer",{get:function(){return this.foreLayers.filter((function(t){return t.isPlayingVideo&&!t.isLoopPlayingVideo})).length>0||this.backLayers.filter((function(t){return t.isPlayingVideo&&!t.isLoopPlayingVideo})).length>0},enumerable:!0,configurable:!0}),e.prototype.waitVideoClickCallback=function(){this.conductor.clearEventHandlerByName("move"),this.foreLayers.forEach((function(t){return t.stopVideo()})),this.backLayers.forEach((function(t){return t.stopVideo()})),this.conductor.start()},e.prototype.waitVideoCompleteCallback=function(){this.conductor.clearEventHandlerByName("click"),this.conductor.start()},e.prototype.startQuake=function(t,e,n,r){this.isQuaking=!0,this.quakeStartTick=t,this.quakeTime=e,this.quakeMaxX=n,this.quakeMaxY=r,this.isQuakePhase=!0,this.quakeFrameCount=0},e.prototype.stopQuake=function(){this.isQuaking=!1,this.quakeStartTick=-1,this.quakeTime=0,this.quakeMaxX=20,this.quakeMaxY=20,this.isQuakePhase=!0,this.quakeFrameCount=0,this.foreLayers.forEach((function(t){return t.clearQuake()})),this.backLayers.forEach((function(t){return t.clearQuake()})),this.conductor.trigger("quake")},e.prototype.quake=function(t){var e,n;this.isQuaking&&(this.quakeFrameCount++%this.quakeIntervalFrame==0&&(t-this.quakeStartTick>this.quakeTime?this.stopQuake():(this.quakeMaxY===this.quakeMaxX?(e=Math.floor(Math.random()*this.quakeMaxX*2-this.quakeMaxX),n=Math.floor(Math.random()*this.quakeMaxY*2-this.quakeMaxY)):this.quakeMaxX<this.quakeMaxY?(e=Math.floor(Math.random()*this.quakeMaxX*2-this.quakeMaxX),n=Math.floor((this.isQuakePhase?Math.random():-Math.random())*this.quakeMaxY)):(e=Math.floor((this.isQuakePhase?Math.random():-Math.random())*this.quakeMaxX),n=Math.floor(Math.random()*this.quakeMaxY*2-this.quakeMaxY)),this.foreLayers.forEach((function(t){return t.applyQuake(e,n)})),this.backLayers.forEach((function(t){return t.applyQuake(e,n)})))))},Object.defineProperty(e.prototype,"textSpeed",{get:function(){return this.nowaitModeFlag?0:this.conductor.isPassedLatestSaveMark()?"user"===this.textSpeedMode?this.userReadTextSpeed:this.readTextSpeed:"user"===this.textSpeedMode?this.userUnreadTextSpeed:this.unreadTextSpeed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"messageLayer",{get:function(){return this.foreLayers[this.messageLayerNum]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backMessageLayer",{get:function(){return this.backLayers[this.messageLayerNum]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineBreakGlyphLayer",{get:function(){return this.foreLayers[this.lineBreakGlyphLayerNum]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageBreakGlyphLayer",{get:function(){return this.foreLayers[this.pageBreakGlyphLayerNum]},enumerable:!0,configurable:!0}),e.prototype.showLineBreakGlyph=function(t){this.showBreakGlyph(t,this.lineBreakGlyphLayer,this.lineBreakGlyphPos,this.lineBreakGlyphVerticalAlign,this.lineBreakGlyphX,this.lineBreakGlyphY,this.lineBreakGlyphMarginX,this.lineBreakGlyphMarginY)},e.prototype.showPageBreakGlyph=function(t){this.showBreakGlyph(t,this.pageBreakGlyphLayer,this.pageBreakGlyphPos,this.pageBreakGlyphVerticalAlign,this.pageBreakGlyphX,this.pageBreakGlyphY,this.pageBreakGlyphMarginX,this.pageBreakGlyphMarginY)},e.prototype.showBreakGlyph=function(t,e,n,r,i,o,s,a){this.resetBreakGlyphPos(e,n,r,i,o,s,a),e.hasFrameAnim&&(e.stopFrameAnim(),e.startFrameAnim(t)),e.visible=!0},e.prototype.resetLineBreakGlyphPos=function(){this.resetBreakGlyphPos(this.lineBreakGlyphLayer,this.lineBreakGlyphPos,this.lineBreakGlyphVerticalAlign,this.lineBreakGlyphX,this.lineBreakGlyphY,this.lineBreakGlyphMarginX,this.lineBreakGlyphMarginY)},e.prototype.resetPageBreakGlyphPos=function(){this.resetBreakGlyphPos(this.pageBreakGlyphLayer,this.pageBreakGlyphPos,this.pageBreakGlyphVerticalAlign,this.pageBreakGlyphX,this.pageBreakGlyphY,this.pageBreakGlyphMarginX,this.pageBreakGlyphMarginY)},e.prototype.resetBreakGlyphPos=function(t,e,n,r,i,o,s){var a=this.messageLayer;if("eol"===e){var u=a.getNextTextPos(t.width);t.x=a.x+u.x;var h=a.textCanvas.lineHeight;switch(n){case"bottom":t.y=a.y+(u.y+h)-t.height;break;case"top":t.y=a.y+u.y;break;default:case"middle":t.y=a.y+u.y+(h-t.height)/2;break;case"text-top":t.y=a.y+u.y+h-+a.textCanvas.style.fontSize;break;case"text-middle":var l=u.y+h-+a.textCanvas.style.fontSize;t.y=a.y+l+(+a.textCanvas.style.fontSize-t.height)/2}t.x+=o,t.y+=s}else"relative"===e?(t.x=a.x+r,t.y=a.y+i):"absolute"===e&&(t.x=r,t.y=i)},e.prototype.hideBreakGlyph=function(){this.pageBreakGlyphLayer.visible=!1,this.lineBreakGlyphLayer.visible=!1},e.prototype.hideMessages=function(){this.foreLayers.forEach((function(t){return t.storeVisible()})),this.foreLayers.forEach((function(t){t.autoHideWithMessage&&(t.visible=!1)})),this.messageLayer.visible=!1,this.lineBreakGlyphLayer.visible=!1,this.pageBreakGlyphLayer.visible=!1,this.plugins.forEach((function(t){null!=t.onChangeMessageVisible&&t.onChangeMessageVisible(!1)})),this.hideMessageFlag=!0},e.prototype.showMessages=function(){this.foreLayers.forEach((function(t){t.restoreVisible()})),this.plugins.forEach((function(t){null!=t.onChangeMessageVisible&&t.onChangeMessageVisible(!0)})),this.hideMessageFlag=!1},e.prototype.hideMessagesByRightClick=function(){this.conductor.isStable&&(this.hideMessages(),this.hideMessageByRClickFlag=!0)},e.prototype.showMessagesByRightClick=function(){this.hideMessageByRClickFlag&&(this.showMessages(),this.hideMessageByRClickFlag=!1)},e.prototype.onAddChar=function(t,e){t===this.messageLayer&&this.historyLayer.addHistoryChar(e)},e.prototype.onTextReturn=function(t){t===this.messageLayer&&this.historyLayer.addHistoryTextReturn()},e.prototype.showHistoryLayer=function(){this.historyLayer.goToEnd(),this.historyLayer.show()},e.prototype.hideHistoryLayer=function(){this.historyLayer.hide()},e.prototype.historyTextReturn=function(){this.historyLayer.addHistoryTextReturn()},e.prototype.addTextToHistory=function(t){for(var e=0;e<t.length;e++)this.historyLayer.addHistoryChar(t[e])},e.prototype.backlay=function(t,e){for(var n=this.getLayers({lay:t,page:"fore",exclude:e}),r=this.getLayers({lay:t,page:"back",exclude:e}),i=0;i<n.length;i++)n[i].copyTo(r[i]);this.plugins.forEach((function(t){null!=t.onBacklay&&t.onBacklay()}))},e.prototype.copylay=function(t,e,n,r){var i=this.getLayers({lay:t,page:n}),o=this.getLayers({lay:e,page:r});if(i.length!==o.length)throw new Error("コピー元と先のレイヤ数が異なります(copylay)");for(var s=0;s<i.length;s++)i[s]!==o[s]&&i[s].copyTo(o[s]);this.plugins.forEach((function(t){null!=t.onCopylay&&t.onCopylay(i,o,n,r)}))},e.prototype.flipPrimaryLayers=function(){var e;t.prototype.flipPrimaryLayers.call(this),e=[this.backPrimaryLayer,this.forePrimaryLayer],this.forePrimaryLayer=e[0],this.backPrimaryLayer=e[1],this.plugins.forEach((function(t){null!=t.onFlipLayers&&t.onFlipLayers()})),this.removeForePrimaryLayer(this.historyLayer),this.removeBackPrimaryLayer(this.historyLayer),this.addForePrimaryLayer(this.historyLayer)},e.prototype.onCompleteTrans=function(){return this.currentPage="fore",t.prototype.onCompleteTrans.call(this)},e.prototype.waitTransClickCallback=function(){this.conductor.clearEventHandlerByName("trans"),this.transManager.stop(),this.conductor.start()},e.prototype.waitTransCompleteCallback=function(){this.conductor.clearEventHandlerByName("click"),this.conductor.start()},e.prototype.onWindowClose=function(){return this.saveSystemData(),!0},e.prototype.saveSystemData=function(){var t=this.systemVar,n=this;t.system={},e.ponkanSystemStoreParams.forEach((function(e){t.system[e]=n[e]})),t.soundBuffers=[],this.soundBuffers.forEach((function(e){t.soundBuffers.push(e.storeSystem())})),this.resource.saveSystemData(this.saveDataPrefix)},e.prototype.loadSystemData=function(t){this.resource.loadSystemData(t);var n=this.systemVar,r=this;if(null!=n.system&&(e.ponkanSystemStoreParams.filter((function(t){return-1===e.ponkanSystemStoreIgnoreParams.indexOf(t)})).forEach((function(t){null!=n.system[t]&&(r[t]=n.system[t])})),null!=n.system.scaleMode))switch(n.system.scaleMode){case e.ScaleMode.FULLSCREEN:case e.ScaleMode.FIT:this.scaleMode=e.ScaleMode.FIT;break;case e.ScaleMode.FIXED:null!=n.system._fixedScaleWidth&&null!=n.system._fixedScaleHeight?(this.scaleMode=e.ScaleMode.FIXED,this.setFixedScaleSize(n.system._fixedScaleWidth,n.system._fixedScaleHeight)):this.scaleMode=e.ScaleMode.FIT}null!=n.soundBuffers&&this.soundBuffers.forEach((function(t,e){null!=n.soundBuffers[e]&&t.restoreSystem(n.soundBuffers[e])}))},e.prototype.getSaveDataName=function(t){return this.saveDataPrefix+"_"+t},e.prototype.save=function(t,e){if(l.Logger.debug("SAVE START"),l.Logger.debug(e,this.latestSaveData),0===Object.keys(this.latestSaveData).length)throw new Error("セーブマークを通過していないため、セーブできません");var n;try{n=JSON.stringify(this.latestSaveData)}catch(t){throw l.Logger.error(t),new Error("セーブデータの保存に失敗しました。JSON文字列に変換できません")}this.resource.storeToLocalStorage(this.getSaveDataName(e),n),null==this.systemVar.saveDataInfo&&(this.systemVar.saveDataInfo=[]),this.systemVar.saveDataInfo[e]={isEmpty:!1,date:this.getNowDateStr(),name:this.latestSaveData.name,comment:this.latestSaveData.comment,text:this.latestSaveData.text,screenShot:this.screenShot.getDataUrl()},l.Logger.debug(this.systemVar.saveDataInfo[e]),this.saveSystemData(),l.Logger.debug("SAVE END.")},e.prototype.getNowDateStr=function(){var t=new Date;return t.getFullYear()+"/"+("0"+(t.getMonth()+1)).substring(0,2)+"/"+("0"+t.getDate()).substring(0,2)+" "+("0"+t.getHours()).substring(0,2)+":"+("0"+t.getMinutes()).substring(0,2)+":"+("0"+t.getSeconds()).substring(0,2)},e.prototype.generateSaveData=function(t,n,r){var i={},o=this;return i.tick=r,i.saveMarkName=t,i.comment=n,i.text=this.messageLayer.text,e.ponkanStoreParams.forEach((function(t){i[t]=o[t]})),i.gameVar=f.objClone(this.gameVar),i.conductor=this.conductor.store(t,r),i.forePrimaryLayer=this.forePrimaryLayer.store(r),i.foreLayers=[],this.foreLayers.forEach((function(t){i.foreLayers.push(t.store(r))})),i.backPrimaryLayer=this.backPrimaryLayer.store(r),i.backLayers=[],this.backLayers.forEach((function(t){i.backLayers.push(t.store(r))})),i.historyLayer=this.historyLayer.store(r),i.soundBuffers=[],this.soundBuffers.forEach((function(t){i.soundBuffers.push(t.store(r))})),this.plugins.forEach((function(t){null!=t.onStore&&t.onStore(i,r)})),i},e.prototype.tempSave=function(t,e){var n=""+e;this.tempSaveData[n]=this.generateSaveData("tempsave","tempsave",t),this.tempSaveData[n].gameVar=null},e.prototype.restore=function(t,e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,this.load(t,e)]}))}))},e.prototype.load=function(t,n){return o(this,void 0,void 0,(function(){var r,i,a,u,h=this;return s(this,(function(c){switch(c.label){case 0:return r=this,i=this.resource.restoreFromLocalStorage(this.getSaveDataName(n)),a=JSON.parse(i),l.Logger.debug("LOAD START",a),this.stopDrawLoop(),this.goToMainConductor(),this.mainConductor.stop(),e.ponkanStoreParams.forEach((function(t){r[t]=a[t]})),this.waitUntilStartTick=-1,[4,this.forePrimaryLayer.restore(a.forePrimaryLayer,t,!0)];case 1:return c.sent(),[4,this.backPrimaryLayer.restore(a.backPrimaryLayer,t,!0)];case 2:c.sent(),u=0,c.label=3;case 3:return u<a.foreLayers.length?[4,this.foreLayers[u].restore(a.foreLayers[u],t,!0)]:[3,7];case 4:return c.sent(),[4,this.backLayers[u].restore(a.backLayers[u],t,!0)];case 5:c.sent(),c.label=6;case 6:return u++,[3,3];case 7:return[4,this.historyLayer.restore(a.historyLayer,t,!1)];case 8:c.sent(),this.soundBuffers.forEach((function(t){t.stop()})),u=0,c.label=9;case 9:return u<a.soundBuffers.length?null==this.soundBuffers[u]?[3,11]:[4,this.soundBuffers[u].restore(a.soundBuffers[u],t)]:[3,12];case 10:c.sent(),c.label=11;case 11:return u++,[3,9];case 12:return[4,this.mainConductor.restore(a.conductor,t)];case 13:return c.sent(),null!=a.gameVar&&(this.resource.gameVar=f.objClone(a.gameVar)),this.stopSkip(),this.stopAutoMode(),this.plugins.forEach((function(e){return o(h,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return null==e.onRestore?[3,2]:[4,e.onRestore(a,t,!1,!0,!1)];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))})),this.startDrawLoop(),this.conductor.stop(),l.Logger.debug("LOAD END"),[2]}}))}))},e.prototype.tempLoad=function(t,n,r,i){return void 0===r&&(r=!1),void 0===i&&(i=!1),o(this,void 0,void 0,(function(){var a,u,h,c=this;return s(this,(function(p){switch(p.label){case 0:return a=this,u=this.tempSaveData[""+n],l.Logger.debug(u),this.stopDrawLoop(),e.ponkanStoreParams.forEach((function(t){a[t]=u[t]})),i?[4,this.backPrimaryLayer.restore(u.forePrimaryLayer,t,!1)]:[3,6];case 1:p.sent(),h=0,p.label=2;case 2:return h<u.foreLayers.length?[4,this.backLayers[h].restore(u.foreLayers[h],t,!1)]:[3,5];case 3:p.sent(),p.label=4;case 4:return h++,[3,2];case 5:return[3,13];case 6:return[4,this.forePrimaryLayer.restore(u.forePrimaryLayer,t,!1)];case 7:return p.sent(),[4,this.backPrimaryLayer.restore(u.backPrimaryLayer,t,!1)];case 8:p.sent(),h=0,p.label=9;case 9:return h<u.foreLayers.length?[4,this.foreLayers[h].restore(u.foreLayers[h],t,!1)]:[3,13];case 10:return p.sent(),[4,this.backLayers[h].restore(u.backLayers[h],t,!1)];case 11:p.sent(),p.label=12;case 12:return h++,[3,9];case 13:return[4,this.historyLayer.restore(u.historyLayer,t,!1)];case 14:if(p.sent(),!r)return[3,18];this.soundBuffers.forEach((function(t){t.stop()})),h=0,p.label=15;case 15:return h<u.soundBuffers.length?null==this.soundBuffers[h]?[3,17]:[4,this.soundBuffers[h].restore(u.soundBuffers[h],t)]:[3,18];case 16:p.sent(),p.label=17;case 17:return h++,[3,15];case 18:return this.plugins.forEach((function(e){return o(c,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return e.onRestore?[4,e.onRestore(u,t,!0,r,i)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))})),this.startDrawLoop(),[2]}}))}))},e.prototype.copySaveData=function(t,e){this.resource.copyLocalStorage(this.getSaveDataName(t),this.getSaveDataName(e))},Object.defineProperty(e.prototype,"emptySaveData",{get:function(){return{isEmpty:!0,date:"----/--/-- --:--:--",name:"",comment:"NO DATA",message:"",text:"",screenShot:this.screenShot.nodata}},enumerable:!0,configurable:!0}),e.prototype.deleteSaveData=function(t){delete this.systemVar.saveDataInfo[t],this.resource.storeToLocalStorage(this.getSaveDataName(t),""),this.saveSystemData()},e.prototype.getSaveDataInfo=function(t){if(this.existSaveData(t)){var e=this.systemVar.saveDataInfo[t];null!=e.screenShot&&""!==e.screenShot||(e.screenShot=this.screenShot.nodata);var n=this.emptySaveData;return null==e.date&&(e.date=n.date),null==e.name&&(e.name=n.name),null==e.comment&&(e.comment=n.comment),null==e.message&&(e.message=n.message),null==e.text&&(e.text=n.text),null==e.screenShot&&(e.screenShot=n.screenShot),e}return this.emptySaveData},e.prototype.existSaveData=function(t){return null!=this.systemVar&&null!=this.systemVar.saveDataInfo&&null!=this.systemVar.saveDataInfo[t]},e.prototype.getSaveDataScreenShot=function(t){return this.getSaveDataInfo(t).screenShot},e.prototype.splitStrByLength=function(t,e){var n=[];if(null==t||null==e||e<1)return n;for(var r=0,i=r,o=i+e;i<t.length;)n[r]=t.substring(i,o),r++,o=(i=o)+e;return n},e.ponkanSystemStoreParams=["scaleMode","_fixedScaleWidth","_fixedScaleHeight","autoModeInterval","userReadTextSpeed","userUnreadTextSpeed","canSkipUnreadPart","canSkipUnreadPartByCtrl"],e.ponkanSystemStoreIgnoreParams=["scaleMode","_fixedScaleWidth","_fixedScaleHeight"],e.ponkanStoreParams=["layerCount","currentPage","textSpeedMode","unreadTextSpeed","readTextSpeed","nowaitModeFlag","addCharWithBackFlag","messageLayerNum","lineBreakGlyphLayerNum","lineBreakGlyphPos","lineBreakGlyphVerticalAlign","lineBreakGlyphX","lineBreakGlyphY","lineBreakGlyphMarginX","lineBreakGlyphMarginY","pageBreakGlyphLayerNum","pageBreakGlyphVerticalAlign","pageBreakGlyphPos","pageBreakGlyphX","pageBreakGlyphY","pageBreakGlyphMarginX","pageBreakGlyphMarginY","rightClickJump","rightClickCall","rightClickFilePath","rightClickLabel","rightClickEnabled","enabledHistory","latestSaveComment"],e}(c.PonGame);e.Ponkan=b,t.utils.skipHello(),b.PIXI=t,b.WebFont=n(80),window.Ponkan=b}).call(this,n(9))},function(t,e,n){"use strict";(function(t){var e=n(27),r=n(28),i=n.n(r);
/*!
 * @pixi/polyfill - v5.2.3
 * Compiled Fri, 24 Apr 2020 00:55:22 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
window.Promise||(window.Promise=e.Polyfill),Object.assign||(Object.assign=i.a);var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!o.performance||!o.performance.now){var s=Date.now();o.performance||(o.performance={}),o.performance.now=function(){return Date.now()-s}}for(var a=Date.now(),u=["ms","moz","webkit","o"],h=0;h<u.length&&!o.requestAnimationFrame;++h){var l=u[h];o.requestAnimationFrame=o[l+"RequestAnimationFrame"],o.cancelAnimationFrame=o[l+"CancelAnimationFrame"]||o[l+"CancelRequestAnimationFrame"]}o.requestAnimationFrame||(o.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),n=16+a-e;return n<0&&(n=0),a=e,setTimeout((function(){a=Date.now(),t(performance.now())}),n)}),o.cancelAnimationFrame||(o.cancelAnimationFrame=function(t){return clearTimeout(t)}),Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array),window.Uint8Array||(window.Uint8Array=Array),window.Int32Array||(window.Int32Array=Array)}).call(this,n(14))},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(32),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(14))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,o,s,a,u=1,h={},l=!1,c=t.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(t);p=p&&p.setTimeout?p:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){f(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){f(t.data)},r=function(t){o.port2.postMessage(t)}):c&&"onreadystatechange"in c.createElement("script")?(i=c.documentElement,r=function(t){var e=c.createElement("script");e.onreadystatechange=function(){f(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(f,0,t)}:(s="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(s)&&f(+e.data.slice(s.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),r=function(e){t.postMessage(s+e,"*")}),p.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return h[u]=i,r(u),u++},p.clearImmediate=d}function d(t){delete h[t]}function f(t){if(l)setTimeout(f,0,t);else{var e=h[t];if(e){l=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{d(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(14),n(33))},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var u,h=[],l=!1,c=-1;function p(){l&&u&&(l=!1,u.length?h=u.concat(h):c=-1,h.length&&d())}function d(){if(!l){var t=a(p);l=!0;for(var e=h.length;e;){for(u=h,h=[];++c<e;)u&&u[c].run();c=-1,e=h.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new f(t,e)),1!==h.length||l||a(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){(function(t,r){var i;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(o){e&&e.nodeType,t&&t.nodeType;var s="object"==typeof r&&r;s.global!==s&&s.window!==s&&s.self;var a,u=2147483647,h=/^xn--/,l=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=Math.floor,f=String.fromCharCode;function g(t){throw new RangeError(p[t])}function y(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function m(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),r+y((t=t.replace(c,".")).split("."),e).join(".")}function v(t){for(var e,n,r=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function b(t){return y(t,(function(t){var e="";return t>65535&&(e+=f((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=f(t)})).join("")}function _(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function x(t,e,n){var r=0;for(t=n?d(t/700):t>>1,t+=d(t/e);t>455;r+=36)t=d(t/35);return d(r+36*t/(t+38))}function w(t){var e,n,r,i,o,s,a,h,l,c,p,f=[],y=t.length,m=0,v=128,_=72;for((n=t.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&g("not-basic"),f.push(t.charCodeAt(r));for(i=n>0?n+1:0;i<y;){for(o=m,s=1,a=36;i>=y&&g("invalid-input"),((h=(p=t.charCodeAt(i++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:36)>=36||h>d((u-m)/s))&&g("overflow"),m+=h*s,!(h<(l=a<=_?1:a>=_+26?26:a-_));a+=36)s>d(u/(c=36-l))&&g("overflow"),s*=c;_=x(m-o,e=f.length+1,0==o),d(m/e)>u-v&&g("overflow"),v+=d(m/e),m%=e,f.splice(m++,0,v)}return b(f)}function T(t){var e,n,r,i,o,s,a,h,l,c,p,y,m,b,w,T=[];for(y=(t=v(t)).length,e=128,n=0,o=72,s=0;s<y;++s)(p=t[s])<128&&T.push(f(p));for(r=i=T.length,i&&T.push("-");r<y;){for(a=u,s=0;s<y;++s)(p=t[s])>=e&&p<a&&(a=p);for(a-e>d((u-n)/(m=r+1))&&g("overflow"),n+=(a-e)*m,e=a,s=0;s<y;++s)if((p=t[s])<e&&++n>u&&g("overflow"),p==e){for(h=n,l=36;!(h<(c=l<=o?1:l>=o+26?26:l-o));l+=36)w=h-c,b=36-c,T.push(f(_(c+w%b,0))),h=d(w/b);T.push(f(_(h,0))),o=x(n,m,r==i),n=0,++r}++n,++e}return T.join("")}a={version:"1.4.1",ucs2:{decode:v,encode:b},decode:w,encode:T,toASCII:function(t){return m(t,(function(t){return l.test(t)?"xn--"+T(t):t}))},toUnicode:function(t){return m(t,(function(t){return h.test(t)?w(t.slice(4).toLowerCase()):t}))}},void 0===(i=function(){return a}.call(e,n,e,t))||(t.exports=i)}()}).call(this,n(35)(t),n(14))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,n){"use strict";e.decode=e.parse=n(38),e.encode=e.stringify=n(39)},function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,o){e=e||"&",n=n||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var h=t.length;u>0&&h>u&&(h=u);for(var l=0;l<h;++l){var c,p,d,f,g=t[l].replace(a,"%20"),y=g.indexOf(n);y>=0?(c=g.substr(0,y),p=g.substr(y+1)):(c=g,p=""),d=decodeURIComponent(c),f=decodeURIComponent(p),r(s,d)?i(s[d])?s[d].push(f):s[d]=[s[d],f]:s[d]=f}return s};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,a){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?o(s(t),(function(s){var a=encodeURIComponent(r(s))+n;return i(t[s])?o(t[s],(function(t){return a+encodeURIComponent(r(t))})).join(e):a+encodeURIComponent(r(t[s]))})).join(e):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var s=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.resource=t}return Object.defineProperty(t.prototype,"systemVar",{get:function(){return this.resource.systemVar},enumerable:!0,configurable:!0}),t.prototype.pass=function(t,e){var n=this.systemVar;null==n.trail&&(n.trail={}),null==n.trail[t.filePath]&&(n.trail[t.filePath]={}),null==n.trail[t.filePath][e]?n.trail[t.filePath][e]=1:n.trail[t.filePath][e]++},t.prototype.isPassed=function(t,e){var n=this.systemVar;return null!=n.trail&&null!=n.trail[t.filePath]&&null!=n.trail[t.filePath][e]&&n.trail[t.filePath][e]>0},t.prototype.clear=function(t){var e=this.systemVar;null!=e.trail?e.trail[t.filePath]={}:e.trail={}},t.prototype.clearAll=function(){this.systemVar.trail={}},t}();e.ReadUnread=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),i=n(12);e.default=function(t){return[new r.TagAction(["frameanim","fanim"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("loop","boolean",!1,!1),new r.TagValue("time","number",!0,null),new r.TagValue("width","number",!0,null),new r.TagValue("height","number",!0,null),new r.TagValue("frames","array",!0,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.initFrameAnim(e.loop,e.time,e.width,e.height,e.frames)})),"continue"})),new r.TagAction(["startframeanim","startfanim"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.startFrameAnim(n)})),"continue"})),new r.TagAction(["stopframeanim","stopfanim"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.deleteFrameAnim()})),"continue"})),new r.TagAction(["waitframeanim","waitfanim"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("canskip","boolean",!1,!0)],(function(e,n){var r=t.getLayers(e).filter((function(t){return t.frameAnimRunning&&!t.frameAnimLoop}));return 0===r.length?"continue":t.isSkipping&&e.canskip?(t.waitFrameAnimClickCallback(r),"break"):(e.canskip&&t.conductor.addEventHandler(new i.PonEventHandler("click",(function(){t.waitFrameAnimClickCallback(r)}),"waitframeanim")),t.conductor.addEventHandler(new i.PonEventHandler("frameanim",(function(){t.waitFrameAnimCompleteCallback(r)}),"waitframeanim")),t.conductor.stop())})),new r.TagAction(["startmove","move"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("time","number",!0,null),new r.TagValue("delay","number",!1,0),new r.TagValue("path","array",!0,null),new r.TagValue("type","string",!1,"linear"),new r.TagValue("ease","string",!1,"none"),new r.TagValue("loop","boolean",!1,!1)],(function(e,n){return t.getLayers(e).forEach((function(t){t.startMove(n,e.time,e.delay,e.path,e.type,e.ease,e.loop)})),"continue"})),new r.TagAction(["stopmove"],[new r.TagValue("lay","string",!1,"all"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.stopMove()})),"continue"})),new r.TagAction(["waitmove","wm"],[new r.TagValue("canskip","boolean",!1,!0)],(function(e,n){return t.hasMovingLayer?t.isSkipping&&e.canskip?(t.waitMoveClickCallback(),"break"):(e.canskip&&t.conductor.addEventHandler(new i.PonEventHandler("click",(function(){t.waitMoveClickCallback()}),"waitmove")),t.conductor.addEventHandler(new i.PonEventHandler("move",(function(){t.waitMoveCompleteCallback()}),"waitmove")),t.conductor.stop()):"continue"}))]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8);e.default=function(t){return[new r.TagAction(["textbutton","txtbtn"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("btnname","string",!1,null),new r.TagValue("jump","boolean",!1,!0),new r.TagValue("call","boolean",!1,null),new r.TagValue("file","string",!1,null),new r.TagValue("label","string",!1,null),new r.TagValue("onenter","string",!1,null),new r.TagValue("onleave","string",!1,null),new r.TagValue("onclick","string",!1,null),new r.TagValue("text","string",!1,""),new r.TagValue("x","number",!1,0),new r.TagValue("y","number",!1,0),new r.TagValue("width","number",!0,null),new r.TagValue("height","number",!0,null),new r.TagValue("bgcolors","array",!0,null),new r.TagValue("bgalphas","array",!1,[1,1,1]),new r.TagValue("system","boolean",!1,!1),new r.TagValue("margint","number",!1,0),new r.TagValue("marginr","number",!1,0),new r.TagValue("marginb","number",!1,0),new r.TagValue("marginl","number",!1,0),new r.TagValue("align","string",!1,"center"),new r.TagValue("countpage","boolean",!1,!0),new r.TagValue("enterbuf","string",!1,""),new r.TagValue("leavebuf","string",!1,""),new r.TagValue("clickbuf","string",!1,""),new r.TagValue("keyindex","number",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(n){var r=e.keyindex;null!=r&&null!=r||(r=t.getButtonKeyIndex(e)),n.addTextButton(e.btnname,e.jump,e.call,e.file,e.label,e.countpage,e.onenter,e.onleave,e.onclick,e.text,e.x,e.y,e.width,e.height,e.bgcolors,e.bgalphas,e.system,e.margint,e.marginr,e.marginb,e.marginl,e.align,e.enterbuf,e.leavebuf,e.clickbuf,r)})),"continue"})),new r.TagAction(["textbuttonopt","txtbtnopt"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("btnname","string",!0,null),new r.TagValue("bgcolors","array",!1,null),new r.TagValue("bgalphas","array",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){e.bgcolors&&t.changeTextButtonColors(e.btnname,e.bgcolors),e.bgalphas&&t.changeTextButtonAlphas(e.btnname,e.bgalphas)})),"continue"})),new r.TagAction(["clearbuttons","clearbutton","clearbtn"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.clearTextButtons(),t.clearImageButtons(),t.clearToggleButtons()})),"continue"})),new r.TagAction(["cleartextbuttons","cleartextbutton","cleartxtbtn"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.clearTextButtons()})),"continue"})),new r.TagAction(["imagebutton","imgbtn"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("jump","boolean",!1,!0),new r.TagValue("call","boolean",!1,null),new r.TagValue("file","string",!1,null),new r.TagValue("label","string",!1,null),new r.TagValue("onenter","string",!1,null),new r.TagValue("onleave","string",!1,null),new r.TagValue("onclick","string",!1,null),new r.TagValue("imagefile","string",!0,null),new r.TagValue("x","number",!1,0),new r.TagValue("y","number",!1,0),new r.TagValue("direction","string",!1,"horizontal"),new r.TagValue("system","boolean",!1,!1),new r.TagValue("countpage","boolean",!1,!0),new r.TagValue("enterbuf","string",!1,""),new r.TagValue("leavebuf","string",!1,""),new r.TagValue("clickbuf","string",!1,""),new r.TagValue("keyindex","number",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(n){var r=e.keyindex;null!=r&&null!=r||(r=t.getButtonKeyIndex(e)),n.addImageButton(e.jump,e.call,e.file,e.label,e.countpage,e.onenter,e.onleave,e.onclick,e.imagefile,e.x,e.y,e.direction,e.system,e.enterbuf,e.leavebuf,e.clickbuf,r).then((function(){t.conductor.start()})).catch((function(){t.error(new Error("画像読み込みに失敗しました。("+e.imagefile+")"))}))})),t.conductor.stop()})),new r.TagAction(["clearimagebuttons","clearimagebutton","clearimgbtn"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.clearImageButtons()})),"continue"})),new r.TagAction(["togglebutton","tglbtn"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("statevar","string",!0,null),new r.TagValue("jump","boolean",!1,!0),new r.TagValue("call","boolean",!1,null),new r.TagValue("file","string",!1,null),new r.TagValue("label","string",!1,null),new r.TagValue("onenter","string",!1,null),new r.TagValue("onleave","string",!1,null),new r.TagValue("onclick","string",!1,null),new r.TagValue("imagefile","string",!0,null),new r.TagValue("x","number",!1,0),new r.TagValue("y","number",!1,0),new r.TagValue("direction","string",!1,"horizontal"),new r.TagValue("system","boolean",!1,!1),new r.TagValue("countpage","boolean",!1,!0),new r.TagValue("enterbuf","string",!1,""),new r.TagValue("leavebuf","string",!1,""),new r.TagValue("clickbuf","string",!1,""),new r.TagValue("keyindex","number",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(n){var r=e.keyindex;null!=r&&null!=r||(r=t.getButtonKeyIndex(e)),n.addToggleButton(e.jump,e.call,e.file,e.label,e.countpage,e.onenter,e.onleave,e.onclick,e.imagefile,e.x,e.y,e.direction,e.system,e.enterbuf,e.leavebuf,e.clickbuf,r,e.statevar).then((function(){t.conductor.start()})).catch((function(){t.error(new Error("画像読み込みに失敗しました。("+e.imagefile+")"))}))})),t.conductor.stop()})),new r.TagAction(["cleartogglebuttons","cleartogglebutton","cleartglbtn"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.clearToggleButtons()})),"continue"})),new r.TagAction(["lockbuttons","lockbutton","lock"],[new r.TagValue("lay","string",!1,"all"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.lockButtons()})),"continue"})),new r.TagAction(["unlockbuttons","unlockbutton","unlock"],[new r.TagValue("lay","string",!1,"all"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.unlockButtons()})),"continue"})),new r.TagAction(["locksystembuttons","locksystembutton","locksystem"],[new r.TagValue("lay","string",!1,"all"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.lockSystemButtons()})),"continue"})),new r.TagAction(["unlocksystembuttons","unlocksystembutton","unlocksystem"],[new r.TagValue("lay","string",!1,"all"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.unlockSystemButtons()})),"continue"})),new r.TagAction(["slider"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("x","number",!1,0),new r.TagValue("y","number",!1,0),new r.TagValue("value","number",!1,0),new r.TagValue("onstart","string|function",!1,""),new r.TagValue("onslide","string|function",!1,""),new r.TagValue("onend","string|function",!1,""),new r.TagValue("onchange","string|function",!1,""),new r.TagValue("back","string",!0,null),new r.TagValue("fore","string",!0,null),new r.TagValue("button","string",!0,null),new r.TagValue("keyindex","number",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(n){var r=e.keyindex;null!=r&&null!=r||(r=t.getButtonKeyIndex(e)),n.addSlider(e.x,e.y,e.value,e.onstart,e.onslide,e.onend,e.onchange,e.back,e.fore,e.button,r).then((function(){t.conductor.start()})).catch((function(){t.error(new Error("画像読み込みに失敗しました。("+e.back+")("+e.fore+")("+e.button+")"))}))})),t.conductor.stop()})),new r.TagAction(["locksliders","lockslider"],[new r.TagValue("lay","string",!1,"all"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.lockSliders()})),"continue"})),new r.TagAction(["unlocksliders","unlockslider"],[new r.TagValue("lay","string",!1,"all"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.unlockSliders()})),"continue"})),new r.TagAction(["clearsliders","clearslider"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.clearSliders()})),"continue"}))]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8);e.default=function(t){return[new r.TagAction(["historyopt"],[new r.TagValue("output","boolean",!1,null),new r.TagValue("enabled","boolean",!1,null)],(function(e,n){return null!=e.output&&(t.historyLayer.enableOutput=e.output),null!=e.enabled&&(t.enabledHistory=e.enabled),"continue"})),new r.TagAction(["showhistory","history"],[],(function(e,n){return t.showHistoryLayer(),"continue"})),new r.TagAction(["historych","hch"],[new r.TagValue("text","string",!0,null)],(function(e,n){return t.addTextToHistory(e.text),"continue"})),new r.TagAction(["hbr"],[],(function(e,n){return t.historyTextReturn(),"continue"}))]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8);e.default=function(t){return[new r.TagAction(["clearfilters","clearfilter"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.clearFilters()})),"continue"})),new r.TagAction(["blur"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("blurx","number",!1,4),new r.TagValue("blury","number",!1,4),new r.TagValue("quality","number",!1,4)],(function(e,n){return t.getLayers(e).forEach((function(t){t.addFilter("blur",{blurX:e.blurx,blurY:e.blury,quality:e.quality})})),"continue"})),new r.TagAction(["colorfilter"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("gamma","number",!1,null),new r.TagValue("saturation","number",!1,null),new r.TagValue("contrast","number",!1,null),new r.TagValue("brightness","number",!1,null),new r.TagValue("red","number",!1,null),new r.TagValue("green","number",!1,null),new r.TagValue("blue","number",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.addFilter("color",e)})),"continue"}))]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8);e.default=function(t){return[new r.TagAction(["layalias"],[new r.TagValue("name","string",!0,null),new r.TagValue("lay","string",!0,null)],(function(e,n){return t.layerAlias[e.name]=e.lay,"continue"})),new r.TagAction(["dellayalias"],[new r.TagValue("name","string",!0,null)],(function(e,n){return delete t.layerAlias[e.name],"continue"})),new r.TagAction(["messagelayer","messagelay","meslay"],[new r.TagValue("lay","number",!0,null)],(function(e,n){var r=+e.lay;if(r<0||t.layerCount<=r)throw new Error("メッセージレイヤーの指定が範囲外です");return t.messageLayerNum=r,"continue"})),new r.TagAction(["linebreakglyph","lbglyph"],[new r.TagValue("lay","number",!1,null),new r.TagValue("pos","string",!1,null),new r.TagValue("verticalalign","string",!1,null),new r.TagValue("x","number",!1,null),new r.TagValue("y","number",!1,null),new r.TagValue("marginx","number",!1,null),new r.TagValue("marginy","number",!1,null)],(function(e,n){return null!=e.lay&&(t.lineBreakGlyphLayerNum=e.lay),null!=e.pos&&(t.lineBreakGlyphPos=e.pos),null!=e.verticalalign&&(t.lineBreakGlyphVerticalAlign=e.verticalalign),null!=e.x&&(t.lineBreakGlyphX=e.x),null!=e.y&&(t.lineBreakGlyphY=e.y),null!=e.marginx&&(t.lineBreakGlyphMarginX=e.marginx),null!=e.marginy&&(t.lineBreakGlyphMarginY=e.marginy),"continue"})),new r.TagAction(["pagebreakglyph","pbglyph"],[new r.TagValue("lay","number",!1,null),new r.TagValue("pos","string",!1,null),new r.TagValue("verticalalign","string",!1,null),new r.TagValue("x","number",!1,null),new r.TagValue("y","number",!1,null),new r.TagValue("marginx","number",!1,null),new r.TagValue("marginy","number",!1,null)],(function(e,n){return null!=e.lay&&(t.pageBreakGlyphLayerNum=e.lay),null!=e.pos&&(t.pageBreakGlyphPos=e.pos),null!=e.verticalalign&&(t.pageBreakGlyphVerticalAlign=e.verticalalign),null!=e.x&&(t.pageBreakGlyphX=e.x),null!=e.y&&(t.pageBreakGlyphY=e.y),null!=e.marginx&&(t.pageBreakGlyphMarginX=e.marginx),null!=e.marginy&&(t.pageBreakGlyphMarginY=e.marginy),"continue"})),new r.TagAction(["fillcolor","fill"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("color","number",!0,null),new r.TagValue("alpha","number",!1,1)],(function(e,n){return t.getLayers(e).forEach((function(t){t.setBackgroundColor(e.color,e.alpha)})),"continue"})),new r.TagAction(["clearcolor"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.clearBackgroundColor()})),"continue"})),new r.TagAction(["layopt"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("visible","boolean",!1,null),new r.TagValue("x","number",!1,null),new r.TagValue("y","number",!1,null),new r.TagValue("width","number",!1,null),new r.TagValue("height","number",!1,null),new r.TagValue("alpha","number",!1,1),new r.TagValue("autohide","boolean",!1,null),new r.TagValue("scalex","number",!1,null),new r.TagValue("scaley","number",!1,null),new r.TagValue("ignorequake","boolean",!1,null),new r.TagValue("blocklclick","boolean",!1,null),new r.TagValue("blockrclick","boolean",!1,null),new r.TagValue("blockcclick","boolean",!1,null),new r.TagValue("blockmove","boolean",!1,null),new r.TagValue("blockwheel","boolean",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){null!=e.visible&&(t.visible=e.visible),null!=e.x&&(t.x=e.x),null!=e.y&&(t.y=e.y),null!=e.scalex&&(t.scaleX=e.scalex),null!=e.scaley&&(t.scaleY=e.scaley),null!=e.width&&(t.width=e.width),null!=e.height&&(t.height=e.height),null!=e.alpha&&(t.alpha=e.alpha),null!=e.autohide&&(t.autoHideWithMessage=e.autohide),null!=e.ignorequake&&(t.ignoreQuake=e.ignorequake),null!=e.blocklclick&&(t.blockLeftClickFlag=e.blocklclick),null!=e.blockrclick&&(t.blockRightClickFlag=e.blockrclick),null!=e.blockcclick&&(t.blockCenterClickFlag=e.blockcclick),null!=e.blockmove&&(t.blockMouseMove=e.blockmove),null!=e.blockwheel&&(t.blockWheelFlag=e.blockwheel)})),"continue"})),new r.TagAction(["loadimage","image"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("file","string",!0,null),new r.TagValue("visible","boolean",!1,null),new r.TagValue("x","number",!1,null),new r.TagValue("y","number",!1,null),new r.TagValue("alpha","number",!1,1)],(function(e,n){var r=[];return t.getLayers(e).forEach((function(t){r.push((null!=e.x&&(t.x=e.x),null!=e.y&&(t.y=e.y),null!=e.visible&&(t.visible=e.visible),null!=e.alpha&&(t.alpha=e.alpha),t.loadImage(e.file)))})),Promise.all(r).then((function(){t.conductor.start()})).catch((function(){t.config&&t.config.developMode?t.error(new Error("画像読み込みに失敗しました。("+e.file+")")):t.error(new Error("画像読み込みに失敗しました。"))})),t.conductor.stop()})),new r.TagAction(["loadchildimage","childimage"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("file","string",!0,null),new r.TagValue("x","number",!0,null),new r.TagValue("y","number",!0,null),new r.TagValue("alpha","number",!1,1)],(function(e,n){var r=[];return t.getLayers(e).forEach((function(t){r.push(t.loadChildImage(e.file,e.x,e.y,e.alpha))})),Promise.all(r).then((function(){t.conductor.start()})).catch((function(){t.error(new Error("追加の画像読み込みに失敗しました。"))})),t.conductor.stop()})),new r.TagAction(["freeimage","free","unloadimage"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.freeImage(),t.freeChildImages()})),"continue"})),new r.TagAction(["setlayermask","setlaymask"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("mask","number",!0,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.setMaskSibling(e.mask)})),"continue"})),new r.TagAction(["clearlayermask","clearlaymask"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.clearMaskSibling()})),"continue"}))]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8);e.default=function(t){return[new r.TagAction(["macro"],[new r.TagValue("name","string",!0,null)],(function(e,n){return t.conductor.script.defineMacro(e.name),"continue"})),new r.TagAction(["endmacro"],[],(function(t,e){throw new Error("マクロ定義エラー。macroとendmacroの対応が取れていません")}))]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),i=n(12);e.default=function(t){return[new r.TagAction(["messageopt","mesopt"],[new r.TagValue("lay","string",!1,"message"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("fontfamily","array",!1,null),new r.TagValue("fontsize","number",!1,null),new r.TagValue("fontweight","string",!1,null),new r.TagValue("fontstyle","string",!1,null),new r.TagValue("color","number|array",!1,null),new r.TagValue("gradientstops","array",!1,null),new r.TagValue("gradienttype","string",!1,null),new r.TagValue("margint","number",!1,null),new r.TagValue("marginr","number",!1,null),new r.TagValue("marginb","number",!1,null),new r.TagValue("marginl","number",!1,null),new r.TagValue("pitch","number",!1,null),new r.TagValue("lineheight","number",!1,null),new r.TagValue("linepitch","number",!1,null),new r.TagValue("align","string",!1,null),new r.TagValue("shadow","boolean",!1,null),new r.TagValue("shadowalpha","number",!1,null),new r.TagValue("shadowangle","number",!1,null),new r.TagValue("shadowblur","number",!1,null),new r.TagValue("shadowcolor ","number",!1,null),new r.TagValue("shadowdistance","number",!1,null),new r.TagValue("edgewidth","number",!1,null),new r.TagValue("edgecolor","number",!1,null),new r.TagValue("edgealpha","number",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){null!=e.fontfamily&&(t.textCanvas.style.fontFamily=e.fontfamily),null!=e.fontsize&&(t.textCanvas.style.fontSize=e.fontsize,t.textCanvas.lineHeight<e.fontsize&&(t.textCanvas.lineHeight=e.fontsize)),null!=e.fontweight&&(t.textCanvas.style.fontWeight=e.fontweight),null!=e.fontstyle&&(t.textCanvas.style.fontStyle=e.fontstyle),null!=e.color&&(t.textCanvas.style.fill=e.color),null!=e.gradientstops&&(t.textCanvas.style.fillGradientStops=e.gradientstops),null!=e.gradienttype&&t.textCanvas.style.setGradientType(e.gradienttype),null!=e.margint&&(t.textCanvas.marginTop=e.margint),null!=e.marginr&&(t.textCanvas.marginRight=e.marginr),null!=e.marginb&&(t.textCanvas.marginBottom=e.marginb),null!=e.marginl&&(t.textCanvas.marginLeft=e.marginl),null!=e.pitch&&(t.textCanvas.style.pitch=e.pitch),null!=e.lineheight&&(t.textCanvas.lineHeight=e.lineheight),null!=e.linepitch&&(t.textCanvas.linePitch=e.linepitch),null!=e.align&&(t.textCanvas.align=e.align),null!=e.shadow&&(t.textCanvas.style.dropShadow=e.shadow),null!=e.shadowalpha&&(t.textCanvas.style.dropShadowAlpha=e.shadowalpha),null!=e.shadowangle&&(t.textCanvas.style.dropShadowAngle=e.shadowangle),null!=e.shadowblur&&(t.textCanvas.style.dropShadowBlur=e.shadowblur),null!=e.shadowcolor&&(t.textCanvas.style.dropShadowColor=e.shadowcolor),null!=e.shadowdistance&&(t.textCanvas.style.dropShadowDistance=e.shadowdistance),null!=e.edgewidth&&(t.textCanvas.style.strokeThickness=e.edgewidth),null!=e.edgecolor&&(t.textCanvas.style.edgeColor=e.edgecolor),null!=e.edgealpha&&(t.textCanvas.style.edgeAlpha=e.edgealpha)})),"continue"})),new r.TagAction(["chineffect"],[new r.TagValue("lay","string",!1,"message"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("type","string|array",!1,null),new r.TagValue("time","number",!1,null),new r.TagValue("ease","string",!1,"none"),new r.TagValue("offsetx","number",!1,null),new r.TagValue("offsety","number",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){null!=e.type&&(t.textCanvas.style.inEffectTypes=e.type),null!=e.time&&(t.textCanvas.style.inEffectTime=e.time),null!=e.ease&&(t.textCanvas.style.inEffectEase=e.ease),t.textCanvas.style.inEffectOptions={offsetx:e.offsetx,offsety:e.offsety}})),"continue"})),new r.TagAction(["ch"],[new r.TagValue("lay","string",!1,"message"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("text","string",!0,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.addChar(e.text)})),"fore"===e.page&&t.addCharWithBackFlag&&(e.page="back",t.getLayers(e).forEach((function(t){t.addChar(e.text)}))),t.isSkipping||0===t.textSpeed?"continue":t.conductor.sleep(n,t.textSpeed,"ch")})),new r.TagAction(["ruby"],[new r.TagValue("lay","string",!1,"message"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("text","string",!1,null)],(function(e,n){return null!=e.text&&t.getLayers(e).forEach((function(t){t.reserveRubyText(e.text)})),"continue"})),new r.TagAction(["rubyopt"],[new r.TagValue("lay","string",!1,"message"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("offset","number",!1,null),new r.TagValue("fontfamily","array",!1,null),new r.TagValue("fontsize","number",!1,null),new r.TagValue("fontweight","string",!1,null),new r.TagValue("fontstyle","string",!1,null),new r.TagValue("color","number|array",!1,null),new r.TagValue("gradientstops","array",!1,null),new r.TagValue("gradienttype","string",!1,null),new r.TagValue("pitch","number",!1,null),new r.TagValue("shadow","boolean",!1,null),new r.TagValue("shadowalpha","number",!1,null),new r.TagValue("shadowangle","number",!1,null),new r.TagValue("shadowblur","number",!1,null),new r.TagValue("shadowcolor ","number",!1,null),new r.TagValue("shadowdistance","number",!1,null),new r.TagValue("edgewidth","number",!1,null),new r.TagValue("edgecolor","number",!1,null),new r.TagValue("edgealpha","number",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){null!=e.offset&&(t.textCanvas.rubyOffset=e.offset),null!=e.fontfamily&&(t.textCanvas.rubyStyle.fontFamily=e.fontfamily),null!=e.fontsize&&(t.textCanvas.rubyStyle.fontSize=e.fontsize),null!=e.fontweight&&(t.textCanvas.rubyStyle.fontWeight=e.fontweight),null!=e.fontstyle&&(t.textCanvas.rubyStyle.fontStyle=e.fontstyle),null!=e.color&&(t.textCanvas.rubyStyle.fill=e.color),null!=e.gradientstops&&(t.textCanvas.rubyStyle.fillGradientStops=e.gradientstops),null!=e.gradienttype&&t.textCanvas.rubyStyle.setGradientType(e.gradienttype),null!=e.pitch&&(t.textCanvas.rubyStyle.pitch=e.pitch),null!=e.shadow&&(t.textCanvas.rubyStyle.dropShadow=e.shadow),null!=e.shadowalpha&&(t.textCanvas.rubyStyle.dropShadowAlpha=e.shadowalpha),null!=e.shadowangle&&(t.textCanvas.rubyStyle.dropShadowAngle=e.shadowangle),null!=e.shadowblur&&(t.textCanvas.rubyStyle.dropShadowBlur=e.shadowblur),null!=e.shadowcolor&&(t.textCanvas.rubyStyle.dropShadowColor=e.shadowcolor),null!=e.shadowdistance&&(t.textCanvas.rubyStyle.dropShadowDistance=e.shadowdistance),null!=e.edgewidth&&(t.textCanvas.rubyStyle.strokeThickness=e.edgewidth),null!=e.edgecolor&&(t.textCanvas.rubyStyle.edgeColor=e.edgecolor),null!=e.edgealpha&&(t.textCanvas.rubyStyle.edgeAlpha=e.edgealpha)})),"continue"})),new r.TagAction(["br"],[new r.TagValue("lay","string",!1,"message"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.addTextReturn()})),"continue"})),new r.TagAction(["clear","c"],[new r.TagValue("lay","string",!1,"message"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.clearText()})),"continue"})),new r.TagAction(["textspeed"],[new r.TagValue("mode","string",!1,null),new r.TagValue("unread","number",!1,null),new r.TagValue("read","number",!1,null),new r.TagValue("sysunread","number",!1,null),new r.TagValue("sysread","number",!1,null)],(function(e,n){return null!=e.move&&(t.textSpeedMode=e.mode),null!=e.unread&&(t.userUnreadTextSpeed=e.unread),null!=e.read&&(t.userReadTextSpeed=e.read),null!=e.sysunread&&(t.unreadTextSpeed=e.sysunread),null!=e.sysread&&(t.readTextSpeed=e.sysread),"continue"})),new r.TagAction(["nowait"],[],(function(e,n){return t.nowaitModeFlag=!0,"continue"})),new r.TagAction(["endnowait"],[],(function(e,n){return t.nowaitModeFlag=!1,"continue"})),new r.TagAction(["textlocate","locate"],[new r.TagValue("lay","string",!1,"message"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("x","number",!1,null),new r.TagValue("y","number",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.setCharLocate(e.x,e.y)})),"continue"})),new r.TagAction(["indent"],[new r.TagValue("lay","string",!1,"message"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("history","boolean",!1,!0)],(function(e,n){return t.getLayers(e).forEach((function(t){t.setIndentPoint()})),e.history&&t.historyLayer.setHistoryIndentPoint(),"continue"})),new r.TagAction(["endindent"],[new r.TagValue("lay","string",!1,"message"),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("history","boolean",!1,!0)],(function(e,n){return t.getLayers(e).forEach((function(t){t.clearIndentPoint()})),e.history&&t.historyLayer.clearHistoryIndentPoint(),"continue"})),new r.TagAction(["linebreak","lb","l"],[],(function(e,n){return t.stopUntilClickSkip(),t.isSkipping?(t.showLineBreakGlyph(n),t.hideBreakGlyph(),"break"):(t.showLineBreakGlyph(n),t.conductor.addEventHandler(new i.PonEventHandler("click",(function(){t.conductor.start(),t.hideBreakGlyph()}),"lb")),t.reserveAutoClick(n),t.conductor.stop())})),new r.TagAction(["pagebreak","pb","p"],[],(function(e,n){return t.stopUntilClickSkip(),t.historyTextReturn(),t.isSkipping?(t.showPageBreakGlyph(n),t.hideBreakGlyph(),"break"):(t.showPageBreakGlyph(n),t.conductor.addEventHandler(new i.PonEventHandler("click",(function(){t.conductor.start(),t.hideBreakGlyph()}),"pb")),t.reserveAutoClick(n),t.conductor.stop())})),new r.TagAction(["hidemessages"],[],(function(e,n){return t.hideMessages(),t.conductor.addEventHandler(new i.PonEventHandler("click",(function(){t.conductor.start(),t.showMessages()}),"hidemessages")),t.conductor.stop()}))]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8);e.default=function(t){return[new r.TagAction(["save"],[new r.TagValue("num","number",!0,null)],(function(e,n){return t.save(n,e.num),"continue"})),new r.TagAction(["load"],[new r.TagValue("num","number",!0,null)],(function(e,n){return t.load(n,e.num).then((function(){t.conductor.start()})).catch((function(t){throw console.error(t),new Error("セーブデータのロードに失敗しました("+e.num+")")})),t.conductor.stop()})),new r.TagAction(["tempsave"],[new r.TagValue("num","number",!0,null)],(function(e,n){return t.tempSave(n,e.num),"continue"})),new r.TagAction(["tempload"],[new r.TagValue("num","number",!0,null),new r.TagValue("sound","boolean",!1,!1),new r.TagValue("toback","boolean",!1,!1)],(function(e,n){return t.tempLoad(n,e.num,e.sound,e.toback).then((function(){t.conductor.start()})).catch((function(n){console.error(n),t.error(new Error("セーブデータのロードに失敗しました("+e.num+")"))})),t.conductor.stop()})),new r.TagAction(["lockscreenshot"],[],(function(e,n){return t.lockScreenShot(),"continue"})),new r.TagAction(["unlockscreenshot"],[],(function(e,n){return t.unlockScreenShot(),"continue"})),new r.TagAction(["copysavedata","copysave"],[new r.TagValue("srcnum","number",!0,null),new r.TagValue("destnum","number",!0,null)],(function(e,n){return t.copySaveData(e.srcnum,e.destnum),"continue"})),new r.TagAction(["deletesavedata","delsavedata","delsave"],[new r.TagValue("num","number",!0,null)],(function(e,n){return t.deleteSaveData(e.num),"continue"}))]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),i=n(12);e.default=function(t){return[new r.TagAction(["s"],[],(function(e,n){return t.conductor.passLatestSaveMark(),t.conductor.stop(),t.stopSkip(),"break"})),new r.TagAction(["jump"],[new r.TagValue("file","string",!1,null),new r.TagValue("label","string",!1,null),new r.TagValue("countpage","boolean",!1,!0)],(function(e,n){return null==e.file&&null==e.label?"continue":(t.conductor.jump(e.file,e.label,e.countpage).then((function(){t.conductor.start()})),t.conductor.stop())})),new r.TagAction(["call"],[new r.TagValue("file","string",!1,null),new r.TagValue("label","string",!1,null),new r.TagValue("countpage","boolean",!1,!1)],(function(e,n){return null==e.file&&null==e.label?"continue":(t.callSubroutine(e.file,e.label,e.countpage).then((function(){t.conductor.start()})),t.conductor.stop())})),new r.TagAction(["return"],[new r.TagValue("forcestart","boolean",!1,!1),new r.TagValue("countpage","boolean",!1,!0)],(function(e,n){return t.returnSubroutine(e.forcestart,e.countpage)})),new r.TagAction(["if"],[new r.TagValue("exp","string",!0,null)],(function(e,n){return t.conductor.script.ifJump(e.exp,t.tagActions),"continue"})),new r.TagAction(["elseif","elsif"],[],(function(e,n){return t.conductor.script.elsifJump(),"continue"})),new r.TagAction(["else"],[],(function(e,n){return t.conductor.script.elseJump(),"continue"})),new r.TagAction(["endif"],[],(function(e,n){return t.conductor.script.endif(),"continue"})),new r.TagAction(["for"],[new r.TagValue("loops","number",!0,null),new r.TagValue("indexvar","string",!1,"__index__")],(function(e,n){return t.conductor.script.startForLoop(e.loops,e.indexvar),"continue"})),new r.TagAction(["endfor"],[],(function(e,n){return t.conductor.script.endForLoop(),"continue"})),new r.TagAction(["breakfor"],[],(function(e,n){return t.conductor.script.breakForLoop(),"continue"})),new r.TagAction(["startskip","skip"],[],(function(e,n){return t.startSkipByTag(),"continue"})),new r.TagAction(["stopskip"],[],(function(e,n){return t.stopSkip(),"continue"})),new r.TagAction(["startautomode","startauto","auto"],[],(function(e,n){return t.startAutoMode(),"continue"})),new r.TagAction(["stopautomode","stopauto"],[],(function(e,n){return t.stopAutoMode(),"continue"})),new r.TagAction(["automodeopt","autoopt"],[new r.TagValue("lay","number",!1,null),new r.TagValue("time","number",!1,null)],(function(e,n){return e.lay&&(t.autoModeLayerNum=e.lay),e.time&&(t.autoModeInterval=e.time),"continue"})),new r.TagAction(["wait"],[new r.TagValue("time","number",!0,null),new r.TagValue("canskip","boolean",!1,!0)],(function(e,n){return t.isSkipping&&e.canskip?"continue":(e.canskip&&t.conductor.addEventHandler(new i.PonEventHandler("click",(function(){t.conductor.start(),t.stopUntilClickSkip()}),"wait")),t.conductor.sleep(n,e.time,"wait"))})),new r.TagAction(["waituntil"],[new r.TagValue("time","number",!0,null),new r.TagValue("canskip","boolean",!1,!0)],(function(e,n){if(t.waitUntilTime=0,t.isSkipping&&e.canskip)return"continue";if(-1==t.waitUntilStartTick)return"continue";var r=Date.now(),o=r-t.waitUntilStartTick;return o>=e.time?"continue":(e.canskip&&t.conductor.addEventHandler(new i.PonEventHandler("click",(function(){t.conductor.start(),t.stopUntilClickSkip()}),"waituntil")),t.waitUntilTime=e.time-o,t.conductor.sleep(r,t.waitUntilTime,"wait"))})),new r.TagAction(["resetwait"],[],(function(e,n){return t.waitUntilStartTick=Date.now(),"continue"})),new r.TagAction(["waitclick"],[new r.TagValue("canskip","boolean",!1,!0)],(function(e,n){return t.stopUntilClickSkip(),t.isSkipping&&e.canskip?"continue":(t.conductor.addEventHandler(new i.PonEventHandler("click",(function(){t.conductor.start()}),"waitclick")),t.autoModeFlag&&e.canskip&&t.reserveAutoClick(n),t.conductor.stop())}))]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),i=n(12);e.default=function(t){return[new r.TagAction(["bufalias"],[new r.TagValue("name","string",!0,null),new r.TagValue("buf","string",!0,null)],(function(e,n){return t.soundBufferAlias[e.name]=e.buf,"continue"})),new r.TagAction(["delbufalias"],[new r.TagValue("name","string",!0,null)],(function(e,n){return delete t.soundBufferAlias[e.name],"continue"})),new r.TagAction(["loadsound","sound"],[new r.TagValue("buf","string",!0,null),new r.TagValue("file","string",!0,null)],(function(e,n){return t.getSoundBuffer(e.buf).loadSound(e.file).then((function(e){t.conductor.start()})).catch((function(){t.error(new Error("音声のロードに失敗しました("+e.file+")"))})),t.conductor.stop()})),new r.TagAction(["freesound","unloadsound"],[new r.TagValue("buf","string",!0,null)],(function(e,n){return t.getSoundBuffer(e.buf).freeSound(),"continue"})),new r.TagAction(["soundopt"],[new r.TagValue("buf","string",!0,null),new r.TagValue("volume","number",!1,null),new r.TagValue("gvolume","number",!1,null),new r.TagValue("seek","number",!1,null),new r.TagValue("loop","boolean",!1,null)],(function(e,n){var r=t.getSoundBuffer(e.buf);return null!=e.volume&&(r.volume=e.volume),null!=e.gvolume&&(r.gvolume=e.gvolume),null!=e.seek&&(r.seek=e.seek),null!=e.loop&&(r.loop=e.loop),"continue"})),new r.TagAction(["setsoundstop"],[new r.TagValue("buf","string",!0,null),new r.TagValue("jump","boolean",!1,!0),new r.TagValue("call","boolean",!1,!1),new r.TagValue("file","string",!1,null),new r.TagValue("label","string",!1,null)],(function(e,n){var r=t.getSoundBuffer(e.buf);return null!=e.jump&&(r.onStopJump=e.jump),null!=e.call&&(r.onStopCall=e.call),null!=e.file&&(r.onStopFile=e.file),null!=e.label&&(r.onStopLabel=e.label),"continue"})),new r.TagAction(["playsound"],[new r.TagValue("buf","string",!0,null)],(function(e,n){return t.getSoundBuffer(e.buf).play(),"continue"})),new r.TagAction(["stopsound"],[new r.TagValue("buf","string",!0,null)],(function(e,n){return t.getSoundBuffer(e.buf).stop("tag"),"continue"})),new r.TagAction(["fadesound"],[new r.TagValue("buf","string",!0,null),new r.TagValue("volume","number",!0,null),new r.TagValue("time","number",!0,null),new r.TagValue("autostop","boolean",!1,!1)],(function(e,n){return t.getSoundBuffer(e.buf).fade(e.volume,e.time,e.autostop),"continue"})),new r.TagAction(["fadeoutsound","fadeout"],[new r.TagValue("buf","string",!0,null),new r.TagValue("time","number",!0,null),new r.TagValue("autostop","boolean",!1,!0)],(function(e,n){return t.getSoundBuffer(e.buf).fadeout(e.time,e.autostop),"continue"})),new r.TagAction(["fadeinsound","fadein"],[new r.TagValue("buf","string",!0,null),new r.TagValue("volume","number",!0,null),new r.TagValue("time","number",!0,null)],(function(e,n){return t.getSoundBuffer(e.buf).fadein(e.volume,e.time),"continue"})),new r.TagAction(["waitsoundstop","waitsound"],[new r.TagValue("buf","string",!0,null),new r.TagValue("canskip","boolean",!1,!0)],(function(e,n){var r=t.getSoundBuffer(e.buf);return!r.playing||r.loop?"continue":t.isSkipping&&e.canskip?(t.waitSoundStopClickCallback(r),"continue"):(e.canskip&&t.conductor.addEventHandler(new i.PonEventHandler("click",(function(){t.waitSoundStopClickCallback(r)}),"waitsoundstop")),t.conductor.addEventHandler(new i.PonEventHandler("soundstop",(function(){t.waitSoundCompleteCallback(r)}),"waitsoundstop")),t.conductor.stop())})),new r.TagAction(["waitsoundfade","waitfade"],[new r.TagValue("buf","string",!0,null),new r.TagValue("canskip","boolean",!1,!0)],(function(e,n){var r=t.getSoundBuffer(e.buf);return r.fading?t.isSkipping&&e.canskip?(t.waitSoundFadeClickCallback(r),"continue"):(e.canskip&&t.conductor.addEventHandler(new i.PonEventHandler("click",(function(){t.waitSoundFadeClickCallback(r)}),"waitsoundfade")),t.conductor.addEventHandler(new i.PonEventHandler("soundfade",(function(){t.waitSoundFadeCompleteCallback(r)}),"waitsoundfade")),t.conductor.stop()):"continue"})),new r.TagAction(["endfadesound","endfade"],[new r.TagValue("buf","string",!0,null)],(function(e,n){return t.getSoundBuffer(e.buf).endFade(),"continue"}))]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),i=n(12);e.default=function(t){return[new r.TagAction(["laycount"],[new r.TagValue("count","number",!0,null)],(function(e,n){return t.layerCount=e.count,"continue"})),new r.TagAction(["raiseerror"],[new r.TagValue("unknowncommand","boolean",!1,null)],(function(e,n){return null!=e.unknowncommand&&(t.raiseError.unknowncommand=e.unknowncommand),"continue"})),new r.TagAction(["dumpdebuginfo"],[],(function(e,n){return t.dumpDebugInfo(),"continue"})),new r.TagAction(["lockgame"],[],(function(e,n){return t.lock(),"break"})),new r.TagAction(["unlockgame"],[],(function(e,n){return t.unlock(),"break"})),new r.TagAction(["clearsysvar"],[],(function(e,n){return t.resource.systemVar={},"continue"})),new r.TagAction(["cleargamevar"],[],(function(e,n){return t.resource.gameVar={},"continue"})),new r.TagAction(["cleartmpvar"],[],(function(e,n){return t.resource.tmpVar={},"continue"})),new r.TagAction(["savesysvar"],[],(function(e,n){return t.saveSystemData(),"continue"})),new r.TagAction(["clickskipopt","clickskip"],[new r.TagValue("enabled","boolean",!0,null)],(function(e,n){return t.clickSkipEnabled=e.enabled,"continue"})),new r.TagAction(["quake"],[new r.TagValue("time","number",!0,null),new r.TagValue("x","number",!1,20),new r.TagValue("y","number",!1,20)],(function(e,n){return t.startQuake(n,e.time,e.x,e.y),"continue"})),new r.TagAction(["stopquake"],[],(function(e,n){return t.stopQuake(),"continue"})),new r.TagAction(["waitquake"],[new r.TagValue("canskip","boolean",!1,!0)],(function(e,n){return t.isQuaking?t.isSkipping&&e.canskip?(t.stopQuake(),"break"):(e.canskip&&t.conductor.addEventHandler(new i.PonEventHandler("click",(function(){t.stopQuake(),t.conductor.start()}),"waitquake")),t.conductor.addEventHandler(new i.PonEventHandler("quake",(function(){t.conductor.start()}),"waitquake")),t.conductor.stop()):"continue"})),new r.TagAction(["rightclick","rclick"],[new r.TagValue("jump","boolean",!1,null),new r.TagValue("call","boolean",!1,null),new r.TagValue("file","string",!1,null),new r.TagValue("label","string",!1,null),new r.TagValue("enabled","boolean",!1,null)],(function(e,n){return null!=e.jump&&(t.rightClickJump=e.jump),null!=e.call&&(t.rightClickCall=e.call),null!=e.file&&(t.rightClickFilePath=e.file),null!=e.label&&(t.rightClickLabel=e.label),null!=e.enabled&&(t.rightClickEnabled=e.enabled),"continue"})),new r.TagAction(["commandshortcut","cmdsc"],[new r.TagValue("ch","string",!0,null),new r.TagValue("command","string",!0,null)],(function(e,n){return t.addCommandShortcut(e.ch,e.command),"continue"})),new r.TagAction(["delcommandshortcut","delcmdsc"],[new r.TagValue("ch","string",!0,null)],(function(e,n){return t.delCommandShortcut(e.ch),"continue"}))]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),i=n(12);e.default=function(t){return[new r.TagAction(["backlay"],[new r.TagValue("lay","string",!1,"all"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.backlay(e.lay,e.exclude),"continue"})),new r.TagAction(["copylay"],[new r.TagValue("srclay","number",!0,null),new r.TagValue("destlay","number",!0,null),new r.TagValue("srcpage","string",!1,"fore"),new r.TagValue("destpage","string",!1,"fore")],(function(e,n){return t.copylay(e.srclay,e.destlay,e.srcpage,e.destpage),"continue"})),new r.TagAction(["currentpage"],[new r.TagValue("page","string",!0,null)],(function(e,n){return t.currentPage=e.page,"continue"})),new r.TagAction(["preparetrans","pretrans"],[],(function(e,n){return t.backlay("all",null),t.currentPage="back","continue"})),new r.TagAction(["trans"],[new r.TagValue("time","number",!0,null),new r.TagValue("method","string",!1,"crossfade"),new r.TagValue("rule","string",!1,""),new r.TagValue("vague","number",!1,.25)],(function(e,n){return e.time<=0?(t.flip(),t.onCompleteTrans(),"continue"):"univ"===e.method?(t.transManager.initUnivTrans(e.time,e.rule,e.vague).then((function(){t.transManager.start(),t.conductor.start()})).catch((function(n){console.error(n),t.error(new Error("トランジションの処理に失敗しました。("+e.method+", "+e.rule+")"))})),t.conductor.stop()):(t.transManager.initTrans(e.time,e.method).then((function(){t.transManager.start(),t.conductor.start()})).catch((function(n){console.error(n),t.error(new Error("トランジションの処理に失敗しました。("+e.method+")"))})),t.conductor.stop())})),new r.TagAction(["stoptrans"],[],(function(e,n){return t.transManager.isRunning?(t.transManager.stop(),"continue"):"continue"})),new r.TagAction(["waittrans","wt"],[new r.TagValue("canskip","boolean",!1,!0)],(function(e,n){return t.transManager.isRunning?t.isSkipping&&e.canskip?(t.waitTransClickCallback(),"break"):(e.canskip&&t.conductor.addEventHandler(new i.PonEventHandler("click",(function(){t.waitTransClickCallback()}),"waittrans")),t.conductor.addEventHandler(new i.PonEventHandler("trans",(function(){t.waitTransCompleteCallback()}),"waittrans")),t.conductor.stop()):"continue"})),new r.TagAction(["flip"],[],(function(e,n){return t.flip(),t.onCompleteTrans(),"continue"}))]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),i=n(12);e.default=function(t){return[new r.TagAction(["loadvideo","video"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("file","string",!0,null),new r.TagValue("width","number",!0,null),new r.TagValue("height","number",!0,null),new r.TagValue("autoplay","boolean",!1,!0),new r.TagValue("loop","boolean",!1,!1),new r.TagValue("volume","number",!1,1),new r.TagValue("visible","boolean",!1,null),new r.TagValue("x","number",!1,null),new r.TagValue("y","number",!1,null),new r.TagValue("alpha","number",!1,1)],(function(e,n){var r=[];return t.getLayers(e).forEach((function(t){r.push((null!=e.x&&(t.x=e.x),null!=e.y&&(t.y=e.y),null!=e.visible&&(t.visible=e.visible),null!=e.alpha&&(t.alpha=e.alpha),t.loadVideo(e.file,e.width,e.height,e.autoplay,e.loop,e.volume)))})),Promise.all(r).then((function(){t.conductor.start()})).catch((function(n){console.error(n),t.error(new Error("動画読み込みに失敗しました。("+e.file+")"))})),t.conductor.stop()})),new r.TagAction(["freevideo"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.freeVideo()})),"continue"})),new r.TagAction(["videoopt"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null),new r.TagValue("volume","number",!1,null),new r.TagValue("loop","boolean",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){null!=e.volume&&(t.videoVolume=e.volume),null!=e.loop&&(t.videoLoop=e.loop)})),"continue"})),new r.TagAction(["playvideo"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.playVideo()})),"continue"})),new r.TagAction(["pausevideo"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exclude","string",!1,null)],(function(e,n){return t.getLayers(e).forEach((function(t){t.pauseVideo()})),"continue"})),new r.TagAction(["stopvideo"],[new r.TagValue("lay","string",!0,null),new r.TagValue("exclude","string",!1,null),new r.TagValue("page","string",!1,"current")],(function(e,n){return t.getLayers(e).forEach((function(t){t.stopVideo()})),"continue"})),new r.TagAction(["waitvideo"],[new r.TagValue("canskip","boolean",!1,!0)],(function(e,n){return t.hasPlayingVideoLayer?t.isSkipping&&e.canskip?(t.waitVideoClickCallback(),"break"):(e.canskip&&t.conductor.addEventHandler(new i.PonEventHandler("click",(function(){t.waitVideoClickCallback()}),"waitvideo")),t.conductor.addEventHandler(new i.PonEventHandler("video",(function(){t.waitVideoCompleteCallback()}),"waitvideo")),t.conductor.stop()):"continue"}))]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this.tagPoint=0,this.params={},this.name=t,this.tags=e}return t.prototype.clone=function(){var e=[];return this.tags.forEach((function(t){e.push(t.clone())})),new t(this.name,e)},t.prototype.getCurrentTag=function(){return this.tags.length<=this.tagPoint?null:this.tags[this.tagPoint]},t.prototype.getNextTag=function(){return this.tags.length<=this.tagPoint?null:this.tags[this.tagPoint++]},t.prototype.clearTagPoint=function(){this.tagPoint=0},t}();e.Macro=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(11),i=n(18),o=function(){function t(t,e){this.lines=[],this.currentLineNum=0,this.saveMarkCount=0,this._tags=[],this.labelMap={},this.saveMarkMap={},this.resource=t,this.scriptText=e,this.currentLineNum=0,this.saveMarkCount=0,this.lines=this.scriptText.split(/\r\n|\n|\r/g),this.parse()}return Object.defineProperty(t.prototype,"tags",{get:function(){return this._tags},enumerable:!0,configurable:!0}),t.prototype.debugPrint=function(){this.tags.forEach((function(t){t.debugPrint()}))},t.prototype.getLine=function(){return this.currentLineNum<this.lines.length?this.lines[this.currentLineNum++].replace(/^[ \t]+|[ \t]+$/g,""):null},t.prototype.getLineWithoutTrim=function(){return this.currentLineNum<this.lines.length?this.lines[this.currentLineNum++]:null},t.prototype.getLabelPos=function(t){return Object.prototype.hasOwnProperty.call(this.labelMap,t)?this.labelMap[t]:-1},t.prototype.getSaveMarkPos=function(t){return Object.prototype.hasOwnProperty.call(this.saveMarkMap,t)?this.saveMarkMap[t]:-1},t.prototype.parse=function(){for(;;){var t=this.getLine();if(null===t)break;if(""!==t){var e=t.charAt(0),n=t.substring(1).trim();if("---"===t){for(var r="";;){var i=this.getLineWithoutTrim();if(null===i||"---"===i.trim())break;r+=i+"\n"}this.addTag("__js__",{__body__:r,print:!1})}else switch(e){case"#":break;case";":this.parseCommand(n);break;case"*":this.parseLabel(n);break;case"~":this.parseSaveMark(n);break;case"-":this.parseJs(n);break;case"=":this.parseJsPrint(n);break;default:this.parseText(t)}}else this.currentLineNum<this.lines.length&&this.addLinebreak()}this.addTag("s",{__body__:"s"})},t.prototype.parseCommand=function(t){try{var e=void 0,n=void 0,i=void 0,o=/[{ ]/.exec(t);if(null==o)e=t.substring(0).trim(),i={};else{if(e=t.substring(0,o.index).trim(),0!==(n=t.substring(o.index).trim()).indexOf("{"))n="{"+n+"}";else{for(console.log("valuesStr",n);";"!==n[n.length-1];){var s=this.getLine();if(null===s)break;n+=" "+s.trim()}n=n.substring(0,n.length-1)}i=this.resource.evalJs("("+n+")")}i.__body__=t,this.addTag(e,i)}catch(e){throw r.Logger.error(e),console.error(t),new Error("コマンド行の文法エラーです(行:"+this.currentLineNum+")")}},t.prototype.parseLabel=function(t){Object.prototype.hasOwnProperty.call(this.labelMap,t)||(this.labelMap[t]=this._tags.length),this.addTag("__label__",{__body__:t})},t.prototype.parseSaveMark=function(t){var e=t.indexOf("|");if(-1!==e){var n=t.substring(0,e),r=t.substring(e+1);null!=n&&0!=n.length||(n="__save_mark_"+this.saveMarkCount+"__"),Object.prototype.hasOwnProperty.call(this.saveMarkMap,n)||(this.saveMarkMap[n]=this._tags.length),this.addTag("__save_mark__",{__body__:t,name:n,comment:r})}else if(t.length>0){var i="__save_mark_"+this.saveMarkCount+"__";Object.prototype.hasOwnProperty.call(this.saveMarkMap,i)||(this.saveMarkMap[i]=this._tags.length),this.addTag("__save_mark__",{__body__:t,name:i,comment:t})}else{var o="__save_mark_"+this.saveMarkCount+"__";Object.prototype.hasOwnProperty.call(this.saveMarkMap,o)||(this.saveMarkMap[o]=this._tags.length),this.addTag("__save_mark__",{__body__:t,name:o,comment:""})}this.saveMarkCount++},t.prototype.parseJs=function(t){this.addTag("__js__",{__body__:t,print:!1})},t.prototype.parseJsPrint=function(t){this.addTag("__js__",{__body__:t,print:!0})},t.prototype.parseText=function(t){for(var e=0;e<t.length;e++){var n=t.charAt(e);""!==n&&this.addTag("ch",{__body__:n,text:n})}this.addLinebreak()},t.prototype.addLinebreak=function(){this.addTag("__line_break__",{__body__:"\n"})},t.prototype.addTag=function(t,e){this._tags.push(new i.Tag(t,e,this.currentLineNum-1))},t}();e.ScriptParser=o},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o,s=n(24),a=n(11),u=n(57),h=n(19),l=n(58),c=n(59),p=n(60),d=n(62),f=n(63);!function(t){t[t.FIXED=0]="FIXED",t[t.FIT=1]="FIT",t[t.FULLSCREEN=2]="FULLSCREEN"}(o=e.ScaleMode||(e.ScaleMode={}));var g=function(){function t(t,e){void 0===e&&(e={}),this.eventHandlers={},this.config={},this.isLocked=!1,this.updateLoopFlag=!1,this.drawLoopFlag=!1,this.updateLoopTimer=null,this.drawLoopTimer=null,this.fpsPreTick=0,this.fpsCount=0,this.fps=0,this._scaleModeBuffer=o.FIT,this._scaleMode=o.FIT,this._fixedScaleWidth=800,this._fixedScaleHeight=450,this.conductorStack=[],this.forePrimaryLayers=[],this.backPrimaryLayers=[],this.updateScreenShotFlag=!0;var n=document.getElementById(t);if(null==n)throw new Error("Not found HTMLElement: "+t);this.parentElm=n,this.config=e,null!=e.width&&null!=e.height||(e.width=800,e.height=450),this.renderer=new l.PonRenderer(n,e.width,e.height),n.style.position="relative",n.style.display="block",n.style.padding="0",this.renderer.canvasElm.style.display="block",this.renderer.canvasElm.className="ponkan-scale-target",this.resource=new p.Resource(this,e.gameDataDir,e.gameVersion),this.resource.enableResourceCache=!e.developMode,this.transManager=new f.TransManager(this,this.resource),this.screenShot=new d.ScreenShot(e),this.initWindowScale(),this.initWindowEvent(),this.initMouseEventOnCanvas(this.renderer.canvasElm),this.initKeyboardEvent(),this.conductorStack.push(new s.Conductor(this.resource,"Main Conductor",this))}return Object.defineProperty(t.prototype,"width",{get:function(){return this.renderer.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.renderer.height},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.stop(),this.renderer.destroy(),this.removeEvents()},t.prototype.start=function(){this.stop(),this.startUpdateLoop(),this.startDrawLoop()},t.prototype.startUpdateLoop=function(){var t=this;this.updateLoopFlag=!0,this.updateLoopTimer=window.setTimeout((function(){t.updateLoop()}),0)},t.prototype.startDrawLoop=function(){var t=this;this.fpsPreTick=Date.now(),this.drawLoopFlag=!0,window.setTimeout((function(){t.drawLoop()}),60)},t.prototype.stop=function(){this.stopUpdateLoop(),this.stopDrawLoop()},t.prototype.stopUpdateLoop=function(){this.updateLoopFlag=!1,null!=this.updateLoopTimer&&(window.clearTimeout(this.updateLoopTimer),this.updateLoopTimer=null)},t.prototype.stopDrawLoop=function(){this.fpsPreTick=0,this.fpsCount=0,this.fps=0,this.drawLoopFlag=!1,null!=this.drawLoopTimer&&(window.cancelAnimationFrame(this.drawLoopTimer),this.drawLoopTimer=null)},t.prototype.lock=function(t){void 0===t&&(t=!0),this.isLocked=!0,t&&this.conductor.stop()},t.prototype.unlock=function(t){void 0===t&&(t=!0),this.isLocked=!1,t&&this.conductor.start()},t.prototype.initWindowScale=function(){var t=this;this._fixedScaleWidth=this.config.width,this._fixedScaleHeight=this.config.height;var e=null;window.addEventListener("resize",(function(){null!=e&&window.clearTimeout(e),e=window.setTimeout((function(){t.onWindowResize()}),100)})),this.onWindowResize(),window.addEventListener("fullscreenchange",(function(){t.onFullscreenChange()})),window.addEventListener("fullscreenerror",(function(){t.onFullscreenChange()}))},Object.defineProperty(t.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){this._scaleModeBuffer=this._scaleMode,this._scaleMode=t,this._scaleMode===o.FULLSCREEN?this.isFullscreen||this.requestFullscreen():this.isFullscreen&&this.cancelFullscreen(),this.onWindowResize()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFullscreen",{get:function(){var t=window.document;return null!=(t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement)},enumerable:!0,configurable:!0}),t.prototype.requestFullscreen=function(){var t=window.document.documentElement,e=t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen||t.msRequestFullscreen;e&&e.call(t)},t.prototype.cancelFullscreen=function(){var t=window.document,e=t.exitFullscreen||t.mozCancelFullScreen||t.webkitExitFullscreen||t.msExitFullscreen;e&&e.call(t)},t.prototype.onFullscreenChange=function(){this.isFullscreen&&this.scaleMode!==o.FULLSCREEN?this.scaleMode=o.FULLSCREEN:this.isFullscreen||this.scaleMode!==o.FULLSCREEN||(this.scaleMode=this._scaleModeBuffer)},Object.defineProperty(t.prototype,"fixedScaleWidth",{get:function(){return this._fixedScaleWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fixedScaleHeight",{get:function(){return this._fixedScaleHeight},enumerable:!0,configurable:!0}),t.prototype.setFixedScaleSize=function(t,e){this._fixedScaleWidth=t,this._fixedScaleHeight=e,this.scaleMode=o.FIXED,window.electron&&window.electron.setContentSize(t,e)},t.prototype.onWindowResize=function(){this.setCanvasScale(0,0);var t=1,e=1;switch(this.scaleMode){case o.FIXED:this.parentElm.clientWidth>=this.fixedScaleWidth&&this.parentElm.clientHeight>=this.fixedScaleHeight?(t=this.fixedScaleWidth/this.config.width,e=this.fixedScaleHeight/this.config.height):t=e=this.getFitScale(),this.setCanvasScale(t,e);break;case o.FIT:case o.FULLSCREEN:t=e=this.getFitScale(),this.setCanvasScale(t,e)}},t.prototype.getFitScale=function(){return Math.min(this.parentElm.clientWidth/this.config.width,this.parentElm.clientHeight/this.config.height)},t.prototype.setCanvasScale=function(t,e){var n=this.config.width*t,r=this.config.height*e,i="scale("+t+","+e+")",o=(this.parentElm.clientWidth-n)/2+"px",s=(this.parentElm.clientHeight-r)/2+"px";document.querySelectorAll(".ponkan-scale-target").forEach((function(t){null!=t.style&&(t.style.position="absolute",t.style.transform=i,t.style["transform-origin"]="0 0",t.style.left=o,t.style.top=s)}))},t.prototype.updateLoop=function(){var t=this;try{if(!this.updateLoopFlag)return;var e=Date.now();this.update(e),this.updateLoopTimer=window.setTimeout((function(){return t.updateLoop()}),1)}catch(t){console.error(t),this.error(t)}},t.prototype.drawLoop=function(){var t=this;try{if(!this.drawLoopFlag)return;var e=Date.now();e-this.fpsPreTick>=1e3&&(this.fps=this.fpsCount,this.fpsPreTick=e,this.fpsCount=0),this.beforeDraw(e),this.transManager.isRunning?this.transManager.draw(e):this.renderer.draw(),this.afterDraw(e),this.updateScreenShotFlag&&this.screenShot.draw(this.renderer.canvasElm),this.fpsCount++,this.drawLoopTimer=window.requestAnimationFrame((function(){return t.drawLoop()}))}catch(t){console.error(t),this.error(t)}},t.prototype.update=function(t){},t.prototype.beforeDraw=function(t){},t.prototype.afterDraw=function(t){},t.prototype.error=function(t){a.Logger.error(t),alert(t.message)},Object.defineProperty(t.prototype,"conductor",{get:function(){return this.conductorStack[this.conductorStack.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mainConductor",{get:function(){return this.conductorStack[0]},enumerable:!0,configurable:!0}),t.prototype.callSubroutine=function(t,e,n){return void 0===e&&(e=null),void 0===n&&(n=!1),r(this,void 0,void 0,(function(){var r;return i(this,(function(i){return null==t&&(t=this.conductor.script.filePath),r=new s.Conductor(this.resource,"Sub Conductor "+this.conductorStack.length,this),this.conductorStack.push(r),[2,this.conductor.jump(t,e,n)]}))}))},t.prototype.returnSubroutine=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!0),1===this.conductorStack.length)throw new Error("returnで戻れませんでした。callとreturnの対応が取れていません");if(e&&this.conductor.passLatestSaveMark(),this.conductorStack.pop(),this.onReturnSubroutin(t),t){var n=this.conductor.script.getLatestTag();null!=n&&"s"!==n.name&&(this.conductor.clearAllEventHandler(),this.conductor.start())}return this.conductor.trigger("return_subroutin"),this.onChangeStable(this.conductor.isStable),"break"},t.prototype.goToMainConductor=function(){for(;this.conductorStack.length>1;){var t=this.conductorStack.pop();null!=t&&t.stop()}},t.prototype.onTag=function(t,e,n){return"continue"},t.prototype.onLabel=function(t,e,n){return"continue"},t.prototype.onSaveMark=function(t,e,n,r){return"continue"},t.prototype.onJs=function(t,e,n,r){return"continue"},t.prototype.onChangeStable=function(t){},t.prototype.onReturnSubroutin=function(t){void 0===t&&(t=!1)},t.prototype.onError=function(t){this.error(t)},t.prototype.addForePrimaryLayer=function(t){return this.forePrimaryLayers.push(t),this.renderer.addToFore(t.container),t},t.prototype.addBackPrimaryLayer=function(t){return this.backPrimaryLayers.push(t),this.renderer.addToBack(t.container),t},t.prototype.removeForePrimaryLayer=function(t){this.forePrimaryLayers=this.forePrimaryLayers.filter((function(e){return e!==t})),this.renderer.removeFromFore(t.container)},t.prototype.removeBackPrimaryLayer=function(t){this.backPrimaryLayers=this.backPrimaryLayers.filter((function(e){return e!==t})),this.renderer.removeFromBack(t.container)},t.prototype.flip=function(){this.flipPrimaryLayers(),this.resetPrimaryLayersRenderer()},t.prototype.flipPrimaryLayers=function(){var t=this.forePrimaryLayers;this.forePrimaryLayers=this.backPrimaryLayers,this.backPrimaryLayers=t},t.prototype.resetPrimaryLayersRenderer=function(){var t=this;this.forePrimaryLayers.forEach((function(t){t.container.parent.removeChild(t.container)})),this.backPrimaryLayers.forEach((function(t){t.container.parent.removeChild(t.container)})),this.forePrimaryLayers.forEach((function(e){t.renderer.addToFore(e.container)})),this.backPrimaryLayers.forEach((function(e){t.renderer.addToBack(e.container)}))},t.prototype.lockScreenShot=function(){this.updateScreenShotFlag=!1},t.prototype.unlockScreenShot=function(){this.updateScreenShotFlag=!0},t.prototype.onCompleteTrans=function(){return this.conductor.trigger("trans"),!0},t.prototype.initWindowEvent=function(){var t=this,e=this.eventHandlers.window={};window.addEventListener("unload",e.unload=function(){t.onWindowClose()}),window.addEventListener("beforeunload",e.beforeunload=function(){t.onWindowClose()})},t.prototype.onWindowClose=function(){return!0},t.prototype.removeEvents=function(){var t=this;null!=this.eventHandlers&&Object.keys(this.eventHandlers).forEach((function(e){var n;n=t.eventHandlers[e],Object.keys(n).forEach((function(t){window.removeEventListener(t,n[t])}))}))},t.prototype.initMouseEventOnCanvas=function(t){var e=this,n=this.eventHandlers.mouse={};t.addEventListener("mouseenter",n.mouseenter=function(t){try{if(t.preventDefault(),e.isLocked)return!0;e.onMouseEnter(new h.PonMouseEvent(t))}catch(t){e.error(t)}return!0}),t.addEventListener("mouseleave",n.mouseleave=function(t){try{return t.preventDefault(),e.isLocked?!0:(e.onMouseLeave(new h.PonMouseEvent(t)),!0)}catch(t){return e.error(t),!0}}),t.addEventListener("wheel",n.wheel=function(t){try{if(t.preventDefault(),e.isLocked)return!0;e.onMouseWheel(new c.PonWheelEvent(t))}catch(t){e.error(t)}return!0}),t.addEventListener("click",n.click=function(t){return t.preventDefault(),!0}),t.addEventListener("contextmenu",n.contextmenu=function(t){return t.preventDefault(),!0}),"ontouchmove"in t?t.addEventListener("touchmove",n.touchmove=function(t){try{if(t.preventDefault(),e.isLocked)return!0;e.onMouseMove(e.convertTouchEventToMouseEvent(t))}catch(t){e.error(t)}return!0}):t.addEventListener("mousemove",n.mousemove=function(t){try{if(t.preventDefault(),e.isLocked)return!0;e.onMouseMove(new h.PonMouseEvent(t))}catch(t){e.error(t)}return!0}),"ontouchstart"in t?t.addEventListener("touchstart",n.touchstart=function(t){try{if(t.preventDefault(),e.isLocked)return!0;e.onMouseDown(e.convertTouchEventToMouseEvent(t))}catch(t){e.error(t)}return!0}):t.addEventListener("mousedown",n.mousedown=function(t){try{if(t.preventDefault(),e.isLocked)return!0;e.onMouseDown(new h.PonMouseEvent(t))}catch(t){e.error(t)}return!0}),"ontouchend"in t?t.addEventListener("touchend",n.touchend=function(t){t.preventDefault();try{if(e.isLocked)return!0;e.onMouseUp(e.convertTouchEventToMouseEvent(t))}catch(t){e.error(t)}return!0}):t.addEventListener("mouseup",n.mouseup=function(t){t.preventDefault();try{if(e.isLocked)return!0;e.onMouseUp(new h.PonMouseEvent(t))}catch(t){e.error(t)}return!0})},t.prototype.convertTouchEventToMouseEvent=function(t){var e=t.changedTouches[t.changedTouches.length-1],n=e.pageX-e.target.offsetLeft,r=e.pageY-e.target.offsetTop,i=this.getFitScale();n/=i,r/=i;try{return new h.PonMouseEvent(Math.floor(n),Math.floor(r),0)}catch(t){return this.error(t),new h.PonMouseEvent(-1,-1,0)}},t.prototype.onMouseEnter=function(t){},t.prototype.onMouseLeave=function(t){},t.prototype.onMouseMove=function(t){},t.prototype.onMouseDown=function(t){},t.prototype.onMouseUp=function(t){},t.prototype.onMouseWheel=function(t){return!0},t.prototype.initKeyboardEvent=function(){var t=this,e=this.eventHandlers.keyboard={};window.addEventListener("keydown",e.keydown=function(e){try{if(t.isLocked)return;t.onKeyDown(new u.PonKeyEvent(e))}catch(e){t.error(e)}}),window.addEventListener("keyup",e.keyup=function(e){try{if(t.isLocked)return;t.onKeyUp(new u.PonKeyEvent(e))}catch(e){t.error(e)}})},t.prototype.onKeyDown=function(t){return!0},t.prototype.onKeyUp=function(t){return!0},t.ScaleMode=o,t.Logger=a.Logger,t}();e.PonGame=g},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.e=t}return Object.defineProperty(t.prototype,"key",{get:function(){return this.e.key},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ctrl",{get:function(){return this.e.ctrlKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shift",{get:function(){return this.e.shiftKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alt",{get:function(){return this.e.altKey},enumerable:!0,configurable:!0}),t}();e.PonKeyEvent=r},function(t,e,n){"use strict";var r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(9)),o=function(){function t(t,e,n){this._width=e,this._height=n,this.parentElm=t;var r=new i.Renderer({width:this._width,height:this._height,backgroundColor:4278190080});this.renderer=r,t.appendChild(this.renderer.view),this._sprite=i.Sprite.from(this.renderer.view),this._texture=this._sprite.texture,this._sprite.width=e,this._sprite.height=n,this._canvasElm=this.renderer.view,this.primaryContainer=new i.Container,this.foreContainer=new i.Container,this.backContainer=new i.Container,this.backContainer.visible=!1,this.primaryContainer.addChild(this.backContainer),this.primaryContainer.addChild(this.foreContainer)}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvasElm",{get:function(){return this._canvasElm},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sprite",{get:function(){return this._sprite},enumerable:!0,configurable:!0}),t.prototype.createContainer=function(t,e){var n=new i.Container,r=new i.Sprite(i.Texture.WHITE);return r.width=t,r.height=e,n.addChild(r),n.mask=r,n},t.prototype.destroy=function(){this.foreContainer.destroy(),this.backContainer.destroy(),this.parentElm.removeChild(this.renderer.view),this.renderer.destroy()},t.prototype.draw=function(){null!=this.renderer&&this.renderer.render(this.primaryContainer)},t.prototype.addToFore=function(t){this.foreContainer.addChild(t)},t.prototype.addToBack=function(t){this.backContainer.addChild(t)},t.prototype.removeFromFore=function(t){this.foreContainer.removeChild(t)},t.prototype.removeFromBack=function(t){this.backContainer.removeChild(t)},t.prototype.setBackVisible=function(t){this.backContainer.visible=t},t}();e.PonRenderer=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.deltaX=t.deltaX,this.deltaY=t.deltaY}return Object.defineProperty(t.prototype,"isUp",{get:function(){return this.deltaY<=0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDown",{get:function(){return this.deltaY>0},enumerable:!0,configurable:!0}),t}();e.PonWheelEvent=r},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},__generator=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},__importStar=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(exports,"__esModule",{value:!0});var howler_1=__webpack_require__(61),logger_1=__webpack_require__(11),script_1=__webpack_require__(25),PIXI=__importStar(__webpack_require__(9)),Util=__importStar(__webpack_require__(13)),Resource=function(){function Resource(t,e,n){void 0===e&&(e="./gamedata"),void 0===n&&(n="0.0.0"),this.gameVersion="",this.enableResourceCache=!0,this.tmpVar={},this.gameVar={},this.systemVar={saveDataInfo:[]},this.enabledScriptCache=!0,this.scriptCache={},this.cursor={disabled:"auto",normal:"auto",over:"pointer",on:"pointer"},this.macroInfo={},this.macroParams=null,this.commandShortcut={},this.ponGame=t,this.basePath=this.fixPath(e),this.gameVersion=n,howler_1.Howler.usingWebAudio=!0,this.bufferCanvas=document.createElement("canvas"),this.bufferCanvas.width=t.width,this.bufferCanvas.height=t.height;var r=this.bufferCanvas.getContext("2d");if(null===r)throw new Error("Canvasの初期化に失敗しました。");this.bufferCanvasContext=r}return Resource.prototype.getCanvasElm=function(){return this.ponGame.renderer.canvasElm},Resource.prototype.saveSystemData=function(t){try{logger_1.Logger.debug("==SYSTEM SAVE======================================"),logger_1.Logger.debug(this.systemVar),logger_1.Logger.debug("==================================================="),this.storeToLocalStorage(t+"_sys",JSON.stringify(this.systemVar))}catch(t){throw logger_1.Logger.error(t),new Error("セーブデータの保存に失敗しました。JSON文字列に変換できません")}},Resource.prototype.loadSystemData=function(t){try{var e=this.restoreFromLocalStorage(t+"_sys");null!=e&&Util.objExtend(this.systemVar,JSON.parse(e)),logger_1.Logger.debug("==SYSTEM LOAD======================================"),logger_1.Logger.debug(this.systemVar),logger_1.Logger.debug("===================================================")}catch(t){throw logger_1.Logger.error(t),new Error("システムデータのロードに失敗しました")}},Resource.prototype.existSystemData=function(t){try{return null!=this.restoreFromLocalStorage(t+"_sys")}catch(t){return!1}},Resource.prototype.debugClearSystemData=function(){var t=this;Object.keys(this.systemVar).forEach((function(e){delete t.systemVar[e]}))},Resource.prototype.evalJs=function(js){var ponkan=this.ponGame,tv=this.tmpVar,gv=this.gameVar,sv=this.systemVar,mp=this.macroParams;return function(){return eval(js)}()},Resource.prototype.setMacroParams=function(t){this.macroParams=t},Resource.prototype.clearMacroParams=function(){this.macroParams=null},Resource.prototype.clearMacroInfo=function(){var t=this;Object.keys(this.macroInfo).forEach((function(e){return delete t.macroInfo[e]}))},Resource.prototype.fixPath=function(t){return"/"===t[t.length-1]?t.substring(0,t.length-1):t},Resource.prototype.getPath=function(t){if(t.match(/^http:\/\/|^https:\/\//))return t;var e=this.basePath+"/"+t;return this.enableResourceCache?e+="?v="+this.gameVersion:e+="?x="+Math.random().toString(36).slice(-8),e},Resource.prototype.hasMacro=function(t){return null!=this.macroInfo[t]},Resource.prototype.getMacro=function(t){return this.macroInfo[t]},Resource.prototype.loadText=function(t){return __awaiter(this,void 0,void 0,(function(){var e=this;return __generator(this,(function(n){return[2,new Promise((function(n,r){var i=new XMLHttpRequest;i.onload=function(){200<=i.status&&i.status<300?(logger_1.Logger.debug("AJAX SUCCESS: ",i),n(i.responseText)):(logger_1.Logger.debug("AJAX FAILED: ",i),r(i.statusText))},i.open("GET",e.getPath(t),!0),i.overrideMimeType("text/plain; charset=UTF-8"),i.send()}))]}))}))},Resource.prototype.loadScript=function(t){return __awaiter(this,void 0,void 0,(function(){var e,n,r;return __generator(this,(function(i){switch(i.label){case 0:return this.enableResourceCache&&this.enabledScriptCache&&null!=this.scriptCache[t]?[2,this.scriptCache[t].clone()]:[3,1];case 1:return i.trys.push([1,3,,4]),[4,this.loadText(t)];case 2:return e=i.sent(),n=new script_1.Script(this,t,e),this.enabledScriptCache?(this.scriptCache[t]=n,[2,n.clone()]):[2,n];case 3:throw r=i.sent(),logger_1.Logger.error(r),"string"==typeof r?new Error(r):r;case 4:return[2]}}))}))},Resource.prototype.loadImage=function(t){return __awaiter(this,void 0,void 0,(function(){var e=this;return __generator(this,(function(n){return[2,new Promise((function(n,r){var i=e.getPath(t),o=new Image,s=!1;o.onload=function(){s=!0,n(o)},o.onerror=function(){s||r(o)},0===t.indexOf("data:image/")?o.src=t:o.src=i}))]}))}))},Resource.prototype.loadSoundHowler=function(t){var e=this;return new Promise((function(n,r){var i=new howler_1.Howl({src:[e.getPath(t)],loop:!0,volume:1,autoplay:!1,onload:function(){n(i)},onloaderror:function(){r(i)}})}))},Resource.prototype.loadVideoTexture=function(t,e){var n=this.getPath(t),r=PIXI.Texture.from(n,{scaleMode:PIXI.SCALE_MODES.NEAREST});return r.baseTexture.resource.autoPlay=e,r},Resource.prototype.cloneVideoTexture=function(t){var e=t.baseTexture.resource.source;return PIXI.Texture.from(e)},Resource.prototype.isEnabledLocalStorage=function(){return null!=window.localStorage},Resource.prototype.storeToLocalStorage=function(t,e){try{window.localStorage.setItem(t,e)}catch(t){throw new Error("ストレージが満杯のため保存できませんでした")}},Resource.prototype.restoreFromLocalStorage=function(t){var e=window.localStorage.getItem(t);if(null!=e)return e;throw new Error("ストレージ"+t+"にはデータがありません")},Resource.prototype.copyLocalStorage=function(t,e){try{var n=this.restoreFromLocalStorage(t);return this.storeToLocalStorage(e,n),!0}catch(t){return!1}},Resource}();exports.Resource=Resource},function(t,e,n){(function(n){var r;
/*!
 *  howler.js v2.1.3
 *  howlerjs.com
 *
 *  (c) 2013-2019, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */!function(){"use strict";var i=function(){this.init()};i.prototype={init:function(){var t=this||o;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var e=this||o;if(t=parseFloat(t),e.ctx||d(),void 0!==t&&t>=0&&t<=1){if(e._volume=t,e._muted)return e;e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t,o.ctx.currentTime);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var r=e._howls[n]._getSoundIds(),i=0;i<r.length;i++){var s=e._howls[n]._soundById(r[i]);s&&s._node&&(s._node.volume=s._volume*t)}return e}return e._volume},mute:function(t){var e=this||o;e.ctx||d(),e._muted=t,e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t?0:e._volume,o.ctx.currentTime);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var r=e._howls[n]._getSoundIds(),i=0;i<r.length;i++){var s=e._howls[n]._soundById(r[i]);s&&s._node&&(s._node.muted=!!t||s._muted)}return e},unload:function(){for(var t=this||o,e=t._howls.length-1;e>=0;e--)t._howls[e].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,d()),t},codecs:function(t){return(this||o)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||o;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(t){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||o,e=null;try{e="undefined"!=typeof Audio?new Audio:null}catch(e){return t}if(!e||"function"!=typeof e.canPlayType)return t;var n=e.canPlayType("audio/mpeg;").replace(/^no$/,""),r=t._navigator&&t._navigator.userAgent.match(/OPR\/([0-6].)/g),i=r&&parseInt(r[0].split("/")[1],10)<33;return t._codecs={mp3:!(i||!n&&!e.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!e.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!e.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(e.canPlayType("audio/x-mp4;")||e.canPlayType("audio/mp4;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!e.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(e.canPlayType("audio/x-flac;")||e.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||o;if(!t._audioUnlocked&&t.ctx){t._audioUnlocked=!1,t.autoUnlock=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var e=function(n){for(var r=0;r<t.html5PoolSize;r++)try{var i=new Audio;i._unlocked=!0,t._releaseHtml5Audio(i)}catch(n){t.noAudio=!0}for(r=0;r<t._howls.length;r++)if(!t._howls[r]._webAudio)for(var o=t._howls[r]._getSoundIds(),s=0;s<o.length;s++){var a=t._howls[r]._soundById(o[s]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}t._autoResume();var u=t.ctx.createBufferSource();u.buffer=t._scratchBuffer,u.connect(t.ctx.destination),void 0===u.start?u.noteOn(0):u.start(0),"function"==typeof t.ctx.resume&&t.ctx.resume(),u.onended=function(){u.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",e,!0),document.removeEventListener("touchend",e,!0),document.removeEventListener("click",e,!0);for(var n=0;n<t._howls.length;n++)t._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",e,!0),document.addEventListener("touchend",e,!0),document.addEventListener("click",e,!0),t}},_obtainHtml5Audio:function(){var t=this||o;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var e=(new Audio).play();return e&&"undefined"!=typeof Promise&&(e instanceof Promise||"function"==typeof e.then)&&e.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(t){var e=this||o;return t._unlocked&&e._html5AudioPool.push(t),e},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&o.usingWebAudio){for(var e=0;e<t._howls.length;e++)if(t._howls[e]._webAudio)for(var n=0;n<t._howls[e]._sounds.length;n++)if(!t._howls[e]._sounds[n]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout((function(){t.autoSuspend&&(t._suspendTimer=null,t.state="suspending",t.ctx.suspend().then((function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())})))}),3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&o.usingWebAudio)return"running"===t.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state?(t.ctx.resume().then((function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")})),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var o=new i,s=function(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")};s.prototype={init:function(t){var e=this;return o.ctx||d(),e._autoplay=t.autoplay||!1,e._format="string"!=typeof t.format?t.format:[t.format],e._html5=t.html5||!1,e._muted=t.mute||!1,e._loop=t.loop||!1,e._pool=t.pool||5,e._preload="boolean"!=typeof t.preload||t.preload,e._rate=t.rate||1,e._sprite=t.sprite||{},e._src="string"!=typeof t.src?t.src:[t.src],e._volume=void 0!==t.volume?t.volume:1,e._xhrWithCredentials=t.xhrWithCredentials||!1,e._duration=0,e._state="unloaded",e._sounds=[],e._endTimers={},e._queue=[],e._playLock=!1,e._onend=t.onend?[{fn:t.onend}]:[],e._onfade=t.onfade?[{fn:t.onfade}]:[],e._onload=t.onload?[{fn:t.onload}]:[],e._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],e._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],e._onpause=t.onpause?[{fn:t.onpause}]:[],e._onplay=t.onplay?[{fn:t.onplay}]:[],e._onstop=t.onstop?[{fn:t.onstop}]:[],e._onmute=t.onmute?[{fn:t.onmute}]:[],e._onvolume=t.onvolume?[{fn:t.onvolume}]:[],e._onrate=t.onrate?[{fn:t.onrate}]:[],e._onseek=t.onseek?[{fn:t.onseek}]:[],e._onunlock=t.onunlock?[{fn:t.onunlock}]:[],e._onresume=[],e._webAudio=o.usingWebAudio&&!e._html5,void 0!==o.ctx&&o.ctx&&o.autoUnlock&&o._unlockAudio(),o._howls.push(e),e._autoplay&&e._queue.push({event:"play",action:function(){e.play()}}),e._preload&&e.load(),e},load:function(){var t=null;if(o.noAudio)this._emit("loaderror",null,"No audio support.");else{"string"==typeof this._src&&(this._src=[this._src]);for(var e=0;e<this._src.length;e++){var n,r;if(this._format&&this._format[e])n=this._format[e];else{if("string"!=typeof(r=this._src[e])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(n=/^data:audio\/([^;,]+);/i.exec(r))||(n=/\.([^.]+)$/.exec(r.split("?",1)[0])),n&&(n=n[1].toLowerCase())}if(n||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),n&&o.codecs(n)){t=this._src[e];break}}if(t)return this._src=t,this._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new a(this),this._webAudio&&h(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(t,e){var n=this,r=null;if("number"==typeof t)r=t,t=null;else{if("string"==typeof t&&"loaded"===n._state&&!n._sprite[t])return null;if(void 0===t&&(t="__default",!n._playLock)){for(var i=0,s=0;s<n._sounds.length;s++)n._sounds[s]._paused&&!n._sounds[s]._ended&&(i++,r=n._sounds[s]._id);1===i?t=null:r=null}}var a=r?n._soundById(r):n._inactiveSound();if(!a)return null;if(r&&!t&&(t=a._sprite||"__default"),"loaded"!==n._state){a._sprite=t,a._ended=!1;var u=a._id;return n._queue.push({event:"play",action:function(){n.play(u)}}),u}if(r&&!a._paused)return e||n._loadQueue("play"),a._id;n._webAudio&&o._autoResume();var h=Math.max(0,a._seek>0?a._seek:n._sprite[t][0]/1e3),l=Math.max(0,(n._sprite[t][0]+n._sprite[t][1])/1e3-h),c=1e3*l/Math.abs(a._rate),p=n._sprite[t][0]/1e3,d=(n._sprite[t][0]+n._sprite[t][1])/1e3;a._sprite=t,a._ended=!1;var f=function(){a._paused=!1,a._seek=h,a._start=p,a._stop=d,a._loop=!(!a._loop&&!n._sprite[t][2])};if(!(h>=d)){var g=a._node;if(n._webAudio){var y=function(){n._playLock=!1,f(),n._refreshBuffer(a);var t=a._muted||n._muted?0:a._volume;g.gain.setValueAtTime(t,o.ctx.currentTime),a._playStart=o.ctx.currentTime,void 0===g.bufferSource.start?a._loop?g.bufferSource.noteGrainOn(0,h,86400):g.bufferSource.noteGrainOn(0,h,l):a._loop?g.bufferSource.start(0,h,86400):g.bufferSource.start(0,h,l),c!==1/0&&(n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),c)),e||setTimeout((function(){n._emit("play",a._id),n._loadQueue()}),0)};"running"===o.state?y():(n._playLock=!0,n.once("resume",y),n._clearTimer(a._id))}else{var m=function(){g.currentTime=h,g.muted=a._muted||n._muted||o._muted||g.muted,g.volume=a._volume*o.volume(),g.playbackRate=a._rate;try{var r=g.play();if(r&&"undefined"!=typeof Promise&&(r instanceof Promise||"function"==typeof r.then)?(n._playLock=!0,f(),r.then((function(){n._playLock=!1,g._unlocked=!0,e||(n._emit("play",a._id),n._loadQueue())})).catch((function(){n._playLock=!1,n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0}))):e||(n._playLock=!1,f(),n._emit("play",a._id),n._loadQueue()),g.playbackRate=a._rate,g.paused)return void n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||a._loop?n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),c):(n._endTimers[a._id]=function(){n._ended(a),g.removeEventListener("ended",n._endTimers[a._id],!1)},g.addEventListener("ended",n._endTimers[a._id],!1))}catch(t){n._emit("playerror",a._id,t)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===g.src&&(g.src=n._src,g.load());var v=window&&window.ejecta||!g.readyState&&o._navigator.isCocoonJS;if(g.readyState>=3||v)m();else{n._playLock=!0;var b=function(){m(),g.removeEventListener(o._canPlayEvent,b,!1)};g.addEventListener(o._canPlayEvent,b,!1),n._clearTimer(a._id)}}return a._id}n._ended(a)},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var n=e._getSoundIds(t),r=0;r<n.length;r++){e._clearTimer(n[r]);var i=e._soundById(n[r]);if(i&&!i._paused&&(i._seek=e.seek(n[r]),i._rateSeek=0,i._paused=!0,e._stopFade(n[r]),i._node))if(e._webAudio){if(!i._node.bufferSource)continue;void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),e._cleanBuffer(i._node)}else isNaN(i._node.duration)&&i._node.duration!==1/0||i._node.pause();arguments[1]||e._emit("pause",i?i._id:null)}return e},stop:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(t)}}),n;for(var r=n._getSoundIds(t),i=0;i<r.length;i++){n._clearTimer(r[i]);var o=n._soundById(r[i]);o&&(o._seek=o._start||0,o._rateSeek=0,o._paused=!0,o._ended=!0,n._stopFade(r[i]),o._node&&(n._webAudio?o._node.bufferSource&&(void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),n._cleanBuffer(o._node)):isNaN(o._node.duration)&&o._node.duration!==1/0||(o._node.currentTime=o._start||0,o._node.pause(),o._node.duration===1/0&&n._clearSound(o._node))),e||n._emit("stop",o._id))}return n},mute:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(t,e)}}),n;if(void 0===e){if("boolean"!=typeof t)return n._muted;n._muted=t}for(var r=n._getSoundIds(e),i=0;i<r.length;i++){var s=n._soundById(r[i]);s&&(s._muted=t,s._interval&&n._stopFade(s._id),n._webAudio&&s._node?s._node.gain.setValueAtTime(t?0:s._volume,o.ctx.currentTime):s._node&&(s._node.muted=!!o._muted||t),n._emit("mute",s._id))}return n},volume:function(){var t,e,n,r=this,i=arguments;if(0===i.length)return r._volume;if(1===i.length||2===i.length&&void 0===i[1]){var s=r._getSoundIds(),a=s.indexOf(i[0]);a>=0?e=parseInt(i[0],10):t=parseFloat(i[0])}else i.length>=2&&(t=parseFloat(i[0]),e=parseInt(i[1],10));if(!(void 0!==t&&t>=0&&t<=1))return(n=e?r._soundById(e):r._sounds[0])?n._volume:0;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,i)}}),r;void 0===e&&(r._volume=t),e=r._getSoundIds(e);for(var u=0;u<e.length;u++)(n=r._soundById(e[u]))&&(n._volume=t,i[2]||r._stopFade(e[u]),r._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(t,o.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=t*o.volume()),r._emit("volume",n._id));return r},fade:function(t,e,n,r){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"fade",action:function(){i.fade(t,e,n,r)}}),i;t=parseFloat(t),e=parseFloat(e),n=parseFloat(n),i.volume(t,r);for(var s=i._getSoundIds(r),a=0;a<s.length;a++){var u=i._soundById(s[a]);if(u){if(r||i._stopFade(s[a]),i._webAudio&&!u._muted){var h=o.ctx.currentTime,l=h+n/1e3;u._volume=t,u._node.gain.setValueAtTime(t,h),u._node.gain.linearRampToValueAtTime(e,l)}i._startFadeInterval(u,t,e,n,s[a],void 0===r)}}return i},_startFadeInterval:function(t,e,n,r,i,o){var s=this,a=e,u=n-e,h=Math.abs(u/.01),l=Math.max(4,h>0?r/h:r),c=Date.now();t._fadeTo=n,t._interval=setInterval((function(){var i=(Date.now()-c)/r;c=Date.now(),a+=u*i,a=Math.max(0,a),a=Math.min(1,a),a=Math.round(100*a)/100,s._webAudio?t._volume=a:s.volume(a,t._id,!0),o&&(s._volume=a),(n<e&&a<=n||n>e&&a>=n)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,s.volume(n,t._id),s._emit("fade",t._id))}),l)},_stopFade:function(t){var e=this._soundById(t);return e&&e._interval&&(this._webAudio&&e._node.gain.cancelScheduledValues(o.ctx.currentTime),clearInterval(e._interval),e._interval=null,this.volume(e._fadeTo,t),e._fadeTo=null,this._emit("fade",t)),this},loop:function(){var t,e,n,r=this,i=arguments;if(0===i.length)return r._loop;if(1===i.length){if("boolean"!=typeof i[0])return!!(n=r._soundById(parseInt(i[0],10)))&&n._loop;t=i[0],r._loop=t}else 2===i.length&&(t=i[0],e=parseInt(i[1],10));for(var o=r._getSoundIds(e),s=0;s<o.length;s++)(n=r._soundById(o[s]))&&(n._loop=t,r._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=t,t&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop)));return r},rate:function(){var t,e,n,r=this,i=arguments;if(0===i.length)e=r._sounds[0]._id;else if(1===i.length){var s=r._getSoundIds(),a=s.indexOf(i[0]);a>=0?e=parseInt(i[0],10):t=parseFloat(i[0])}else 2===i.length&&(t=parseFloat(i[0]),e=parseInt(i[1],10));if("number"!=typeof t)return(n=r._soundById(e))?n._rate:r._rate;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,i)}}),r;void 0===e&&(r._rate=t),e=r._getSoundIds(e);for(var u=0;u<e.length;u++)if(n=r._soundById(e[u])){r.playing(e[u])&&(n._rateSeek=r.seek(e[u]),n._playStart=r._webAudio?o.ctx.currentTime:n._playStart),n._rate=t,r._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(t,o.ctx.currentTime):n._node&&(n._node.playbackRate=t);var h=r.seek(e[u]),l=(r._sprite[n._sprite][0]+r._sprite[n._sprite][1])/1e3-h,c=1e3*l/Math.abs(n._rate);!r._endTimers[e[u]]&&n._paused||(r._clearTimer(e[u]),r._endTimers[e[u]]=setTimeout(r._ended.bind(r,n),c)),r._emit("rate",n._id)}return r},seek:function(){var t,e,n=this,r=arguments;if(0===r.length)e=n._sounds[0]._id;else if(1===r.length){var i=n._getSoundIds(),s=i.indexOf(r[0]);s>=0?e=parseInt(r[0],10):n._sounds.length&&(e=n._sounds[0]._id,t=parseFloat(r[0]))}else 2===r.length&&(t=parseFloat(r[0]),e=parseInt(r[1],10));if(void 0===e)return n;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"seek",action:function(){n.seek.apply(n,r)}}),n;var a=n._soundById(e);if(a){if(!("number"==typeof t&&t>=0)){if(n._webAudio){var u=n.playing(e)?o.ctx.currentTime-a._playStart:0,h=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(h+u*Math.abs(a._rate))}return a._node.currentTime}var l=n.playing(e);l&&n.pause(e,!0),a._seek=t,a._ended=!1,n._clearTimer(e),n._webAudio||!a._node||isNaN(a._node.duration)||(a._node.currentTime=t);var c=function(){n._emit("seek",e),l&&n.play(e,!0)};if(l&&!n._webAudio){var p=function(){n._playLock?setTimeout(p,0):c()};setTimeout(p,0)}else c()}return n},playing:function(t){if("number"==typeof t){var e=this._soundById(t);return!!e&&!e._paused}for(var n=0;n<this._sounds.length;n++)if(!this._sounds[n]._paused)return!0;return!1},duration:function(t){var e=this._duration,n=this._soundById(t);return n&&(e=this._sprite[n._sprite][1]/1e3),e},state:function(){return this._state},unload:function(){for(var t=this,e=t._sounds,n=0;n<e.length;n++)e[n]._paused||t.stop(e[n]._id),t._webAudio||(t._clearSound(e[n]._node),e[n]._node.removeEventListener("error",e[n]._errorFn,!1),e[n]._node.removeEventListener(o._canPlayEvent,e[n]._loadFn,!1),o._releaseHtml5Audio(e[n]._node)),delete e[n]._node,t._clearTimer(e[n]._id);var r=o._howls.indexOf(t);r>=0&&o._howls.splice(r,1);var i=!0;for(n=0;n<o._howls.length;n++)if(o._howls[n]._src===t._src||t._src.indexOf(o._howls[n]._src)>=0){i=!1;break}return u&&i&&delete u[t._src],o.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,n,r){var i=this["_on"+t];return"function"==typeof e&&i.push(r?{id:n,fn:e,once:r}:{id:n,fn:e}),this},off:function(t,e,n){var r=this["_on"+t],i=0;if("number"==typeof e&&(n=e,e=null),e||n)for(i=0;i<r.length;i++){var o=n===r[i].id;if(e===r[i].fn&&o||!e&&o){r.splice(i,1);break}}else if(t)this["_on"+t]=[];else{var s=Object.keys(this);for(i=0;i<s.length;i++)0===s[i].indexOf("_on")&&Array.isArray(this[s[i]])&&(this[s[i]]=[])}return this},once:function(t,e,n){return this.on(t,e,n,1),this},_emit:function(t,e,n){for(var r=this["_on"+t],i=r.length-1;i>=0;i--)r[i].id&&r[i].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,n)}.bind(this,r[i].fn),0),r[i].once&&this.off(t,r[i].fn,r[i].id));return this._loadQueue(t),this},_loadQueue:function(t){if(this._queue.length>0){var e=this._queue[0];e.event===t&&(this._queue.shift(),this._loadQueue()),t||e.action()}return this},_ended:function(t){var e=t._sprite;if(!this._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(this._ended.bind(this,t),100),this;var n=!(!t._loop&&!this._sprite[e][2]);if(this._emit("end",t._id),!this._webAudio&&n&&this.stop(t._id,!0).play(t._id),this._webAudio&&n){this._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=o.ctx.currentTime;var r=1e3*(t._stop-t._start)/Math.abs(t._rate);this._endTimers[t._id]=setTimeout(this._ended.bind(this,t),r)}return this._webAudio&&!n&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,this._clearTimer(t._id),this._cleanBuffer(t._node),o._autoSuspend()),this._webAudio||n||this.stop(t._id,!0),this},_clearTimer:function(t){if(this._endTimers[t]){if("function"!=typeof this._endTimers[t])clearTimeout(this._endTimers[t]);else{var e=this._soundById(t);e&&e._node&&e._node.removeEventListener("ended",this._endTimers[t],!1)}delete this._endTimers[t]}return this},_soundById:function(t){for(var e=0;e<this._sounds.length;e++)if(t===this._sounds[e]._id)return this._sounds[e];return null},_inactiveSound:function(){this._drain();for(var t=0;t<this._sounds.length;t++)if(this._sounds[t]._ended)return this._sounds[t].reset();return new a(this)},_drain:function(){var t=this._pool,e=0,n=0;if(!(this._sounds.length<t)){for(n=0;n<this._sounds.length;n++)this._sounds[n]._ended&&e++;for(n=this._sounds.length-1;n>=0;n--){if(e<=t)return;this._sounds[n]._ended&&(this._webAudio&&this._sounds[n]._node&&this._sounds[n]._node.disconnect(0),this._sounds.splice(n,1),e--)}}},_getSoundIds:function(t){if(void 0===t){for(var e=[],n=0;n<this._sounds.length;n++)e.push(this._sounds[n]._id);return e}return[t]},_refreshBuffer:function(t){return t._node.bufferSource=o.ctx.createBufferSource(),t._node.bufferSource.buffer=u[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,o.ctx.currentTime),this},_cleanBuffer:function(t){var e=o._navigator&&o._navigator.vendor.indexOf("Apple")>=0;if(o._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),e))try{t.bufferSource.buffer=o._scratchBuffer}catch(t){}return t.bufferSource=null,this},_clearSound:function(t){/MSIE |Trident\//.test(o._navigator&&o._navigator.userAgent)||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var a=function(t){this._parent=t,this.init()};a.prototype={init:function(){var t=this._parent;return this._muted=t._muted,this._loop=t._loop,this._volume=t._volume,this._rate=t._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++o._counter,t._sounds.push(this),this.create(),this},create:function(){var t=this._parent,e=o._muted||this._muted||this._parent._muted?0:this._volume;return t._webAudio?(this._node=void 0===o.ctx.createGain?o.ctx.createGainNode():o.ctx.createGain(),this._node.gain.setValueAtTime(e,o.ctx.currentTime),this._node.paused=!0,this._node.connect(o.masterGain)):o.noAudio||(this._node=o._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(o._canPlayEvent,this._loadFn,!1),this._node.src=t._src,this._node.preload="auto",this._node.volume=e*o.volume(),this._node.load()),this},reset:function(){var t=this._parent;return this._muted=t._muted,this._loop=t._loop,this._volume=t._volume,this._rate=t._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++o._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var t=this._parent;t._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),this._node.removeEventListener(o._canPlayEvent,this._loadFn,!1)}};var u={},h=function(t){var e=t._src;if(u[e])return t._duration=u[e].duration,void p(t);if(/^data:[^;]+;base64,/.test(e)){for(var n=atob(e.split(",")[1]),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);c(r.buffer,t)}else{var o=new XMLHttpRequest;o.open("GET",e,!0),o.withCredentials=t._xhrWithCredentials,o.responseType="arraybuffer",o.onload=function(){var e=(o.status+"")[0];"0"===e||"2"===e||"3"===e?c(o.response,t):t._emit("loaderror",null,"Failed loading audio file with status: "+o.status+".")},o.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete u[e],t.load())},l(o)}},l=function(t){try{t.send()}catch(e){t.onerror()}},c=function(t,e){var n=function(){e._emit("loaderror",null,"Decoding audio data failed.")},r=function(t){t&&e._sounds.length>0?(u[e._src]=t,p(e,t)):n()};"undefined"!=typeof Promise&&1===o.ctx.decodeAudioData.length?o.ctx.decodeAudioData(t).then(r).catch(n):o.ctx.decodeAudioData(t,r,n)},p=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},d=function(){if(o.usingWebAudio){try{"undefined"!=typeof AudioContext?o.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?o.ctx=new webkitAudioContext:o.usingWebAudio=!1}catch(t){o.usingWebAudio=!1}o.ctx||(o.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(o._navigator&&o._navigator.platform),e=o._navigator&&o._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=e?parseInt(e[1],10):null;if(t&&n&&n<9){var r=/safari/.test(o._navigator&&o._navigator.userAgent.toLowerCase());(o._navigator&&o._navigator.standalone&&!r||o._navigator&&!o._navigator.standalone&&!r)&&(o.usingWebAudio=!1)}o.usingWebAudio&&(o.masterGain=void 0===o.ctx.createGain?o.ctx.createGainNode():o.ctx.createGain(),o.masterGain.gain.setValueAtTime(o._muted?0:o._volume,o.ctx.currentTime),o.masterGain.connect(o.ctx.destination)),o._setup()}};void 0===(r=function(){return{Howler:o,Howl:s}}.apply(e,[]))||(t.exports=r),e.Howler=o,e.Howl=s,"undefined"!=typeof window?(window.HowlerGlobal=i,window.Howler=o,window.Howl=s,window.Sound=a):void 0!==n&&(n.HowlerGlobal=i,n.Howler=o,n.Howl=s,n.Sound=a)}(),
/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.1.3
 *  howlerjs.com
 *
 *  (c) 2013-2019, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
function(){"use strict";var t;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){if(!this.ctx||!this.ctx.listener)return this;for(var e=this._howls.length-1;e>=0;e--)this._howls[e].stereo(t);return this},HowlerGlobal.prototype.pos=function(t,e,n){return this.ctx&&this.ctx.listener?(e="number"!=typeof e?this._pos[1]:e,n="number"!=typeof n?this._pos[2]:n,"number"!=typeof t?this._pos:(this._pos=[t,e,n],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(t,e,n,r,i,o){if(!this.ctx||!this.ctx.listener)return this;var s=this._orientation;return e="number"!=typeof e?s[1]:e,n="number"!=typeof n?s[2]:n,r="number"!=typeof r?s[3]:r,i="number"!=typeof i?s[4]:i,o="number"!=typeof o?s[5]:o,"number"!=typeof t?s:(this._orientation=[t,e,n,r,i,o],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(e,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(i,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(t,e,n,r,i,o),this)},Howl.prototype.init=(t=Howl.prototype.init,function(e){return this._orientation=e.orientation||[1,0,0],this._stereo=e.stereo||null,this._pos=e.pos||null,this._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:0,distanceModel:void 0!==e.distanceModel?e.distanceModel:"inverse",maxDistance:void 0!==e.maxDistance?e.maxDistance:1e4,panningModel:void 0!==e.panningModel?e.panningModel:"HRTF",refDistance:void 0!==e.refDistance?e.refDistance:1,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:1},this._onstereo=e.onstereo?[{fn:e.onstereo}]:[],this._onpos=e.onpos?[{fn:e.onpos}]:[],this._onorientation=e.onorientation?[{fn:e.onorientation}]:[],t.call(this,e)}),Howl.prototype.stereo=function(t,n){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"stereo",action:function(){r.stereo(t,n)}}),r;var i=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof t)return r._stereo;r._stereo=t,r._pos=[t,0,0]}for(var o=r._getSoundIds(n),s=0;s<o.length;s++){var a=r._soundById(o[s]);if(a){if("number"!=typeof t)return a._stereo;a._stereo=t,a._pos=[t,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||e(a,i),"spatial"===i?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(t,0,0):a._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),r._emit("stereo",a._id)}}return r},Howl.prototype.pos=function(t,n,r,i){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"pos",action:function(){o.pos(t,n,r,i)}}),o;if(n="number"!=typeof n?0:n,r="number"!=typeof r?-.5:r,void 0===i){if("number"!=typeof t)return o._pos;o._pos=[t,n,r]}for(var s=o._getSoundIds(i),a=0;a<s.length;a++){var u=o._soundById(s[a]);if(u){if("number"!=typeof t)return u._pos;u._pos=[t,n,r],u._node&&(u._panner&&!u._panner.pan||e(u,"spatial"),void 0!==u._panner.positionX?(u._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):u._panner.setPosition(t,n,r)),o._emit("pos",u._id)}}return o},Howl.prototype.orientation=function(t,n,r,i){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"orientation",action:function(){o.orientation(t,n,r,i)}}),o;if(n="number"!=typeof n?o._orientation[1]:n,r="number"!=typeof r?o._orientation[2]:r,void 0===i){if("number"!=typeof t)return o._orientation;o._orientation=[t,n,r]}for(var s=o._getSoundIds(i),a=0;a<s.length;a++){var u=o._soundById(s[a]);if(u){if("number"!=typeof t)return u._orientation;u._orientation=[t,n,r],u._node&&(u._panner||(u._pos||(u._pos=o._pos||[0,0,-.5]),e(u,"spatial")),void 0!==u._panner.orientationX?(u._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):u._panner.setOrientation(t,n,r)),o._emit("orientation",u._id)}}return o},Howl.prototype.pannerAttr=function(){var t,n,r,i=this,o=arguments;if(!i._webAudio)return i;if(0===o.length)return i._pannerAttr;if(1===o.length){if("object"!=typeof o[0])return(r=i._soundById(parseInt(o[0],10)))?r._pannerAttr:i._pannerAttr;t=o[0],void 0===n&&(t.pannerAttr||(t.pannerAttr={coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),i._pannerAttr={coneInnerAngle:void 0!==t.pannerAttr.coneInnerAngle?t.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:void 0!==t.pannerAttr.coneOuterAngle?t.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:void 0!==t.pannerAttr.coneOuterGain?t.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:void 0!==t.pannerAttr.distanceModel?t.pannerAttr.distanceModel:i._distanceModel,maxDistance:void 0!==t.pannerAttr.maxDistance?t.pannerAttr.maxDistance:i._maxDistance,refDistance:void 0!==t.pannerAttr.refDistance?t.pannerAttr.refDistance:i._refDistance,rolloffFactor:void 0!==t.pannerAttr.rolloffFactor?t.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:void 0!==t.pannerAttr.panningModel?t.pannerAttr.panningModel:i._panningModel})}else 2===o.length&&(t=o[0],n=parseInt(o[1],10));for(var s=i._getSoundIds(n),a=0;a<s.length;a++)if(r=i._soundById(s[a])){var u=r._pannerAttr;u={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:u.coneOuterAngle,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:u.coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:u.distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:u.maxDistance,refDistance:void 0!==t.refDistance?t.refDistance:u.refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:u.rolloffFactor,panningModel:void 0!==t.panningModel?t.panningModel:u.panningModel};var h=r._panner;h?(h.coneInnerAngle=u.coneInnerAngle,h.coneOuterAngle=u.coneOuterAngle,h.coneOuterGain=u.coneOuterGain,h.distanceModel=u.distanceModel,h.maxDistance=u.maxDistance,h.refDistance=u.refDistance,h.rolloffFactor=u.rolloffFactor,h.panningModel=u.panningModel):(r._pos||(r._pos=i._pos||[0,0,-.5]),e(r,"spatial"))}return i},Sound.prototype.init=function(t){return function(){var e=this._parent;this._orientation=e._orientation,this._stereo=e._stereo,this._pos=e._pos,this._pannerAttr=e._pannerAttr,t.call(this),this._stereo?e.stereo(this._stereo):this._pos&&e.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var e=this._parent;return this._orientation=e._orientation,this._stereo=e._stereo,this._pos=e._pos,this._pannerAttr=e._pannerAttr,this._stereo?e.stereo(this._stereo):this._pos?e.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,e._refreshBuffer(this)),t.call(this)}}(Sound.prototype.reset);var e=function(t,e){"spatial"===(e=e||"spatial")?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,void 0!==t._panner.positionX?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),void 0!==t._panner.orientationX?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}}()}).call(this,n(14))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.dataType="image/jpeg",this.quality=.85,this.nodata="image/nodata.png",this.canvas=document.createElement("canvas"),null==t&&(t={}),null==t.screenShot&&(t.screenShot={});var e=t.screenShot;null!=e.width?this.canvas.width=e.width:this.canvas.width=320,null!=e.height?this.canvas.height=e.height:this.canvas.height=180,null!=e.dataType&&(this.dataType=e.dataType),null!=e.quality&&(this.quality=e.quality),null!=e.nodata&&(this.nodata=e.nodata);var n=this.canvas.getContext("2d");if(null==n)throw new Error("Canvasの初期化に失敗しました");this.context=n,this.context.fillStyle="#000000",this.context.fillRect(0,0,this.canvas.width,this.canvas.height)}return t.prototype.draw=function(t){this.context.drawImage(t,0,0,this.canvas.width,this.canvas.height)},t.prototype.getDataUrl=function(){return null!=this.quality?this.canvas.toDataURL(this.dataType,this.quality):this.canvas.toDataURL(this.dataType)},t}();e.ScreenShot=r},function(t,e,n){"use strict";(function(t){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(){return t.call(this,void 0,"\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float alpha;\n\nvoid main(void) {\n  vec4 color = texture2D(uSampler, vTextureCoord);\n  gl_FragColor = color * alpha;\n}",{alpha:{type:"float",value:1}})||this}return r(e,t),e}(t.Filter),a=function(t){function e(){return t.call(this,void 0,"\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D ruleSampler;\nuniform float vague;\nuniform float phaseMax;\nuniform float phase;\n\nvoid main(void) {\n  vec4 color = texture2D(uSampler, vTextureCoord);\n  vec4 rcolor = texture2D(ruleSampler, vTextureCoord);\n\n  float a = (rcolor.r + rcolor.g + rcolor.b) / 3.0;\n  if (a < phase) {\n    gl_FragColor = vec4(0);\n  } else if (a >= phaseMax) {\n    gl_FragColor = color;\n  } else {\n    // float tmp = 1.0 - ((a - phase) * 1.0 / vague);\n    float tmp = (a - phase) * 1.0 / vague;\n    if (tmp < 0.0) { tmp = 0.0; }\n    if (tmp > 1.0) { tmp = 1.0; }\n    gl_FragColor = color * tmp;\n  }\n}",{ruleSampler:{type:"sampler2D",value:1},vague:{type:"float",value:1},phase:{type:"float",value:1},phaseMax:{type:"float",value:1}})||this}return r(e,t),e}(t.Filter),u=function(){function e(t,e){this.startTick=-1,this.time=1e3,this.method="crossfade",this.ruleImage=null,this.ruleSprite=null,this.vague=.25,this.status="stop",this.game=t,this.resource=e,this.filters={"scroll-to-right":null,"scroll-to-left":null,"scroll-to-top":null,"scroll-to-bottom":null,univ:new a,crossfade:new s},this.filter=this.filters.crossfade}return e.prototype.initTrans=function(t,e){return i(this,void 0,void 0,(function(){return o(this,(function(n){if(this.isRunning&&this.stop(),this.startTick=-1,this.time=t,this.method=e,void 0===this.filters[this.method])throw new Error("存在しないmethodです("+this.method+")");return[2,new Promise((function(t){setTimeout((function(){t()}),0)}))]}))}))},e.prototype.initUnivTrans=function(e,n,r){return void 0===r&&(r=.25),i(this,void 0,void 0,(function(){var i,s,a,u;return o(this,(function(o){switch(o.label){case 0:return this.initTrans(e,"univ"),r<0&&(r=0),r>1&&(r=1),this.vague=r,i=this.game.width,s=this.game.height,a=this,[4,this.resource.loadImage(n)];case 1:return a.ruleImage=o.sent(),this.ruleSprite=new t.Sprite(t.Texture.from(this.ruleImage)),this.ruleSprite.width=i,this.ruleSprite.height=s,(u=new t.Sprite(t.Texture.WHITE)).width=i,u.height=s,this.ruleSprite.mask=u,[2]}}))}))},Object.defineProperty(e.prototype,"isRunning",{get:function(){return"run"===this.status},enumerable:!0,configurable:!0}),e.prototype.stop=function(){"run"===this.status&&(this.status="stop",this.game.renderer.setBackVisible(!1),this.game.resetPrimaryLayersRenderer(),this.game.renderer.foreContainer.filters=[],this.game.renderer.backContainer.filters=[],this.game.renderer.foreContainer.x=0,this.game.renderer.foreContainer.y=0,this.game.renderer.backContainer.x=0,this.game.renderer.backContainer.y=0,this.game.onCompleteTrans())},e.prototype.start=function(){this.status="run",this.game.flipPrimaryLayers(),this.filter=this.filters[this.method],null===this.filter?this.game.renderer.setBackVisible(!0):(this.game.renderer.setBackVisible(!0),this.game.renderer.foreContainer.filters=[this.filter])},e.prototype.draw=function(t){-1===this.startTick&&(this.startTick=t);var e=t-this.startTick;if(e>this.time)return this.stop(),void this.game.renderer.draw();switch(this.method){case"scroll-to-right":this.drawScrollHorizontal(t,e,"right");break;case"scroll-to-left":this.drawScrollHorizontal(t,e,"left");break;case"scroll-to-top":this.drawScrollVertical(t,e,"top");break;case"scroll-to-bottom":this.drawScrollVertical(t,e,"bottom");break;case"univ":this.drawUniv(t,e);break;case"crossfade":default:this.drawCrossFade(t,e)}this.game.renderer.draw()},e.prototype.drawScrollHorizontal=function(t,e,n){var r=this.game.width,i=r*(e/this.time);i<0&&(i=0),i>r&&(i=r),this.game.renderer.foreContainer.x="right"===n?i:-i},e.prototype.drawScrollVertical=function(t,e,n){var r=this.game.height,i=r*(e/this.time);i<0&&(i=0),i>r&&(i=r),this.game.renderer.foreContainer.y="bottom"===n?i:-i},e.prototype.drawCrossFade=function(t,e){var n=1-e/this.time;n<0&&(n=0),n>1&&(n=1),this.filter.uniforms.alpha=n},e.prototype.drawUniv=function(t,e){var n=this.filter.uniforms;n.ruleSampler=this.ruleSprite.texture,n.vague=this.vague,n.phaseMax=1+this.vague,n.phase=e*n.phaseMax/this.time-this.vague},e}();e.TransManager=u}).call(this,n(9))},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o,s=n(11);!function(t){t[t.Stop=0]="Stop",t[t.Play=1]="Play",t[t.Pause=2]="Pause",t[t.Fade=3]="Fade",t[t.Fadein=4]="Fadein",t[t.Fadeout=5]="Fadeout"}(o=e.SoundState||(e.SoundState={}));var a=function(){function t(t,e,n){this.howl=null,this.filePath=null,this._state=o.Stop,this._volume=1,this._gvolume=1,this._seek=0,this._loop=!1,this.fadeStartVolume=0,this.fadeTargetVolume=0,this.fadeTime=0,this.stopAfterFade=!1,this.onStopJump=!1,this.onStopCall=!1,this.onStopExp=null,this.onStopFile=null,this.onStopLabel=null,this.resource=t,this.bufferNum=e,this.callback=n}return t.prototype.loadSound=function(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:s.Logger.debug("SoundBuffer.loadSound call: ",t),this.filePath=t,r.label=1;case 1:return r.trys.push([1,3,,4]),this.stop("loadSound"),e=this,[4,this.resource.loadSoundHowler(t)];case 2:return e.howl=r.sent(),s.Logger.debug("SoundBuffer.loadSound success: ",this.howl),this.setHowlerEvent(),this.setHowlerOptions(),[3,4];case 3:throw n=r.sent(),s.Logger.debug("SoundBuffer.loadSound fail: ",t),n;case 4:return[2]}}))}))},Object.defineProperty(t.prototype,"hasSound",{get:function(){return null!=this.howl},enumerable:!0,configurable:!0}),t.prototype.freeSound=function(){this.stop("freeSound"),this.filePath=null,null!=this.howl&&(this.howl.unload(),this.howl=null)},t.prototype.clearOnStop=function(){this.onStopJump=!1,this.onStopCall=!1,this.onStopExp=null,this.onStopFile=null,this.onStopLabel=null},t.prototype.setHowlerEvent=function(){var t=this;null!=this.howl&&(this.howl.off("playerror").on("playerror",(function(){throw new Error("音声の再生に失敗しました("+t.filePath+")")})),this.howl.off("end").on("end",(function(){t.loop||t.stop("onEndEvent")})),this.howl.off("fade").on("fade",(function(){t.onFade()})))},t.prototype.setHowlerOptions=function(){null!=this.howl&&(this.volume=this._volume,this.gvolume=this._gvolume,this.seek=this._seek,this.loop=this._loop)},Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(t){t<0&&(t=0),t>1&&(t=1),this._volume=t,null!=this.howl&&this.howl.volume(this.volume*this.gvolume)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gvolume",{get:function(){return this._gvolume},set:function(t){t<0&&(t=0),t>1&&(t=1),this._gvolume=t,null!=this.howl&&this.howl.volume(this.volume*this.gvolume)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"seek",{get:function(){return this._seek},set:function(t){this._seek=t,null!=this.howl&&this.howl.seek(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,null!=this.howl&&this.howl.loop(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playing",{get:function(){return this._state===o.Play||this._state===o.Fade||this._state===o.Fadein||this._state===o.Fadeout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fading",{get:function(){return this._state===o.Fade||this._state===o.Fadein||this._state===o.Fadeout},enumerable:!0,configurable:!0}),t.prototype.play=function(){null!=this.howl&&(this.fading&&this.endFade(),this.playing&&this.stop("play"),this.setHowlerEvent(),this.setHowlerOptions(),this.howl.play(),this._state=o.Play)},t.prototype.stop=function(t){void 0===t&&(t="unknown"),null!=this.howl&&(this.howl.stop(),this.howl.off("fade"),this.howl.off("play"),this.howl.off("end")),this._state===o.Fade&&(this.volume=this.fadeTargetVolume),this._state=o.Stop,null!==this.onStopExp&&this.resource.evalJs(this.onStopExp),this.callback.onStop({bufferNum:this.bufferNum,stopBy:t,jump:this.onStopJump,call:this.onStopCall,file:this.onStopFile,label:this.onStopLabel}),this.clearOnStop()},t.prototype.pause=function(){null!=this.howl&&(this.setHowlerEvent(),this.howl.pause(),this._state=o.Pause)},t.prototype.fade=function(t,e,n){null!=this.howl&&(this.fadeStartVolume=this.volume,this.fadeTargetVolume=t,this.fadeTime=e,this.stopAfterFade=n,this.setHowlerEvent(),this.setHowlerOptions(),this.howl.fade(this.fadeStartVolume*this.gvolume,this.fadeTargetVolume*this.gvolume,e),this._state=o.Fade)},t.prototype.fadein=function(t,e){var n=this;null!=this.howl&&(this.stop("fadein"),this.fadeStartVolume=0,this.fadeTargetVolume=t,this.fadeTime=e,this.stopAfterFade=!1,this.howl.once("play",(function(){n.setHowlerEvent(),null!=n.howl&&n.howl.fade(n.fadeStartVolume*n.gvolume,n.fadeTargetVolume*n.gvolume,e)})),this.volume=this.fadeStartVolume,this.play(),this._state=o.Fadein)},t.prototype.fadeout=function(t,e){null!=this.howl&&(this.fadeStartVolume=this.volume,this.fadeTargetVolume=0,this.fadeTime=t,this.stopAfterFade=e,this.setHowlerEvent(),this.howl.fade(this.fadeStartVolume*this.gvolume,this.fadeTargetVolume*this.gvolume,t),this._state=o.Fadeout)},t.prototype.endFade=function(){this.fading&&(this._volume=this.fadeTargetVolume,this.stopAfterFade?this.stop("endFade"):this._state=o.Play)},t.prototype.onFade=function(){this.fading&&(this.endFade(),this.callback.onFadeComplete(this.bufferNum))},t.prototype.store=function(e){var n={},r=this;return t.soundBufferStoreParams.forEach((function(t){n[t]=r[t]})),n},t.prototype.restore=function(e,n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return r=this,o=["hasSound","state"],t.soundBufferStoreParams.filter((function(t){return-1===o.indexOf(t)})).forEach((function(t){r[t]=e[t]})),this.stop("restore"),e.hasSound?[4,this.loadSound(e.filePath)]:[3,2];case 1:return i.sent(),this.restoreAfterLoad(e,n),[3,3];case 2:this.restoreAfterLoad(e,n),i.label=3;case 3:return[2]}}))}))},t.prototype.restoreAfterLoad=function(t,e){t.state===o.Play&&t.loop&&this.play(),t.state===o.Fade&&!t.stopAfterFade&&t.loop&&(this.volume=t.fadeTargetVolume,this.play()),t.state===o.Fadein&&t.loop&&this.fadein(t.fadeTargetVolume,t.fadeTime)},t.prototype.storeSystem=function(){return{gvolume:this.gvolume}},t.prototype.restoreSystem=function(t){null!=t&&null!=t.gvolume&&(this.gvolume=t.gvolume)},t.soundBufferStoreParams=["hasSound","filePath","bufferNum","state","seek","loop","volume","fadeStartVolume","fadeTargetVolume","fadeTime","stopAfterFade","jump","call","onStopExp","onStopFile","onStopLabel"],t}();e.SoundBuffer=a},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var u=n(15),h=n(19),l=a(n(13)),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initHistoryButton=function(t,e){return o(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this.loadImage(t)];case 1:return n.sent(),this.initButton(e),this.width=Math.floor(this.imageWidth/3),this.setButtonStatus("normal"),[2]}}))}))},e.prototype.clearHistoryButton=function(){this.clearButton(),this.freeImage()},e.prototype.setButtonStatus=function(e){switch(t.prototype.setButtonStatus.call(this,e),e){case"normal":case"disabled":this.imageX=0;break;case"over":this.imageX=-Math.floor(this.imageWidth/3);break;case"on":this.imageX=-Math.floor(this.imageWidth/3*2)}},e.prototype.setCallbacks=function(t){this.callbacks=t},e.prototype.onMouseDown=function(e){t.prototype.onMouseDown.call(this,e),this.isInsideEvent(e)&&this.callbacks.onMouseDown&&this.callbacks.onMouseDown(e)},e.prototype.onMouseUp=function(e){t.prototype.onMouseUp.call(this,e),this.isInsideEvent(e)&&this.callbacks.onMouseUp&&this.callbacks.onMouseUp(e)},e}(n(16).Button);e.HistoryButton=c;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.down=!1,e.downX=0,e.downY=0,e}return i(e,t),e.prototype.onMouseDown=function(e){t.prototype.onMouseDown.call(this,e),this.isInsideEvent(e)&&(this.down=!0,this.downX=e.y,this.downY=e.y)},e.prototype.onMouseMove=function(e){t.prototype.onMouseMove.call(this,e)},e.prototype.onMouseUp=function(e){t.prototype.onMouseUp.call(this,e),e.isLeft&&(this.down=!1)},e}(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgColors=[16711680,65280,255],e.bgAlphas=[1,1,1],e.status="normal",e.mouseEnter=function(){},e.mouseLeave=function(){},e.mouseMove=function(){},e.mouseDown=function(){},e.mouseUp=function(){},e}return i(e,t),e.prototype.initButton=function(t,e){this.bgColors=t,this.bgAlphas=e,this.setStatus("normal"),this.visible=!0},e.prototype.setStatus=function(t){this.status=t;var e={normal:0,over:1,on:2}[t];this.setBackgroundColor(this.bgColors[e],this.bgAlphas[e]),this.resource.getCanvasElm().style.cursor=this.resource.cursor[t]},e.prototype.onMouseEnter=function(e){t.prototype.onMouseEnter.call(this,e),this.setStatus("over"),this.mouseEnter(this)},e.prototype.onMouseLeave=function(e){t.prototype.onMouseLeave.call(this,e),this.setStatus("normal"),this.mouseLeave(this)},e.prototype.onMouseMove=function(e){t.prototype.onMouseMove.call(this,e),this.isInsideEvent(e)&&this.mouseMove(this)},e.prototype.onMouseDown=function(e){t.prototype.onMouseDown.call(this,e),this.isInsideEvent(e)&&(this.setStatus("on"),this.mouseDown(this))},e.prototype.onMouseUp=function(e){if(t.prototype.onMouseUp.call(this,e),this.isInsideEvent(e)){if("on"!==this.status)return;if(!e.isLeft)return;this.mouseUp(this),this.resource.getCanvasElm().style.cursor=this.resource.cursor.normal}},e}(u.BaseLayer)),d=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.minHeight=30,i.onChangeCallback=function(){},i.bar=new p("ScrollBarButton",n,r),i}return i(e,t),e.prototype.initScrollBar=function(t,e,n,r){this.minHeight=r,this.visible=!0,this.applyConfig(t),this.bar.initButton(e,n),this.bar.x=0,this.bar.y=0,this.bar.width=this.width,this.bar.height=this.width,this.addChild(this.bar)},e.prototype.setValues=function(t,e,n,r){if(n<=r)this.bar.visible=!1;else{var i,o=Math.floor(this.height*r/n);o<this.minHeight&&(o=this.minHeight),o>this.height&&(o=this.height),i=0===t?0:t===e?this.height-o:Math.floor((this.height-o)*(t/e)),this.bar.height=o,this.bar.y=i,this.bar.visible=!0}},e.prototype.onMouseEnter=function(e){t.prototype.onMouseEnter.call(this,e),this.resource.getCanvasElm().style.cursor=this.resource.cursor.over,e.stopPropagation()},e.prototype.onMouseLeave=function(e){t.prototype.onMouseLeave.call(this,e),this.resource.getCanvasElm().style.cursor=this.resource.cursor.normal,e.stopPropagation()},e.prototype.onMouseDown=function(e){t.prototype.onMouseDown.call(this,e),e.stopPropagation()},e.prototype.onMouseMove=function(e){t.prototype.onMouseMove.call(this,e),(this.bar.down||this.isInsideEvent(e))&&(this.resource.getCanvasElm().style.cursor=this.resource.cursor.over),this.bar.down&&(this.setBarY(e.y-this.bar.downY),this.onChangeCallback(this)),e.stopPropagation()},e.prototype.onMouseUp=function(e){t.prototype.onMouseUp.call(this,e),e.isLeft&&((this.bar.down||this.isInsideEvent(e))&&(this.setBarY(e.y-this.bar.height/2),this.resource.getCanvasElm().style.cursor=this.resource.cursor.normal,this.onChangeCallback(this),this.bar.onMouseUp(new h.PonMouseEvent(0,0,0))),e.stopPropagation())},e.prototype.setBarY=function(t){var e=this.height-this.bar.height;t<0&&(t=0),t>e&&(t=e),this.bar.y=t},e.prototype.getBarPoint=function(){var t=this.bar.y,e=this.height-this.bar.height;return 0===t?0:t===e?1:t/e},Object.defineProperty(e.prototype,"dragging",{get:function(){return this.bar.down},enumerable:!0,configurable:!0}),e}(u.BaseLayer),f=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.lines=[[]],i.maxLinesCount=1e4,i.indentPoints=[-1],i.clearIndentPoints=[-1],i.scrollOffLines=3,i.point=0,i.lazyRedrawFlag=!1,i.visible=!0,i}return i(e,t),Object.defineProperty(e.prototype,"currentLine",{get:function(){return this.lines[this.lines.length-1]},enumerable:!0,configurable:!0}),e.prototype.init=function(t){this.width=t.width,this.height=t.height,this.textCanvas.autoReturn=!1,null!=t.history&&t.history.text&&this.applyConfig(t.history.text),this.point=0,this.clear()},e.prototype.clear=function(){this.lines=[[]],this.indentPoints=[-1],this.clearIndentPoints=[-1]},Object.defineProperty(e.prototype,"historyText",{get:function(){var t="";return this.lines.forEach((function(e){t+=e.join("")+"\n"})),t},enumerable:!0,configurable:!0}),e.prototype.add=function(t){this.currentLine.push(t)},e.prototype.textReturn=function(){this.lines.push([]),this.indentPoints.push(-1),this.clearIndentPoints.push(-1),this.lines.length>this.maxLinesCount&&this.lines.shift()},e.prototype.setHistoryIndentPoint=function(){this.indentPoints[this.indentPoints.length-1]=this.currentLine.length-1},e.prototype.clearHistoryIndentPoint=function(){this.clearIndentPoints[this.clearIndentPoints.length-1]=this.currentLine.length-1},e.prototype.scrollUp=function(t){void 0===t&&(t=1),this.point-=t,this.fixPoint()},e.prototype.scrollDown=function(t){void 0===t&&(t=1),this.point+=t,this.fixPoint()},e.prototype.scrollUpPage=function(){this.scrollUp(this.screenLineCount-this.scrollOffLines)},e.prototype.scrollDownPage=function(){this.scrollDown(this.screenLineCount-this.scrollOffLines)},e.prototype.goTo=function(t){this.point=t,this.fixPoint()},e.prototype.goToEnd=function(){this.point=this.maxPoint},e.prototype.fixPoint=function(){this.point<0&&(this.point=0),this.point>this.maxPoint&&(this.point=this.maxPoint)},e.prototype.redraw=function(){var t=this;this.clearText();for(var e=this.point+this.screenLineCount,n=function(e){var n=r.indentPoints[e],i=r.clearIndentPoints[e];r.lines[e].forEach((function(e,r){t.addChar(e),r===n&&t.setIndentPoint(),r===i&&t.clearIndentPoint()})),r.addTextReturn()},r=this,i=this.point;i<e&&i<this.lines.length;i++)n(i)},e.prototype.redrawLazy=function(){this.lazyRedrawFlag=!0},e.prototype.update=function(e){t.prototype.update.call(this,e),this.lazyRedrawFlag&&(this.redraw(),this.lazyRedrawFlag=!1)},Object.defineProperty(e.prototype,"screenLineCount",{get:function(){var t=this.textCanvas.lineHeight+this.textCanvas.linePitch,e=this.height-this.textCanvas.marginTop-this.textCanvas.marginBottom+this.textCanvas.linePitch;return Math.floor(e/t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxPoint",{get:function(){var t=this.lines.length-1-this.screenLineCount;return t<0?0:t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPoint",{get:function(){return this.point},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linesCount",{get:function(){return this.lines.length},enumerable:!0,configurable:!0}),e}(u.BaseLayer),g=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.wheelScrollCount=3,i.enableOutput=!0,i.textLayer=new f("HistoryText",n,r),i.upButton=new c("ScrollUpButton",n,r),i.downButton=new c("ScrollDownButton",n,r),i.scrollBar=new d("ScrollBar",n,r),i.closeButton=new c("CloseButton",n,r),i}return i(e,t),e.prototype.init=function(t){return void 0===t&&(t={}),o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return null==t.history&&(t.history={}),null==t.history.text&&(t.history.text={}),null==t.history.upButton&&(t.history.upButton={}),null==t.history.downButton&&(t.history.downButton={}),null==t.history.scrollBar&&(t.history.scrollBar={}),null==t.history.closeButton&&(t.history.closeButton={}),this.x=0,this.y=0,this.width=t.width,this.height=t.height,this.wheelScrollCount=t.history.wheelScrollCount||3,null==t.history.backgroundImage?[3,2]:[4,this.loadImage(t.history.backgroundImage)];case 1:e.sent(),e.label=2;case 2:return this.textLayer.init(t),this.textLayer.visible=!0,this.addChild(this.textLayer),this.initScrollButtons(t),this.initScrollBar(t),this.initCloseButton(t),[2]}}))}))},e.prototype.initScrollButtons=function(t){var e=this,n=function(t,n,r){null==n.bgColors&&(n.bgColors=[4359924,4359924,4359924]),null==n.bgAlphas&&(n.bgAlphas=[.7,.8,.9]),t.applyConfig(n),t.visible=!0,t.initHistoryButton(n.imageFile,r),e.addChild(t)};n(this.upButton,t.history.upButton,1),n(this.downButton,t.history.downButton,2),this.upButton.setCallbacks({onMouseUp:function(){e.scrollUpPage()}}),this.downButton.setCallbacks({onMouseUp:function(){e.scrollDownPage()}})},e.prototype.initScrollBar=function(t){var e=this,n=l.objClone(t.history.scrollBar);n=l.objExtend({x:t.width-32-20,y:52,width:32,height:t.height-104,backgroundColor:4359924,backgroundAlpha:.1,bgColors:[4359924,4359924,4359924],bgAlphas:[.4,.5,.6],minHeight:16},n);var r=this.scrollBar;r.initScrollBar(n,n.bgColors,n.bgAlphas,n.minHeight),r.onChangeCallback=function(){var t=Math.floor(e.textLayer.maxPoint*r.getBarPoint());e.textLayer.currentPoint!==t&&(e.textLayer.goTo(t),e.textLayer.redrawLazy())},this.addChild(r)},e.prototype.initCloseButton=function(t){var e=this,n=l.objClone(t.history.closeButton);n=l.objExtend({x:t.width-40-30,y:15},n),this.closeButton.applyConfig(n),this.closeButton.initHistoryButton(n.imageFile,3),this.closeButton.setCallbacks({onMouseUp:function(){e.hide(),e.resource.getCanvasElm().style.cursor=e.resource.cursor.normal}}),this.closeButton.visible=!0,this.addChild(this.closeButton)},e.prototype.addHistoryChar=function(t){this.enableOutput&&(this.textLayer.add(t),this.visible&&(this.textLayer.redraw(),this.resetScrollBar()))},e.prototype.addHistoryTextReturn=function(){this.enableOutput&&(this.textLayer.textReturn(),this.visible&&(this.textLayer.redraw(),this.resetScrollBar()))},e.prototype.clearHistory=function(){this.textLayer.clear()},e.prototype.show=function(){this.textLayer.redraw(),this.resetScrollBar(),this.visible=!0},e.prototype.hide=function(){this.visible=!1},e.prototype.scrollUp=function(t){void 0===t&&(t=1),this.textLayer.scrollUp(t),this.textLayer.redraw(),this.resetScrollBar()},e.prototype.scrollUpPage=function(){this.textLayer.scrollUpPage(),this.textLayer.redraw(),this.resetScrollBar()},e.prototype.scrollDown=function(t){void 0===t&&(t=1),this.textLayer.scrollDown(t),this.textLayer.redraw(),this.resetScrollBar()},e.prototype.scrollDownPage=function(){this.textLayer.scrollDownPage(),this.textLayer.redraw(),this.resetScrollBar()},e.prototype.resetScrollBar=function(){this.scrollBar.setValues(this.textLayer.currentPoint,this.textLayer.maxPoint,this.textLayer.linesCount,this.textLayer.screenLineCount)},e.prototype.setHistoryIndentPoint=function(){this.textLayer.setHistoryIndentPoint()},e.prototype.clearHistoryIndentPoint=function(){this.textLayer.clearHistoryIndentPoint()},e.prototype.goToEnd=function(){this.textLayer.goToEnd()},e.prototype.onMouseEnter=function(e){t.prototype.onMouseEnter.call(this,e),e.stopPropagation()},e.prototype.onMouseLeave=function(e){t.prototype.onMouseLeave.call(this,e),e.stopPropagation()},e.prototype.onMouseMove=function(e){t.prototype.onMouseMove.call(this,e),e.stopPropagation();var n=this.scrollBar;if(n.dragging){var r=new h.PonMouseEvent(e.x-n.x,e.y-n.y,e.button);this.scrollBar.onMouseMove(r)}},e.prototype.onMouseDown=function(e){t.prototype.onMouseDown.call(this,e),e.stopPropagation()},e.prototype.onMouseUp=function(e){if(t.prototype.onMouseUp.call(this,e),e.stopPropagation(),e.isLeft){var n=this.scrollBar;if(n.dragging){var r=new h.PonMouseEvent(e.x-n.x,e.y-n.y,e.button);this.scrollBar.onMouseUp(r),this.resource.getCanvasElm().style.cursor=this.resource.cursor.normal}}e.isRight&&this.hide()},e.prototype.onMouseWheel=function(t){return t.isUp?this.scrollUp(this.wheelScrollCount):this.scrollDown(this.wheelScrollCount),!1},e.prototype.store=function(t){return{enableOutput:this.enableOutput}},e.prototype.restore=function(t,e,n){return o(this,void 0,void 0,(function(){return s(this,(function(e){return null!=t.enableOutput&&(this.enableOutput=t.enableOutput),[2]}))}))},e}(u.BaseLayer);e.HistoryLayer=g},function(t,e,n){"use strict";var r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i,o=r(n(9));!function(t){t[t.Unknown=0]="Unknown",t[t.Image=1]="Image",t[t.Color=2]="Color",t[t.Canvas=3]="Canvas"}(i=e.SpriteType||(e.SpriteType={}));var s=function(){function t(t){this._x=0,this._y=0,this._offsetX=0,this._offsetY=0,this._width=32,this._height=32,this._scaleX=1,this._scaleY=1,this._visible=!0,this.pixiSprite=null,this.type=i.Unknown,this.callbacks=t}return Object.defineProperty(t.prototype,"pixiDisplayObject",{get:function(){return this.pixiSprite},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spriteType",{get:function(){return this.type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return this.type===i.Unknown},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,null!=this.pixiSprite&&(this.pixiSprite.x=t+this._offsetX)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,null!=this.pixiSprite&&(this.pixiSprite.y=t+this._offsetY)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,null!=this.pixiSprite&&(this.pixiSprite.width=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,null!=this.pixiSprite&&(this.pixiSprite.height=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleX",{get:function(){return this._scaleX},set:function(t){this._scaleX=t,null!=this.pixiSprite&&(this.pixiSprite.scale.x=t,this._width=this.pixiSprite.width)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleY",{get:function(){return this._scaleY},set:function(t){this._scaleY=t,null!=this.pixiSprite&&(this.pixiSprite.scale.y=t,this._height=this.pixiSprite.height)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible=t,null!=this.pixiSprite&&(this.pixiSprite.visible=t)},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.clear()},t.prototype.clear=function(){try{null!=this.pixiSprite&&(this.callbacks.pixiContainerRemoveChild(this.pixiSprite),this.pixiSprite.destroy({children:!0})),this.pixiSprite=null,this.type=i.Unknown}catch(t){throw console.error(t),t}},t.prototype.fillColor=function(t,e){this.clear(),this.pixiSprite=new o.Graphics,this.pixiSprite.x=this.x,this.pixiSprite.y=this.y,this.pixiSprite.width=this.width,this.pixiSprite.height=this.height,this.pixiSprite.lineStyle(0),this.pixiSprite.beginFill(t,e),this.pixiSprite.drawRect(0,0,this.width,this.height),this.pixiSprite.scale.x=this.scaleX,this.pixiSprite.scale.y=this.scaleY,this.callbacks.pixiContainerAddChild(this.pixiSprite),this.type=i.Color},t.prototype.clearColor=function(){null!=this.pixiSprite&&this.pixiSprite instanceof o.Graphics&&(this.pixiSprite.clear(),this.type=i.Unknown)},t.prototype.setImage=function(t){this.clear();var e=o.Texture.from(t);this.pixiSprite=new o.Sprite(e),this.pixiSprite.x=this.x,this.pixiSprite.y=this.y,this.pixiSprite.anchor.set(0),this.pixiSprite.scale.x=this.scaleX,this.pixiSprite.scale.y=this.scaleY,this._width=this.pixiSprite.width,this._height=this.pixiSprite.height,this.callbacks.pixiContainerAddChild(this.pixiSprite),this.type=i.Image},t.prototype.setCanvas=function(t){this.clear();var e=o.Texture.from(t);this.pixiSprite=new o.Sprite(e),this.pixiSprite.x=this.x,this.pixiSprite.y=this.y,this.pixiSprite.anchor.set(0),this.pixiSprite.scale.x=this.scaleX,this.pixiSprite.scale.y=this.scaleY,this._width=this.pixiSprite.width,this._height=this.pixiSprite.height,this.callbacks.pixiContainerAddChild(this.pixiSprite),this.type=i.Canvas},t.prototype.beforeDraw=function(t){null!=this.pixiSprite&&this.type===i.Canvas&&this.pixiSprite.texture.update()},t}();e.PonSprite=s},function(t,e,n){"use strict";var r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(9)),o=function(){function t(t,e){this.callbacks=e,this.videoTexture=t,this.source.preload="auto",this.videoSprite=new i.Sprite(this.videoTexture),this.videoSprite.width=32,this.videoSprite.height=32,this.callbacks.pixiContainerAddChild(this.videoSprite)}return Object.defineProperty(t.prototype,"texture",{get:function(){return this.videoTexture},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sprite",{get:function(){return this.videoSprite},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"source",{get:function(){return this.videoTexture.baseTexture.resource.source},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.videoSprite.width},set:function(t){this.videoSprite.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.videoSprite.height},set:function(t){this.videoSprite.height=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loop",{get:function(){return this.source.loop},set:function(t){this.source.loop=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this.source.volume},set:function(t){t<0&&(t=0),t>1&&(t=1),this.source.volume=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playing",{get:function(){return!this.source.paused},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.clear()},t.prototype.clear=function(){this.stop(),this.callbacks.pixiContainerRemoveChild(this.videoSprite),this.videoSprite.destroy({children:!0,texture:!0,baseTexture:!0})},t.prototype.play=function(){this.source.play()},t.prototype.stop=function(){this.source.pause(),this.source.currentTime=0},t.prototype.pause=function(){this.source.pause()},t}();e.PonVideo=o},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var u,h=a(n(9)),l=n(13);!function(t){t[t.Stop=0]="Stop",t[t.Run=1]="Run"}(u||(u={}));var c=function(){function t(){this.map=new Map}return t.prototype.genKey=function(t,e){var n={ch:t,style:l.objSort(e.toJson())};return JSON.stringify(n)},t.prototype.get=function(e,n){if(t.ENABLED){var r=this.map.get(this.genKey(e,n));return null==r?null:new h.Sprite(r.texture.clone())}return null},t.prototype.set=function(e,n,r){if(t.ENABLED){n.surroundFontFamily();var i=this.genKey(e,n);this.map.set(i,r),this.map.size>t.MAX_SIZE&&this.map.delete(this.map.keys().next().value)}},t.MAX_SIZE=5e3,t.ENABLED=!0,t}();e.TextSpriteCache=c;var p={align:"left",breakWords:!1,dropShadow:!0,dropShadowAlpha:.7,dropShadowAngle:Math.PI/6,dropShadowBlur:5,dropShadowColor:"#000000",dropShadowDistance:2,fill:"#FFFFFF",fillGradientType:h.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"#000000",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0,edgeColor:"#000000",edgeAlpha:1,pitch:0,inEffectTypes:[],inEffectTime:100,inEffectEase:"none",inEffectOptions:{}},d=l.objExtend(l.objClone(p),{dropShadow:!1,fill:"#FFFFFF",fontFamily:"Arial",fontSize:10,strokeThickness:0,pitch:0}),f=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],g=function(t){function e(e){void 0===e&&(e=p);var n=t.call(this,e)||this;return n._edgeColor=1,n._edgeAlpha=1,n.pitch=0,n.inEffectTypes=[],n.inEffectTime=100,n.inEffectEase="none",n.inEffectOptions={},n.edgeAlpha=1,n}return i(e,t),e.prototype.surroundFontFamily=function(){if(Array.isArray(this.fontFamily)){var t=[];this.fontFamily.forEach((function(e){e=e.trim(),!/(["'])[^'"]+\1/.test(e)&&f.indexOf(e)<0&&(e='"'+e+'"'),t.push(e)})),this.fontFamily=t}},e.prototype.setGradientType=function(t){this.fillGradientType="vertical"===t?h.TEXT_GRADIENT.LINEAR_VERTICAL:h.TEXT_GRADIENT.LINEAR_HORIZONTAL},Object.defineProperty(e.prototype,"edgeColor",{get:function(){return this._edgeColor},set:function(t){this._edgeColor=t,this.resetStroke()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"edgeAlpha",{get:function(){return this._edgeAlpha},set:function(t){this._edgeAlpha=t,this.resetStroke()},enumerable:!0,configurable:!0}),e.prototype.resetStroke=function(){var t;t="number"==typeof this._edgeColor?h.utils.hex2rgb(this._edgeColor):h.utils.hex2rgb(h.utils.string2hex(this._edgeColor)),this.stroke="rgba("+255*t[0]+","+255*t[1]+","+255*t[2]+","+this._edgeAlpha+")"},e.prototype.checkOptions=function(){this.inEffectTypes.includes("move")&&(null==this.inEffectOptions&&(this.inEffectOptions={}),null==this.inEffectOptions.offsetx&&(this.inEffectOptions.offsetx=0),null==this.inEffectOptions.offsety&&(this.inEffectOptions.offsety=0))},e.prototype.clone=function(){var t=new e;return e.assign(t,this),t},e.assign=function(t,e){for(var n in p)Array.isArray(e[n])?t[n]=e[n].slice():"object"==typeof e[n]?t[n]=Object.assign({},e[n]):t[n]=e[n];return t},e.prototype.applyConfig=function(t){null!=t&&Object.assign(this,t)},e.prototype.store=function(t){return e.assign({},this)},e.prototype.restore=function(t,n,r){return o(this,void 0,void 0,(function(){return s(this,(function(n){return e.assign(this,t),[2]}))}))},e.prototype.toJson=function(){return e.assign({},this)},e}(h.TextStyle);e.TextStyle=g;var y=function(){function t(e,n,r,i){this._x=0,this._y=0,this.inEffectState=u.Stop,this.inEffectStartTick=-1,this._offsetX=0,this._offsetY=0,this.style=n.clone(),this.ch=e;var o=t.textCache.get(this.ch,this.style);if(null!=o)this.pixiSprite=o,this.fromCache=!0;else{var s=new h.Text(e,this.style);t.textCache.set(this.ch,this.style,s),this.pixiSprite=s,this.fromCache=!1}this.x=r,this.y=i,this.style.checkOptions(),null!=this.style.inEffectTypes&&this.style.inEffectTypes.length>0&&(this.inEffectState=u.Run)}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this.refreshPosition()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.pixiSprite.y},set:function(t){this._y=t,this.refreshPosition()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.pixiSprite.width+this.style.pitch},set:function(t){this.pixiSprite.width=t-this.style.pitch},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.pixiSprite.alpha},set:function(t){this.pixiSprite.alpha=t},enumerable:!0,configurable:!0}),t.prototype.addTo=function(t){return t.addChild(this.pixiSprite),this},t.prototype.clone=function(){var e=this,n=new t(this.ch,this.style.clone(),this.x,this.y);return t.CloneParams.forEach((function(t){n[t]=e[t]})),n},t.prototype.destroy=function(){this.pixiSprite.parent&&(this.pixiSprite.parent.removeChild(this.pixiSprite),this.fromCache&&this.pixiSprite.destroy({children:!1,texture:!1,baseTexture:!1}))},t.prototype.beforeDraw=function(t){if(this.inEffectState===u.Run){-1===this.inEffectStartTick&&(this.inEffectStartTick=t);var e=t-this.inEffectStartTick,n=e/this.style.inEffectTime;switch(n<0&&(n=0),n>1&&(n=1),this.style.inEffectEase){case"in":n=l.Ease.in(n);break;case"out":n=l.Ease.out(n);break;case"both":n=l.Ease.inOut(n)}return this.style.inEffectTypes.includes("alpha")&&this.InEffectAlpha(e,n),this.style.inEffectTypes.includes("move")&&this.InEffectMove(e,n),e>=this.style.inEffectTime&&(this.inEffectState=u.Stop),!0}return!1},t.prototype.refreshPosition=function(){this.pixiSprite.x=this._x+this._offsetX,this.pixiSprite.y=this._y+this._offsetY},t.prototype.InEffectAlpha=function(t,e){this.alpha=e},t.prototype.InEffectMove=function(t,e){this._offsetX=Math.floor(this.style.inEffectOptions.offsetx*(1-e)),this._offsetY=Math.floor(this.style.inEffectOptions.offsety*(1-e)),this.refreshPosition()},t.textCache=new c,t.CloneParams=["inEffectState","inEffectStartTick","_offsetX","_offsetY","alpha"],t}();e.LayerChar=y;var m=function(){function t(){this.container=new h.Container,this.lineHeight=0,this.chList=[],this.rubyList=[],this._textX=0,this.rubyText="",this.rubyOffset=0,this.rubyStyle=new g(d)}return Object.defineProperty(t.prototype,"x",{get:function(){return this.container.x},set:function(t){this.container.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.container.y},set:function(t){this.container.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.chList.map((function(t){return t.ch})).join("")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ruby",{get:function(){return this.rubyList.map((function(t){return t.ch})).join("")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textX",{get:function(){return this._textX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tailChar",{get:function(){return this.chList[this.chList.length-1].ch},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this.chList.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){if(0===this.chList.length)return 0;var t=0;return this.chList.forEach((function(e){t+=e.width})),t-=this.chList[this.chList.length-1].style.pitch},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.chList.forEach(t)},t.prototype.destroy=function(){this.clear(),this.container.parent&&(this.container.parent.removeChild(this.container),this.container.destroy())},t.prototype.addTo=function(t){return t.addChild(this.container),this},t.prototype.clear=function(){this.chList.forEach((function(t){t.destroy()})),this.chList=[],this.rubyList.forEach((function(t){t.destroy()})),this.rubyList=[],this.container.removeChildren(),this.lineHeight=0,this.rubyText="",this.rubyOffset=0,this.rubyStyle=new g(d)},t.prototype.addChar=function(t,e,n){this.lineHeight<n&&(this.lineHeight=n);var r=this._textX,i=n-+e.fontSize,o=new y(t,e,r,i).addTo(this.container);this._textX+=o.width,this.chList.push(o),""!==this.rubyText&&(this.addRubyText(o),this.rubyText="")},t.prototype.addRubyText=function(t){for(var e=this,n=this.rubyStyle,r=this.rubyText,i=this.rubyStyle.pitch,o=t.x+t.width/2,s=[],a=0,u=0;u<r.length;u++){var h=new y(r.charAt(u),n,0,0).addTo(this.container);s.push(h),a+=h.width+i}a-=i;var l=-(+this.rubyStyle.fontSize+this.rubyOffset),c=o-a/2;s.forEach((function(t){t.y=l,t.x=c,c+=t.width+i,e.rubyList.push(t)}))},t.prototype.reserveRubyText=function(t,e,n){this.rubyText=t,this.rubyOffset=e,this.rubyStyle=n.clone()},t.prototype.getCh=function(t){return this.chList[t]},t.prototype.getTailCh=function(){return this.chList[this.chList.length-1]},t.prototype.backspace=function(){this.chList[this.chList.length-1].destroy(),this.chList.splice(this.chList.length-1,1)},t.prototype.beforeDraw=function(t){this.chList.forEach((function(e){e.beforeDraw(t)}))},t.prototype.copyTo=function(e){e.clear();var n=this,r=e;t.storeParams.forEach((function(t){return r[t]=n[t]})),this.chList.forEach((function(t){e.chList.push(t.clone().addTo(e.container))})),this.rubyList.forEach((function(t){e.rubyList.push(t.clone().addTo(e.container))}))},t.storeParams=["x","y","lineHeight","_textX","rubyText","rubyFontSize","rubyOffset","rubyPitch"],t}();e.LayerTextLine=m;var v=function(){function t(){this._width=32,this._height=32,this.lines=[],this.style=new g,this.lineHeight=26,this.linePitch=10,this.rubyStyle=new g(d),this.marginTop=20,this.marginRight=20,this.marginBottom=20,this.marginLeft=20,this.autoReturn=!0,this.locatePoint=null,this.indentPoint=null,this.reservedIndentPoint=null,this.reservedIndentClear=!1,this.align="left",this.rubyOffset=5,this.lineHeight=+this.style.fontSize,this.container=new h.Container,this.container.x=0,this.container.y=0,this.clear()}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this.clear()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this.clear()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.lines.map((function(t){return t.text})).join("\n")},enumerable:!0,configurable:!0}),t.prototype.addTo=function(t){return t.addChild(this.container),this},t.prototype.beforeDraw=function(t){this.lines.forEach((function(e){e.beforeDraw(t)}))},Object.defineProperty(t.prototype,"currentLine",{get:function(){return this.lines[this.lines.length-1]},enumerable:!0,configurable:!0}),t.prototype.addText=function(t){if(null!=t&&""!==t)for(var e=0;e<t.length;e++)this.addChar(t.charAt(e))},t.prototype.addChar=function(e){if(null!=e&&""!=e){if("string"!=typeof e&&(e=""+e),e.length>1)return this.addText(e);var n=this.currentLine,r=n.getTailCh();n.addChar(e,this.style,this.lineHeight),this.alignCurrentTextLine();var i=this.autoReturn&&this.shouldBeNewTextLine();i&&null!=r&&-1!==t.tailProhibitionChar.indexOf(r.ch)&&(i=!1),i&&-1!==t.headProhibitionChar.indexOf(e)&&(i=!1),i&&(n.backspace(),this.alignCurrentTextLine(),this.addTextReturn(),this.currentLine.addChar(e,this.style,this.lineHeight),this.alignCurrentTextLine())}},t.prototype.getNextTextPos=function(t){var e=this.currentLine,n=e.x+e.width,r=0,i=e.y,o=!1;switch(this.align){case"left":this.shouldBeNewTextLine(t)?(r=this.getTextLineBasePoint(),i=this.currentLine.y+this.lineHeight+this.linePitch,o=!0):(r=n,i=e.y);break;case"center":this.shouldBeNewTextLine(t)?(r=this.getTextLineBasePoint()-t/2,i=this.currentLine.y+this.lineHeight+this.linePitch,o=!0):(r=n+t/2,i=e.y);break;case"right":r=n,i=e.y,this.shouldBeNewTextLine(t)?(r=this.getTextLineBasePoint()-t,i=this.currentLine.y+this.lineHeight+this.linePitch,o=!0):(r=n,i=e.y)}return{x:r,y:i,newLineFlag:o}},t.prototype.shouldBeNewTextLine=function(t){void 0===t&&(t=0);var e=this.currentLine,n=e.x,r=e.x+e.width;switch(this.align){case"left":return r+t>this.width-this.marginRight;case"center":return n-t/2<this.marginLeft||r+t/2>this.width-this.marginRight;case"right":return n-t<this.marginLeft}},t.prototype.addTextReturn=function(){var t=this.currentLine.y;this.lines.push((new m).addTo(this.container)),null!=this.reservedIndentPoint?this.indentPoint=this.reservedIndentPoint:this.reservedIndentClear&&(this.indentPoint=null,this.reservedIndentClear=!1),this.locatePoint=null,this.alignCurrentTextLine(),this.currentLine.y=t+this.lineHeight+this.linePitch},t.prototype.alignCurrentTextLine=function(){var t=this.currentLine;switch(this.align){case"left":t.x=this.getTextLineBasePoint();break;case"center":t.x=this.getTextLineBasePoint()-t.width/2;break;case"right":t.x=this.getTextLineBasePoint()-t.width}},t.prototype.getTextLineBasePoint=function(){if(null!=this.locatePoint)return this.locatePoint;switch(this.align){case"left":return null==this.indentPoint?this.marginLeft:this.indentPoint;case"center":return null==this.indentPoint?this.marginLeft+(this.width-this.marginLeft-this.marginRight)/2:this.indentPoint+(this.width-this.indentPoint-this.marginRight)/2;case"right":return null==this.indentPoint?this.width-this.marginRight:this.indentPoint}},t.prototype.setCharLocate=function(t,e){var n=this.currentLine;this.addTextReturn();var r=this.currentLine;if(null!=t)this.locatePoint=t;else switch(this.align){case"left":this.locatePoint=n.x+n.width;break;case"center":this.locatePoint=n.x+n.width/2;break;case"right":this.locatePoint=n.x}r.y=null!=e?e:n.y},t.prototype.setIndentPoint=function(){var t=this.currentLine;switch(this.align){case"left":case"center":this.reservedIndentPoint=t.x+t.width;break;case"right":this.reservedIndentPoint=t.x}},t.prototype.clearIndentPoint=function(){this.reservedIndentPoint=null,this.reservedIndentClear=!0},t.prototype.reserveRubyText=function(t){this.currentLine.reserveRubyText(t,this.rubyOffset,this.rubyStyle)},t.prototype.clear=function(){this.lines.forEach((function(t){t.destroy()})),this.lines=[],this.lines.push((new m).addTo(this.container)),this.locatePoint=null,this.indentPoint=null,this.reservedIndentPoint=null,this.reservedIndentClear=!1,this.currentLine.x=this.getTextLineBasePoint(),this.currentLine.y=this.marginTop},t.prototype.copyTo=function(e){e.clear(),e.width=this.width,e.height=this.height,e.style=this.style.clone(),e.rubyStyle=this.rubyStyle.clone();var n=this,r=e;t.storeParams.forEach((function(t){return r[t]=n[t]})),e.lines=[],this.lines.forEach((function(t){var n=(new m).addTo(e.container);t.copyTo(n),e.lines.push(n)}))},t.prototype.store=function(e){var n={},r=this;return t.storeParams.forEach((function(t){return n[t]=r[t]})),n.width=this.width,n.height=this.height,n.style=this.style.store(e),n.rubyStyle=this.rubyStyle.store(e),n},t.prototype.restore=function(e,n,r){return o(this,void 0,void 0,(function(){var i;return s(this,(function(o){return i=this,t.storeParams.forEach((function(t){return i[t]=e[t]})),r&&this.clear(),this.width!=e.width&&(this.clear(),this.width=e.width),this.height!=e.height&&(this.clear(),this.height=e.height),this.style.restore(e.style,n,r),this.rubyStyle.restore(e.rubyStyle,n,r),[2]}))}))},t.prototype.applyConfig=function(t){if(null!=t){var e=this;Object.keys(t).forEach((function(n){n in e&&(e[n]=t[n])})),null!=t.styleConfig&&this.style.applyConfig(t.styleConfig),null!=t.rubyStyleConfig&&this.rubyStyle.applyConfig(t.rubyStyleConfig)}},t.headProhibitionChar='%),:;]}｡｣ﾞﾟ。，、．：；゛゜ヽヾゝ"ゞ々’”）〕］｝〉》」』】°′″℃￠％‰!.?､･ｧｨｩｪｫｬｭｮｯｰ・？！ーぁぃぅぇぉっゃゅょゎァィゥェォッャュョヮヵヶ',t.tailProhibitionChar="\\$([{｢‘“（〔［｛〈《「『【￥＄￡",t.storeParams=["lineHeight","linePitch","marginTop","marginRight","marginBottom","marginLeft","autoReturn","locatePoint","indentPoint","reservedIndentPoint","reservedIndentClear","align","rubyFontSize","rubyOffset","rubyPitch"],t}();e.LayerTextCanvas=v,h.TextMetrics.BASELINE_SYMBOL+="ぽン甘｜|gq"},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(15),u=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.autoHideWithMessage=!1,i.childImages=[],i.visibleBuffer=i.visible,i}return i(e,t),e.prototype.addChar=function(e){t.prototype.addChar.call(this,e),null!=e&&e.length>0&&this.owner.onAddChar(this,e)},e.prototype.addTextReturn=function(){t.prototype.addTextReturn.call(this),this.owner.onTextReturn(this)},e.prototype.loadChildImage=function(t,e,n,r){return o(this,void 0,void 0,(function(){var i;return s(this,(function(o){switch(o.label){case 0:return i=new a.BaseLayer("ChildImage (filePath)",this.resource,this.owner),this.addChild(i),this.childImages.push(i),i.x=e,i.y=n,[4,i.loadImage(t)];case 1:return o.sent(),i.alpha=r,i.visible=!0,[2]}}))}))},e.prototype.freeChildImages=function(){var t=this;this.childImages.forEach((function(e){e.freeImage(),e.destroy(),t.deleteChildLayer(e)})),this.childImages=[]},e.prototype.freeImage=function(){t.prototype.freeImage.call(this)},e.prototype.storeVisible=function(){this.visibleBuffer=this.visible},e.prototype.restoreVisible=function(){this.visible=this.visibleBuffer},e.prototype.store=function(n){var r=t.prototype.store.call(this,n),i=this;return e.ponLayerStoreParams.forEach((function(t){return r[t]=i[t]})),r.childImages=this.childImages.map((function(t){return t.store(n)})),r},e.prototype.restore=function(n,r,i){return o(this,void 0,void 0,(function(){var o,u=this;return s(this,(function(s){switch(s.label){case 0:return[4,t.prototype.restore.call(this,n,r,i)];case 1:return s.sent(),o=this,e.ponLayerStoreParams.forEach((function(t){return o[t]=n[t]})),n.childImages.length>0?n.childImages.length!==this.childImages.length?[3,3]:[4,Promise.all(n.childImages.map((function(t,e){return u.childImages[e].restore(t,r,i)})))]:[3,6];case 2:return s.sent(),[3,5];case 3:return this.freeChildImages(),[4,Promise.all(n.childImages.map((function(t){var e=new a.BaseLayer(t.name,u.resource,u.owner);return u.addChild(e),u.childImages.push(e),e.restore(t,r,i)})))];case 4:s.sent(),s.label=5;case 5:return[3,7];case 6:this.freeChildImages(),s.label=7;case 7:return[2]}}))}))},e.prototype.copyTo=function(n){var r=this;t.prototype.copyTo.call(this,n);var i=this,o=n;e.ponLayerStoreParams.forEach((function(t){return o[t]=i[t]})),n.freeChildImages(),this.childImages.forEach((function(t){var e=new a.BaseLayer(t.name,r.resource,r.owner);n.addChild(e),n.childImages.push(e),t.copyTo(e)}))},e.ponLayerStoreParams=["autoHideWithMessage","visibleBuffer"],e}(n(70).FilteredLayer);e.PonLayer=u},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(71),u=n(76),h=n(78),l=n(79),c=function(t){function e(n,r,i){var o=t.call(this,n,r,i)||this;return o._filters=[],o._filters=[],null==e.filterClassList&&(e.filterClassList={},e.registerFilter(h.BlurFilter.filterName,h.createBlurFilter),e.registerFilter(l.ColorMatrixFilter.filterName,l.createColorMatrixFilter),e.registerFilter(u.ColorFilter.filterName,u.createColorFilter)),o}return i(e,t),Object.defineProperty(e.prototype,"pixiFilters",{get:function(){return null==this.container.filters?[]:this.container.filters},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filters",{get:function(){return this._filters},enumerable:!0,configurable:!0}),e.registerFilter=function(t,n){e.filterClassList[t]=n},e.prototype.addFilter=function(t,n){var r=(0,e.filterClassList[t])(n);this.addLayerFilter(r)},e.prototype.addLayerFilter=function(t){this.filters.push(t);var e=[];this.filters.forEach((function(t){e.push(t.pixiFilter)})),this.container.filters=e},e.prototype.clearFilters=function(){this._filters=[],this.container.filters=[]},e.prototype.store=function(e){var n=t.prototype.store.call(this,e);return n.filters=[],this.filters.forEach((function(t){n.filters.push({filterName:t.filterName,data:t.store()})})),n},e.prototype.restore=function(e,n,r){return o(this,void 0,void 0,(function(){var i=this;return s(this,(function(o){switch(o.label){case 0:return[4,t.prototype.restore.call(this,e,n,r)];case 1:return o.sent(),this.clearFilters(),null!=e.filters&&e.filters.forEach((function(t){i.addFilter(t.filterName,t.data)})),[2]}}))}))},e.prototype.copyTo=function(e){t.prototype.copyTo.call(this,e),e.clearFilters(),this.filters.forEach((function(t){e.addFilter(t.filterName,t.store())}))},e.filterClassList=null,e}(a.MovableLayer);e.FilteredLayer=c},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(26),u=n(13),h=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i._isMoving=!1,i.moveType="linear",i.moveEase="none",i.movePosList=[],i.movePoint=0,i.moveTime=0,i.moveDelay=0,i.moveLoop=!1,i.moveTotalTime=0,i.moveStartTick=-1,i.moveDelayStartTick=-1,i}return i(e,t),Object.defineProperty(e.prototype,"isMoving",{get:function(){return this._isMoving},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoopMoving",{get:function(){return this.moveLoop},enumerable:!0,configurable:!0}),e.prototype.startMove=function(t,e,n,r,i,o,s){if("bezier2"===i&&2!==r.length)throw new Error("bezier2ではpathを2点指定する必要があります。");if("bezier3"===i&&3!==r.length)throw new Error("bezier3ではpathを3点指定する必要があります。");if("catmullrom"===i&&r.length<2)throw new Error("catmullromではpathを2点以上指定する必要があります。");if(s&&"linear"!==i&&"catmullrom"!==i)throw new Error("自動移動をループできるのはlinearまたはcatmullromの場合のみです。");this._isMoving=!0,this.moveType=i,this.moveEase=o,this.movePoint=0,this.moveTime=e,this.moveDelay=n,this.moveLoop=s,this.moveTotalTime=e*(r.length-1),this.moveStartTick=-1,this.moveDelayStartTick=-1;var a=this.clonePath(r);a.unshift({x:this.x,y:this.y,alpha:this.alpha,scalex:this.scaleX,scaley:this.scaleY});for(var u=1;u<a.length;u++){var h=a[u-1],l=a[u];null==l.x&&(l.x=h.x),null==l.y&&(l.y=h.y),null==l.alpha&&(l.alpha=h.alpha),null==l.scalex&&(l.scalex=h.scalex),null==l.scaley&&(l.scaley=h.scaley)}this.movePosList=a,"bezier2"!==i&&"bezier3"!==i||(this.moveTime=this.moveTotalTime)},e.prototype.stopMove=function(t){if(void 0===t&&(t=!0),this._isMoving){var e=this.movePosList[this.movePosList.length-1];this.x=e.x,this.y=e.y,this.alpha=e.alpha,this.scaleX=e.scalex,this.scaleY=e.scaley,this._isMoving=!1,this.movePosList=[],this.moveLoop=!1,t&&this.owner.conductor.trigger("move")}},e.prototype.clonePath=function(t){var e=[];return t.forEach((function(t){var n={};Object.keys(t).forEach((function(e){n[e]=t[e]})),e.push(n)})),e},e.prototype.beforeDraw=function(e){if(t.prototype.beforeDraw.call(this,e),this._isMoving){if(-1===this.moveDelayStartTick&&(this.moveDelayStartTick=e),e-this.moveDelayStartTick<this.moveDelay)return;-1===this.moveStartTick&&(this.moveStartTick=e);var n=(e-this.moveStartTick)/this.moveTime;switch(this.moveEase){case"in":n=u.Ease.in(n);break;case"out":n=u.Ease.out(n);break;case"both":n=u.Ease.inOut(n)}switch(n>1&&(n=1),this.moveType){case"bezier2":this.moveBezierCurve2(e,n);break;case"bezier3":this.moveBezierCurve3(e,n);break;case"catmullrom":this.moveCatmullRom(e,n);break;default:this.moveLinear(e,n)}}},e.prototype.moveLinear=function(t,e){var n,r=this.movePosList[this.movePoint];if(n=this.movePoint+1<this.movePosList.length?this.movePosList[this.movePoint+1]:this.movePosList[0],this.x=Math.floor(r.x+(n.x-r.x)*e),this.y=Math.floor(r.y+(n.y-r.y)*e),this.alpha=r.alpha+(n.alpha-r.alpha)*e,this.scaleX=r.scalex+(n.scalex-r.scalex)*e,this.scaleY=r.scaley+(n.scaley-r.scaley)*e,t-this.moveStartTick>=this.moveTime)if(this.movePoint++,this.moveLoop){this.movePoint>=this.movePosList.length&&(this.movePoint=0),this.moveStartTick+=this.moveTime;var i=this.movePosList[this.movePoint];this.x=i.x,this.y=i.y}else if(this.movePoint+1<this.movePosList.length){this.moveStartTick+=this.moveTime;i=this.movePosList[this.movePoint];this.x=i.x,this.y=i.y}else this.stopMove()},e.prototype.moveBezierCurve2=function(t,e){var n=this.movePosList[0],r=this.movePosList[1],i=this.movePosList[2],o=e;this.x=(1-o)*(1-o)*n.x+2*(1-o)*o*r.x+o*o*i.x,this.y=(1-o)*(1-o)*n.y+2*(1-o)*o*r.y+o*o*i.y,this.alpha=n.alpha+(i.alpha-n.alpha)*e,this.scaleX=n.scalex+(i.scalex-n.scalex)*e,this.scaleY=n.scaley+(i.scaley-n.scaley)*e,t-this.moveStartTick>=this.moveTime&&this.stopMove()},e.prototype.moveBezierCurve3=function(t,e){var n=this.movePosList[0],r=this.movePosList[1],i=this.movePosList[2],o=this.movePosList[3],s=e;this.x=(1-s)*(1-s)*(1-s)*n.x+3*(1-s)*(1-s)*s*r.x+3*(1-s)*s*s*i.x+s*s*s*o.x,this.y=(1-s)*(1-s)*(1-s)*n.y+3*(1-s)*(1-s)*s*r.y+3*(1-s)*s*s*i.y+s*s*s*o.y,this.alpha=n.alpha+(o.alpha-n.alpha)*e,this.scaleX=n.scalex+(o.scalex-n.scalex)*e,this.scaleY=n.scaley+(o.scaley-n.scaley)*e,t-this.moveStartTick>=this.moveTime&&this.stopMove()},e.prototype.moveCatmullRom=function(t,e){var n,r,i,o,s=this.movePoint,a=this.movePosList;if(this.moveLoop?(n=s-1<0?a[a.length-1]:a[s-1],r=a[s],i=a[(s+1)%a.length],o=a[(s+2)%a.length]):0===s?(n=a[s],r=a[s],i=a[s+1],o=a[s+2]):s+2>=a.length?(n=a[s-1],r=a[s],i=a[s+1],o=a[s+1]):(n=a[s-1],r=a[s],i=a[s+1],o=a[s+2]),this.x=this.catmullRom(n.x,r.x,i.x,o.x,e),this.y=this.catmullRom(n.y,r.y,i.y,o.y,e),this.alpha=r.alpha+(i.alpha-r.alpha)*e,this.scaleX=r.scalex+(i.scalex-r.scalex)*e,this.scaleY=r.scaley+(i.scaley-r.scaley)*e,t-this.moveStartTick>=this.moveTime)if(this.movePoint++,this.moveLoop){this.movePoint>=this.movePosList.length&&(this.movePoint=0),this.moveStartTick+=this.moveTime;var u=this.movePosList[this.movePoint];this.x=u.x,this.y=u.y}else if(this.movePoint+1<this.movePosList.length){this.moveStartTick+=this.moveTime;u=this.movePosList[this.movePoint];this.x=u.x,this.y=u.y}else this.stopMove()},e.prototype.catmullRom=function(t,e,n,r,i){var o=(n-t)/2,s=(r-e)/2,a=i*i;return(2*e-2*n+o+s)*(a*i)+(-3*e+3*n-2*o-s)*a+o*i+e},e.prototype.store=function(n){var r=t.prototype.store.call(this,n),i=this;if(this.isMoving)if(this.moveLoop)e.movableLayerStoreParams.forEach((function(t){r[t]=i[t]}));else{var o=this.movePosList[this.movePosList.length-1];r.x=o.x,r.y=o.y,r.alpha=o.alpha}return r},e.prototype.restore=function(n,r,i){return o(this,void 0,void 0,(function(){var o;return s(this,(function(s){switch(s.label){case 0:return this.stopMove(!1),[4,t.prototype.restore.call(this,n,r,i)];case 1:return s.sent(),n.moveLoop&&(o=this,e.movableLayerStoreParams.forEach((function(t){o[t]=n[t]})),this.moveDelay=0,this.moveDelayStartTick=-1,this.moveStartTick=-1),[2]}}))}))},e.prototype.copyTo=function(n){t.prototype.copyTo.call(this,n);var r=this,i=n;e.movableLayerStoreParams.forEach((function(t){return i[t]=r[t]}))},e.movableLayerStoreParams=["_isMoving","moveType","moveEase","movePosList","movePoint","moveTime","moveDelay","moveLoop","moveTotalTime","moveStartTick","moveDelayStartTick"],e}(a.SliderLayer);e.MovableLayer=h},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(73),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.direction="horizontal",e.varName="toggle-button-value",e.toggleState=!1,e.offImageFile="",e}return i(e,t),e.prototype.initImageToggleButton=function(t,e,n,r,i,a,u,h,l,c,p,d,f,g,y,m){return void 0===t&&(t=!0),void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=!0),void 0===a&&(a=!1),void 0===u&&(u=null),void 0===h&&(h=null),void 0===l&&(l=null),void 0===y&&(y=null),o(this,void 0,void 0,(function(){return s(this,(function(o){switch(o.label){case 0:return this.clearCommandButton(),this.freeImage(),this.initCommandButton(t,e,n,r,i,a,u,h,l,d,f,g,y),this.direction=p,this.varName=m,this.resource.tmpVar[this.varName]=this.toggleState,[4,this.loadImage(c)];case 1:return o.sent(),"vertical"===this.direction?this.height=Math.floor(this.imageHeight/6):this.width=Math.floor(this.imageHeight/6),this.setButtonStatus("disabled"),[2]}}))}))},e.prototype.clearCommandButton=function(){t.prototype.clearCommandButton.call(this),this.varName="toggle-button-value",this.toggleState=!1},e.prototype.setButtonStatus=function(e){if(t.prototype.setButtonStatus.call(this,e),"vertical"===this.direction){var n=this.toggleState?-Math.floor(this.imageHeight/2):0;switch(e){case"normal":case"disabled":this.imageY=n;break;case"over":this.imageY=n-Math.floor(this.imageHeight/6);break;case"on":this.imageY=n-Math.floor(this.imageHeight/6*2)}}else{n=this.toggleState?-Math.floor(this.imageWidth/2):0;switch(e){case"normal":case"disabled":this.imageX=n;break;case"over":this.imageX=n-Math.floor(this.imageWidth/6);break;case"on":this.imageX=n-Math.floor(this.imageWidth/6*2)}}},e.prototype.submit=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.toggleState=!this.toggleState,this.resource.tmpVar[this.varName]=this.toggleState,[4,t.prototype.submit.call(this)];case 1:return e.sent(),[2]}}))}))},e.prototype.store=function(n){var r=t.prototype.store.call(this,n),i=this;return e.toggleButtonStoreParams.forEach((function(t){r[t]=i[t]})),r},e.prototype.restore=function(e,n,r){return o(this,void 0,void 0,(function(){return s(this,(function(i){switch(i.label){case 0:return[4,t.prototype.restore.call(this,e,n,r)];case 1:return i.sent(),[2]}}))}))},e.prototype.restoreAfterLoadImage=function(n,r){var i=this;e.toggleButtonStoreParams.forEach((function(t){i[t]=n[t]})),this.resource.tmpVar[this.varName]=this.toggleState,t.prototype.restoreAfterLoadImage.call(this,n,r)},e.prototype.copyTo=function(n){t.prototype.copyTo.call(this,n);var r=this,i=n;e.toggleButtonStoreParams.forEach((function(t){i[t]=r[t]}))},e.toggleButtonStoreParams=["varName","toggleState","onImageFile","offImageFile"],e}(n(16).CommandButton);e.ImageToggleButton=u;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imageToggleButtons=[],e}return i(e,t),e.prototype.addToggleButton=function(t,e,n,r,i,a,h,l,c,p,d,f,g,y,m,v,b,_){return void 0===t&&(t=!0),void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=!0),void 0===a&&(a=null),void 0===h&&(h=null),void 0===l&&(l=null),void 0===b&&(b=null),o(this,void 0,void 0,(function(){var o,x;return s(this,(function(s){switch(s.label){case 0:return o="ImageToggleButton "+this.imageToggleButtons.length,x=new u(o,this.resource,this.owner),this.addChild(x),this.imageToggleButtons.push(x),x.x=p,x.y=d,[4,x.initImageToggleButton(t,e,n,r,i,g,a,h,l,c,f,y,m,v,b,_)];case 1:return s.sent(),[2]}}))}))},e.prototype.clearToggleButtons=function(){var t=this;this.imageToggleButtons.forEach((function(e){e.clearCommandButton(),e.destroy(),t.deleteChildLayer(e)})),this.imageToggleButtons=[]},e.prototype.hasToggleButton=function(){return this.imageToggleButtons.length>0},e.prototype.getButtons=function(){var e=t.prototype.getButtons.call(this);return this.imageToggleButtons.forEach((function(t){e.push(t)})),e},e.prototype.lockButtons=function(){t.prototype.lockButtons.call(this),this.imageToggleButtons.forEach((function(t){t.setButtonStatus("disabled")}))},e.prototype.unlockButtons=function(){t.prototype.unlockButtons.call(this),this.imageToggleButtons.forEach((function(t){t.setButtonStatus("normal")}))},e.prototype.lockSystemButtons=function(){t.prototype.lockSystemButtons.call(this),this.imageToggleButtons.forEach((function(t){t.lockSystemButton()}))},e.prototype.unlockSystemButtons=function(){t.prototype.unlockSystemButtons.call(this),this.imageToggleButtons.forEach((function(t){t.unlockSystemButton()}))},e.prototype.store=function(e){var n=t.prototype.store.call(this,e);return n.imageToggleButtons=this.imageToggleButtons.map((function(t){return t.store(e)})),n},e.prototype.restore=function(e,n,r){return o(this,void 0,void 0,(function(){var i=this;return s(this,(function(o){switch(o.label){case 0:return null!=e.imageToggleButtons&&e.imageToggleButtons.length>0?e.imageToggleButtons.length!==this.imageToggleButtons.length?[3,2]:[4,Promise.all(e.imageToggleButtons.map((function(t,e){return i.imageToggleButtons[e].restore(t,n,r)})))]:[3,5];case 1:return o.sent(),[3,4];case 2:return this.clearToggleButtons(),[4,Promise.all(e.imageToggleButtons.forEach((function(t){var e=new u(t.name,i.resource,i.owner);return i.addChild(e),i.imageToggleButtons.push(e),e.restore(t,n,r)})))];case 3:o.sent(),o.label=4;case 4:return[3,6];case 5:this.clearToggleButtons(),o.label=6;case 6:return[4,t.prototype.restore.call(this,e,n,r)];case 7:return o.sent(),[2]}}))}))},e.prototype.restoreAfterLoadImage=function(e,n){if(t.prototype.restoreAfterLoadImage.call(this,e,n),null!=e.imageToggleButtons&&e.imageToggleButtons.length>0)for(var r=0;r<e.imageToggleButtons.length;r++)this.imageToggleButtons[r].restoreAfterLoadImage(e.imageToggleButtons[r],n)},e.prototype.copyTo=function(e){t.prototype.copyTo.call(this,e),e.clearToggleButtons(),this.imageToggleButtons.forEach((function(t){var n=new u(name,e.resource,e.owner);e.addChild(n),e.imageToggleButtons.push(n),t.copyTo(n)}))},e}(a.ImageButtonLayer);e.ToggleButtonLayer=h},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(16),u=n(74),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.direction="horizontal",e}return i(e,t),e.prototype.initImageButton=function(t,e,n,r,i,a,u,h,l,c,p,d,f,g,y){return void 0===t&&(t=!0),void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=!0),void 0===a&&(a=!1),void 0===u&&(u=null),void 0===h&&(h=null),void 0===l&&(l=null),void 0===y&&(y=null),o(this,void 0,void 0,(function(){return s(this,(function(o){switch(o.label){case 0:return this.clearCommandButton(),this.freeImage(),this.initCommandButton(t,e,n,r,i,a,u,h,l,d,f,g,y),this.direction=p,[4,this.loadImage(c)];case 1:return o.sent(),"vertical"===this.direction?this.height=Math.floor(this.imageHeight/3):this.width=Math.floor(this.imageWidth/3),this.setButtonStatus("disabled"),this.resetImageButtonPosition("normal"),[2]}}))}))},e.prototype.clearCommandButton=function(){t.prototype.clearCommandButton.call(this),this.direction="horizontal"},e.prototype.setButtonStatus=function(e){t.prototype.setButtonStatus.call(this,e),this.resetImageButtonPosition(e)},e.prototype.resetImageButtonPosition=function(t){if("vertical"===this.direction)switch(t){case"disabled":break;case"normal":this.imageY=0;break;case"over":this.imageY=-Math.floor(this.imageHeight/3);break;case"on":this.imageY=-Math.floor(this.imageHeight/3*2)}else switch(t){case"disabled":break;case"normal":this.imageX=0;break;case"over":this.imageX=-Math.floor(this.imageWidth/3);break;case"on":this.imageX=-Math.floor(this.imageWidth/3*2)}},e.prototype.store=function(n){var r=t.prototype.store.call(this,n),i=this;return e.imageButtonStoreParams.forEach((function(t){r[t]=i[t]})),r},e.prototype.restore=function(e,n,r){return o(this,void 0,void 0,(function(){return s(this,(function(i){switch(i.label){case 0:return[4,t.prototype.restore.call(this,e,n,r)];case 1:return i.sent(),[2]}}))}))},e.prototype.restoreAfterLoadImage=function(n,r){var i=this;e.imageButtonStoreParams.forEach((function(t){i[t]=n[t]})),t.prototype.restoreAfterLoadImage.call(this,n,r)},e.prototype.copyTo=function(n){t.prototype.copyTo.call(this,n);var r=this,i=n;e.imageButtonStoreParams.forEach((function(t){i[t]=r[t]}))},e.imageButtonStoreParams=["direction"],e}(a.CommandButton);e.CommandImageButton=h;var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imageButtons=[],e}return i(e,t),e.prototype.addImageButton=function(t,e,n,r,i,a,u,l,c,p,d,f,g,y,m,v,b){return void 0===t&&(t=!0),void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=!0),void 0===a&&(a=null),void 0===u&&(u=null),void 0===l&&(l=null),void 0===b&&(b=null),o(this,void 0,void 0,(function(){var o,_;return s(this,(function(s){switch(s.label){case 0:return o="ImageButton "+this.imageButtons.length,_=new h(o,this.resource,this.owner),this.addChild(_),this.imageButtons.push(_),_.x=p,_.y=d,[4,_.initImageButton(t,e,n,r,i,g,a,u,l,c,f,y,m,v,b)];case 1:return s.sent(),[2]}}))}))},e.prototype.clearImageButtons=function(){var t=this;this.imageButtons.forEach((function(e){e.clearCommandButton(),e.destroy(),t.deleteChildLayer(e)})),this.imageButtons=[]},e.prototype.hasImageButton=function(){return this.imageButtons.length>0},e.prototype.getButtons=function(){var e=t.prototype.getButtons.call(this);return this.imageButtons.forEach((function(t){e.push(t)})),e},e.prototype.lockButtons=function(){t.prototype.lockButtons.call(this),this.imageButtons.forEach((function(t){t.setButtonStatus("disabled")}))},e.prototype.unlockButtons=function(){t.prototype.unlockButtons.call(this),this.imageButtons.forEach((function(t){t.setButtonStatus("normal")}))},e.prototype.lockSystemButtons=function(){t.prototype.lockSystemButtons.call(this),this.imageButtons.forEach((function(t){t.lockSystemButton()}))},e.prototype.unlockSystemButtons=function(){t.prototype.unlockSystemButtons.call(this),this.imageButtons.forEach((function(t){t.unlockSystemButton()}))},e.prototype.store=function(e){var n=t.prototype.store.call(this,e);return n.imageButtons=this.imageButtons.map((function(t){return t.store(e)})),n},e.prototype.restore=function(e,n,r){return o(this,void 0,void 0,(function(){var i=this;return s(this,(function(o){switch(o.label){case 0:return null!=e.imageButtons&&e.imageButtons.length>0?e.imageButtons.length!==this.imageButtons.length?[3,2]:[4,Promise.all(e.imageButtons.map((function(t,e){return i.imageButtons[e].restore(t,n,r)})))]:[3,5];case 1:return o.sent(),[3,4];case 2:return this.clearImageButtons(),[4,Promise.all(e.imageButtons.map((function(t){var e=new h(t.name,i.resource,i.owner);return i.addChild(e),i.imageButtons.push(e),e.restore(t,n,r)})))];case 3:o.sent(),o.label=4;case 4:return[3,6];case 5:this.clearImageButtons(),o.label=6;case 6:return[4,t.prototype.restore.call(this,e,n,r)];case 7:return o.sent(),[2]}}))}))},e.prototype.restoreAfterLoadImage=function(e,n){if(t.prototype.restoreAfterLoadImage.call(this,e,n),null!=e.imageButtons&&e.imageButtons.length>0)for(var r=0;r<e.imageButtons.length;r++)this.imageButtons[r].restoreAfterLoadImage(e.imageButtons[r],n)},e.prototype.copyTo=function(e){t.prototype.copyTo.call(this,e),e.clearImageButtons(),this.imageButtons.forEach((function(t){var n=new h(t.name,e.resource,e.owner);e.addChild(n),e.imageButtons.push(n),t.copyTo(n)}))},e}(u.TextButtonLayer);e.ImageButtonLayer=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(16),u=n(75),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtBtnText="",e.txtBtnNormalBackgroundColor=0,e.txtBtnOverBackgroundColor=0,e.txtBtnOnBackgroundColor=0,e.txtBtnNormalBackgroundAlpha=1,e.txtBtnOverBackgroundAlpha=1,e.txtBtnOnBackgroundAlpha=1,e}return i(e,t),e.prototype.initTextButton=function(t,e,n,r,i,o,s,a,u,h,l,c,p,d,f,g,y,m,v,b){void 0===t&&(t=!0),void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=!0),void 0===o&&(o=!1),void 0===s&&(s=null),void 0===a&&(a=null),void 0===u&&(u=null),void 0===h&&(h=""),void 0===l&&(l=0),void 0===c&&(c=0),void 0===p&&(p=0),void 0===d&&(d=1),void 0===f&&(f=1),void 0===g&&(g=1),void 0===y&&(y=""),void 0===m&&(m=""),void 0===v&&(v=""),void 0===b&&(b=null),this.clearCommandButton(),this.freeImage(),this.clearText(),this.initCommandButton(t,e,n,r,i,o,s,a,u,y,m,v,b),this.txtBtnText=h,this.txtBtnNormalBackgroundColor=l,this.txtBtnOverBackgroundColor=c,this.txtBtnOnBackgroundColor=p,this.txtBtnNormalBackgroundAlpha=d,this.txtBtnOverBackgroundAlpha=f,this.txtBtnOnBackgroundAlpha=g,this.setBackgroundColor(l,d),this.addText(h),this.setButtonStatus("disabled")},e.prototype.clearCommandButton=function(){t.prototype.clearCommandButton.call(this),this.txtBtnText="",this.txtBtnNormalBackgroundColor=0,this.txtBtnOverBackgroundColor=0,this.txtBtnOnBackgroundColor=0,this.txtBtnNormalBackgroundAlpha=1,this.txtBtnOverBackgroundAlpha=1,this.txtBtnOnBackgroundAlpha=1},e.prototype.setButtonStatus=function(e){t.prototype.setButtonStatus.call(this,e),this.resetTextButtonColors()},e.prototype.resetTextButtonColors=function(){var t=null,e=null;switch(this.buttonStatus){case"disabled":break;case"normal":t=this.txtBtnNormalBackgroundColor,e=this.txtBtnNormalBackgroundAlpha;break;case"over":t=this.txtBtnOverBackgroundColor,e=this.txtBtnOverBackgroundAlpha;break;case"on":t=this.txtBtnOnBackgroundColor,e=this.txtBtnOnBackgroundAlpha}null!=t&&null!=e&&this.setBackgroundColor(t,e)},e.prototype.store=function(n){var r=t.prototype.store.call(this,n),i=this;return e.textButtonStoreParams.forEach((function(t){r[t]=i[t]})),r},e.prototype.restoreAfterLoadImage=function(n,r){t.prototype.restoreAfterLoadImage.call(this,n,r);var i=this;e.textButtonStoreParams.forEach((function(t){i[t]=n[t]})),this.clearText(),this.addText(n.txtBtnText)},e.prototype.copyTo=function(n){t.prototype.copyTo.call(this,n);var r=this,i=n;e.textButtonStoreParams.forEach((function(t){i[t]=r[t]}))},e.textButtonStoreParams=["txtBtnText","txtBtnNormalBackgroundColor","txtBtnOverBackgroundColor","txtBtnOnBackgroundColor","txtBtnNormalBackgroundAlpha","txtBtnOverBackgroundAlpha","txtBtnOnBackgroundAlpha"],e}(a.CommandButton);e.TextButton=h;var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.textButtons=[],e}return i(e,t),e.prototype.addTextButton=function(t,e,n,r,i,o,s,a,u,l,c,p,d,f,g,y,m,v,b,_,x,w,T,S,E,P){void 0===t&&(t=""),void 0===e&&(e=!0),void 0===n&&(n=!1),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=!0),void 0===s&&(s=null),void 0===a&&(a=null),void 0===u&&(u=null),void 0===v&&(v=0),void 0===b&&(b=0),void 0===_&&(_=0),void 0===x&&(x=0),void 0===w&&(w="center"),void 0===P&&(P=null),null!=t&&""!==t||(t=""+this.textButtons.length);var C=new h("TextButton "+t,this.resource,this.owner);this.addChild(C),this.textButtons.push(C);var k=+g[0],A=null!=g[1]?+g[1]:k,I=null!=g[2]?+g[2]:k,O=+y[0],L=null!=y[1]?+y[1]:O,M=null!=y[2]?+y[2]:O;this.textCanvas.copyTo(C.textCanvas),C.x=c,C.y=p,C.width=d,C.height=f,C.textCanvas.marginTop=v,C.textCanvas.marginRight=b,C.textCanvas.marginBottom=_,C.textCanvas.marginLeft=x,C.textCanvas.align=w,C.clearText(),C.initTextButton(e,n,r,i,o,m,s,a,u,l,k,A,I,O,L,M,T,S,E,P)},e.prototype.clearTextButtons=function(){var t=this;this.textButtons.forEach((function(e){e.clearCommandButton(),e.destroy(),t.deleteChildLayer(e)})),this.textButtons=[]},e.prototype.changeTextButtonColors=function(t,e){var n=+e[0],r=null!=e[1]?+e[1]:n,i=null!=e[2]?+e[2]:n;this.findTextButtonByName(t).forEach((function(t){t.txtBtnNormalBackgroundColor=n,t.txtBtnOverBackgroundColor=r,t.txtBtnOnBackgroundColor=i,t.resetTextButtonColors()}))},e.prototype.changeTextButtonAlphas=function(t,e){var n=+e[0],r=null!=e[1]?+e[1]:n,i=null!=e[2]?+e[2]:n;this.findTextButtonByName(t).forEach((function(t){t.txtBtnNormalBackgroundAlpha=n,t.txtBtnOverBackgroundAlpha=r,t.txtBtnOnBackgroundAlpha=i,t.resetTextButtonColors()}))},e.prototype.findTextButtonByName=function(t){var e="TextButton "+t;return this.textButtons.filter((function(t){return t.name===e}))},e.prototype.hasTextButton=function(){return this.textButtons.length>0},e.prototype.getButtons=function(){var t=[];return this.textButtons.forEach((function(e){t.push(e)})),t},e.prototype.lockButtons=function(){this.textButtons.forEach((function(t){t.setButtonStatus("disabled")}))},e.prototype.unlockButtons=function(){this.textButtons.forEach((function(t){t.setButtonStatus("normal")}))},e.prototype.lockSystemButtons=function(){this.textButtons.forEach((function(t){t.lockSystemButton()}))},e.prototype.unlockSystemButtons=function(){this.textButtons.forEach((function(t){t.unlockSystemButton()}))},e.prototype.store=function(e){var n=t.prototype.store.call(this,e);return n.textButtons=this.textButtons.map((function(t){return t.store(e)})),n},e.prototype.restore=function(e,n,r){return o(this,void 0,void 0,(function(){var i=this;return s(this,(function(o){switch(o.label){case 0:return this.clearTextButtons(),null!=e.textButtons&&e.textButtons.length>0?[4,Promise.all(e.textButtons.map((function(t){var e=new h(t.name,i.resource,i.owner);return i.addChild(e),i.textButtons.push(e),e.restore(t,n,r)})))]:[3,2];case 1:o.sent(),o.label=2;case 2:return[4,t.prototype.restore.call(this,e,n,r)];case 3:return o.sent(),[2]}}))}))},e.prototype.restoreAfterLoadImage=function(e,n){if(t.prototype.restoreAfterLoadImage.call(this,e,n),null!=e.textButtons&&e.textButtons.length>0)for(var r=0;r<e.textButtons.length;r++)this.textButtons[r].restoreAfterLoadImage(e.textButtons[r],n)},e.prototype.copyTo=function(e){t.prototype.copyTo.call(this,e),e.clearTextButtons(),this.textButtons.forEach((function(t){var n=new h(name,e.resource,e.owner);e.addChild(n),e.textButtons.push(n),t.copyTo(n)}))},e}(u.FrameAnimLayer);e.TextButtonLayer=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(15),u=n(11),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._frameAnimLoop=!1,e.frameAnimTime=50,e.frameAnimWidth=32,e.frameAnimHeight=32,e.frameAnimFrames=[],e.frameAnimStartTick=-1,e.frameAnimState="stop",e}return i(e,t),Object.defineProperty(e.prototype,"frameAnimLoop",{get:function(){return this._frameAnimLoop},enumerable:!0,configurable:!0}),e.prototype.initFrameAnim=function(t,e,n,r,i){this.stopFrameAnim(!1),this._frameAnimLoop=t,this.frameAnimTime=e,this.frameAnimWidth=this.width=n,this.frameAnimHeight=this.height=r,this.frameAnimFrames=i},Object.defineProperty(e.prototype,"hasFrameAnim",{get:function(){return 0!==this.frameAnimFrames.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameAnimRunning",{get:function(){return"run"===this.frameAnimState},enumerable:!0,configurable:!0}),e.prototype.startFrameAnim=function(t){if(0===this.frameAnimFrames.length)throw new Error("アニメーション定義が未定義です");this.frameAnimState="run",this.frameAnimStartTick=-1},e.prototype.stopFrameAnim=function(t){void 0===t&&(t=!0),"run"===this.frameAnimState&&(this.frameAnimState="stop",this.frameAnimStartTick=-1,t&&this.owner.conductor.trigger("frameanim"))},e.prototype.deleteFrameAnim=function(){this.stopFrameAnim(),this._frameAnimLoop=!1,this.frameAnimTime=50,this.frameAnimWidth=32,this.frameAnimHeight=32,this.frameAnimFrames=[]},e.prototype.update=function(e){if(t.prototype.update.call(this,e),this.frameAnimRunning){-1===this.frameAnimStartTick&&(this.frameAnimStartTick=e);var n=this.frameAnimStartTick,r=this.frameAnimTime,i=this.frameAnimFrames;if(!this._frameAnimLoop&&e-n>i.length*r){var o=i[i.length-1];this.applyFrameAnim(o),this.stopFrameAnim()}else{o=i[Math.floor((e-n)/r)%i.length];this.applyFrameAnim(o)}}},e.prototype.applyFrameAnim=function(t){null!=t.x&&(this.imageX=-+t.x),null!=t.y&&(this.imageY=-+t.y),null!=t.alpha&&(this.alpha=+t.alpha)},e.prototype.freeImage=function(){this.deleteFrameAnim(),t.prototype.freeImage.call(this)},e.prototype.store=function(n){var r=t.prototype.store.call(this,n),i=this;return e.frameAnimLayerStoreParams.forEach((function(t){r[t]=i[t]})),r},e.prototype.restore=function(e,n,r){return o(this,void 0,void 0,(function(){return s(this,(function(i){switch(i.label){case 0:return this.stopFrameAnim(!1),[4,t.prototype.restore.call(this,e,n,r)];case 1:return i.sent(),[2]}}))}))},e.prototype.restoreAfterLoadImage=function(t,n){var r=this;e.frameAnimLayerStoreParams.forEach((function(e){r[e]=t[e]})),0!==t.frameAnimFrames.length&&"run"===t.frameAnimState&&(this.startFrameAnim(n),u.Logger.debug("data.frameAnimState",t.frameAnimState,this.frameAnimState,this.frameAnimFrames))},e.prototype.copyTo=function(n){t.prototype.copyTo.call(this,n);var r=this,i=n;e.frameAnimLayerStoreParams.forEach((function(t){return i[t]=r[t]}))},e.frameAnimLayerStoreParams=["_frameAnimLoop","frameAnimTime","frameAnimWidth","frameAnimHeight","frameAnimFrames","frameAnimStartTick","frameAnimState"],e}(a.BaseLayer);e.FrameAnimLayer=h},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(77),s=function(t){function e(n){var r=t.call(this,n,e.permitedList)||this,i=r._filter=new o.AdjustmentFilter;return n=r.params,e.permitedList.forEach((function(t){if(null!=n[t]){var e=+n[t];e<0&&(e=0),i[t]=e}})),r}return i(e,t),Object.defineProperty(e.prototype,"filterName",{get:function(){return e.filterName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),e.filterName="color",e.permitedList=["gamma","saturation","contrast","brightness","red","green","blue"],e}(n(20).LayerFilter);e.ColorFilter=s,e.createColorFilter=function(t){if(null==t)throw new Error("Cannot create GammaFilter, params is empty.");return new s(t)}},function(t,e,n){"use strict";n.r(e),n.d(e,"AdjustmentFilter",(function(){return i}));var r=n(3),i=function(t){function e(e){t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform float gamma;\nuniform float contrast;\nuniform float saturation;\nuniform float brightness;\nuniform float red;\nuniform float green;\nuniform float blue;\nuniform float alpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (c.a > 0.0) {\n        c.rgb /= c.a;\n\n        vec3 rgb = pow(c.rgb, vec3(1. / gamma));\n        rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, saturation), contrast);\n        rgb.r *= red;\n        rgb.g *= green;\n        rgb.b *= blue;\n        c.rgb = rgb * brightness;\n\n        c.rgb *= c.a;\n    }\n\n    gl_FragColor = c * alpha;\n}\n"),Object.assign(this,{gamma:1,saturation:1,contrast:1,brightness:1,red:1,green:1,blue:1,alpha:1},e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t,e,n,r){this.uniforms.gamma=Math.max(this.gamma,1e-4),this.uniforms.saturation=this.saturation,this.uniforms.contrast=this.contrast,this.uniforms.brightness=this.brightness,this.uniforms.red=this.red,this.uniforms.green=this.green,this.uniforms.blue=this.blue,this.uniforms.alpha=this.alpha,t.applyFilter(this,e,n,r)},e}(r.n);
/*!
 * @pixi/filter-adjustment - v3.1.0
 * Compiled Wed, 11 Mar 2020 20:38:18 UTC
 *
 * @pixi/filter-adjustment is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */},function(t,e,n){"use strict";(function(t){var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(e){function n(n){var r=e.call(this,n)||this,i=r._filter=new t.filters.BlurFilter;return i.blurX=n.blurX||4,i.blurY=n.blurY||4,i.quality=n.quality||4,r}return i(n,e),Object.defineProperty(n.prototype,"filterName",{get:function(){return n.filterName},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"filter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),n.filterName="blur",n}(n(20).LayerFilter);e.BlurFilter=o,e.createBlurFilter=function(t){if(null==t)throw new Error("Cannot create BlurFilter, data is empty.");return new o(t)}}).call(this,n(9))},function(t,e,n){"use strict";(function(t){var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(e){function n(n){var r=e.call(this,n)||this,i=r._filter=new t.filters.ColorMatrixFilter;switch(n.type.toLowerCase()){case"negative":i.negative(!0);break;case"grayscale":i.greyscale(n.scale||1,!0);break;case"brightness":i.brightness(n.bright||.5,!0);break;case"browni":i.browni(!0);break;case"contrast":i.contrast(n.contrast||.5,!0);break;case"desaturate":i.desaturate();break;case"hue":i.hue(n.rotation||0,!0);break;case"kodachrome":i.kodachrome(!0);break;case"lsd":i.lsd(!0);break;case"night":i.night(n.intensity||0,!0);break;case"polaroid":i.polaroid(!0);break;case"predator":i.predator(n.amount||0,!0);break;case"saturate":i.saturate(n.amount||0,!0);break;case"sepia":i.sepia(!0);break;case"technicolor":i.technicolor(!0);break;case"toBGR":i.toBGR(!0);break;case"vintage":i.vintage(!0);break;case"colortone":i.colorTone(n.desaturation,n.toned,n.lightColor,n.darkColor,!0)}return r}return i(n,e),Object.defineProperty(n.prototype,"filterName",{get:function(){return n.filterName},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"filter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),n.filterName="colormatrix",n}(n(20).LayerFilter);e.ColorMatrixFilter=o,e.createColorMatrixFilter=function(t){if(null==t)throw new Error("Cannot create ColorMatrixFilter, params is empty.");return new o(t)}}).call(this,n(9))},function(t,e,n){var r;!function(){function i(t,e,n){return t.call.apply(t.bind,arguments)}function o(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function s(t,e,n){return(s=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?i:o).apply(null,arguments)}var a=Date.now||function(){return+new Date};function u(t,e){this.a=t,this.o=e||t,this.c=this.o.document}var h=!!window.FontFace;function l(t,e,n,r){if(e=t.c.createElement(e),n)for(var i in n)n.hasOwnProperty(i)&&("style"==i?e.style.cssText=n[i]:e.setAttribute(i,n[i]));return r&&e.appendChild(t.c.createTextNode(r)),e}function c(t,e,n){(t=t.c.getElementsByTagName(e)[0])||(t=document.documentElement),t.insertBefore(n,t.lastChild)}function p(t){t.parentNode&&t.parentNode.removeChild(t)}function d(t,e,n){e=e||[],n=n||[];for(var r=t.className.split(/\s+/),i=0;i<e.length;i+=1){for(var o=!1,s=0;s<r.length;s+=1)if(e[i]===r[s]){o=!0;break}o||r.push(e[i])}for(e=[],i=0;i<r.length;i+=1){for(o=!1,s=0;s<n.length;s+=1)if(r[i]===n[s]){o=!0;break}o||e.push(r[i])}t.className=e.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function f(t,e){for(var n=t.className.split(/\s+/),r=0,i=n.length;r<i;r++)if(n[r]==e)return!0;return!1}function g(t,e,n){function r(){a&&i&&o&&(a(s),a=null)}e=l(t,"link",{rel:"stylesheet",href:e,media:"all"});var i=!1,o=!0,s=null,a=n||null;h?(e.onload=function(){i=!0,r()},e.onerror=function(){i=!0,s=Error("Stylesheet failed to load"),r()}):setTimeout((function(){i=!0,r()}),0),c(t,"head",e)}function y(t,e,n,r){var i=t.c.getElementsByTagName("head")[0];if(i){var o=l(t,"script",{src:e}),s=!1;return o.onload=o.onreadystatechange=function(){s||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(s=!0,n&&n(null),o.onload=o.onreadystatechange=null,"HEAD"==o.parentNode.tagName&&i.removeChild(o))},i.appendChild(o),setTimeout((function(){s||(s=!0,n&&n(Error("Script load timeout")))}),r||5e3),o}return null}function m(){this.a=0,this.c=null}function v(t){return t.a++,function(){t.a--,_(t)}}function b(t,e){t.c=e,_(t)}function _(t){0==t.a&&t.c&&(t.c(),t.c=null)}function x(t){this.a=t||"-"}function w(t,e){this.c=t,this.f=4,this.a="n";var n=(e||"n4").match(/^([nio])([1-9])$/i);n&&(this.a=n[1],this.f=parseInt(n[2],10))}function T(t){var e=[];t=t.split(/,\s*/);for(var n=0;n<t.length;n++){var r=t[n].replace(/['"]/g,"");-1!=r.indexOf(" ")||/^\d/.test(r)?e.push("'"+r+"'"):e.push(r)}return e.join(",")}function S(t){return t.a+t.f}function E(t){var e="normal";return"o"===t.a?e="oblique":"i"===t.a&&(e="italic"),e}function P(t){var e=4,n="n",r=null;return t&&((r=t.match(/(normal|oblique|italic)/i))&&r[1]&&(n=r[1].substr(0,1).toLowerCase()),(r=t.match(/([1-9]00|normal|bold)/i))&&r[1]&&(/bold/i.test(r[1])?e=7:/[1-9]00/.test(r[1])&&(e=parseInt(r[1].substr(0,1),10)))),n+e}function C(t,e){this.c=t,this.f=t.o.document.documentElement,this.h=e,this.a=new x("-"),this.j=!1!==e.events,this.g=!1!==e.classes}function k(t){if(t.g){var e=f(t.f,t.a.c("wf","active")),n=[],r=[t.a.c("wf","loading")];e||n.push(t.a.c("wf","inactive")),d(t.f,n,r)}A(t,"inactive")}function A(t,e,n){t.j&&t.h[e]&&(n?t.h[e](n.c,S(n)):t.h[e]())}function I(){this.c={}}function O(t,e){this.c=t,this.f=e,this.a=l(this.c,"span",{"aria-hidden":"true"},this.f)}function L(t){c(t.c,"body",t.a)}function M(t){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+T(t.c)+";font-style:"+E(t)+";font-weight:"+t.f+"00;"}function B(t,e,n,r,i,o){this.g=t,this.j=e,this.a=r,this.c=n,this.f=i||3e3,this.h=o||void 0}function D(t,e,n,r,i,o,s){this.v=t,this.B=e,this.c=n,this.a=r,this.s=s||"BESbswy",this.f={},this.w=i||3e3,this.u=o||null,this.m=this.j=this.h=this.g=null,this.g=new O(this.c,this.s),this.h=new O(this.c,this.s),this.j=new O(this.c,this.s),this.m=new O(this.c,this.s),t=M(t=new w(this.a.c+",serif",S(this.a))),this.g.a.style.cssText=t,t=M(t=new w(this.a.c+",sans-serif",S(this.a))),this.h.a.style.cssText=t,t=M(t=new w("serif",S(this.a))),this.j.a.style.cssText=t,t=M(t=new w("sans-serif",S(this.a))),this.m.a.style.cssText=t,L(this.g),L(this.h),L(this.j),L(this.m)}x.prototype.c=function(t){for(var e=[],n=0;n<arguments.length;n++)e.push(arguments[n].replace(/[\W_]+/g,"").toLowerCase());return e.join(this.a)},B.prototype.start=function(){var t=this.c.o.document,e=this,n=a(),r=new Promise((function(r,i){!function o(){a()-n>=e.f?i():t.fonts.load(function(t){return E(t)+" "+t.f+"00 300px "+T(t.c)}(e.a),e.h).then((function(t){1<=t.length?r():setTimeout(o,25)}),(function(){i()}))}()})),i=null,o=new Promise((function(t,n){i=setTimeout(n,e.f)}));Promise.race([o,r]).then((function(){i&&(clearTimeout(i),i=null),e.g(e.a)}),(function(){e.j(e.a)}))};var F={D:"serif",C:"sans-serif"},R=null;function N(){if(null===R){var t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);R=!!t&&(536>parseInt(t[1],10)||536===parseInt(t[1],10)&&11>=parseInt(t[2],10))}return R}function V(t,e,n){for(var r in F)if(F.hasOwnProperty(r)&&e===t.f[F[r]]&&n===t.f[F[r]])return!0;return!1}function j(t){var e,n=t.g.a.offsetWidth,r=t.h.a.offsetWidth;(e=n===t.f.serif&&r===t.f["sans-serif"])||(e=N()&&V(t,n,r)),e?a()-t.A>=t.w?N()&&V(t,n,r)&&(null===t.u||t.u.hasOwnProperty(t.a.c))?U(t,t.v):U(t,t.B):function(t){setTimeout(s((function(){j(this)}),t),50)}(t):U(t,t.v)}function U(t,e){setTimeout(s((function(){p(this.g.a),p(this.h.a),p(this.j.a),p(this.m.a),e(this.a)}),t),0)}function X(t,e,n){this.c=t,this.a=e,this.f=0,this.m=this.j=!1,this.s=n}D.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=a(),j(this)};var H=null;function G(t){0==--t.f&&t.j&&(t.m?((t=t.a).g&&d(t.f,[t.a.c("wf","active")],[t.a.c("wf","loading"),t.a.c("wf","inactive")]),A(t,"active")):k(t.a))}function Y(t){this.j=t,this.a=new I,this.h=0,this.f=this.g=!0}function W(t,e,n,r,i){var o=0==--t.h;(t.f||t.g)&&setTimeout((function(){var t=i||null,a=r||{};if(0===n.length&&o)k(e.a);else{e.f+=n.length,o&&(e.j=o);var u,h=[];for(u=0;u<n.length;u++){var l=n[u],c=a[l.c],p=e.a,f=l;if(p.g&&d(p.f,[p.a.c("wf",f.c,S(f).toString(),"loading")]),A(p,"fontloading",f),p=null,null===H)if(window.FontFace){f=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent);var g=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);H=f?42<parseInt(f[1],10):!g}else H=!1;p=H?new B(s(e.g,e),s(e.h,e),e.c,l,e.s,c):new D(s(e.g,e),s(e.h,e),e.c,l,e.s,t,c),h.push(p)}for(u=0;u<h.length;u++)h[u].start()}}),0)}function z(t,e){this.c=t,this.a=e}function q(t,e){this.c=t,this.a=e}function K(t,e){this.c=t||J,this.a=[],this.f=[],this.g=e||""}X.prototype.g=function(t){var e=this.a;e.g&&d(e.f,[e.a.c("wf",t.c,S(t).toString(),"active")],[e.a.c("wf",t.c,S(t).toString(),"loading"),e.a.c("wf",t.c,S(t).toString(),"inactive")]),A(e,"fontactive",t),this.m=!0,G(this)},X.prototype.h=function(t){var e=this.a;if(e.g){var n=f(e.f,e.a.c("wf",t.c,S(t).toString(),"active")),r=[],i=[e.a.c("wf",t.c,S(t).toString(),"loading")];n||r.push(e.a.c("wf",t.c,S(t).toString(),"inactive")),d(e.f,r,i)}A(e,"fontinactive",t),G(this)},Y.prototype.load=function(t){this.c=new u(this.j,t.context||this.j),this.g=!1!==t.events,this.f=!1!==t.classes,function(t,e,n){var r=[],i=n.timeout;!function(t){t.g&&d(t.f,[t.a.c("wf","loading")]),A(t,"loading")}(e);r=function(t,e,n){var r,i=[];for(r in e)if(e.hasOwnProperty(r)){var o=t.c[r];o&&i.push(o(e[r],n))}return i}(t.a,n,t.c);var o=new X(t.c,e,i);for(t.h=r.length,e=0,n=r.length;e<n;e++)r[e].load((function(e,n,r){W(t,o,e,n,r)}))}(this,new C(this.c,t),t)},z.prototype.load=function(t){var e=this,n=e.a.projectId,r=e.a.version;if(n){var i=e.c.o;y(this.c,(e.a.api||"https://fast.fonts.net/jsapi")+"/"+n+".js"+(r?"?v="+r:""),(function(r){r?t([]):(i["__MonotypeConfiguration__"+n]=function(){return e.a},function e(){if(i["__mti_fntLst"+n]){var r,o=i["__mti_fntLst"+n](),s=[];if(o)for(var a=0;a<o.length;a++){var u=o[a].fontfamily;null!=o[a].fontStyle&&null!=o[a].fontWeight?(r=o[a].fontStyle+o[a].fontWeight,s.push(new w(u,r))):s.push(new w(u))}t(s)}else setTimeout((function(){e()}),50)}())})).id="__MonotypeAPIScript__"+n}else t([])},q.prototype.load=function(t){var e,n,r=this.a.urls||[],i=this.a.families||[],o=this.a.testStrings||{},s=new m;for(e=0,n=r.length;e<n;e++)g(this.c,r[e],v(s));var a=[];for(e=0,n=i.length;e<n;e++)if((r=i[e].split(":"))[1])for(var u=r[1].split(","),h=0;h<u.length;h+=1)a.push(new w(r[0],u[h]));else a.push(new w(r[0]));b(s,(function(){t(a,o)}))};var J="https://fonts.googleapis.com/css";function Z(t){this.f=t,this.a=[],this.c={}}var Q={latin:"BESbswy","latin-ext":"çöüğş",cyrillic:"йяЖ",greek:"αβΣ",khmer:"កខគ",Hanuman:"កខគ"},$={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},tt={i:"i",italic:"i",n:"n",normal:"n"},et=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function nt(t,e){this.c=t,this.a=e}var rt={Arimo:!0,Cousine:!0,Tinos:!0};function it(t,e){this.c=t,this.a=e}function ot(t,e){this.c=t,this.f=e,this.a=[]}nt.prototype.load=function(t){var e=new m,n=this.c,r=new K(this.a.api,this.a.text),i=this.a.families;!function(t,e){for(var n=e.length,r=0;r<n;r++){var i=e[r].split(":");3==i.length&&t.f.push(i.pop());var o="";2==i.length&&""!=i[1]&&(o=":"),t.a.push(i.join(o))}}(r,i);var o=new Z(i);!function(t){for(var e=t.f.length,n=0;n<e;n++){var r=t.f[n].split(":"),i=r[0].replace(/\+/g," "),o=["n4"];if(2<=r.length){var s;if(s=[],a=r[1])for(var a,u=(a=a.split(",")).length,h=0;h<u;h++){var l;if((l=a[h]).match(/^[\w-]+$/))if(null==(p=et.exec(l.toLowerCase())))l="";else{if(l=null==(l=p[2])||""==l?"n":tt[l],null==(p=p[1])||""==p)p="4";else var c=$[p],p=c||(isNaN(p)?"4":p.substr(0,1));l=[l,p].join("")}else l="";l&&s.push(l)}0<s.length&&(o=s),3==r.length&&(s=[],0<(r=(r=r[2])?r.split(","):s).length&&(r=Q[r[0]])&&(t.c[i]=r))}for(t.c[i]||(r=Q[i])&&(t.c[i]=r),r=0;r<o.length;r+=1)t.a.push(new w(i,o[r]))}}(o),g(n,function(t){if(0==t.a.length)throw Error("No fonts to load!");if(-1!=t.c.indexOf("kit="))return t.c;for(var e=t.a.length,n=[],r=0;r<e;r++)n.push(t.a[r].replace(/ /g,"+"));return e=t.c+"?family="+n.join("%7C"),0<t.f.length&&(e+="&subset="+t.f.join(",")),0<t.g.length&&(e+="&text="+encodeURIComponent(t.g)),e}(r),v(e)),b(e,(function(){t(o.a,o.c,rt)}))},it.prototype.load=function(t){var e=this.a.id,n=this.c.o;e?y(this.c,(this.a.api||"https://use.typekit.net")+"/"+e+".js",(function(e){if(e)t([]);else if(n.Typekit&&n.Typekit.config&&n.Typekit.config.fn){e=n.Typekit.config.fn;for(var r=[],i=0;i<e.length;i+=2)for(var o=e[i],s=e[i+1],a=0;a<s.length;a++)r.push(new w(o,s[a]));try{n.Typekit.load({events:!1,classes:!1,async:!0})}catch(t){}t(r)}}),2e3):t([])},ot.prototype.load=function(t){var e=this.f.id,n=this.c.o,r=this;e?(n.__webfontfontdeckmodule__||(n.__webfontfontdeckmodule__={}),n.__webfontfontdeckmodule__[e]=function(e,n){for(var i=0,o=n.fonts.length;i<o;++i){var s=n.fonts[i];r.a.push(new w(s.name,P("font-weight:"+s.weight+";font-style:"+s.style)))}t(r.a)},y(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+function(t){return t.o.location.hostname||t.a.location.hostname}(this.c)+"/"+e+".js",(function(e){e&&t([])}))):t([])};var st=new Y(window);st.a.c.custom=function(t,e){return new q(e,t)},st.a.c.fontdeck=function(t,e){return new ot(e,t)},st.a.c.monotype=function(t,e){return new z(e,t)},st.a.c.typekit=function(t,e){return new it(e,t)},st.a.c.google=function(t,e){return new nt(e,t)};var at={load:s(st.load,st)};void 0===(r=function(){return at}.call(e,n,e,t))||(t.exports=r)}()}]);
//# sourceMappingURL=ponkan.js.map