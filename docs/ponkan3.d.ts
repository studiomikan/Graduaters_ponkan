// Generated by dts-bundle v0.7.3
// Dependencies for this module:
//   ../pixi.js

declare module 'ponkan3' {
  import { BaseLayer } from "ponkan3/base/base-layer";
  import { PonGame } from "ponkan3/base/pon-game";
  import { PonKeyEvent } from "ponkan3/base/pon-key-event";
  import { PonMouseEvent } from "ponkan3/base/pon-mouse-event";
  import { PonWheelEvent } from "ponkan3/base/pon-wheel-event";
  import { SoundBuffer } from "ponkan3/base/sound";
  import { Tag } from "ponkan3/base/tag";
  import { HistoryLayer } from "ponkan3/layer/history-layer";
  import { PonLayer } from "ponkan3/layer/pon-layer";
  import { PonPlugin } from "ponkan3/plugin/pon-plugin";
  export enum SkipType {
      INVALID = 0,
      UNTIL_CLICK_WAIT = 1,
      UNTIL_S = 2,
      WHILE_PRESSING_CTRL = 3
  }
  export type GlyphVerticalAlignType = "bottom" | "middle" | "top" | "text-top" | "text-middle";
  export class Ponkan3 extends PonGame {
      raiseError: any;
      skipMode: SkipType;
      canSkipUnreadPart: boolean;
      canSkipUnreadPartByCtrl: boolean;
      autoModeFlag: boolean;
      autoModeInterval: number;
      autoModeStartTick: number;
      autoModeLayerNum: number;
      readonly tagActions: any;
      protected _layerCount: number;
      layerAlias: any;
      forePrimaryLayer: PonLayer;
      backPrimaryLayer: PonLayer;
      readonly foreLayers: PonLayer[];
      readonly backLayers: PonLayer[];
      currentPage: "fore" | "back";
      isQuaking: boolean;
      protected quakeStartTick: number;
      protected quakeTime: number;
      protected quakeMaxX: number;
      protected quakeMaxY: number;
      protected isQuakePhase: boolean;
      protected quakeFrameCount: number;
      protected quakeIntervalFrame: number;
      textSpeedMode: "user" | "system";
      unreadTextSpeed: number;
      readTextSpeed: number;
      userUnreadTextSpeed: number;
      userReadTextSpeed: number;
      clickSkipEnabled: boolean;
      nowaitModeFlag: boolean;
      addCharWithBackFlag: boolean;
      hideMessageFlag: boolean;
      hideMessageByRlickFlag: boolean;
      protected _messageLayerNum: number;
      messageLayerNum: number;
      protected _lineBreakGlyphLayerNum: number;
      lineBreakGlyphLayerNum: number;
      lineBreakGlyphPos: "eol" | "relative" | "absolute";
      lineBreakGlyphVerticalAlign: GlyphVerticalAlignType;
      lineBreakGlyphX: number;
      lineBreakGlyphY: number;
      lineBreakGlyphMarginX: number;
      lineBreakGlyphMarginY: number;
      protected _pageBreakGlyphLayerNum: number;
      pageBreakGlyphLayerNum: number;
      pageBreakGlyphPos: "eol" | "relative" | "absolute";
      pageBreakGlyphVerticalAlign: GlyphVerticalAlignType;
      pageBreakGlyphX: number;
      pageBreakGlyphY: number;
      pageBreakGlyphMarginX: number;
      pageBreakGlyphMarginY: number;
      rightClickJump: boolean;
      rightClickCall: boolean;
      rightClickFilePath: string | null;
      rightClickLabel: string | null;
      rightClickEnabled: boolean;
      historyLayer: HistoryLayer;
      enabledHistory: boolean;
      soundBufferAlias: any;
      soundBufferCount: number;
      readonly soundBuffers: SoundBuffer[];
      protected saveDataPrefix: string;
      protected latestSaveComment: string;
      protected latestSaveData: any;
      protected tempSaveData: any;
      readonly tmpVar: any;
      readonly gameVar: any;
      readonly systemVar: any;
      protected pluginMap: any;
      protected plugins: PonPlugin[];
      constructor(parentId: string, config?: any);
      destroy(): void;
      start(): Promise<void>;
      stop(): void;
      /**
        * Ponkan3を一時停止する。
        * HTMLファイルによるシステム画面などを表示する際は、このメソッドで停止する。
        * 再開にはresumeメソッドを使う。
        */
      pause(countPage?: boolean, stopSkip?: boolean): void;
      resume(): void;
      addPlugin(name: string, plugin: PonPlugin): void;
      removePlugin(name: string): void;
      getPlugin(name: string): PonPlugin;
      protected update(tick: number): void;
      protected beforeDraw(tick: number): void;
      error(e: Error): void;
      showLayerDebugInfo(): void;
      hideLayerDebugInfo(): void;
      getDebugInfo(): any;
      dumpDebugInfo(): void;
      protected readonly eventReceivesLayer: BaseLayer;
      onMouseEnter(e: PonMouseEvent): void;
      onMouseLeave(e: PonMouseEvent): void;
      onMouseMove(e: PonMouseEvent): void;
      onMouseDown(e: PonMouseEvent): void;
      onMouseUp(e: PonMouseEvent): void;
      /** マウスホイールによる読み進め処理が連続して発生しないようにするためのフラグ */
      protected onMouseWheelLocked: boolean;
      onMouseWheel(e: PonWheelEvent): boolean;
      onPrimaryClick(): boolean;
      onPrimaryRightClick(): Promise<boolean>;
      onKeyDown(e: PonKeyEvent): boolean;
      onKeyUp(e: PonKeyEvent): boolean;
      addCommandShortcut(ch: string, command: string): void;
      delCommandShortcut(ch: string): void;
      execCommand(commandName: string, values?: any): void;
      onTag(tag: Tag, line: number, tick: number): "continue" | "break";
      onLabel(labelName: string, line: number, tick: number): "continue" | "break";
      onSaveMark(saveMarkName: string, comment: string, line: number, tick: number): "continue" | "break";
      onJs(js: string, printFlag: boolean, line: number, tick: number): "continue" | "break";
      onChangeStable(isStable: boolean): void;
      onReturnSubroutin(forceStart?: boolean): void;
      readonly isSkipping: boolean;
      startSkipByTag(): void;
      startSkipByCtrl(): void;
      stopWhilePressingCtrlSkip(): void;
      stopUntilClickSkip(): void;
      stopSkip(): void;
      readonly autoModeLayer: PonLayer;
      startAutoMode(): void;
      stopAutoMode(): void;
      reserveAutoClick(tick: number): void;
      getSoundBuffer(num: string): SoundBuffer;
      onSoundStop(bufferNum: number): void;
      onSoundFadeComplete(bufferNum: number): void;
      waitSoundCompleteCallback(sb: SoundBuffer): void;
      waitSoundStopClickCallback(sb: SoundBuffer): void;
      waitSoundFadeCompleteCallback(sb: SoundBuffer): void;
      waitSoundFadeClickCallback(sb: SoundBuffer): void;
      layerCount: number;
      /**
        * レイヤを作成する。
        * rendererへの追加は行わないので、他のレイヤの子レイヤにする必要がある。
        */
      createLayer(name: string): PonLayer;
      /**
        * 操作対象となるレイヤーを取得する
        * @param pageLayers ページのレイヤー
        * @param lay レイヤー指定の文字列
        * @return 操作対象レイヤー
        */
      protected getTargetLayers(pageLayers: PonLayer[], lay: string): PonLayer[];
      /**
        * 操作対象のレイヤーを取得する
        * @param values タグの値
        */
      getLayers(values: any): PonLayer[];
      readonly hasMovingLayer: boolean;
      waitMoveClickCallback(): void;
      waitMoveCompleteCallback(): void;
      waitFrameAnimClickCallback(layers: PonLayer[]): void;
      waitFrameAnimCompleteCallback(layers: PonLayer[]): void;
      readonly hasPlayingVideoLayer: boolean;
      waitVideoClickCallback(): void;
      waitVideoCompleteCallback(): void;
      startQuake(tick: number, time: number, maxX: number, maxY: number): void;
      stopQuake(): void;
      protected quake(tick: number): void;
      readonly textSpeed: number;
      /**
        * メッセージレイヤ（表）
        */
      readonly messageLayer: PonLayer;
      readonly backMessageLayer: PonLayer;
      readonly lineBreakGlyphLayer: PonLayer;
      readonly pageBreakGlyphLayer: PonLayer;
      showLineBreakGlyph(tick: number): void;
      showPageBreakGlyph(tick: number): void;
      showBreakGlyph(tick: number, lay: PonLayer, pos: "eol" | "relative" | "absolute", verticalAlign: GlyphVerticalAlignType, x: number, y: number, marginX: number, marginY: number): void;
      hideBreakGlyph(): void;
      hideMessages(): void;
      showMessages(): void;
      hideMessagesByRightClick(): void;
      showMessagesByRightClick(): void;
      onAddChar(sender: PonLayer, ch: string): void;
      onTextReturn(sender: PonLayer): void;
      showHistoryLayer(): void;
      hideHistoryLayer(): void;
      historyTextReturn(): void;
      addTextToHistory(text: string): void;
      backlay(lay: string): void;
      copylay(srclay: string, destlay: string, srcpage: string, destpage: string): void;
      flipPrimaryLayers(): void;
      /**
        * [override]
        * トランジション完了時にTransManagerから呼ばれる。
        * この時点で表ページ・裏ページの入れ替えは完了している。
        */
      onCompleteTrans(): boolean;
      waitTransClickCallback(): void;
      waitTransCompleteCallback(): void;
      onWindowClose(): boolean;
      protected static ponkanSystemStoreParams: string[];
      protected static ponkanSystemStoreIgnoreParams: string[];
      saveSystemData(): void;
      loadSystemData(saveDataPrefix: string): void;
      protected getSaveDataName(num: number): string;
      save(tick: number, num: number): void;
      getNowDateStr(): string;
      protected static ponkanStoreParams: string[];
      protected generateSaveData(saveMarkName: string, comment: string, tick: number): any;
      tempSave(tick: number, num: number): void;
      load(tick: number, num: number): Promise<void>;
      tempLoad(tick: number, num: number, sound?: boolean, toBack?: boolean): Promise<void>;
      copySaveData(srcNum: number, destNum: number): void;
      readonly emptySaveData: any;
      deleteSaveData(num: number): void;
      getSaveDataInfo(num: number): any;
      existSaveData(num: number): boolean;
      getSaveDataScreenShot(num: number): string;
      splitStrByLength(str: string, length: number): string[];
  }
}

declare module 'ponkan3/base/base-layer' {
  import * as PIXI from "pixi.js";
  import { PonGame } from "ponkan3/base/pon-game";
  import { PonMouseEvent } from "ponkan3/base/pon-mouse-event";
  import { IPonSpriteCallbacks, PonSprite } from "ponkan3/base/pon-sprite";
  import { IPonVideoCallbacks, PonVideo } from "ponkan3/base/pon-video";
  import { PonWheelEvent } from "ponkan3/base/pon-wheel-event";
  import { Resource } from "ponkan3/base/resource";
  export class BaseLayerChar {
      readonly ch: string;
      readonly sp: PonSprite;
      constructor(ch: string, sp: PonSprite);
      clone(spriteCallbacks: IPonSpriteCallbacks): BaseLayerChar;
      destroy(): void;
  }
  export class BaseLayerTextLine {
      readonly container: PIXI.Container;
      readonly spriteCallbacks: IPonSpriteCallbacks;
      readonly chList: BaseLayerChar[];
      readonly rubyList: BaseLayerChar[];
      x: number;
      y: number;
      readonly textX: number;
      readonly text: string;
      readonly tailChar: string;
      readonly length: number;
      readonly width: number;
      constructor();
      forEach(func: (ch: BaseLayerChar, index: number) => void): void;
      /**
        * このテキスト行を破棄する。
        * 以後、テキストを追加したりするとエラーになる。
        */
      destroy(): void;
      /**
        * このテキスト行の文字をすべてクリアする。
        */
      clear(): void;
      addChar(ch: string, textStyle: PIXI.TextStyle, pitch: number, lineHeight: number): void;
      reserveRubyText(rubyText: string, rubyFontSize: number, rubyOffset: number, rubyPitch: number): void;
      getCh(index: number): BaseLayerChar;
      getTailCh(): BaseLayerChar;
      backspace(): void;
      copyFrom(src: BaseLayerTextLine): void;
  }
  /**
    * 基本レイヤ。PIXI.Containerをラップしたもの
    */
  export class BaseLayer {
      /** レイヤ名 */
      name: string;
      /** リソース */
      protected resource: Resource;
      /** 持ち主 */
      protected owner: PonGame;
      /** スプライト表示用コンテナ */
      protected _container: PIXI.Container;
      readonly container: PIXI.Container;
      /** レイヤサイズでクリッピングするためのマスク */
      protected maskSprite: PIXI.Sprite;
      /** デバッグ情報を出力するためのコンテナ */
      protected debugContainer: PIXI.Container;
      debugInfoVisible: boolean;
      /** デバッグ情報: ボーダー */
      protected debugBorder: PIXI.Graphics;
      /** デバッグ情報: テキスト情報 */
      protected debugText: PIXI.Text;
      /** デバッグ情報: テキスト情報のスタイル */
      debugTextStyle: PIXI.TextStyle;
      /** 背景色用スプライト */
      protected backgroundSprite: PonSprite;
      protected hasBackgroundColor: boolean;
      protected _backgroundColor: number;
      protected _backgroundAlpha: number;
      protected textContainer: PIXI.Container;
      protected childContainer: PIXI.Container;
      protected childSpriteCallbacks: IPonSpriteCallbacks;
      protected imageContainer: PIXI.Container;
      protected imageSpriteCallbacks: IPonSpriteCallbacks;
      protected canvasSpriteCallbacks: IPonVideoCallbacks;
      protected videoCallbacks: IPonVideoCallbacks;
      /** 読み込んでいる画像 */
      protected image: HTMLImageElement | null;
      protected imageFilePath: string | null;
      /** 画像用スプライト */
      protected imageSprite: PonSprite | null;
      readonly imageWidth: number;
      readonly imageHeight: number;
      /** 読み込んでいるCanvas */
      protected canvas: HTMLCanvasElement | null;
      protected canvasSprite: PonSprite | null;
      readonly canvasWidth: number;
      readonly canvasHeight: number;
      /** 動画スプライト */
      protected videoFilePath: string | null;
      video: PonVideo | null;
      videoWidth: number;
      videoHeight: number;
      videoLoop: boolean;
      videoVolume: number;
      /** イベント遮断フラグ。trueにするとマウスイベントの伝播を遮断する。 */
      blockLeftClickFlag: boolean;
      blockRightClickFlag: boolean;
      blockCenterClickFlag: boolean;
      blockMouseMove: boolean;
      blockWheelFlag: boolean;
      protected textLines: BaseLayerTextLine[];
      textStyle: PIXI.TextStyle;
      textFontFamily: string[];
      textFontSize: number;
      textFontWeight: string;
      textFontStyle: string;
      textColor: number | string | number[] | string[] | CanvasGradient | CanvasPattern;
      textGradientStops: number[];
      textGradientType: "vertical" | "horizontal";
      textShadowVisible: boolean;
      textShadowAlpha: number;
      textShadowAngle: number;
      textShadowBlur: number;
      textShadowColor: number | string;
      textShadowDistance: number;
      textEdgeColor: number | string;
      textEdgeWidth: number;
      textMarginTop: number;
      textMarginRight: number;
      textMarginBottom: number;
      textMarginLeft: number;
      /** 次の文字を描画する予定の位置。予定であって、自動改行等が発生した場合は次の行になるため注意。 */
      textPitch: number;
      textLineHeight: number;
      textLinePitch: number;
      textAutoReturn: boolean;
      textLocatePoint: number | null;
      textIndentPoint: number | null;
      reservedTextIndentPoint: number | null;
      reservedTextIndentClear: boolean;
      textAlign: "left" | "center" | "right";
      rubyFontSize: number;
      rubyOffset: number;
      rubyPitch: number;
      /** 禁則文字（行頭禁則文字） */
      static headProhibitionChar: string;
      /** 禁則文字（行末禁則文字） */
      static tailProhibitionChar: string;
      readonly children: BaseLayer[];
      x: number;
      y: number;
      width: number;
      height: number;
      visible: boolean;
      alpha: number;
      backgroundColor: number;
      backgroundAlpha: number;
      imageX: number;
      imageY: number;
      canvasX: number;
      canvasY: number;
      scaleX: number;
      scaleY: number;
      constructor(name: string, resource: Resource, owner: PonGame);
      /**
        * 破棄
        */
      destroy(): void;
      addChild(childLayer: BaseLayer): BaseLayer;
      /**
        * 子レイヤーを削除する。
        * 管理から削除されるだけで、レイヤー自体は初期化されたりしない。
        */
      deleteChildLayer(childLayer: BaseLayer): void;
      /**
        * 子レイヤーをすべて削除する。
        * 管理から削除されるだけで、レイヤー自体は初期化されたりしない。
        */
      deleteAllChildren(): void;
      child(index: number): BaseLayer;
      update(tick: number): void;
      beforeDraw(tick: number): void;
      /**
        * 座標が、指定のレイヤーの内側かどうかを調査する
        */
      static isInsideOfLayer(layer: BaseLayer, x: number, y: number): boolean;
      protected isInsideEvent(e: PonMouseEvent): boolean;
      protected isBlockedEvent(e: PonMouseEvent | PonWheelEvent, eventName: string): boolean;
      onMouseEnter(e: PonMouseEvent): void;
      _onMouseEnter(e: PonMouseEvent): void;
      onMouseLeave(e: PonMouseEvent): void;
      _onMouseLeave(e: PonMouseEvent): void;
      /** onMouseEnter等を発生させるためのバッファ */
      protected isInsideBuffer: boolean;
      onMouseMove(e: PonMouseEvent): void;
      _onMouseMove(e: PonMouseEvent): void;
      onMouseDown(e: PonMouseEvent): void;
      _onMouseDown(e: PonMouseEvent): void;
      onMouseUp(e: PonMouseEvent): void;
      _onMouseUp(e: PonMouseEvent): void;
      onMouseWheel(e: PonWheelEvent): boolean;
      onChangeStable(isStable: boolean): void;
      /**
        * 背景色を設定する
        * @param color 色 0xRRGGBB
        * @param alpha アルファ値 0.0〜1.0
        */
      setBackgroundColor(color: number, alpha?: number): void;
      /**
        * 背景色をクリアする
        */
      clearBackgroundColor(): void;
      readonly preTextLine: BaseLayerTextLine;
      readonly currentTextLine: BaseLayerTextLine;
      readonly text: string;
      /**
        * 表示しているテキストの内容を文字列で取得
        * @return テキスト
        */
      readonly messageText: string;
      /**
        * レイヤにテキストを追加する
        */
      addText(text: string): void;
      /**
        * レイヤに1文字追加する
        */
      addChar(ch: string): void;
      /**
        * 次の文字の表示位置を取得する
        * @param chWidth 追加しようとしている文字の横幅
        * @return 表示位置
        */
      getNextTextPos(chWidth: number): {
          x: number;
          y: number;
          newLineFlag: boolean;
      };
      /**
        * 改行が必要かどうかを返す（自動改行の判定用）
        * @param chWidth 追加する文字の幅
        * @return 改行が必要ならtrue
        */
      protected shouldBeNewTextLine(chWidth?: number): boolean;
      /**
        * テキストを改行する
        */
      addTextReturn(): void;
      /**
        * 現在描画中のテキスト行をの位置をtextAlignにそろえる
        */
      alignCurrentTextLine(): void;
      /**
        * テキスト行の描画時、ベースとなる点(x)を取得する。
        * 左揃えの時: 左端の位置
        * 中央揃えの時：中央の位置
        * 右揃えの時：右端の位置
        */
      protected getTextLineBasePoint(): number;
      /**
        * テキストの表示位置を指定する。
        * 内部的には、指定前とは別の行として扱われる。
        * @param x x座標
        * @param y y座標
        */
      setCharLocate(x: number | null, y: number | null): void;
      /**
        * 現在のテキスト描画位置でインデントするように設定する
        */
      setIndentPoint(): void;
      /**
        * インデント位置をクリアする
        */
      clearIndentPoint(): void;
      reserveRubyText(rubyText: string): void;
      /**
        * テキストをクリアする。
        * 描画していたテキストは全削除される。
        * テキストの描画開始位置は初期化される。
        * インデント位置は初期化される。
        */
      clearText(): void;
      /**
        * 画像を読み込む。
        * 同時に、レイヤサイズを画像に合わせて変更する。
        * @param filePath ファイルパス
        */
      loadImage(filePath: string): Promise<void>;
      /**
        * 画像を開放する
        */
      freeImage(): void;
      /**
        * キャンバスを読み込む。
        * 同時に、レイヤサイズをキャンバスに合わせて変更する。
        * @param canvask
        */
      loadCanvas(canvas: HTMLCanvasElement): void;
      /**
        * 画像を開放する
        */
      freeCanvas(): void;
      /**
        * 動画を読み込む。
        * @param filePath ファイルパス
        * @param width 動画の幅
        * @param height 動画の高さ
        * @param autoPlay 自動再生するかどうか
        * @param loop ループ再生するかどうか
        * @param volume 音量
        */
      loadVideo(filePath: string, width: number, height: number, autoPlay: boolean, loop: boolean, volume: number): Promise<BaseLayer>;
      playVideo(): void;
      pauseVideo(): void;
      stopVideo(): void;
      freeVideo(): void;
      readonly isPlayingVideo: boolean;
      readonly isLoopPlayingVideo: boolean;
      protected static baseLayerStoreParams: string[];
      protected static baseLayerIgnoreParams: string[];
      /**
        * 保存する。
        * 子レイヤーの状態は保存されないことに注意が必要。
        */
      store(tick: number): any;
      /**
        * 復元する。
        * 子レイヤーの状態は変化しないことに注意。
        * 継承先で子レイヤーを使用している場合は、継承先で独自に復元処理を実装する
        */
      restore(data: any, tick: number, clear: boolean): Promise<void>;
      protected restoreAfterLoadImage(data: any, tick: number): void;
      copyTo(dest: BaseLayer): void;
      /**
        * コンフィグを反映する。
        * このメソッドでは単純に値の設定のみ行うため、
        * 画像読み込みなどの非同期処理が必要なものには対応していない。
        */
      applyConfig(config: any): void;
  }
}

declare module 'ponkan3/base/pon-game' {
  import { BaseLayer } from "ponkan3/base/base-layer";
  import { Conductor, IConductorEvent } from "ponkan3/base/conductor";
  import { Logger } from "ponkan3/base/logger";
  import { PonKeyEvent } from "ponkan3/base/pon-key-event";
  import { PonMouseEvent } from "ponkan3/base/pon-mouse-event";
  import { PonRenderer } from "ponkan3/base/pon-renderer";
  import { PonWheelEvent } from "ponkan3/base/pon-wheel-event";
  import { Resource } from "ponkan3/base/resource";
  import { ScreenShot } from "ponkan3/base/screen-shot";
  import { Tag } from "ponkan3/base/tag";
  import { TransManager } from "ponkan3/base/trans-manager";
  export enum ScaleMode {
      FIXED = 0,
      FIT = 1,
      FULLSCREEN = 2
  }
  export class PonGame implements IConductorEvent {
      static ScaleMode: typeof ScaleMode;
      static readonly Logger: typeof Logger;
      readonly parentElm: HTMLElement;
      config: any;
      isLocked: boolean;
      readonly resource: Resource;
      readonly foreRenderer: PonRenderer;
      readonly backRenderer: PonRenderer;
      _fixedScaleWidth: number;
      _fixedScaleHeight: number;
      protected conductorStack: Conductor[];
      readonly transManager: TransManager;
      readonly screenShot: ScreenShot;
      updateScreenShotFlag: boolean;
      readonly width: number;
      readonly height: number;
      constructor(parentId: string, config?: any);
      destroy(): void;
      start(): void;
      stop(): void;
      lock(stop?: boolean): void;
      unlock(restart?: boolean): void;
      scaleMode: ScaleMode;
      onFullscreenChange(): void;
      readonly fixedScaleWidth: number;
      readonly fixedScaleHeight: number;
      setFixedScaleSize(width: number, height: number): void;
      onWindowResize(): void;
      setCanvasScale(scaleX: number, scaleY: number): void;
      protected update(tick: number): void;
      protected beforeDraw(tick: number): void;
      error(e: Error): void;
      readonly conductor: Conductor;
      readonly mainConductor: Conductor;
      /**
        * サブルーチンを呼び出す。
        * @param file 移動先ファイル
        * @param label 移動先ラベル
        */
      callSubroutine(filePath: string | null, label?: string | null, countPage?: boolean): Promise<void>;
      /**
        * サブルーチンから戻る
        * @param forceStart 強制的にpb, lb, waitclickを終わらせるかどうか
        * @param countPage 既読処理をするかどうか
        */
      returnSubroutine(forceStart?: boolean, countPage?: boolean): "continue" | "break";
      onTag(tag: Tag, line: number, tick: number): "continue" | "break";
      onLabel(labelName: string, line: number, tick: number): "continue" | "break";
      onSaveMark(saveMarkName: string, comment: string, line: number, tick: number): "continue" | "break";
      onJs(js: string, printFlag: boolean, line: number, tick: number): "continue" | "break";
      onChangeStable(isStable: boolean): void;
      onReturnSubroutin(forceStart?: boolean): void;
      onError(e: Error): void;
      clearLayer(): void;
      addForePrimaryLayer(layer: BaseLayer): BaseLayer;
      addBackPrimaryLayer(layer: BaseLayer): BaseLayer;
      removeForePrimaryLayer(layer: BaseLayer): void;
      removeBackPrimaryLayer(layer: BaseLayer): void;
      flip(): void;
      /**
        * レイヤの表と裏を入れ替える。
        * レンダラーの入れ替えは実施しないため、これまで裏ページだったものが画面に表示される状態となる。
        * トランジションが終わったらresetPrimaryLayersRendererを呼び、
        * レンダラーとの紐付けを正しい状態に戻すこと。
        */
      flipPrimaryLayers(): void;
      /**
        * レンダラーの再設定
        */
      resetPrimaryLayersRenderer(): void;
      lockScreenShot(): void;
      unlockScreenShot(): void;
      /**
        * トランジション完了時にTransManagerから呼ばれる。
        * この時点で表ページ・裏ページの入れ替えは完了している。
        */
      onCompleteTrans(): boolean;
      onWindowClose(): boolean;
      onMouseEnter(e: PonMouseEvent): void;
      onMouseLeave(e: PonMouseEvent): void;
      onMouseMove(e: PonMouseEvent): void;
      onMouseDown(e: PonMouseEvent): void;
      onMouseUp(e: PonMouseEvent): void;
      onMouseWheel(e: PonWheelEvent): boolean;
      onKeyDown(e: PonKeyEvent): boolean;
      onKeyUp(e: PonKeyEvent): boolean;
  }
}

declare module 'ponkan3/base/pon-key-event' {
  export class PonKeyEvent {
    constructor(e: KeyboardEvent);
    readonly key: string;
    readonly ctrl: boolean;
    readonly shift: boolean;
    readonly alt: boolean;
  }
}

declare module 'ponkan3/base/pon-mouse-event' {
  export class PonMouseEvent {
    readonly x: number;
    readonly y: number;
    readonly button: number;
    constructor(x: number, y: number, button: number);
    constructor(e: MouseEvent);
    readonly isLeft: boolean;
    readonly isCenter: boolean;
    readonly isRight: boolean;
    stopPropagation(): void;
    readonly stopPropagationFlag: boolean;
    forceStop(): void;
    readonly forceStopFlag: boolean;
  }
}

declare module 'ponkan3/base/pon-wheel-event' {
  export class PonWheelEvent {
    readonly deltaX: number;
    readonly deltaY: number;
    constructor(e: WheelEvent);
    readonly isUp: boolean;
    readonly isDown: boolean;
  }
}

declare module 'ponkan3/base/sound' {
  import { Resource } from "ponkan3/base/resource";
  export interface ISoundBufferCallbacks {
    onStop(bufferNum: number): void;
    onFadeComplete(bufferNum: number): void;
  }
  export enum SoundState {
    Stop = 0,
    Play = 1,
    Pause = 2,
    Fade = 3,
    Fadein = 4,
    Fadeout = 5
  }
  export class SoundBuffer {
    readonly bufferNum: number;
    protected callback: ISoundBufferCallbacks;
    protected resource: Resource;
    howl: Howl | null;
    filePath: string | null;
    protected _state: SoundState;
    protected _volume: number;
    protected _gvolume: number;
    protected _seek: number;
    protected _loop: boolean;
    protected fadeStartVolume: number;
    protected fadeTargetVolume: number;
    protected fadeTime: number;
    protected stopAfterFade: boolean;
    constructor(resource: Resource, bufferNum: number, callback: ISoundBufferCallbacks);
    loadSound(filePath: string): Promise<void>;
    readonly hasSound: boolean;
    freeSound(): void;
    protected setHowlerEvent(): void;
    protected setHowlerOptions(): void;
    readonly state: SoundState;
    volume: number;
    gvolume: number;
    seek: number;
    loop: boolean;
    readonly playing: boolean;
    readonly fading: boolean;
    play(): void;
    stop(): void;
    pause(): void;
    fade(volume: number, time: number, autoStop: boolean): void;
    fadein(volume: number, time: number): void;
    fadeout(time: number, autoStop: boolean): void;
    endFade(): void;
    protected onFade(): void;
    protected static soundBufferStoreParams: string[];
    store(tick: number): any;
    restore(data: any, tick: number): Promise<void>;
    restoreAfterLoad(data: any, tick: number): void;
    storeSystem(): any;
    restoreSystem(data: any): void;
  }
}

declare module 'ponkan3/base/tag' {
  export class Tag {
    readonly name: string;
    readonly values: any;
    readonly line: number;
    constructor(name: string, values: any, line: number);
    debugPrint(): void;
    clone(): Tag;
  }
}

declare module 'ponkan3/layer/history-layer' {
  import { BaseLayer } from "ponkan3/base/base-layer";
  import { PonGame } from "ponkan3/base/pon-game";
  import { PonMouseEvent } from "ponkan3/base/pon-mouse-event";
  import { PonWheelEvent } from "ponkan3/base/pon-wheel-event";
  import { Resource } from "ponkan3/base/resource";
  import { Button } from "ponkan3/layer/button";
  export class HistoryButton extends Button {
    initHistoryButton(imagePath: string): Promise<void>;
    clearHistoryButton(): void;
    setButtonStatus(status: "normal" | "over" | "on" | "disabled"): void;
    setCallbacks(callbacks: any): void;
    onMouseDown(e: PonMouseEvent): void;
    onMouseUp(e: PonMouseEvent): void;
  }
  class SimpleButton extends BaseLayer {
    protected bgColors: number[];
    protected bgAlphas: number[];
    protected status: "normal" | "over" | "on";
    mouseEnter: (sender: SimpleButton) => void;
    mouseLeave: (sender: SimpleButton) => void;
    mouseMove: (sender: SimpleButton) => void;
    mouseDown: (sender: SimpleButton) => void;
    mouseUp: (sender: SimpleButton) => void;
    initButton(bgColors: number[], bgAlphas: number[]): void;
    setStatus(status: "normal" | "over" | "on"): void;
    onMouseEnter(e: PonMouseEvent): void;
    onMouseLeave(e: PonMouseEvent): void;
    onMouseMove(e: PonMouseEvent): void;
    onMouseDown(e: PonMouseEvent): void;
    onMouseUp(e: PonMouseEvent): void;
  }
  class ScrollBarButton extends SimpleButton {
    down: boolean;
    downX: number;
    downY: number;
    onMouseDown(e: PonMouseEvent): void;
    onMouseMove(e: PonMouseEvent): void;
    onMouseUp(e: PonMouseEvent): void;
  }
  class ScrollBar extends BaseLayer {
    protected minHeight: number;
    protected bar: ScrollBarButton;
    onChangeCallback: (sender: ScrollBar) => void;
    constructor(name: string, resource: Resource, owner: PonGame);
    initScrollBar(config: any, buttonColors: number[], buttonAlphas: number[], minHeight: number): void;
    setValues(currentPoint: number, maxPoint: number, linesCount: number, screenLineCount: number): void;
    onMouseEnter(e: PonMouseEvent): void;
    onMouseLeave(e: PonMouseEvent): void;
    onMouseDown(e: PonMouseEvent): void;
    onMouseMove(e: PonMouseEvent): void;
    onMouseUp(e: PonMouseEvent): void;
    protected setBarY(y: number): void;
    getBarPoint(): number;
    readonly dragging: boolean;
  }
  class HistoryTextLayer extends BaseLayer {
    protected lines: string[][];
    protected maxLinesCount: number;
    protected indentPoints: number[];
    protected clearIndentPoints: number[];
    readonly currentLine: string[];
    scrollOffLines: number;
    protected point: number;
    protected lazyRedrawFlag: boolean;
    constructor(name: string, resource: Resource, owner: PonGame);
    init(config: any): void;
    clear(): void;
    readonly historyText: string;
    add(ch: string): void;
    textReturn(): void;
    setHistoryIndentPoint(): void;
    clearHistoryIndentPoint(): void;
    scrollUp(count?: number): void;
    scrollDown(count?: number): void;
    scrollUpPage(): void;
    scrollDownPage(): void;
    goTo(point: number): void;
    goToEnd(): void;
    redraw(): void;
    redrawLazy(): void;
    update(tick: number): void;
    readonly screenLineCount: number;
    readonly maxPoint: number;
    readonly currentPoint: number;
    readonly linesCount: number;
  }
  /**
    * 履歴レイヤ
    */
  export class HistoryLayer extends BaseLayer {
    protected config: any;
    protected textLayer: HistoryTextLayer;
    protected upButton: HistoryButton;
    protected downButton: HistoryButton;
    protected scrollBar: ScrollBar;
    protected closeButton: HistoryButton;
    wheelScrollCount: number;
    enableOutput: boolean;
    constructor(name: string, resource: Resource, owner: PonGame);
    init(config?: any): Promise<void>;
    protected initScrollButtons(config: any): void;
    protected initScrollBar(config: any): void;
    protected initCloseButton(config: any): void;
    addHistoryChar(ch: string): void;
    addHistoryTextReturn(): void;
    clearHistory(): void;
    show(): void;
    hide(): void;
    scrollUp(count?: number): void;
    scrollUpPage(): void;
    scrollDown(count?: number): void;
    scrollDownPage(): void;
    resetScrollBar(): void;
    setHistoryIndentPoint(): void;
    clearHistoryIndentPoint(): void;
    goToEnd(): void;
    onMouseEnter(e: PonMouseEvent): void;
    onMouseLeave(e: PonMouseEvent): void;
    onMouseMove(e: PonMouseEvent): void;
    onMouseDown(e: PonMouseEvent): void;
    onMouseUp(e: PonMouseEvent): void;
    onMouseWheel(e: PonWheelEvent): boolean;
    store(tick: number): any;
    restore(data: any, tick: number, clear: boolean): Promise<void>;
  }
  export {};
}

declare module 'ponkan3/layer/pon-layer' {
  import { BaseLayer } from "ponkan3/base/base-layer";
  import { Resource } from "ponkan3/base/resource";
  import { Ponkan3 } from "ponkan3/ponkan3";
  import { FilteredLayer } from "ponkan3/layer/filtered-layer";
  export class PonLayer extends FilteredLayer {
      autoHideWithMessage: boolean;
      visibleBuffer: boolean;
      childImages: BaseLayer[];
      constructor(name: string, resource: Resource, owner: Ponkan3);
      /**
        * [override]
        */
      addChar(ch: string): void;
      /**
        * [override]
        */
      addTextReturn(): void;
      /**
        * 画像を追加で読み込む。
        * @param filePath ファイルパス
        * @param x 描画先座標
        * @param y 描画先座標
        * @param alpha アルファ値
        */
      loadChildImage(filePath: string, x: number, y: number, alpha: number): Promise<void>;
      freeChildImages(): void;
      freeImage(): void;
      protected static ponLayerStoreParams: string[];
      storeVisible(): void;
      restoreVisible(): void;
      store(tick: number): any;
      restore(data: any, tick: number, clear: boolean): Promise<void>;
      copyTo(dest: PonLayer): void;
  }
}

declare module 'ponkan3/plugin/pon-plugin' {
  /**
    * Ponkan3プラグイン
    */
  export class PonPlugin {
      /**
        * プラグインを破棄するときに呼ばれる
        */
      destroy(): void;
      /**
        * セーブデータ保存時
        * @param data 保存先のオブジェクト
        */
      onStore(data: any, tick: number): void;
      /**
        * セーブデータ復元時
        * @param data 復元元データ
        * @param tick 復元時の時間
        * @param clear メッセージをクリアする場合はtrue
        * @param sound 音声を復元する場合はtrue
        * @param toBack 表ページを裏ページに復元する場合はtrue
        */
      onRestore(data: any, tick: number, clear: boolean, sound: boolean, toBack: boolean): Promise<void>;
      /**
        * 状態更新時
        * @param tick 時間
        */
      onUpdate(tick: number): void;
      /**
        * 描画前
        * @param tick 時間
        */
      beforeDraw(tick: number): void;
      /**
        * ゲーム進行の状態が変化したときに呼ばれる
        * @param isStable 安定していればtrue
        */
      onChangeStable(isStable: boolean): void;
      /**
        * メッセージを一時的に隠す／戻すときに呼ばれる
        * @param visible 隠すときfalse、表示するときtrue
        */
      onChangeMessageVisible(visible: boolean): void;
      /**
        * backlayなどでレイヤーがコピーされるときに呼ばれる
        */
      onBacklay(): void;
      /**
        * backlayなどでレイヤーがコピーされるときに呼ばれる
        * @param srcLayers コピー元レイヤ
        * @param destLayers コピー先レイヤ
        * @param srcpage コピー元ページ
        * @param destpage コピー先ページ
        */
      onCopylay(srcLayers: any[], destLayers: any[], srcpage: string, destpage: string): void;
      /**
        * レイヤーの表と裏が入れ替わった後に呼ばれる。
        * 呼び出された時点で、すでにレイヤーは入れ替わっているため、
        * ここではレイヤーが入れ替わったことで情報が矛盾するものを入れ替える。
        * たとえば foreLayers や backLayers への参照を保持していた場合などは、
        * ここで入れ替える必要がある。
        */
      onFlipLayers(): void;
      /**
        * システム変数（sv）を保存する直前に呼ばれる
        */
      onSaveSystemVariables(): void;
  }
}

declare module 'ponkan3/base/pon-sprite' {
  import * as PIXI from "pixi.js";
  /**
    * PonSpriteのコールバック
    */
  export interface IPonSpriteCallbacks {
      /**
        * コンテナにスプライトを追加する
        * @param child 追加するスプライト
        */
      pixiContainerAddChild(child: PIXI.DisplayObject): void;
      /**
        * コンテナからスプライトを削除する
        * @param child 削除するスプライト
        */
      pixiContainerRemoveChild(child: PIXI.DisplayObject): void;
  }
  export enum SpriteType {
      Unknown = 0,
      Image = 1,
      Color = 2,
      Text = 3,
      Canvas = 4
  }
  /**
    * スプライト
    */
  export class PonSprite {
      /** x座標 */
      x: number;
      /** y座標 */
      y: number;
      /** 幅 */
      width: number;
      /** 高さ */
      height: number;
      /** スケーリング x */
      scaleX: number;
      /** スケーリング y */
      scaleY: number;
      /** 表示状態 */
      visible: boolean;
      /** テキスト */
      readonly text: string | null;
      /** テキストスタイル */
      readonly textStyle: PIXI.TextStyle | null;
      /** テキストの文字間 */
      readonly textPitch: number;
      /** テキストの横幅 */
      readonly textWidth: number;
      /**
        * @param callbacks コールバック
        */
      constructor(callbacks: IPonSpriteCallbacks);
      /**
        * 破棄
        */
      destroy(): void;
      /**
        * スプライトをクリアする。
        * 内部で保持しているPIXIのスプライトを開放する。
        * このスプライトの保持している座標、サイズ、表示状態などはクリアされず、
        * そのままの状態を保つ。
        */
      clear(): void;
      /**
        * スプライトにテキストを描画する。
        * テキストに合わせて幅と高さは自動で設定される
        * @param text 文字
        * @param style 描画スタイル
        */
      createText(text: string, style: PIXI.TextStyle, pitch: number): void;
      /**
        * スプライトを単色で塗りつぶす。
        * これを使用する前に事前にスプライトの幅と高さを設定しておく必要がある。
        * @param color 色 0xRRGGBB
        * @param alpha アルファ値 0.0〜1.0
        */
      fillColor(color: number, alpha: number): void;
      /**
        * スプライトの塗りつぶしをクリアする
        */
      clearColor(): void;
      /**
        * 画像を設定する
        * @param image 画像
        */
      setImage(image: HTMLImageElement): void;
      /**
        * キャンバスを設定する
        * @param canvas キャンバス
        */
      setCanvas(canvas: HTMLCanvasElement): void;
      beforeDraw(): void;
  }
}

declare module 'ponkan3/base/pon-video' {
  import * as PIXI from "pixi.js";
  /**
    * PonVideoのコールバック
    */
  export interface IPonVideoCallbacks {
      /**
        * コンテナに動画を追加する
        * @param child 追加するスプライト
        */
      pixiContainerAddChild(child: PIXI.DisplayObject): void;
      /**
        * コンテナから動画を削除する
        * @param child 削除するスプライト
        */
      pixiContainerRemoveChild(child: PIXI.DisplayObject): void;
  }
  /**
    * 動画スプライト
    */
  export class PonVideo {
      protected callbacks: IPonVideoCallbacks;
      protected videoTexture: PIXI.Texture;
      protected videoSprite: PIXI.Sprite;
      readonly texture: PIXI.Texture;
      readonly sprite: PIXI.Sprite;
      readonly source: HTMLVideoElement;
      width: number;
      height: number;
      loop: boolean;
      volume: number;
      readonly playing: boolean;
      /**
        * @param callbacks コールバック
        */
      constructor(videoTexture: PIXI.Texture, callbacks: IPonVideoCallbacks);
      /**
        * 破棄
        */
      destroy(): void;
      /**
        * スプライトをクリアする。
        * 内部で保持しているPIXIのスプライトを開放する。
        * このスプライトの保持している座標、サイズ、表示状態などはクリアされず、
        * そのままの状態を保つ。
        */
      clear(): void;
      play(): void;
      stop(): void;
      pause(): void;
  }
}

declare module 'ponkan3/base/resource' {
  import { Macro } from "ponkan3/base/macro";
  import { PonGame } from "ponkan3/base/pon-game";
  import { Script } from "ponkan3/base/script";
  import * as PIXI from "pixi.js";
  export class Resource {
      gameVersion: string;
      enableResourceCache: boolean;
      tmpVar: any;
      gameVar: any;
      systemVar: any;
      enabledScriptCache: boolean;
      cursor: any;
      readonly macroInfo: any;
      macroParams: object | null;
      commandShortcut: any;
      constructor(ponGame: PonGame, basePath?: string, gameVersion?: string);
      getForeCanvasElm(): HTMLCanvasElement;
      getBackCanvasElm(): HTMLCanvasElement;
      saveSystemData(saveDataPrefix: string): void;
      loadSystemData(saveDataPrefix: string): void;
      existSystemData(saveDataPrefix: string): boolean;
      debugClearSystemData(): void;
      evalJs(js: string): any;
      setMacroParams(params: any): void;
      clearMacroParams(): void;
      /**
        * リソースのパスを取得する。
        * @param filePath ファイルパス（basePathからの相対パス）
        * @return 補完後のパス
        */
      getPath(filePath: string): string;
      hasMacro(name: string): boolean;
      getMacro(name: string): Macro;
      /**
        * テキストを読み込む
        * @param filePath ファイルパス（basePathからの相対パス）
        * @return コールバックオブジェクト
        */
      loadText(filePath: string): Promise<string>;
      /**
        * スクリプトファイルを読み込む
        * @param filePath ファイルパス（basePathからの相対パス）
        * @return コールバックオブジェクト
        */
      loadScript(filePath: string): Promise<Script>;
      /**
        * 画像を読み込む
        * @param filePath ファイルパス（basePathからの相対パス）
        * @return コールバックオブジェクト
        */
      loadImage(filePath: string): Promise<HTMLImageElement>;
      loadSoundHowler(filePath: string): Promise<Howl>;
      loadVideoTexture(filePath: string, autoPlay: boolean): PIXI.Texture;
      isEnabledLocalStorage(): boolean;
      storeToLocalStorage(name: string, data: string): void;
      restoreFromLocalStorage(name: string): string;
      copyLocalStorage(srcName: string, destName: string): boolean;
  }
}

declare module 'ponkan3/base/conductor' {
  import { PonEventHandler } from "ponkan3/base/pon-event-handler";
  import { ReadUnread } from "ponkan3/base/read-unread";
  import { Resource } from "ponkan3/base/resource";
  import { Script } from "ponkan3/base/script";
  import { Tag } from "ponkan3/base/tag";
  export interface IConductorEvent {
      onLabel(labelName: string, line: number, tick: number): "continue" | "break";
      onSaveMark(saveMarkName: string, comment: string, line: number, tick: number): "continue" | "break";
      onJs(js: string, printFlag: boolean, line: number, tick: number): "continue" | "break";
      onTag(tag: Tag, line: number, tick: number): "continue" | "break";
      onChangeStable(isStable: boolean): void;
      onError(e: any): void;
  }
  export enum ConductorState {
      Stop = 0,
      Run = 1,
      Sleep = 2
  }
  export class Conductor {
      protected resource: Resource;
      readonly name: string;
      protected eventCallbacks: IConductorEvent;
      latestScriptFilePath: string;
      protected _script: Script;
      readonly script: Script;
      protected _status: ConductorState;
      readonly status: ConductorState;
      protected sleepStartTick: number;
      protected sleepTime: number;
      sleepSender: string;
      protected stableBuffer: boolean;
      protected eventHandlers: any;
      protected eventHandlersStack: any[];
      latestSaveMarkName: string;
      readUnread: ReadUnread;
      constructor(resource: Resource, name: string, eventCallbacks: IConductorEvent);
      loadScript(filePath: string): Promise<void>;
      /**
        * 指定のファイル・ラベルの位置へ移動する。
        * ラベルが省略されたときは、ファイルの先頭となる。
        * ファイルが省略されたときは、現在のファイル内でラベル移動のみ行う。
        * @param file 移動先ファイル
        * @param label 移動先ラベル
        * @param countPage 既読処理をするかどうか
        */
      jump(filePath: string | null, label?: string | null, countPage?: boolean): Promise<void>;
      isPassed(labelName: string): boolean;
      isPassedLatestSaveMark(): boolean;
      passSaveMark(saveMarkName: string): void;
      passLatestSaveMark(): void;
      conduct(tick: number): void;
      start(): "continue" | "break";
      stop(): "continue" | "break";
      sleep(tick: number, sleepTime: number, sender: string): "continue" | "break";
      readonly isStable: boolean;
      addEventHandler(handler: PonEventHandler): void;
      hasEventHandler(eventName: string): boolean;
      /**
        * イベントハンドラの引き金を引く
        * @param eventName イベント名
        * @return イベントハンドラが1つ以上実行されればtrue
        */
      trigger(eventName: string): boolean;
      clearAllEventHandler(): void;
      clearEventHandler(eventHandler: PonEventHandler): void;
      clearEventHandlerByName(eventName: string): void;
      protected static conductorStoreParams: string[];
      store(saveMarkName: string, tick: number): any;
      /**
        * 復元。ステータスの値は復元されるが、再スタートなどはしないので注意。
        */
      restore(data: any, tick: number): Promise<void>;
  }
}

declare module 'ponkan3/base/logger' {
  export class Logger {
    static LEVEL_ERROR: number;
    static LEVEL_WARN: number;
    static LEVEL_INFO: number;
    static LEVEL_DEBUG: number;
    static LEVEL_TRACE: number;
    static level: number;
    static error(...messages: any[]): void;
    static WARN(...messages: any[]): void;
    static info(...messages: any[]): void;
    static debug(...messages: any[]): void;
    static trace(...messages: any[]): void;
  }
}

declare module 'ponkan3/base/pon-renderer' {
  import * as PIXI from "pixi.js";
  export class PonRenderer {
    readonly renderer: PIXI.WebGLRenderer;
    readonly width: number;
    readonly height: number;
    readonly canvasElm: HTMLCanvasElement;
    readonly texture: PIXI.Texture;
    readonly sprite: PIXI.Sprite;
    readonly container: PIXI.Container;
    constructor(parentElm: HTMLElement, width: number, height: number);
    destroy(): void;
    draw(tick: number): void;
    addContainer(child: PIXI.Container): void;
    removeContainer(child: PIXI.Container): void;
    setOtherRenderer(renderer: PonRenderer): void;
    delOtherRenderer(): void;
  }
}

declare module 'ponkan3/base/screen-shot' {
  export class ScreenShot {
    readonly nodata: string;
    constructor(config: any);
    draw(mainCanvas: HTMLCanvasElement): void;
    getDataUrl(): string;
  }
}

declare module 'ponkan3/base/trans-manager' {
  import { PonGame } from "ponkan3/base/pon-game";
  import { Resource } from "ponkan3/base/resource";
  export class TransManager {
    constructor(game: PonGame, resource: Resource);
    initTrans(time: number, method: "scroll-to-right" | "scroll-to-left" | "scroll-to-top" | "scroll-to-bottom" | "univ" | "crossfade"): Promise<void>;
    initUnivTrans(time: number, ruleFilePath: string, vague?: number): Promise<void>;
    readonly isRunning: boolean;
    /**
      * トランジションを停止する。
      * PonGameのonCompleteTransも呼び出される。
      */
    stop(): void;
    start(): void;
    draw(tick: number): void;
    drawScrollHorizontal(tick: number, elapsedTime: number, to: "left" | "right"): void;
    drawScrollVertical(tick: number, elapsedTime: number, to: "top" | "bottom"): void;
    drawCrossFade(tick: number, elapsedTime: number): void;
    drawUniv(tick: number, elapsedTime: number): void;
  }
}

declare module 'ponkan3/layer/button' {
  import { BaseLayer } from "ponkan3/base/base-layer";
  import { PonMouseEvent } from "ponkan3/base/pon-mouse-event";
  export class Button extends BaseLayer {
    protected insideFlag: boolean;
    protected buttonStatus: "normal" | "over" | "on" | "disabled";
    protected down: boolean;
    initButton(): void;
    clearButton(): void;
    setButtonStatus(status: "normal" | "over" | "on" | "disabled"): void;
    onMouseEnter(e: PonMouseEvent): void;
    onMouseLeave(e: PonMouseEvent): void;
    onMouseDown(e: PonMouseEvent): void;
    onMouseUp(e: PonMouseEvent): void;
    protected static buttonStoreParams: string[];
    store(tick: number): any;
    restore(data: any, tick: number, clear: boolean): Promise<void>;
    copyTo(dest: Button): void;
  }
  /**
    * textbuttonコマンドやimagebuttonコマンドで生成するボタンの機能
    */
  export class CommandButton extends Button {
    protected jump: boolean;
    protected call: boolean;
    protected filePath: string | null;
    protected label: string | null;
    protected countPage: boolean;
    protected isSystemButton: boolean;
    protected onEnterExp: string | null;
    protected onLeaveExp: string | null;
    protected onClickExp: string | null;
    protected onEnterSoundBuf: string | null;
    protected onLeaveSoundBuf: string | null;
    protected onClickSoundBuf: string | null;
    protected systemButtonLocked: boolean;
    initCommandButton(jump?: boolean, call?: boolean, filePath?: string | null, label?: string | null, countPage?: boolean, isSystemButton?: boolean, onEnterExp?: string | null, onLeaveExp?: string | null, onClickExp?: string | null, onEnterSoundBuf?: string | null, onLeaveSoundBuf?: string | null, onClickSoundBuf?: string | null): void;
    clearCommandButton(): void;
    lockSystemButton(): void;
    unlockSystemButton(): void;
    onChangeStable(isStable: boolean): void;
    onMouseEnter(e: PonMouseEvent): void;
    onMouseLeave(e: PonMouseEvent): void;
    onMouseUp(e: PonMouseEvent): Promise<void>;
    protected static commandButtonStoreParams: string[];
    store(tick: number): any;
    restore(data: any, tick: number, clear: boolean): Promise<void>;
    restoreAfterLoadImage(data: any, tick: number): void;
    copyTo(dest: CommandButton): void;
  }
}

declare module 'ponkan3/layer/filtered-layer' {
  import { Resource } from "ponkan3/base/resource";
  import { Ponkan3 } from "ponkan3/ponkan3";
  import { MovableLayer } from "ponkan3/layer/movable-layer";
  import { LayerFilter } from "ponkan3/filter/layer-filter";
  export class FilteredLayer extends MovableLayer {
    readonly pixiFilters: Array<PIXI.Filter<any>>;
    protected _filters: LayerFilter[];
    readonly filters: LayerFilter[];
    protected static filterClassList: any;
    constructor(name: string, resource: Resource, owner: Ponkan3);
    static registerFilter(filterName: string, createFunction: any): void;
    addFilter(filterName: string, params: any): void;
    protected addLayerFilter(filter: LayerFilter): void;
    clearFilters(): void;
    store(tick: number): any;
    restore(data: any, tick: number, clear: boolean): Promise<void>;
    copyTo(dest: FilteredLayer): void;
  }
}

declare module 'ponkan3/base/macro' {
  import { Tag } from "ponkan3/base/tag";
  export class Macro {
    readonly name: string;
    readonly tags: Tag[];
    protected tagPoint: number;
    params: any;
    constructor(name: string, tags: Tag[]);
    clone(): Macro;
    getCurrentTag(): Tag | null;
    /**
      * 次のタグを取得する。
      * スクリプトファイル終端の場合はnullが返る
      * @return 次のタグ。終端の場合はnull
      */
    getNextTag(): Tag | null;
    clearTagPoint(): void;
  }
}

declare module 'ponkan3/base/script' {
  import { Macro } from "ponkan3/base/macro";
  import { Resource } from "ponkan3/base/resource";
  import { ScriptParser } from "ponkan3/base/script-parser";
  import { Tag } from "ponkan3/base/tag";
  export interface IForLoopInfo {
      startTagPoint: number;
      indexVarName: string;
      loops: number;
      count: number;
  }
  export class Script {
      protected resource: Resource;
      protected _filePath: string;
      readonly filePath: string;
      protected parser: ScriptParser;
      protected tagPoint: number;
      protected latestTagBuffer: Tag | null;
      protected forLoopStack: IForLoopInfo[];
      protected ifDepth: number;
      protected macroStack: Macro[];
      constructor(resource: Resource, filePath: string, scriptText: string | null);
      debugPrint(): void;
      clone(): Script;
      goToStart(): void;
      goTo(point: number): void;
      getPoint(): number;
      /**
        * 指定のラベルの位置へ移動する。
        * ラベルの検索はファイルの先頭から実施するため、
        * ファイル内に同じラベルが2つ以上あった場合は、1番目の位置へ移動する。
        * ラベルが見つからなかった場合はエラーになる。
        * @param label 移動先ラベル
        */
      goToLabel(label: string): void;
      /**
        * 指定のセーブマーク位置まで移動する
        * 検索はファイルの先頭から実施するため、
        * ファイル内に同じセーブマークが2つ以上あった場合は、1番目の位置へ移動する。
        * ラベルが見つからなかった場合はエラーになる。
        * @param saveMarkName セーブマーク名
        */
      goToSaveMark(saveMarkName: string): void;
      /**
        * 現在実行中のタグを取得する。
        * @return 実行中のタグ。終端の場合はnull
        */
      getCurrentTag(): Tag | null;
      /**
        * 次のタグを取得する。
        * スクリプトファイル終端の場合はnullが返る
        * @return 次のタグ。終端の場合はnull
        */
      getNextTag(): Tag | null;
      protected callMacro(tag: Tag): void;
      isInsideOfMacro(): boolean;
      callCommandShortcut(orgTag: Tag, commandName: string): Tag;
      /**
        * 最後に取得されたタグを返す。
        */
      getLatestTag(): Tag | null;
      /**
        * マクロ定義を開始する
        */
      defineMacro(name: string): Macro;
      /**
        * 次のタグを取得する。マクロの呼び出しを行わない。
        */
      protected getNextTagWithoutMacro(): Tag | null;
      /**
        * 次のタグを取得する。マクロの呼び出しを行わない。
        * ただしマクロの中で呼び出されたときはそのマクロ内部で移動する。
        */
      protected getNextTagForIf(): Tag | null;
      /**
        * 条件分岐を開始
        * @param tagAction タグ動作定義マップ
        */
      ifJump(exp: string, tagActions: any): void;
      /**
        * elseかelsifかendifまでジャンプする。
        * elsifの場合は条件式の評価も行って判定する。
        * @param tagAction タグ動作定義マップ
        */
      protected goToElseFromIf(tagActions: any): void;
      /**
        * elsifタグの動作
        */
      elsifJump(): void;
      /**
        * elseタグの動作
        */
      elseJump(): void;
      /**
        * endifタグの動作
        */
      endif(): void;
      /**
        * endifまでジャンプする。
        */
      protected goToEndifFromElse(): void;
      isInsideOfIf(): boolean;
      /**
        * forループを開始
        * @param loops 繰り返し回数
        * @param indexVarName indexを格納する一時変数の名前。
        */
      startForLoop(loops: number, indexVarName?: string): void;
      /**
        * forLoopの終わり
        */
      endForLoop(): void;
      /**
        * forLoopから抜け出す
        */
      breakForLoop(): void;
      isInsideOfForLoop(): boolean;
  }
}

declare module 'ponkan3/base/pon-event-handler' {
  export class PonEventHandler {
    readonly eventName: string;
    readonly callback: () => void;
    readonly info: string;
    constructor(eventName: string, callback: () => void, info: string);
    fire(): void;
  }
}

declare module 'ponkan3/base/read-unread' {
  import { Resource } from "ponkan3/base/resource";
  import { Script } from "ponkan3/base/script";
  export class ReadUnread {
    protected resource: Resource;
    protected readonly systemVar: any;
    constructor(resource: Resource);
    pass(script: Script, saveMarkName: string): void;
    isPassed(script: Script, label: string): boolean;
  }
}

declare module 'ponkan3/layer/movable-layer' {
  import { Resource } from "ponkan3/base/resource";
  import { Ponkan3 } from "ponkan3/ponkan3";
  import { SliderLayer } from "ponkan3/layer/slider-layer";
  export interface IMovePosInfo {
      x: number;
      y: number;
      alpha: number;
      scalex: number;
      scaley: number;
  }
  export class MovableLayer extends SliderLayer {
      protected _isMoving: boolean;
      protected moveType: "linear" | "bezier2" | "bezier3" | "catmullrom";
      protected moveEase: "none" | "in" | "out" | "both";
      protected movePosList: IMovePosInfo[];
      protected movePoint: number;
      protected moveTime: number;
      protected moveDelay: number;
      protected moveLoop: boolean;
      protected moveTotalTime: number;
      protected moveStartTick: number;
      protected moveDelayStartTick: number;
      readonly isMoving: boolean;
      readonly isLoopMoving: boolean;
      constructor(name: string, resource: Resource, owner: Ponkan3);
      startMove(tick: number, time: number, delay: number, path: IMovePosInfo[], type: "linear" | "bezier2" | "bezier3" | "catmullrom", ease: "none" | "in" | "out" | "both", loop: boolean): void;
      stopMove(triggerEvent?: boolean): void;
      update(tick: number): void;
      /**
        * 緩やかに開始する（2次関数補間）
        * @param phase フェーズ（0～1の値）
        * @return 補正後のフェーズ（0～1の値）
        */
      protected moveEaseIn(phase: number): number;
      /**
        * 緩やかに停止する（2次関数補間）
        * @param phase フェーズ（0～1の値）
        * @return 補正後のフェーズ（0～1の値）
        */
      protected moveEaseOut(phase: number): number;
      /**
        * 緩やかに開始・終了する（3次関数補間）
        * @param phase フェーズ（0～1の値）
        * @return 補正後のフェーズ（0～1の値）
        */
      protected moveEaseInOut(phase: number): number;
      /**
        * 直線移動する
        * @param tick 時刻
        * @param phase フェーズ（0～1の値）
        */
      protected moveLinear(tick: number, phase: number): void;
      /**
        * 2次ベジエ曲線で移動する
        * @param tick 時刻
        * @param phase フェーズ（0～1の値）
        */
      protected moveBezierCurve2(tick: number, phase: number): void;
      /**
        * 3次ベジエ曲線で移動する
        * @param tick 時刻
        * @param phase フェーズ（0～1の値）
        */
      protected moveBezierCurve3(tick: number, phase: number): void;
      /**
        * CatmullRomスプラインで移動する
        * @param tick 時刻
        * @param phase フェーズ（0～1の値）
        */
      protected moveCatmullRom(tick: number, phase: number): void;
      /**
        * CatmullRom補間
        * @param p0 点0
        * @param p1 点1
        * @param p2 点2
        * @param p3 点3
        * @param t 時間
        * @return 補間後の点
        */
      protected catmullRom(p0: number, p1: number, p2: number, p3: number, t: number): number;
      protected static movableLayerStoreParams: string[];
      store(tick: number): any;
      restore(data: any, tick: number, clear: boolean): Promise<void>;
      copyTo(dest: MovableLayer): void;
  }
}

declare module 'ponkan3/filter/layer-filter' {
  export class LayerFilter {
    static readonly filterName: string;
    readonly filterName: string;
    readonly pixiFilter: PIXI.Filter<any>;
    protected _filter: PIXI.Filter<any>;
    protected params: any;
    constructor(params: any, permitedList?: string[]);
    protected permitParams(params: any, list: string[]): any;
    store(): any;
  }
}

declare module 'ponkan3/base/script-parser' {
  import { Resource } from "ponkan3/base/resource";
  import { Tag } from "ponkan3/base/tag";
  export class ScriptParser {
    readonly tags: Tag[];
    constructor(resource: Resource, scriptText: string);
    debugPrint(): void;
  }
}

declare module 'ponkan3/layer/slider-layer' {
  import { BaseLayer } from "ponkan3/base/base-layer";
  import { PonGame } from "ponkan3/base/pon-game";
  import { PonMouseEvent } from "ponkan3/base/pon-mouse-event";
  import { Resource } from "ponkan3/base/resource";
  import { Button } from "ponkan3/layer/button";
  import { ToggleButtonLayer } from "ponkan3/layer/toggle-button-layer";
  export class SliderButton extends Button {
    initSliderButton(imagePath: string): Promise<void>;
    clearSliderButton(): void;
    setButtonStatus(status: "normal" | "over" | "on" | "disabled"): void;
    setCallbacks(callbacks: any): void;
    onMouseDown(e: PonMouseEvent): void;
    onMouseUp(e: PonMouseEvent): void;
  }
  /**
    * スライダー
    */
  export class Slider extends BaseLayer {
    protected foreImage: BaseLayer;
    protected button: SliderButton;
    protected locked: boolean;
    protected value: number;
    protected exp: string | ((v: number) => void);
    protected down: boolean;
    constructor(name: string, resource: Resource, owner: PonGame);
    initSlider(value: number, exp: string | ((v: number) => void), backImagePath: string, foreImagePath: string, buttonImagePath: string): Promise<void>;
    clearSlider(): void;
    lock(): void;
    unlock(): void;
    setValueX(x: number): void;
    setValue(value: number): void;
    onButtonDown(e: PonMouseEvent): void;
    onButtonUp(e: PonMouseEvent): void;
    onMouseEnter(e: PonMouseEvent): void;
    onMouseLeave(e: PonMouseEvent): void;
    onMouseDown(e: PonMouseEvent): void;
    onMouseMove(e: PonMouseEvent): void;
    onMouseUp(e: PonMouseEvent): void;
    protected static sliderStoreParams: string[];
    store(tick: number): any;
    restore(data: any, tick: number, clear: boolean): Promise<void>;
    restoreAfterLoadImage(data: any, tick: number): void;
    copyTo(dest: Slider): void;
  }
  export class SliderLayer extends ToggleButtonLayer {
    addSlider(x: number, y: number, value: number, exp: string | ((v: number) => void), backImagePath: string, foreImagePath: string, buttonImagePath: string): Promise<void>;
    clearSliders(): void;
    lockSliders(): void;
    unlockSliders(): void;
    store(tick: number): any;
    restore(data: any, tick: number, clear: boolean): Promise<void>;
    protected restoreAfterLoadImage(data: any, tick: number): void;
    copyTo(dest: SliderLayer): void;
  }
}

declare module 'ponkan3/layer/toggle-button-layer' {
  import { ImageButtonLayer } from "ponkan3/layer/image-button-layer";
  import { ToggleButton } from "ponkan3/layer/toggle-button";
  export class ImageToggleButton extends ToggleButton {
    protected direction: "horizontal" | "vertical";
    initImageToggleButton(filePath: string, varName: string, isSystemButton: boolean | undefined, exp: string | null, direction: "horizontal" | "vertical"): Promise<void>;
    clearToggleButton(): void;
    setValue(value: boolean): void;
    protected static imageToggleButtonStoreParams: string[];
    store(tick: number): any;
    restore(data: any, tick: number, clear: boolean): Promise<void>;
    restoreAfterLoadImage(data: any, tick: number): void;
    copyTo(dest: ImageToggleButton): void;
  }
  export class ToggleButtonLayer extends ImageButtonLayer {
    addToggleButton(filePath: string, x: number, y: number, varName: string, isSystemButton: boolean | undefined, exp: string | null, direction: "horizontal" | "vertical"): Promise<void>;
    clearToggleButtons(): void;
    lockButtons(): void;
    unlockButtons(): void;
    lockSystemButtons(): void;
    unlockSystemButtons(): void;
    store(tick: number): any;
    restore(data: any, tick: number, clear: boolean): Promise<void>;
    protected restoreAfterLoadImage(data: any, tick: number): void;
    copyTo(dest: ToggleButtonLayer): void;
  }
}

declare module 'ponkan3/layer/image-button-layer' {
  import { CommandButton } from "ponkan3/layer/button";
  import { TextButtonLayer } from "ponkan3/layer/text-button-layer";
  export class CommandImageButton extends CommandButton {
    protected direction: "horizontal" | "vertical";
    initImageButton(jump: boolean | undefined, call: boolean | undefined, filePath: string | null | undefined, label: string | null | undefined, countPage: boolean | undefined, isSystemButton: boolean | undefined, onEnterExp: string | null | undefined, onLeaveExp: string | null | undefined, onClickExp: string | null | undefined, file: string, direction: "horizontal" | "vertical", onEnterSoundBuf: string, onLeaveSoundBuf: string, onClickSoundBuf: string): Promise<void>;
    clearCommandButton(): void;
    setButtonStatus(status: "normal" | "over" | "on" | "disabled"): void;
    protected static imageButtonStoreParams: string[];
    store(tick: number): any;
    restore(data: any, tick: number, clear: boolean): Promise<void>;
    restoreAfterLoadImage(data: any, tick: number): void;
    copyTo(dest: CommandImageButton): void;
  }
  export class ImageButtonLayer extends TextButtonLayer {
    addImageButton(jump: boolean | undefined, call: boolean | undefined, filePath: string | null | undefined, label: string | null | undefined, countPage: boolean | undefined, onEnterExp: string | null | undefined, onLeaveExp: string | null | undefined, onClickExp: string | null | undefined, file: string, x: number, y: number, direction: "horizontal" | "vertical", isSystemButton: boolean, onEnterSoundBuf: string, onLeaveSoundBuf: string, onClickSoundBuf: string): Promise<void>;
    clearImageButtons(): void;
    lockButtons(): void;
    unlockButtons(): void;
    lockSystemButtons(): void;
    unlockSystemButtons(): void;
    store(tick: number): any;
    restore(data: any, tick: number, clear: boolean): Promise<void>;
    protected restoreAfterLoadImage(data: any, tick: number): void;
    copyTo(dest: ImageButtonLayer): void;
  }
}

declare module 'ponkan3/layer/toggle-button' {
  import { BaseLayer } from "ponkan3/base/base-layer";
  import { PonMouseEvent } from "ponkan3/base/pon-mouse-event";
  /**
    * トグルボタン機能
    */
  export class ToggleButton extends BaseLayer {
    protected insideFlag: boolean;
    protected buttonStatus: "enabled" | "disabled";
    protected varName: string;
    protected exp: string | null;
    protected isSystemButton: boolean;
    protected systemButtonLocked: boolean;
    initToggleButton(varName: string, isSystemButton: boolean, exp: string | null): void;
    clearToggleButton(): void;
    setButtonStatus(status: "enabled" | "disabled"): void;
    lockSystemButton(): void;
    unlockSystemButton(): void;
    setValue(value: boolean): void;
    getValue(): boolean;
    onChangeStable(isStable: boolean): void;
    onMouseEnter(e: PonMouseEvent): void;
    onMouseLeave(e: PonMouseEvent): void;
    onMouseDown(e: PonMouseEvent): void;
    onMouseUp(e: PonMouseEvent): void;
    protected static toggleButtonStoreParams: string[];
    store(tick: number): any;
    restore(data: any, tick: number, clear: boolean): Promise<void>;
    restoreAfterLoadImage(data: any, tick: number): void;
    copyTo(dest: ToggleButton): void;
  }
}

declare module 'ponkan3/layer/text-button-layer' {
  import { BaseLayer } from "ponkan3/base/base-layer";
  import { CommandButton } from "ponkan3/layer/button";
  import { FrameAnimLayer } from "ponkan3/layer/frame-anim-layer";
  /**
    * テキストと背景色を指定できるボタン
    */
  export class TextButton extends CommandButton {
      txtBtnNormalBackgroundColor: number;
      txtBtnOverBackgroundColor: number;
      txtBtnOnBackgroundColor: number;
      txtBtnNormalBackgroundAlpha: number;
      txtBtnOverBackgroundAlpha: number;
      txtBtnOnBackgroundAlpha: number;
      initTextButton(jump?: boolean, call?: boolean, filePath?: string | null, label?: string | null, countPage?: boolean, isSystemButton?: boolean, onEnterExp?: string | null, onLeaveExp?: string | null, onClickExp?: string | null, text?: string, normalBackgroundColor?: number, overBackgroundColor?: number, onBackgroundColor?: number, normalBackgroundAlpha?: number, overBackgroundAlpha?: number, onBackgroundAlpha?: number, onEnterSoundBuf?: string, onLeaveSoundBuf?: string, onClickSoundBuf?: string): void;
      clearCommandButton(): void;
      setButtonStatus(status: "normal" | "over" | "on" | "disabled"): void;
      resetTextButtonColors(): void;
      protected static textButtonStoreParams: string[];
      store(tick: number): any;
      restoreAfterLoadImage(data: any, tick: number): void;
      copyTo(dest: TextButton): void;
  }
  /**
    * テキストボタンを配置できるレイヤー
    */
  export class TextButtonLayer extends FrameAnimLayer {
      protected textButtons: TextButton[];
      addTextButton(btnName: string | undefined, jump: boolean | undefined, call: boolean | undefined, filePath: string | null | undefined, label: string | null | undefined, countPage: boolean | undefined, onEnterExp: string | null | undefined, onLeaveExp: string | null | undefined, onClickExp: string | null | undefined, text: string, x: number, y: number, width: number, height: number, backgroundColors: number[], backgroundAlphas: number[], isSystemButton: boolean, textMarginTop: number | undefined, textMarginRight: number | undefined, textMarginBottom: number | undefined, textMarginLeft: number | undefined, textAlign: "left" | "center" | "right" | undefined, onEnterSoundBuf: string, onLeaveSoundBuf: string, onClickSoundBuf: string): void;
      copyTextParams(destLayer: BaseLayer): void;
      clearTextButtons(): void;
      changeTextButtonColors(btnName: string, backgroundColors: number[]): void;
      changeTextButtonAlphas(btnName: string, backgroundAlphas: number[]): void;
      protected findTextButtonByName(btnName: string): TextButton[];
      lockButtons(): void;
      unlockButtons(): void;
      lockSystemButtons(): void;
      unlockSystemButtons(): void;
      store(tick: number): any;
      restore(data: any, tick: number, clear: boolean): Promise<void>;
      protected restoreAfterLoadImage(data: any, tick: number): void;
      copyTo(dest: TextButtonLayer): void;
  }
}

declare module 'ponkan3/layer/frame-anim-layer' {
  import { BaseLayer } from "ponkan3/base/base-layer";
  export class FrameAnimLayer extends BaseLayer {
    protected _frameAnimLoop: boolean;
    readonly frameAnimLoop: boolean;
    protected frameAnimTime: number;
    protected frameAnimWidth: number;
    protected frameAnimHeight: number;
    protected frameAnimFrames: any[];
    protected frameAnimStartTick: number;
    protected frameAnimState: "stop" | "run";
    initFrameAnim(loop: boolean, time: number, width: number, height: number, frames: any[]): void;
    readonly hasFrameAnim: boolean;
    readonly frameAnimRunning: boolean;
    startFrameAnim(tick: number): void;
    stopFrameAnim(triggerEvent?: boolean): void;
    deleteFrameAnim(): void;
    /**
      * [override]
      */
    update(tick: number): void;
    freeImage(): void;
    protected static frameAnimLayerStoreParams: string[];
    store(tick: number): any;
    restore(data: any, tick: number, clear: boolean): Promise<void>;
    protected restoreAfterLoadImage(data: any, tick: number): void;
    copyTo(dest: FrameAnimLayer): void;
  }
}

